function escapeRegExp(a){return a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function formatNumber(a,b){var c=a.toString();if(0>a)return c;if(b&&b>c.length)for(;b>c.length;)c="0"+c;return c}function extractDigits(a,b){b=b||a.length;var c=a.match(/^\d+/g),d=c&&c[0];return d?d.length<=b?d:d.substr(0,b):""}function removeQuatos(a){return stringDelimiter.test(a)?a.substr(1,a.length-2):a}function parseStringToDateLabels(a,b,c){var d={};if(null==a||null==b||null==c)return d;b.split(dateLabelsRegExp);return b.split(dateLabelsRegExp).forEach(function(b){var e;switch(b){case"d":case"dd":case"M":case"MM":case"h":case"hh":case"H":case"HH":case"m":case"mm":case"s":case"ss":e=2;case"yy":case"yyy":case"yyyy":e=e||4,d[b]=extractDigits(a,e),e=d[b].length;break;case"tt":e=0,a.toUpperCase().startsWith(c.DateTimeFormat.AMDesignator.toUpperCase())?e=c.DateTimeFormat.AMDesignator.length:a.toUpperCase().startsWith(c.DateTimeFormat.PMDesignator.toUpperCase())&&(e=c.DateTimeFormat.PMDesignator.length),d[b]=a.substr(0,e);break;default:e=0,b=removeQuatos(b),a.startsWith(b)&&(e=b.length)}a=a.slice(e)}),a.length>0?{}:d}function getTime(a,b){var c=parseInt(a.HH||a.H),d=parseInt(a.hh||a.h||a.time||12);if(isNaN(c)&&!isNaN(d)&&d>=1&&12>=d){if(null==a.tt)a.time||(c=0);else switch(a.tt.toUpperCase()){case b.DateTimeFormat.AMDesignator.toUpperCase():c=d%12;break;case b.DateTimeFormat.PMDesignator.toUpperCase():c=d%12+12}}var e=parseInt(a.mm||a.m||a.time||0),f=parseInt(a.ss||a.s||0);return isNaN(c)||isNaN(e)?NaN:1e3*(60*(60*c+e)+f)}function makeDOMException(){var e,tmp;try{return eval("new DOMException(DOMException.INVALID_CHARACTER_ERR)")}catch(tmp){var ex=new Error("DOM Exception 5");return ex.code=ex.number=5,ex.name=ex.description="INVALID_CHARACTER_ERR",ex.toString=function(){return"Error: "+ex.name+": "+ex.message},ex}}function getbyte64(a,b){var c=ALPHA_1.indexOf(a.charAt(b));if(-1===c)throw makeDOMException();return c}function decode(a){a=""+a;var b,c,d,e=a.length;if(0===e)return a;if(e%4!==0)throw makeDOMException();b=0,a.charAt(e-1)===PADCHAR_1&&(b=1,a.charAt(e-2)===PADCHAR_1&&(b=2),e-=4);var f=[];for(c=0;e>c;c+=4)d=getbyte64(a,c)<<18|getbyte64(a,c+1)<<12|getbyte64(a,c+2)<<6|getbyte64(a,c+3),f.push(String.fromCharCode(d>>16,d>>8&255,255&d));switch(b){case 1:d=getbyte64(a,c)<<18|getbyte64(a,c+1)<<12|getbyte64(a,c+2)<<6,f.push(String.fromCharCode(d>>16,d>>8&255));break;case 2:d=getbyte64(a,c)<<18|getbyte64(a,c+1)<<12,f.push(String.fromCharCode(d>>16))}return f.join("")}function getbyte(a,b){var c=a.charCodeAt(b);if(c>255)throw makeDOMException();return c}function encode(a){if(1!==arguments.length)throw new SyntaxError("Not enough arguments");var b,c,d=PADCHAR_1,e=ALPHA_1,f=[];a=""+a;var g=a.length-a.length%3;if(0===a.length)return a;for(b=0;g>b;b+=3)c=getbyte(a,b)<<16|getbyte(a,b+1)<<8|getbyte(a,b+2),f.push(e.charAt(c>>18)),f.push(e.charAt(c>>12&63)),f.push(e.charAt(c>>6&63)),f.push(e.charAt(63&c));switch(a.length-g){case 1:c=getbyte(a,b)<<16,f.push(e.charAt(c>>18)+e.charAt(c>>12&63)+d+d);break;case 2:c=getbyte(a,b)<<16|getbyte(a,b+1)<<8,f.push(e.charAt(c>>18)+e.charAt(c>>12&63)+e.charAt(c>>6&63)+d)}return f.join("")}var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},NerveImplementation;!function(a){var b=function(){function b(b){this.master=b,this.observers=[],this.bulkChangingModeStackedCount=0,this.changingPeriod=$.Deferred().resolve(),this.changeNotifier=new a.CallLater(this.notifyChange.bind(this)),this.rules=[],this.initializeSnapshot(),this.resetChangeInfo()}return b.prototype.getSnapshot=function(a){if(!this.snapshotCache){for(var b in this.dirtyProperties)this.refreshSubSnapshot(this.dirtyProperties[b]);this.dirtyProperties={},this.snapshotCache=this.createSnapshotCache()}return this.snapshotCache},b.prototype.definitelyMarkAsChanged=function(a){this.defnitelyMarkedAsChanged=!0,this.markAsChanged(a)},b.prototype.markAsChanged=function(b,c){this.ensureChangingPeriodStarted();var d=b.FieldSchema,e=new a.FieldSchemaSet([d]);if(this.changedFields.addFieldSchema(d),c){this.subChanges.push(c);var f=c.FieldSchemas.map(d.__nerve__.shadowMapper);e.addFieldSchemas(f)}this.markFieldsAsChanged(e)},b.prototype.markAsDeleted=function(){this.markFieldsAsChanged([this.master.Schema])},b.prototype.startBulkEditMode=function(){++this.bulkChangingModeStackedCount},b.prototype.endBulkEditMode=function(){--this.bulkChangingModeStackedCount<=0&&(this.bulkChangingModeStackedCount=0,this.changeNotifier.flush())},b.prototype.observe=function(b,c){var d=this.observers[this.getIndexOfObserverInfo(b)];d?c?d.fieldSet.addFieldSchemas(c):d.fieldSet=this.getAllFields().clone():this.observers.push({callback:b,fieldSet:new a.FieldSchemaSet(c||this.getAllFields())})},b.prototype.unobserve=function(a,b){var c=this.getIndexOfObserverInfo(a),d=this.observers[c];d&&(b?b.forEach(function(a){d.fieldSet.removeFieldSchemas(a.__nerve__.allContainedFields)}):d.fieldSet.clear(),0===d.fieldSet.Count&&this.observers.splice(c,1))},b.prototype.addRule=function(a){this.rules.indexOf(a)<0&&this.rules.push(a)},b.prototype.removeRule=function(a){var b=this.rules.indexOf(a);b>=0&&this.rules.splice(b,1)},b.prototype.markSubSnapshotAsDirty=function(a){var b=this;if(a.length){this.snapshotCache=void 0,a.forEach(function(a){return b.dirtyProperties[a.Name]=a});var c=this.Master.__nerve__.membership,d=c&&c.Parent.__nerve__.changeManager;d&&d.markSubSnapshotAsDirty([c.Property])}},b.prototype.getChangingPeriod=function(){return this.changingPeriod.promise()},Object.defineProperty(b.prototype,"Master",{get:function(){return this.master},enumerable:!0,configurable:!0}),b.prototype.createChange=function(a){var b=this.Master.__nerve__.deleted&&!this.markedAsDeleted;return{BeingDeleted:b,DefinitelyMarked:this.defnitelyMarkedAsChanged,FieldSchemas:Object.freeze(a.toArray()),Master:this.Master,NewValues:b?null:this.getSnapshot(),OldValues:this.snapshotBeforeChange,SubChanges:Object.freeze(this.subChanges),UpdateNeeded:b}},b.prototype.resetChangeInfo=function(){this.changedFields=new a.FieldSchemaSet,this.subChanges=[],this.snapshotBeforeChange=this.getSnapshot(),this.markedAsDeleted=this.master.Deleted,this.defnitelyMarkedAsChanged=!1},b.prototype.notifyChangeIfNeed=function(){this.bulkChangingModeStackedCount>0?this.changeNotifier.callOnceLater():this.changeNotifier.callImmediately()},b.prototype.anythingChanged=function(){return this.changedFields.Count>0||this.Master.__nerve__.deleted},b.prototype.markFieldsAsChanged=function(a){this.changedFields.addFieldSchemas(a),this.underRuling?this.changedByRules=!0:this.notifyChangeIfNeed()},b.prototype.shouldObserverBeNotified=function(a,b){return a.fieldSet.intersect(b.FieldSchemas)},b.prototype.removeUnchangedFields=function(a,b){},b.prototype.getMembership=function(){return this.Master.__nerve__.membership},b.prototype.getParentChangeManager=function(){var a=this.Master.Parent;return a&&a.__nerve__.changeManager},b.prototype.getIndexOfObserverInfo=function(a){for(var b=0;b<this.observers.length;++b)if(this.observers[b].callback===a)return b},b.prototype.notifyChange=function(){var a=this;if(this.applyRules(),this.endCurrentChangingPeriod(),this.defnitelyMarkedAsChanged||this.Master.Deleted||this.removeUnchangedFields(this.changedFields,this.snapshotBeforeChange),this.anythingChanged()){var b=Object.freeze(this.createChange(this.changedFields));this.resetChangeInfo();var c=this.Master.__nerve__.membership;if(c&&c.Property.Mounted){var d=c.Parent.__nerve__.changeManager;d&&d.markAsChanged(c.Property,b)}this.observers.concat().forEach(function(c){a.shouldObserverBeNotified(c,b)&&c.callback(b)})}},b.prototype.applyRules=function(){var b=this;this.underRuling=!0;var c=0,d=this.changedFields,e=this.subChanges,f=[],g=function(){var g=h.rules.filter(function(a){return!a.InterestedFields||b.changedFields.intersect(a.InterestedFields)});if(!g.length)return"break";if(++c>8*h.rules.length)return h.warnForAgainstingRules(f),"break";var i=h.changedFields,j=h.subChanges;h.changedFields=new a.FieldSchemaSet,h.subChanges=[];var k=h.Master.__nerve__.deleted&&!h.markedAsDeleted;g.forEach(function(a){b.changedByRules=!1,a.onChange({Master:b.Master,BeingDeleted:k,FieldSchemas:i.toArray(),OldValues:b.snapshotBeforeChange,SubChanges:j}),b.changedByRules&&f.push(a)}),d.addFieldSchemas(h.changedFields),e.push.apply(e,h.subChanges)},h=this;do{var i=g();if("break"===i)break}while(this.changedFields.Count);this.underRuling=!1,this.changedFields=d,this.subChanges=e},b.prototype.warnForAgainstingRules=function(b){Nerve.Debugger.warn("following rules might do against each other: "+JSON.stringify(b.map(function(a){return a.Name}))+" (master: "+a.getMasterName(this.Master)+")")},b.prototype.getAllFields=function(){return this.Master.Schema.__nerve__.allContainedFields},b.prototype.ensureChangingPeriodStarted=function(){"pending"!==this.changingPeriod.state()&&(this.changingPeriod=$.Deferred())},b.prototype.endCurrentChangingPeriod=function(){this.changingPeriod.resolve()},b}();a.BranchChangeManager=b}(NerveImplementation||(NerveImplementation={}));var NerveImplementation;!function(a){var b=function(){function a(a){this.popupRequired=a}return a.prototype.updateDirtiness=function(){if(this.popupRequired){var a=this.getProperty(),b=a.ParentMaster.__nerve__.dirtyChecker;b.setMemberDirtiness(a.Name,this.isDirty())}},a}();a.DirtyChecker=b}(NerveImplementation||(NerveImplementation={}));var NerveImplementation;!function(a){var b=function(a){function b(b,c,d){var e=a.call(this,d)||this;return e.memberDirtinesses={},e.dirtinessCount=0,e.master=b,e.existingInSource=c,e}return __extends(b,a),Object.defineProperty(b.prototype,"Master",{get:function(){return this.master},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"ExistingInSource",{get:function(){return this.existingInSource},set:function(a){this.existingInSource=a,this.updateDirtiness()},enumerable:!0,configurable:!0}),b.prototype.isDirty=function(){if(this.master.__nerve__.deleted){var a=this.Master.Parent,b=a&&a.__nerve__.deleted;return!b&&this.existingInSource}return 0!==this.dirtinessCount},b.prototype.setMemberDirtiness=function(a,b){!this.memberDirtinesses[a]!=!b&&(b?(this.memberDirtinesses[a]=!0,0===this.dirtinessCount++&&this.updateDirtiness()):(delete this.memberDirtinesses[a],0===--this.dirtinessCount&&this.updateDirtiness()))},b.prototype.getDirtyKeys=function(){return Object.keys(this.memberDirtinesses)},b.prototype.getProperty=function(){return this.master.__nerve__.membership.Property},b}(a.DirtyChecker);a.BranchDirtyChecker=b}(NerveImplementation||(NerveImplementation={}));var NerveImplementation;!function(a){var b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.markAsChanged=function(a,c){c&&c.BeingDeleted?this.Master.deleteItems([a.getter()]):b.prototype.markAsChanged.call(this,a,c)},c.prototype.onPropertiesAdded=function(a){a.length&&(this.addedProperties=this.addedProperties.concat(a),this.snapshot=void 0,this.markSubSnapshotAsDirty(a),this.markFieldsAsChanged(this.Master.Schema.__nerve__.allContainedFields))},c.prototype.onPropertiesRemoved=function(a){var b=this;a.length&&(a.forEach(function(a){var c=b.addedProperties.indexOf(a);c>=0?b.addedProperties.splice(c,1):b.removedProperties.push(a),b.indexChanges[a.Name]&&(delete b.indexChanges[a.Name],--b.indexChangedPropertyCount)}),this.snapshot=void 0,this.markSubSnapshotAsDirty(a),this.markFieldsAsChanged(this.Master.Schema.__nerve__.allContainedFields))},c.prototype.onPropertyIndexChange=function(a,b){this.markSubSnapshotAsDirty([a]),this.indexChanges[a.Name]?this.indexChanges[a.Name].NewIndex=a.Index:(this.indexChanges[a.Name]={OldIndex:b,NewIndex:a.Index},++this.indexChangedPropertyCount),this.notifyChangeIfNeed()},c.prototype.initializeSnapshot=function(){var b=this.Master.Schema[0];a.FieldSchema.isLeaf(b)?this.getSubSnapshot=c.getSubSnapshotForLeafContent:this.getSubSnapshot=c.getSubSnapshotForMasterContent,this.createSnapshot()},c.prototype.refreshSubSnapshot=function(a){this.snapshot&&!a.Deleted&&(this.snapshot[a.Index]=this.getSubSnapshot(a.getter()))},c.prototype.createSnapshotCache=function(){return this.snapshot||this.createSnapshot(),this.snapshot.concat()},c.prototype.createChange=function(a){var c=this,d=b.prototype.createChange.call(this,a),e=function(a){return a.getter()},f=function(a){return c.getSubSnapshot(a)};d.AddedModels=Object.freeze(this.addedProperties.map(e)),d.AddedItemsAsSnapshots=Object.freeze(d.AddedModels.map(f)),d.RemovedModels=Object.freeze(this.removedProperties.map(e)),d.RemovedItemsAsSnapshots=Object.freeze(d.RemovedModels.map(f));var g={};Object.keys(this.indexChanges).forEach(function(a){var b=c.indexChanges[a];null!=b.NewIndex&&null!=b.OldIndex&&(g[b.NewIndex]=b.OldIndex)}),d.ChangedIndexMap=Object.freeze(g);var h=this.Master.Schema[0];return d.UpdateNeeded||h.__nerve__.info.Attributes.IsLocalField||(d.UpdateNeeded=d.AddedModels.length>0||d.RemovedModels.length>0||d.SubChanges.some(function(a){return a.UpdateNeeded})),d},c.prototype.resetChangeInfo=function(){b.prototype.resetChangeInfo.call(this),this.addedProperties=[],this.removedProperties=[],this.indexChanges={},this.indexChangedPropertyCount=0},c.prototype.anythingChanged=function(){return this.addedProperties.length>0||this.removedProperties.length>0||this.indexChangedPropertyCount>0||b.prototype.anythingChanged.call(this)},c.prototype.shouldObserverBeNotified=function(a,c){return Object.keys(c.ChangedIndexMap).length?!0:b.prototype.shouldObserverBeNotified.call(this,a,c)},c.prototype.createSnapshot=function(){this.snapshot=[];for(var a=this.Master.Model,b=0;b<a.length;++b)this.snapshot[b]=this.getSubSnapshot(a[b])},c.getSubSnapshotForLeafContent=function(a){return a},c.getSubSnapshotForMasterContent=function(b){return a.getMasterFromModel(b).getSnapshot()},c}(a.BranchChangeManager);a.CollectionChangeManager=b}(NerveImplementation||(NerveImplementation={}));var NerveImplementation;!function(a){var b=function(b){function c(a,c,d){var e=b.call(this,a,c,d)||this;return e.updateMembersWithSourceData([]),e}return __extends(c,b),c.prototype.initializeSourceData=function(a){var b=this;this.updateMembersWithSourceData(a||[]),this.getProperties().forEach(function(a){var c=a.getDirtyChecker(),d=b.sourceData[b.getSourceIndexForProperty(a)];c.initializeSourceData(d)}),this.updateDirtinessForLength(this.Master.Model.length)},c.prototype.getDelta=function(){return Nerve.Debugger.todo("get delta for collection is not supported yet.")},c.prototype.getSnapshotToUpdate=function(){return this.getProperties().map(function(a){return a.getDirtyChecker()}).map(function(a){return a.getSnapshotToUpdate()})},c.prototype.getSourceData=function(){return a.FieldSchema.cloneSourceData(this.sourceData,this.Master.Schema)},c.prototype.setSourceData=function(a){this.setSourceDataInternal(a||[])},c.prototype.onSourceDataReceived=function(a){a=a||[],this.updateMembersWithSourceData(a),this.Master.Model.__nerve__.onSourceDataReceived(a),this.updateDirtinessForLength(this.Master.Model.length)},c.prototype.updateDirtinessForLength=function(a){this.setMemberDirtiness("length",a!==this.getSourceDataLength())},c.prototype.updateDirtinessForIndexChange=function(a){if(a.Deleted)this.setMemberDirtiness(a.Name,!1);else{var b=a.getDirtyChecker();b.setSourceData(this.sourceData[a.Index])}},c.prototype.getSourceDataLength=function(){return this.sourceData.length},c.prototype.setSourceDataInternal=function(b){var c=this;this.updateMembersWithSourceData(b),this.getProperties().forEach(function(b){var d=b.getDirtyChecker(),e=c.getSourceIndexForProperty(b);d.setSourceData(c.sourceData[e]),d instanceof a.BranchDirtyChecker&&(d.ExistingInSource=e<c.sourceData.length)}),this.updateDirtinessForLength(this.Master.Model.length)},c.prototype.getProperties=function(){return this.Master.Model.__nerve__.properties},c.prototype.updateMembersWithSourceData=function(a){var b=this;this.sourceData=a;var c=this.Master.Schema[0];c.__nerve__.withKey&&(this.sourceKeyIndexMap={},a.map(c.__nerve__.getKeyFromSourceData).forEach(function(a,c){a&&(b.sourceKeyIndexMap[a]=c)}))},c.prototype.getSourceIndexForProperty=function(a){var b=this.Master.Schema[0];return b.__nerve__.withKey?this.sourceKeyIndexMap[a.getKey()]:a.Index},c}(a.BranchDirtyChecker);a.CollectionDirtyChecker=b}(NerveImplementation||(NerveImplementation={}));var NerveImplementation;!function(a){function b(a,b,c,d){void 0===d&&(d=!0),o(a,b,{configurable:!1,enumerable:!!d,value:c,writable:!1})}function c(a,c,d){o(a,c,{configurable:!0,enumerable:!0,get:function(){var e=d();return delete a[c],b(a,c,e),e},set:function(){throw Error("Setting readonly field: "+c)}})}function d(a,b,c,d){d=d||function(){throw Error("Setting readonly field: "+b)},o(a,b,{configurable:!1,enumerable:!0,get:c,set:d})}function e(a,b){var c=a;for(var d in b)c[d]=b[d];return c}function f(a){return e({},a)}function g(a){Nerve.Debugger.assert(!Array.isArray(a),"array is not currently supported by readonly().");var c={};for(var d in a)b(c,d,a[d]);return c}function h(a,c){Nerve.Debugger.assert(c in a,"the field named "+c+" not been initialized yet."),b(a,c,a[c])}function i(a){return a?Array.prototype.slice.apply(a):[]}function j(a){return Array.isArray(a)?a:i(a)}function k(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];if(arguments.length){var d=$.Deferred();return d.resolve.apply(d,[a].concat(b)),d.promise()}return p}function l(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];if(arguments.length){var d=$.Deferred();return d.reject.apply(d,[a].concat(b)),d.promise()}return q}function m(a){return a.then(r,r)}function n(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];var c=$.Deferred(),d=a.length,e=[];return a.forEach(function(a,b){return a.done(function(a){return c.resolve(a)}).fail(function(a){e[b]=a,0===--d&&c.reject.apply(c,e)})}),c.promise()}function o(a,b,c){try{Object.defineProperty(a,b,c)}catch(d){var e=d&&d.message||"(no message)";Nerve.Debugger.throwError('Failed to set property "'+b+'": '+e)}}a.defineConstProperty=b,a.defineLazyProperty=c,a.defineProperty=d,a.extendObject=e,a.cloneObject=f,a.cloneAsReadonly=g,a.makePropertyReadonly=h,a.cloneCollectionAsArray=i,a.convertToArray=j;var p=$.Deferred().resolve().promise();a.getResolvedPromise=k;var q=$.Deferred().reject().promise();a.getRejectedPromise=l;var r=function(){return k()};a.always=m,a.anyoneResolved=n;var s=function(){function a(a,b){void 0===b&&(b=0),this.functionToCall=a,this.timeToWaitInMs=b}return a.prototype.callOnceLater=function(){var a=this;0!==this.timeToWaitInMs&&null!=this.handler&&this.clear(),null==this.handler&&(this.handler=setTimeout(function(){a.callImmediately()},this.timeToWaitInMs))},a.prototype.flush=function(){null!=this.handler&&(this.clear(),this.functionToCall())},a.prototype.callImmediately=function(){null!=this.handler&&this.clear(),this.functionToCall()},a.prototype.clear=function(){clearTimeout(this.handler),this.handler=void 0},a}();a.CallLater=s;var t=function(){function a(a){var b=this,c=$.Deferred();a.then(function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];b.canceled||c.resolve.apply(c,a)},function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];b.canceled||c.reject.apply(c,a)}),this.cancelablePromise=c.promise()}return a.prototype.promise=function(){return this.cancelablePromise},a.prototype.cancel=function(){this.canceled=!0},a}();a.Cancelable=t}(NerveImplementation||(NerveImplementation={}));var NerveImplementation;!function(a){function b(b,c,d){void 0===d&&(d=!1),a.defineConstProperty(b,"__nerve__",c,d)}var c=function(){function a(a){void 0===a&&(a={}),b(this,a)}return a}();a.NerveObject=c,a.defineNerveProperty=b}(NerveImplementation||(NerveImplementation={}));var NerveImplementation;!function(a){function b(b){return b instanceof a.ModelBase?b.__nerve__.master:void Nerve.Debugger.throwError("Invalid parameter: please use '<your master>.Model.*' for the parameter.")}function c(a){return d(a).__nerve__.masterName}function d(a){return a instanceof e?a.constructor:void Nerve.Debugger.throwError("the parameter is not a nerve master object.")}a.getMasterFromModel=b,a.getMasterName=c;var e=function(b){function c(c){var d=b.call(this)||this,e=d.__nerve__,g=c&&c.Reserved&&c.Reserved.Membership;g&&(e.membership=a.cloneAsReadonly(g),a.makePropertyReadonly(e,"membership"));var h=!1;return a.defineProperty(e,"deleted",function(){return h},function(a){if(!h&&a){h=!0,e.dirtyChecker.updateDirtiness();var b=e.changeManager;b.startBulkEditMode(),e.markChildrenAsDeleted(),b.markAsDeleted(),b.endBulkEditMode()}}),e.instanceId=(++f).toString(),a.makePropertyReadonly(e,"instanceId"),d}return __extends(c,b),Object.defineProperty(c.prototype,"Schema",{get:function(){return Nerve.Debugger.toBeOverridden()},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"Model",{get:function(){return this.__nerve__.model},set:function(a){this.setData(a,this.Schema.__nerve__.subFields.toArray())},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"Parent",{get:function(){var a=this.__nerve__.membership;return a&&a.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"Membership",{get:function(){var a=this.__nerve__.membership;return{Parent:a&&a.Parent,FieldSchema:a&&a.FieldSchema}},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"Deleted",{get:function(){return this.__nerve__.deleted},set:function(a){this.__nerve__.deleted=a},enumerable:!0,configurable:!0}),c.prototype.getInstanceId=function(){return this.__nerve__.instanceId},c.prototype.getSnapshot=function(a){return this.__nerve__.changeManager.getSnapshot(a)},c.prototype.bulkEdit=function(a){var b=this.__nerve__.changeManager;b&&b.startBulkEditMode();try{return a(this.Model)}finally{b&&b.endBulkEditMode()}},c.prototype.observe=function(a,b){return this.__nerve__.changeManager.observe(a,b)},c.prototype.unobserve=function(a,b){return this.__nerve__.changeManager.unobserve(a,b)},c.prototype.addRule=function(a){return this.__nerve__.changeManager.addRule(a)},c.prototype.removeRule=function(a){return this.__nerve__.changeManager.removeRule(a)},c}(a.NerveObject);a.MasterBase=e;var f=0}(NerveImplementation||(NerveImplementation={}));var NerveImplementation;!function(a){function b(a){var b=a;return!!b.__nerve__&&b.__nerve__.nerveObjectType===f}function c(a){return a instanceof g}function d(b,c){var d=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),Object.defineProperty(b,"Schema",{get:function(){return b.__nerve__.schema},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Schema",{get:function(){return b.__nerve__.schema},enumerable:!0,configurable:!0}),b}(g);return a.defineNerveProperty(d,a.cloneAsReadonly({nerveObjectType:f,masterName:b}),!0),d.__nerve__.schema=a.FieldSchema.createRootFieldSchema(d,c),a.makePropertyReadonly(d.__nerve__,"schema"),d}function e(b){a.FieldSchema.isLeaf(b.Schema[0])||a.convertToArray(b.Model).map(a.getMasterFromModel).forEach(function(a){return a.Deleted=!0})}var f="collection master";a.isCollectionMasterClass=b,a.isCollectionMaster=c,a.createCollectionMasterClass=d;var g=function(b){function c(c){var d=this;c=c||{},d=b.call(this,c)||this;var f=d,g=d.__nerve__;g.markChildrenAsDeleted=function(){return e(f)},a.makePropertyReadonly(g,"markChildrenAsDeleted");var h=d.Schema.__nerve__,i=!h.withDataSource&&!h.info.Attributes.IsLocalField;return g.dirtyChecker=new a.CollectionDirtyChecker(f,c.ExistingInDataSource,i),a.makePropertyReadonly(g,"dirtyChecker"),g.model=new a.CollectionModel(f,c),a.makePropertyReadonly(g,"model"),g.changeManager=new a.CollectionChangeManager(f),a.makePropertyReadonly(g,"changeManager"),d}return __extends(c,b),c.prototype.addItems=function(a){return this.Model.__nerve__.addItems(a,!1).map(function(a){return a.getter()})},c.prototype.deleteItems=function(a){return this.Model.__nerve__.deleteItems(a,!1).map(function(a){return a.getter()})},c.prototype.itemsAddedInSource=function(a){return this.Model.__nerve__.addItems(a,!0).map(function(a){return a.getter()})},c.prototype.itemsDeletedInSource=function(a){return this.Model.__nerve__.deleteItems(a,!0).map(function(a){return a.getter()})},c.prototype.getItemWithKeyFields=function(a){var b=this.Schema[0].__nerve__.getKey(a),c=this.Model.__nerve__.keyToProperty[b];return c&&c.getter()},c.prototype.getIndexWithKeyFields=function(a){var b=this.Schema[0].__nerve__.getKey(a),c=this.Model.__nerve__.keyToProperty[b];return c?c.Index:-1},c.prototype.markAsChanged=function(a){var b=this.Model.__nerve__.properties[a];b&&this.__nerve__.changeManager.definitelyMarkAsChanged(b)},c.prototype.setComparer=function(a){this.Model.__nerve__.setComparer(a)},c.prototype.setData=function(b){this.Model.__nerve__.setData(a.convertToArray(b))},c}(a.MasterBase)}(NerveImplementation||(NerveImplementation={}));var NerveImplementation;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.toJSON=function(){return this.__nerve__.master.getSnapshot()},b}(a.NerveObject);a.ModelBase=b}(NerveImplementation||(NerveImplementation={}));var NerveImplementation;!function(a){function b(a,b,e,f){var g=a.__nerve__.master,h=g.Schema[0],j=h.__nerve__.generateProperty,k=$.Deferred(),l=$.when(a.__nerve__.masterTreeReady,k.promise()),m=b.map(function(b){return j((++a.__nerve__.newestPropertyName).toString(),{InitialData:b,ExistingInDataSource:e,MasterTreeReady:l,Reserved:{Membership:{Parent:g,FieldSchema:h},ParentExistingInDataSource:f,Mounted:k}})});if(h.__nerve__.withKey){var n=a.__nerve__.keyToProperty;if(h.__nerve__.withDataSource){var o=h.__nerve__.keyFields.toArray();m.forEach(function(a){var b=a.Master;b.Synchronizer.ensureFieldsReady(o).done(function(){return c(n,a)})})}else m.forEach(function(a){return c(n,a)})}var p=a.__nerve__.properties,q=p.length;return g.bulkEdit(function(){p.push.apply(p,m),d(a);for(var b=q;b<p.length;++b)p[b].Index=b;g.__nerve__.dirtyChecker.updateDirtinessForLength(p.length);var c=a.__nerve__.propertyComparer;c&&i(a,c),k.resolve();var e=g.__nerve__.changeManager;e&&e.onPropertiesAdded(m)}),m}function c(b,c){var d=c.getKey();d in b&&Nerve.Debugger.throwError('duplicated key "'+d+'" at '+a.FieldSchema.getFieldPath(c.FieldSchema)+" is being added."),b[d]=c}function d(a){for(var b=a.__nerve__,c=b.properties.length;b.initializedLength<c;)e(a,b.initializedLength),++b.initializedLength}function e(b,c){a.defineProperty(b,c,function(){return this.__nerve__.properties[c].getter()},function(a){this.__nerve__.properties[c].setter(a)})}function f(a,b,c){var d=a.__nerve__.properties,e=d.filter(function(a){var c=a.getter();return b.some(function(a){return a===c})});return g(a,e,c),e}function g(a,b,c){var d=b.length;if(d>0){var e=a.__nerve__.properties,f=e.length,g=a.__nerve__.master;g.bulkEdit(function(){for(;d>0;--d){for(var i=b[d-1];--f>i.Index;)e[f].Index-=d;e.splice(f,1),i.markAsDeleted(c)}var j=g.Schema[0];if(j.__nerve__.withKey){var k=a.__nerve__.keyToProperty;if(j.__nerve__.withDataSource){var l=j.__nerve__.keyFields.toArray();b.forEach(function(a){var b=a.Master;b.Synchronizer.ensureFieldsReady(l).done(function(){return h(k,a)})})}else b.forEach(function(a){return h(k,a)})}g.__nerve__.dirtyChecker.updateDirtinessForLength(e.length),g.__nerve__.changeManager.onPropertiesRemoved(b)})}}function h(a,b){var c=b.getKey();b===a[c]&&delete a[c]}function i(a,b){b&&a.__nerve__.properties.sort(b);var c=a.__nerve__.master;c.bulkEdit(function(){a.__nerve__.properties.forEach(function(a,b){a.Index=b})})}function j(a,b){var c=a.__nerve__.master,d=a.__nerve__.master.Schema[0],e=a.__nerve__.properties,f={};b.map(d.__nerve__.getKey).forEach(function(a,b){return f[a]=b});var h={};e.forEach(function(a){return h[a.getKey()]=a});var j={};c.bulkEdit(function(){var c=[];for(var d in f){var e=f[d];if(d in h){var k=h[d];k.setter(b[e]),j[k.Name]=e,delete h[d]}else c.push(e)}var l=[];for(var d in h)l.push(h[d]);l.length&&(l.sort(function(a,b){return a.Index-b.Index}),g(a,l,!1)),c.length&&a.__nerve__.addItems(c.map(function(a){return b[a]}),!1).forEach(function(a,b){return j[a.Name]=c[b]});var m=function(a,b){return j[a.Name]-j[b.Name]},n=a.__nerve__.propertyComparer;n?i(a,function(a,b){return n(a,b)||m(a,b)}):i(a,m)})}function k(b,c){for(var d=b.__nerve__.master,e=(b.length,{}),f=a.convertToArray(b.__nerve__.master.getSnapshot()).slice(),h=[],j={},k=0;k<c.length;++k){var l=c[k],m=f.indexOf(l);0>m?h.push(l):(j[k]=m,f[m]=e)}for(var n=b.__nerve__.properties,o=[],k=0;k<f.length;++k)f[k]!==e&&o.push(n[k]);var p=n.slice();d.bulkEdit(function(){var a=b.__nerve__.addItems(h,!1);o.length&&(o.sort(function(a,b){return a.Index-b.Index}),g(b,o,!1)),Nerve.Debugger.assert(c.length===n.length,"All items should be updated into properties.");for(var d=0,e=0;e<c.length;++e)null==j[e]?n[e]=a[d++]:n[e]=p[j[e]];i(b,b.__nerve__.propertyComparer)})}function l(a,b){a.__nerve__.master.bulkEdit(function(){for(var c=a.length,d=Math.min(c,b.length),e=a.__nerve__.properties,f=0;d>f;++f)e[f].setter(b[f]);if(c<b.length)a.__nerve__.addItems(b.slice(a.length),!1);else if(c>b.length){var h=a.__nerve__.properties.slice(b.length);g(a,h,!1)}})}function m(b,c){var d=b.__nerve__.master;d.bulkEdit(function(){var e=d.Schema[0].__nerve__,f=b.__nerve__.keyToProperty,h={},j=[];c.map(e.getKeyFromSourceData).forEach(function(a,b){h[a]=b,a in f?f[a].getDirtyChecker().onSourceDataReceived(c[b]):j.push(c[b])});var k;k=e.withDataSource?function(a){var b=a.Master;return"resolved"===b.Synchronizer.existingInDataSource().state()&&!(a.getKey()in h)}:function(a){return!(a.getKey()in h)};var l=b.__nerve__.properties.filter(k);g(b,l,!0);var m=a.FieldSchema.convertFromSourceData(j,d.Schema);b.__nerve__.addItems(m,!0);var n=b.__nerve__.propertyComparer;n||(n=function(a,b){return h[a.getKey()]-h[b.getKey()]}),i(b,n)})}function n(b,c){var d=b.__nerve__.master;d.bulkEdit(function(){for(var e=b.length,f=Math.min(e,c.length),h=b.__nerve__.properties,i=0;f>i;++i)h[i].getDirtyChecker().onSourceDataReceived(c[i]);if(e<c.length){var j=c.slice(e),k=a.FieldSchema.convertFromSourceData(j,d.Schema);b.__nerve__.addItems(k,!0)}else if(e>c.length){var l=b.__nerve__.properties.slice(c.length);g(b,l,!0)}})}var o=function(c){function d(d,e){var g,h,o=this,p=d.Schema[0];p.__nerve__.withKey?(g=j,h=m):(g=p.__nerve__.info.IsLeaf?k:l,h=n);var q=e.Reserved&&e.Reserved.ParentExistingInDataSource;return o=c.call(this,{master:d,keyToProperty:p.__nerve__.withKey?{}:null,initializedLength:0,newestPropertyName:0,masterTreeReady:e.MasterTreeReady,properties:[],addItems:function(a,c){return b(o,a,c,q)},deleteItems:function(a,b){return f(o,a,b)},setData:function(a){return g(o,a)},onSourceDataReceived:function(a){return h(o,a)},setComparer:function(a){o.__nerve__.comparer=a,o.__nerve__.propertyComparer=a&&function(b,c){return a(b.getter(),c.getter())},a&&i(o,o.__nerve__.propertyComparer)}})||this,b(o,a.convertToArray(e.InitialData),e.ExistingInDataSource,q),o}return __extends(d,c),Object.defineProperty(d.prototype,"length",{get:function(){return this.__nerve__.properties.length},enumerable:!0,configurable:!0}),d}(a.ModelBase);a.CollectionModel=o}(NerveImplementation||(NerveImplementation={}));var Nerve;!function(a){var b;!function(b){function c(a,b){a||(console.assert(a,"Nerve - "+b),i("assert failed: "+b))}function d(a){return i("TODO: "+a)}function e(){return i("not implememented.")}function f(a,b){return b?b():void 0}function g(){
return i("to be overridden.")}function h(a){console.warn("Nerve - warning: "+a),j("warning: "+a)}function i(a){throw Error("Nerve - "+a)}function j(a){try{throw Error("NerveLog - "+a)}catch(b){OfficeForm.Event.ErrorEventDeprecated.logData({errorName:"ModelError",errorInfo:b.stack})}}b.assert=c,b.todo=d,b.notImplemented=e,b.fakeImplemented=f,b.toBeOverridden=g,b.warnMessage=h,a.Debugger.warn=h,b.throwError=i}(b=a.Debugger||(a.Debugger={}))}(Nerve||(Nerve={}));var NerveImplementation;!function(a){var b=function(a){function b(b,c){var d=a.call(this,c)||this;return d.property=b,d}return __extends(b,a),b.prototype.isDirty=function(){return this.sourceData!==this.convertModelToSourceData()},b.prototype.initializeSourceData=function(a){this.setSourceData(a)},b.prototype.getDelta=function(){return this.convertModelToSourceData()},b.prototype.getSnapshotToUpdate=function(){return this.convertModelToSourceData()},b.prototype.getSourceData=function(){return this.sourceData},b.prototype.setSourceData=function(a){void 0===a&&(a=null),this.sourceData=a,this.updateDirtiness()},b.prototype.onSourceDataReceived=function(a){var b=this.isDirty();this.setSourceData(a),b||this.property.setter(this.convertFromSourceData(a))},b.prototype.getProperty=function(){return this.property},b.prototype.convertModelToSourceData=function(){return this.property.getter()},b.prototype.convertFromSourceData=function(a){return a},b}(a.DirtyChecker);a.LeafDirtyChecker=b}(NerveImplementation||(NerveImplementation={}));var NerveImplementation;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.convertModelToSourceData=function(){return this.convert(this.getProperty().getter())},b.prototype.convertFromSourceData=function(a){return this.convert(a)},b.prototype.convert=function(a){if(null==a)return null;var b=this.getProperty().FieldSchema.__nerve__.enumType;return b[a]},b}(a.LeafDirtyChecker);a.EnumDirtyChecker=b}(NerveImplementation||(NerveImplementation={}));var NerveImplementation;!function(a){var b,c="FieldSchema";!function(b){function d(a){var b=a,d=b&&b.__nerve__;return d&&d.nerveObjectType===c}function e(a){if(!d(a))throw Error("Invalid parameter: please use '<your master [class]>.Schema.*' for the parameter.");return!0}function f(a){return e(a),a.__nerve__.info}function g(a){return e(a),a.__nerve__.subFields.toArray()}function h(a){return f(a).FieldId}function i(a){return f(a).Name}function j(a){return f(a).Path}function k(a){return u[a]}function l(c,d){if(b.isLeaf(d)){if(d.__nerve__.asEnum){var e=d.__nerve__.enumType;if(e&&"string"==typeof c&&c in e)return e[c]}return c}if(b.isCollection(d))return a.convertToArray(c).map(function(a){return l(a,d[0])});if(c){var f={},g=d.__nerve__.sourceNameToClientName;return Object.keys(c).forEach(function(a){if(a in g){var b=g[a],e=d[b];f[b]=l(c[a],e)}}),f}return null}function m(c,d){if(b.isLeaf(d)){if(d.__nerve__.asEnum){var e=d.__nerve__.enumType;if(e&&"number"==typeof c&&c in e)return e[c]}return c}if(b.isCollection(d))return a.convertToArray(c).map(function(a){return m(a,d[0])});if(c){var f={};return Object.keys(d).forEach(function(a){if(a in c){var b=d[a];if(!b.__nerve__.info.Attributes.IsLocalField){var e=b.__nerve__.sourceName;f[e]=m(c[a],b)}}}),f}return null}function n(c,d){if(b.isLeaf(d))return c;if(b.isCollection(d))return a.convertToArray(c).map(function(a){return n(a,d[0])});if(c){var e={},f=d.__nerve__.sourceNameToClientName;return Object.keys(c).forEach(function(a){if(a in f){var b=d[f[a]];e[a]=n(c[a],b)}}),e}return null}function o(b,c){var d=b.__nerve__.masterName,e={enumTypeGetter:null,getKeyForReferenceType:null,info:{Attributes:a.Spec.getAttributes(c),FieldId:r(),IsCollection:!(!a.Spec.isFieldSpec(c)||!c.__nerve__.isCollection),IsLeaf:!1,Name:d,Path:d},parentMasterClass:b,shadowParent:null,withDataSource:!!b.__nerve__.dataSourceFactory};e.info.IsCollection&&a.defineLazyProperty(e,"withDataSource",function(){return f[0].__nerve__.withDataSource});var f=p(e);return Object.keys(c).forEach(function(d){a.defineLazyProperty(f,d,s(b,d,c[d]))}),f}function p(b){var d={};return b.info=a.cloneAsReadonly(b.info),b.nerveObjectType=c,b.shadowParent=b.shadowParent||null,b.shadowRoot=b.shadowRoot||d,a.defineLazyProperty(b,"sourceFieldSet",function(){var c=b.subFields.toArray().filter(function(a){return!a.__nerve__.info.Attributes.IsLocalField});return new a.FieldSchemaSet(c)}),a.defineLazyProperty(b,"sourceName",function(){return b.info.Attributes.SourceFieldName||b.info.Name}),a.defineLazyProperty(b,"sourceNameToClientName",function(){var a={};return b.sourceFieldSet.toArray().forEach(function(b){a[b.__nerve__.sourceName]=b.__nerve__.info.Name}),Object.freeze(a)}),a.defineLazyProperty(b,"subFields",function(){var b=new a.FieldSchemaSet;return Object.keys(d).forEach(function(a){b.addFieldSchema(d[a])}),b}),a.defineLazyProperty(b,"allContainedFields",function(){var b=new a.FieldSchemaSet([d]);return Object.keys(d).forEach(function(a){var c=d[a];b.addFieldSchemas(c.__nerve__.allContainedFields)}),b}),a.defineLazyProperty(b,"asEnum",function(){return!!b.enumType&&!b.info.Attributes.IsNumberTypeInDataSource}),a.defineLazyProperty(b,"enumType",function(){return b.enumTypeGetter&&b.enumTypeGetter()}),b.info.IsLeaf?a.defineLazyProperty(b,"getKey",function(){return Nerve.Debugger.assert(b.getKeyForReferenceType,"getKey has been called but no keyGetter specified for "+b.info.Path),b.getKeyForReferenceType}):a.defineLazyProperty(b,"getKey",function(){var c=b.keyFields.toArray().map(i).sort();return Nerve.Debugger.assert(c.length>0,"getKey has been called but there's no key fields of "+b.info.Path),function(b){var d=c;if(b instanceof a.ObjectModel){var e=b.__nerve__.master;if(a.isObjectMasterWithDataSource(e)){var f=e;if(d=c.filter(function(a){return f.isFieldReady(a)}),!d.length)return void 0}}var g={};return d.forEach(function(a){return g[a]=b[a]}),JSON.stringify(g)}}),a.defineLazyProperty(b,"getKeyFromSourceData",function(){var a=b.keyFields.toArray(),c=b.sourceNameToClientName,d=a.map(function(a){return a.__nerve__.sourceName});return function(a){var e={};return d.forEach(function(b){var d=c[b];e[d]=a[b]}),b.getKey(e)}}),a.defineLazyProperty(b,"keyFields",function(){return new a.FieldSchemaSet(b.subFields.toArray().filter(function(a){return a.__nerve__.info.Attributes.IsKeyField}))}),b.info.IsLeaf?a.defineLazyProperty(b,"withKey",function(){return!!b.getKeyForReferenceType}):a.defineLazyProperty(b,"withKey",function(){return b.keyFields.Count>0}),a.defineNerveProperty(d,b),a.defineConstProperty(d,"toJSON",function(){return"[Nerve] FieldSchema: ("+b.info.Path+")>"},!1),b.info.IsCollection&&a.defineConstProperty(d,"length",1,!1),u[b.info.FieldId]=d,d}function q(a,b){return a+"/"+b}function r(){return(t++).toString()}function s(c,d,e){var f=r();return function(){var g,h=q(c.__nerve__.masterName,d);if(a.Spec.isFieldSpec(e)){if(e.__nerve__.isLeaf)return b.createLeaf(f,c,e,d,h);e.__nerve__.isCollection?g=a.createCollectionMasterClass(h,e):e.__nerve__.masterClassGetter&&(g=e.__nerve__.masterClassGetter())}g||(g=a.createObjectMasterClass(h,e));var i=a.Spec.getAttributes(e);return b.createWithSubmasterClass(f,c,g,d,h,i)}}b.isFieldSchema=d,b.assertFieldSchema=e,b.getFieldInfo=f,b.getSubFields=g,b.getFieldId=h,b.getFieldName=i,b.getFieldPath=j,b.getFieldSchemaById=k,b.convertFromSourceData=l,b.convertToSourceData=m,b.cloneSourceData=n,b.createRootFieldSchema=o,b.createFieldSchemaWithMembers=p,b.getPath=q,b.createFieldSchemaId=r;var t=1,u={}}(b=a.FieldSchema||(a.FieldSchema={}))}(NerveImplementation||(NerveImplementation={}));var NerveImplementation;!function(a){var b;!function(b){function c(a){return a.__nerve__.info.IsCollection}function d(c,d,h,i,j,k){var l=h.Schema,m=l.__nerve__,n=b.createFieldSchemaWithMembers({enumTypeGetter:m.enumTypeGetter,getKeyForReferenceType:m.getKeyForReferenceType,info:{Attributes:k,FieldId:c,IsCollection:m.info.IsCollection,IsLeaf:m.info.IsLeaf,Name:i,Path:j||i},parentMasterClass:d,parentSchema:d.__nerve__.schema,shadowParent:l,shadowRoot:l,subMasterClassGetter:function(){return h},withDataSource:m.withDataSource}),o={};return o[b.getFieldId(h.__nerve__.schema)]=n,n.__nerve__.generateProperty=e(n),a.makePropertyReadonly(n.__nerve__,"generateProperty"),n.__nerve__.shadowMapper=f(n,o),a.makePropertyReadonly(n.__nerve__,"shadowMapper"),g(n,h.Schema,o),n}function e(b){return function(c,d){return new a.PropertyAsBranch(c,b,d)}}function f(a,c){return function d(e){var f=b.getFieldId(e),g=c[f];if(!g){var h=e.__nerve__.parentSchema,i=void 0;i=b.isFieldSchema(h)?d(h):a,g=i[b.getFieldName(e)],Nerve.Debugger.assert(g===c[f],"the new shadow should be added into the shadow map.")}return g}}function g(b,c,d){Object.keys(c).forEach(function(e){a.defineLazyProperty(b,e,h(b,c,e,d))})}function h(a,c,d,e){return function(){var f=c[d],h=f.__nerve__,i=b.createFieldSchemaWithMembers({enumTypeGetter:h.enumTypeGetter,getKeyForReferenceType:h.getKeyForReferenceType,info:{Attributes:h.info.Attributes,FieldId:b.createFieldSchemaId(),IsCollection:h.info.IsCollection,IsLeaf:h.info.IsLeaf,Name:d,Path:b.getPath(a.__nerve__.info.Path,d)},parentSchema:a,parentMasterClass:a.__nerve__.parentMasterClass,shadowParent:f,shadowRoot:h.shadowRoot,subMasterClassGetter:h.subMasterClassGetter,withDataSource:h.withDataSource});return e[b.getFieldId(f)]=i,g(i,f,e),i}}b.isCollection=c,b.createWithSubmasterClass=d}(b=a.FieldSchema||(a.FieldSchema={}))}(NerveImplementation||(NerveImplementation={}));var NerveImplementation;!function(a){var b;!function(b){function c(a){return a.__nerve__.info.IsLeaf}function d(c,d,f,g,h){var i=b.createFieldSchemaWithMembers({enumTypeGetter:f.__nerve__.enumTypeGetter,getKeyForReferenceType:f.__nerve__.keyGetter,info:{Attributes:a.Spec.getAttributes(f),FieldId:c,IsLeaf:!0,IsCollection:!1,Name:g,Path:h||g},parentMasterClass:d,parentSchema:d.__nerve__.schema,withDataSource:!1});return i.__nerve__.generateProperty=e(i),a.makePropertyReadonly(i.__nerve__,"generateProperty"),i}function e(b){return b.__nerve__.asEnum?function(c,d){return new a.PropertyAsEnum(c,b,d)}:function(c,d){return new a.PropertyAsLeaf(c,b,d)}}b.isLeaf=c,b.createLeaf=d}(b=a.FieldSchema||(a.FieldSchema={}))}(NerveImplementation||(NerveImplementation={}));var NerveImplementation;!function(a){var b=function(){function b(a){a instanceof b?this.setData(a.data):this.newData(a)}return Object.defineProperty(b.prototype,"Count",{get:function(){return this.data.fieldCount},enumerable:!0,configurable:!0}),b.prototype.has=function(b){return this.hasId(a.FieldSchema.getFieldId(b))},b.prototype.hasId=function(a){return!!this.data.map[a]},b.prototype.intersect=function(a){if(Array.isArray(a))return a.some(this.has.bind(this));var b=this,c=a;if(c.Count<b.Count){var d=b;b=c,c=d}for(var e in b.data.map)if(c.data.map[e])return!0;return!1},b.prototype.intersection=function(c){var d=this;if(Array.isArray(c))return new b(c.filter(function(b){return a.FieldSchema.isFieldSchema(b)&&d.has(b)}));if(c instanceof b){var e=this,f=c;if(f.Count<e.Count){var g=e;e=f,f=g}var h=new b;for(var i in e.data.map)f.hasId(i)&&h.addFieldSchema(a.FieldSchema.getFieldSchemaById(i));return h}return new b},b.prototype.toArray=function(){return Object.keys(this.data.map).map(a.FieldSchema.getFieldSchemaById)},b.prototype.clone=function(){return new b(this)},b.prototype.clear=function(){this.newData()},b.prototype.addFieldSchema=function(a){this.has(a)||(this.ensureDataOwnership(),this.internalAddFieldSchema(a))},b.prototype.addFieldSchemas=function(a){var c,d=this;if(c=a instanceof b?a.toArray():a,c=c.filter(function(a){return!d.has(a)}),c.length){this.ensureDataOwnership();this.internalAddFieldSchema.bind(this);c.forEach(function(a){return d.internalAddFieldSchema(a)})}},b.prototype.removeFieldSchema=function(a){this.has(a)&&(this.ensureDataOwnership(),this.internalRemoveFieldSchema(a))},b.prototype.removeFieldSchemas=function(a){var c,d=this;c=a instanceof b?a.toArray():a,c=c.filter(function(a){return d.has(a)}),c.length&&(this.ensureDataOwnership(),c.forEach(function(a){return d.internalRemoveFieldSchema(a)}))},b.prototype.ensureDataOwnership=function(){1!==this.data.referenceCount&&this.newData(this.toArray())},b.prototype.internalAddFieldSchema=function(b){var c=a.FieldSchema.getFieldId(b);this.data.map[c]||(this.data.map[c]=!0,++this.data.fieldCount)},b.prototype.internalRemoveFieldSchema=function(b){var c=a.FieldSchema.getFieldId(b);this.data.map[c]&&(delete this.data.map[c],--this.data.fieldCount)},b.prototype.newData=function(a){this.setData({map:{},fieldCount:0,referenceCount:0}),a&&this.addFieldSchemas(a)},b.prototype.setData=function(a){this.data&&--this.data.referenceCount,this.data=a,++this.data.referenceCount},b}();a.FieldSchemaSet=b}(NerveImplementation||(NerveImplementation={}));var NerveImplementation;!function(a){var b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.getSnapshot=function(c){var d=b.prototype.getSnapshot.call(this,c);if(!c)return d;var e={};return this.Master.Schema.__nerve__.subFields.intersection(c).toArray().map(a.FieldSchema.getFieldName).forEach(function(a){return e[a]=d[a]}),e},c.prototype.initializeSnapshot=function(){var b=this;this.snapshot={};var c=this.Master,d=c.Schema.__nerve__.subFields.toArray();if(a.isObjectMasterWithDataSource(c)){var e=c;d=d.filter(function(a){return e.isFieldReady(a)})}d.forEach(function(a){return b.refreshSubSnapshotWithFieldSchema(a)})},c.prototype.refreshSubSnapshot=function(a){this.refreshSubSnapshotWithFieldSchema(a.FieldSchema)},c.prototype.createSnapshotCache=function(){return Object.freeze(a.cloneObject(this.snapshot))},c.prototype.createChange=function(a){var c=b.prototype.createChange.call(this,a);return c.UpdateNeeded||(c.UpdateNeeded=a.toArray().some(function(a){return a.__nerve__.info.IsLeaf&&!a.__nerve__.info.Attributes.IsLocalField})),c.UpdateNeeded||(c.UpdateNeeded=c.SubChanges.filter(function(a){return a.UpdateNeeded}).some(function(b){var c=b.Master.Membership.FieldSchema;return a.has(c)&&!c.__nerve__.info.Attributes.IsLocalField})),c},c.prototype.removeUnchangedFields=function(b,c){var d=this,e=this.Master.Schema,f=b.toArray().filter(function(b){if(b.__nerve__.parentSchema===e&&a.FieldSchema.isLeaf(b)){var f=a.FieldSchema.getFieldName(b);return d.Master.Model[f]===c[f]}return!1});b.removeFieldSchemas(f)},c.prototype.refreshSubSnapshotWithFieldSchema=function(b){var c=a.FieldSchema.getFieldName(b),d=this.Master.Model[c];if(a.FieldSchema.isLeaf(b))this.snapshot[c]=d;else{var e=a.getMasterFromModel(d);this.snapshot[c]=e.getSnapshot()}},c}(a.BranchChangeManager);a.ObjectChangeManager=b}(NerveImplementation||(NerveImplementation={}));var NerveImplementation;!function(a){var b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.initializeSourceData=function(a){a=this.getNormalizedSourceData(a);var b=this.Master.Schema,c=this.Master.Model.__nerve__.properties;for(var d in c){var e=b[d].__nerve__.sourceName;c[d].getDirtyChecker().initializeSourceData(a[e])}},c.prototype.getDelta=function(){var a=this;if(!this.isDirty())return void 0;var b=this.Master.Schema,c=(this.Master.Model,{});return this.getDirtyKeys().sort().forEach(function(d){var e=b[d].__nerve__.sourceName;c[e]=a.getSubDirtyCheckerWithClientName(d).getSnapshotToUpdate()}),c},c.prototype.getSnapshotToUpdate=function(){var a={},b=this.Master.Schema,c=this.getSubDirtyCheckers();for(var d in c){var e=b[d].__nerve__.sourceName;a[e]=c[d].getSnapshotToUpdate()}return a},c.prototype.getSourceData=function(){var a={},b=this.Master.Schema,c=this.getSubDirtyCheckers();for(var d in c){var e=b[d].__nerve__.sourceName;a[e]=c[d].getSourceData()}return a},c.prototype.setSourceData=function(a){var b=this;a=this.getNormalizedSourceData(a),Object.keys(a).forEach(function(c){b.getSubDirtyCheckerWithSourceName(c).setSourceData(a[c])})},c.prototype.onSourceDataReceived=function(b){var c=this;b=this.getNormalizedSourceData(b);var d,e=this.Master;if(a.isObjectMasterWithDataSource(e)){d=$.Deferred();var f=this.Master.Schema,g=f.__nerve__.sourceNameToClientName,h=Object.keys(b).map(function(a){return g[a]}).filter(function(a){return a});e.Synchronizer.markFieldsAsReady(h,d.promise())}e.bulkEdit(function(){Object.keys(b).forEach(function(a){c.getSubDirtyCheckerWithSourceName(a).onSourceDataReceived(b[a])})}),d&&d.resolve()},c.prototype.getNormalizedSourceData=function(a){var b=this.Master.Schema.__nerve__.sourceNameToClientName,c={};return a?Object.keys(a).filter(function(a){return a in b}).forEach(function(b){return c[b]=a[b]}):Object.keys(b).forEach(function(a){return c[a]=null}),c},c.prototype.getSubDirtyCheckers=function(){var b=this.Master.Model.__nerve__.properties,c={};return this.Master.Schema.__nerve__.subFields.toArray().filter(function(a){return!a.__nerve__.info.Attributes.IsLocalField}).map(a.FieldSchema.getFieldName).forEach(function(a){return c[a]=b[a].getDirtyChecker()}),c},c.prototype.getSubDirtyCheckerWithClientName=function(a){var b=this.Master.Model.__nerve__.properties[a];return b.getDirtyChecker()},c.prototype.getSubDirtyCheckerWithSourceName=function(a){var b=this.Master.Schema.__nerve__.sourceNameToClientName[a];return this.getSubDirtyCheckerWithClientName(b)},c}(a.BranchDirtyChecker);a.ObjectDirtyChecker=b}(NerveImplementation||(NerveImplementation={}));var NerveImplementation;!function(a){function b(a){var b=a;return!!b.__nerve__&&b.__nerve__.nerveObjectType===j}function c(a){return a instanceof k}function d(a){var b=a,c=b.__nerve__;return!!c&&c.nerveObjectType===j&&!!c.dataSourceFactory}function e(a){return a instanceof l}function f(b,c,d){a.Spec.validateSpec(b,c);var e=d?l:k,f=function(a){function b(b,c){return a.call(this,b,c,d)||this}return __extends(b,a),Object.defineProperty(b,"Schema",{get:function(){return b.__nerve__.schema},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Schema",{get:function(){return b.__nerve__.schema},enumerable:!0,configurable:!0}),b}(e);return a.defineNerveProperty(f,a.cloneAsReadonly({nerveObjectType:j,masterName:b,dataSourceFactory:d}),!0),f.__nerve__.schema=a.FieldSchema.createRootFieldSchema(f,c),a.makePropertyReadonly(f.__nerve__,"schema"),f}function g(b,c){return c.map(function(c){var d=b.Schema;if("string"==typeof c){var e=d[c];if(a.FieldSchema.isFieldSchema(e))return e}else if(a.FieldSchema.isFieldSchema(c))return h(b,c);Nerve.Debugger.throwError("field "+c+" doesn't exist in master "+a.getMasterName(b))})}function h(b,c){for(var d=b.Schema,e=[];c.__nerve__.shadowRoot!==d;){var f=a.FieldSchema.getFieldName(c);e.push(f),c=c.__nerve__.parentSchema,c||Nerve.Debugger.throwError("field schema ("+a.FieldSchema.getFieldPath(c)+") is not a member schema of master ("+a.getMasterName(b)+")")}for(var g=d;e.length;){var f=e.pop();g=g[f]}return g}function i(b){b.Schema.__nerve__.subFields.toArray().filter(function(b){return!a.FieldSchema.isLeaf(b)}).map(a.FieldSchema.getFieldName).map(function(a){return b.Model.__nerve__.properties[a]}).map(function(a){return a.Master}).forEach(function(a){return a.Deleted=!0})}var j="object master";a.isObjectMasterClass=b,a.isObjectMaster=c,a.isObjectMasterClassWithDataSource=d,a.isObjectMasterWithDataSource=e,a.createObjectMasterClass=f;var k=function(b){function c(c,d,e){var f=this;c=c||{},d=d||{},f=b.call(this,c)||this;var g=f.__nerve__;g.markChildrenAsDeleted=function(){return i(f)},a.makePropertyReadonly(g,"markChildrenAsDeleted");var h=$.Deferred(),j=$.when(d.MasterReady,h.promise()),k=!e&&g.membership&&!g.membership.FieldSchema.__nerve__.info.Attributes.IsLocalField;g.dirtyChecker=new a.ObjectDirtyChecker(f,c.ExistingInDataSource,k),a.makePropertyReadonly(g,"dirtyChecker");var l;if(e?(g.synchronizer=new a.ObjectSynchronizer(f,c,d,j,e),l=g.synchronizer.existingInDataSource()):(g.synchronizer=null,l=c.Reserved&&c.Reserved.ParentExistingInDataSource),a.makePropertyReadonly(g,"synchronizer"),g.model=new a.ObjectModel(f,c.InitialData||{},c.ExistingInDataSource,j,$.when(c.MasterTreeReady,j),l),a.makePropertyReadonly(g,"model"),g.changeManager=new a.ObjectChangeManager(f),a.makePropertyReadonly(g,"changeManager"),e){var m=c.ExistingInDataSource?c.InitialData:null,n=a.FieldSchema.convertToSourceData(m,f.Schema);g.dirtyChecker.initializeSourceData(n)}return h.resolve(),f}return __extends(c,b),c.prototype.setData=function(b,c){var d=this.Model;if(b!==d){b=b||{};var e;if(c)e=g(this,c);else{var f=this.Schema;e=Object.keys(b).map(function(a){return f[a]}).filter(function(a){return a})}var h=[];this.bulkEdit(function(){e.map(a.FieldSchema.getFieldName).forEach(function(a){a in d?d[a]=b[a]:h.push(a)})}),h.length&&Nerve.Debugger.warn("following field(s) not found in "+a.getMasterName(this)+": "+h)}},c.prototype.getModelByFieldSchema=function(b){var c=b;a.FieldSchema.assertFieldSchema(c),c=h(this,c);for(var d=this.Schema,e=[];c!==d;){if(e.push(c),c.__nerve__.info.IsCollection)throw Error("unable to get model/value from collection "+a.FieldSchema.getFieldPath(c)+".");c=c.__nerve__.parentSchema}var f=this.Model;do c=e.pop(),f=f[a.FieldSchema.getFieldName(c)];while(e.length);return f},c}(a.MasterBase),l=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),Object.defineProperty(b.prototype,"Synchronizer",{get:function(){return this.__nerve__.synchronizer},enumerable:!0,configurable:!0}),b.prototype.isFieldReady=function(a){return this.Synchronizer.isFieldReady(a)},b.prototype.ensureFieldsReady=function(a){return this.Synchronizer.ensureFieldsReady(a)},b.prototype.fieldsReady=function(a){return this.Synchronizer.fieldsReady(a)},b.prototype.getRelatedSourceFields=function(a){return a},b}(k);a.getTargetFieldSchemasOfObjectMaster=g}(NerveImplementation||(NerveImplementation={}));var NerveImplementation;!function(a){function b(b){return a.isObjectMasterWithDataSource(b)?function(c,d){var e=function(){if(!b.isFieldReady(d)){var c=a.FieldSchema.getFieldPath(d);Nerve.Debugger.throwError("The field ("+c+") not ready yet.")}};return{getter:function(){return e(),c.getter()},setter:function(a){e(),c.setter(a)}}}:function(a,b){return{getter:function(){return a.getter()},setter:function(b){return a.setter(b)}}}}var c=function(c){function d(d,e,f,g,h,i){var j=this,k={};j=c.call(this,{master:d,properties:k})||this;var l=b(d);return Object.keys(d.Schema).forEach(function(b){var c=d.Schema[b],m=c.__nerve__.generateProperty(b,{InitialData:e[b],ExistingInDataSource:f,MasterTreeReady:h,Reserved:{Membership:{FieldSchema:c,Parent:d},ParentExistingInDataSource:i,Mounted:g}});k[b]=m;var n=l(m,c);a.defineProperty(j,b,n.getter,n.setter)}),j}return __extends(d,c),d}(a.ModelBase);a.ObjectModel=c}(NerveImplementation||(NerveImplementation={}));var NerveImplementation;!function(a){var b;!function(b){function c(b,c){var d;return d=h(b)?a.cloneObject(b.__nerve__):k(),m(d,c),a.extendObject(l(d,c),b)}function d(a,b,c){var d=k();return d.isLeaf=!0,d.basicTypeName=a,d.keyGetter=c||null,m(d,b),l(d,b)}function e(a,b){var c=k();return c.isLeaf=!0,c.basicTypeName="enum",c.enumTypeGetter=a,m(c,b),l(c,b)}function f(b,c){var d=k();if(a.isObjectMasterClass(b))d.masterClassGetter=function(){return b};else{if(!(b instanceof Function))throw Error("The parameter of Spec.fromMasterClass should be a master class of a function.");d.masterClassGetter=b}return l(d,c)}function g(b,c){var d;d=h(b)?b:a.isObjectMasterClass(b)||b instanceof Function?f(b):b;var e=k();e.isCollection=!0;var g=l(e,c);return a.defineConstProperty(g,0,d),g}function h(a){var b=a;return b&&b.__nerve__&&b.__nerve__.nerveObjectType===p}function i(a,b){b?Object.keys(b).forEach(function(c){return n(a+c,b[c])}):o(a,"there's no spec passed")}function j(a){return h(a)?a.__nerve__.attributes:q}function k(){return{attributes:q,basicTypeName:null,enumTypeGetter:null,isCollection:!1,isLeaf:!1,keyGetter:null,masterClassGetter:null,nullable:!1,nerveObjectType:p}}function l(b,c){var d={};return m(b,c),a.defineNerveProperty(d,a.cloneAsReadonly(b)),d}function m(a,b){if(b=b||{},b.IsKeyField){switch(a.basicTypeName){case"boolean":case"string":case"number":break;default:Nerve.Debugger.throwError('"isKeyField" only supported for basic type fields')}b.IsLocalField&&Nerve.Debugger.throwError("a local field can't be key field.")}var c={IsSourceGenerated:!!b.IsSourceGenerated,IsExpandedField:!!b.IsExpandedField,IsKeyField:!!b.IsKeyField,IsLocalField:!!b.IsLocalField,IsNumberTypeInDataSource:!!b.IsNumberTypeInDataSource,SourceFieldName:b.SourceFieldName};a.attributes=Object.freeze(c)}function n(a,b){b?h(b)?b.__nerve__.isCollection&&n(a+"[0]",b[0]):i(a,b):o(a,"empty field spec")}function o(a,b){throw Error("Spec error of "+a+": "+b+".")}var p="Spec",q=Object.freeze({IsKeyField:!1,IsLocalField:!1,IsNumberTypeInDataSource:!1,IsSourceGenerated:!1});b.fromObject=c,b.createLeaf=d,b.createEnumeration=e,b.fromObjectMasterClass=f,b.collectionOf=g,b.isFieldSpec=h,b.validateSpec=i,b.getAttributes=j}(b=a.Spec||(a.Spec={}))}(NerveImplementation||(NerveImplementation={}));var Nerve;!function(a){function b(b){return function(c){for(var d=[],e=1;e<arguments.length;e++)d[e-1]=arguments[e];var f=a.getCollectionMasterFromModel(c),g=f[b];return g.apply(f,d)}}function c(a){return function(b,c){return f.createLeaf(a,b,c)}}a.convertToArray=NerveImplementation.convertToArray,NerveImplementation.makePropertyReadonly(a,"convertToArray"),a.getFieldSchemaInfo=NerveImplementation.FieldSchema.getFieldInfo,NerveImplementation.makePropertyReadonly(a,"getFieldSchemaInfo"),a.getSubFieldSchemas=NerveImplementation.FieldSchema.getSubFields,NerveImplementation.makePropertyReadonly(a,"getSubFieldSchemas"),a.convertFromSourceData=NerveImplementation.FieldSchema.convertFromSourceData,NerveImplementation.makePropertyReadonly(a,"convertFromSourceData"),a.convertToSourceData=NerveImplementation.FieldSchema.convertToSourceData,NerveImplementation.makePropertyReadonly(a,"convertToSourceData"),a.createObjectMasterClass=NerveImplementation.createObjectMasterClass,NerveImplementation.makePropertyReadonly(a,"createObjectMasterClass"),a.getObjectMasterFromModel=NerveImplementation.getMasterFromModel,NerveImplementation.makePropertyReadonly(a,"getObjectMasterFromModel"),a.getCollectionMasterFromModel=NerveImplementation.getMasterFromModel,NerveImplementation.makePropertyReadonly(a,"getCollectionMasterFromModel"),a.isObjectMasterClass=NerveImplementation.isObjectMasterClass,NerveImplementation.makePropertyReadonly(a,"isObjectMasterClass");var d={addItems:null,deleteItems:null,getIndexWithKeyFields:null,getItemWithKeyFields:null,itemsAddedInSource:null,itemsDeletedInSource:null,markAsChanged:null,setComparer:null};for(var e in d)d[e]=b(e);a.Collection=Object.freeze(d),NerveImplementation.makePropertyReadonly(a,"Collection");var f=NerveImplementation.Spec,g=(f.createLeaf("reference"),{create:f.fromObject,"boolean":c("boolean"),number:c("number"),string:c("string"),enumeration:f.createEnumeration,reference:c("reference"),collectionOf:f.collectionOf,fromMasterClass:f.fromObjectMasterClass});a.Spec=Object.freeze(g),NerveImplementation.makePropertyReadonly(a,"Spec")}(Nerve||(Nerve={}));var NerveImplementation;!function(a){var b=Nerve.Spec,c={InProcess:b["boolean"](),AllSucceeded:b["boolean"](),Scheduled:b["boolean"](),CreationError:b.reference(),CreationFailed:b["boolean"](),CreationInProcess:b["boolean"](),CreationScheduled:b["boolean"](),CreationRetryScheduled:b["boolean"](),QueryError:b.reference(),QueryFailed:b["boolean"](),QueryInProcess:b["boolean"](),UpdateError:b.reference(),UpdateFailed:b["boolean"](),UpdateInProcess:b["boolean"](),UpdateRetryScheduled:b["boolean"](),UpdateScheduled:b["boolean"]()},d=function(a){function b(){var b=a.call(this,{InitialData:{InProcess:!1,AllSucceeded:!0,Scheduled:!1,CreationError:null,CreationFailed:!1,CreationInProcess:!1,CreationRetryScheduled:!1,CreationScheduled:!1,QueryError:null,QueryFailed:!1,QueryInProcess:!1,UpdateError:null,UpdateFailed:!1,UpdateInProcess:!1,UpdateRetryScheduled:!1,UpdateScheduled:!1}})||this;return b.addRule(e),b.addRule(f),b.addRule(g),b}return __extends(b,a),b}(Nerve.createObjectMasterClass("Nerve.ObjectSynchronizerMaster",c));a.ObjectSynchronizerMaster=d;var e={Name:"InProcess",InterestedFields:[d.Schema.CreationInProcess,d.Schema.QueryInProcess,d.Schema.UpdateInProcess],onChange:function(a){var b=a.Master.Model;b.InProcess=b.CreationInProcess||b.QueryInProcess||b.UpdateInProcess}},f={Name:"AllSucceeded",InterestedFields:[d.Schema.CreationFailed,d.Schema.QueryFailed,d.Schema.UpdateFailed],onChange:function(a){var b=a.Master.Model;b.AllSucceeded=!(b.CreationFailed||b.QueryFailed||b.UpdateFailed)}},g={Name:"Scheduled",InterestedFields:[d.Schema.CreationScheduled,d.Schema.CreationRetryScheduled,d.Schema.UpdateScheduled,d.Schema.UpdateRetryScheduled],onChange:function(a){var b=a.Master.Model;b.Scheduled=b.CreationScheduled||b.CreationRetryScheduled||b.UpdateScheduled||b.UpdateRetryScheduled}}}(NerveImplementation||(NerveImplementation={}));var NerveImplementation;!function(a){var b=function(b){function c(c,d,e,f,g){var h=b.call(this)||this;h.deletionJob=$.Deferred(),h.updateJob=$.Deferred(),h.fieldReadinesses={},h.fieldReadinesseDeferreds={},h.queryJobsPerField={},h.syncJobWithDataSource=$.Deferred().resolve().promise(),h.retryTimesForUpdate=0,h.dataReceivedDuringSync=[],h.master=c,h.scheduler=new a.SchedulerStabilizer(e.Scheduler),h.initializeUpdateJob();var i=d.Reserved&&d.Reserved.ParentExistingInDataSource;h.dataSourcePromise=$.when(d.MasterTreeReady,f,i).then(function(){return g(c,function(a){return h.onSourceDataReceived(a)},e.DataSourceContext)});var j=h.getReadyFieldNames(d);if(j.length){var k=$.Deferred().resolve();j.forEach(function(a){h.fieldReadinesses[a]=!0,h.fieldReadinesseDeferreds[a]=k})}f.done(function(){c.observe(function(a){a.UpdateNeeded&&h.checkForUpdate()})});var l=!d.ExistingInDataSource;return l?h.createWithDataSource():(h.creationJob=f,h.creationJob.done(function(){return h.checkForUpdate()})),h}return __extends(c,b),c.prototype.flush=function(){var a=this;return this.scheduler.flush(),this.creationJob.then(function(){return a.updateJob})},c.prototype.existingInDataSource=function(){return this.creationJob},c.prototype.deletedFromDataSource=function(){var b=this;return this.creationJob.then(function(){return b.deletionJob.promise()},function(){return a.getResolvedPromise()})},c.prototype.isFieldReady=function(b){b=this.master.getRelatedSourceFields([b])[0];var c=a.getTargetFieldSchemasOfObjectMaster(this.master,[b])[0],d=a.FieldSchema.getFieldName(c);return!!this.fieldReadinesses[d]},c.prototype.ensureFieldsReady=function(b){var c=this;b=this.master.getRelatedSourceFields(b);var d=a.getTargetFieldSchemasOfObjectMaster(this.master,b),e=d.filter(function(a){return!c.isFieldReady(a)});return e.length?this.creationJob.then(function(){var b=d.filter(function(a){return!c.isFieldReady(a)});return b.length?c.query(b):a.getResolvedPromise()}).then(function(){return c.getChangingPeriod()}):a.getResolvedPromise()},c.prototype.fieldsReady=function(b){var c=this;b=this.master.getRelatedSourceFields(b);var d=a.getTargetFieldSchemasOfObjectMaster(this.master,b),e=d.map(a.FieldSchema.getFieldName).map(function(a){return c.fieldReadinesseDeferreds[a]||(c.fieldReadinesseDeferreds[a]=$.Deferred()),c.fieldReadinesseDeferreds[a].promise()});return $.when.apply($,e).then(function(){return c.getChangingPeriod()})},c.prototype.query=function(b){var c=this;b=this.master.getRelatedSourceFields(b);var d=a.getTargetFieldSchemasOfObjectMaster(this.master,b);return this.creationJob.then(function(){var b=[],e=$.Deferred(),f=e.then(function(){return c.queryWithDataSource(b)}),g=[];return d.filter(function(a){return!a.__nerve__.info.Attributes.IsLocalField}).forEach(function(d){var e=a.FieldSchema.getFieldName(d),h=c.queryJobsPerField[e];h&&"pending"===h.state()||(c.queryJobsPerField[e]=f,b.push(d.__nerve__.sourceName)),g.push(c.queryJobsPerField[e]);
}),b.length?e.resolve():e.reject(),$.when.apply($,g)}).then(function(){return c.getChangingPeriod()})},c.prototype.onSourceDataReceived=function(b){var c=this,d=a.FieldSchema.cloneSourceData(b,this.master.Schema);return this.dataReceivedDuringSync.push(d),this.syncJobWithDataSource.then(function(){return c.flushReceivedDataDuringSync()})},c.prototype.onDeletedInDataSource=function(){this.getDirtyChecker().ExistingInSource=!1,this.master.Deleted=!0},c.prototype.setFieldsQueryJob=function(b,c){var d=this,e=a.getTargetFieldSchemasOfObjectMaster(this.master,this.master.getRelatedSourceFields(b)).filter(function(a){return!a.__nerve__.info.Attributes.IsLocalField}),f=$.Deferred(),g=f.then(function(){return c}).then(function(a){var b={};return e.map(function(a){return a.__nerve__.sourceName}).forEach(function(c){return b[c]=a[c]}),d.onSourceDataReceived(b)});e.map(a.FieldSchema.getFieldName).forEach(function(b){var c=d.queryJobsPerField[b];c&&"pending"===c.state()?d.queryJobsPerField[b]=a.anyoneResolved(c,g):d.queryJobsPerField[b]=g}),f.resolve()},c.prototype.markFieldsAsReady=function(a,b){var c=this;a.forEach(function(a){return c.fieldReadinesses[a]=!0}),b.done(function(){var b=$.Deferred().resolve();a.forEach(function(a){c.fieldReadinesseDeferreds[a]?c.fieldReadinesseDeferreds[a].resolve():c.fieldReadinesseDeferreds[a]=b})})},c.prototype.initializeUpdateJob=function(){var a=this;this.updateJob=$.Deferred(),this.observe(function(){return a.changeUpdateJobState()},[this.Schema.UpdateError,this.Schema.UpdateFailed,this.Schema.UpdateInProcess,this.Schema.UpdateScheduled])},c.prototype.changeUpdateJobState=function(){var a=this.Model;a.UpdateScheduled||a.UpdateInProcess?"pending"!==this.updateJob.state()&&(this.updateJob=$.Deferred()):a.UpdateFailed?a.UpdateRetryScheduled||this.updateJob.reject(a.UpdateError):this.updateJob.resolve()},c.prototype.getReadyFieldNames=function(b){var c=this.master.Schema.__nerve__.subFields;if(b.ExistingInDataSource){var d=b.InitialData||{},e=[];return c.toArray().forEach(function(b){var c=a.FieldSchema.getFieldName(b);(b.__nerve__.info.Attributes.IsLocalField||c in d)&&e.push(c)}),e}return c.toArray().filter(function(a){return!a.__nerve__.info.Attributes.IsSourceGenerated}).map(a.FieldSchema.getFieldName)},c.prototype.checkForUpdate=function(){var a=this;this.getDirtyChecker().isDirty()?this.bulkEdit(function(){a.Model.UpdateScheduled=!0,$.when(a.creationJob,a.scheduler.scheduleUpdate()).done(function(){a.retryTimesForUpdate=0,a.update()})}):(this.scheduler.cancelUpdate(),this.Model.UpdateScheduled=!1)},c.prototype.update=function(){if(this.updating)return void(this.updatePended=!0);if(this.getDirtyChecker().isDirty()){if(this.onUpdateStart(),this.getDirtyChecker().isDirty())return this.master.__nerve__.deleted?this.deleteWithDataSource():this.updateWithDataSource();Nerve.Debugger.warn("onUpdateStart changes dirtiness."),this.onUpdateDone()}else this.onUpdateDone()},c.prototype.getDirtyChecker=function(){return this.master.__nerve__.dirtyChecker},c.prototype.createWithDataSource=function(){var a=this,b=$.Deferred();this.creationJob=b.promise();var c=this.master;this.bulkEdit(function(){a.Model.CreationScheduled=!0,a.dataSourcePromise.done(function(d){var e=function(){if(a.scheduler.cancelRetryForCreation(),c.__nerve__.deleted)return a.bulkEdit(function(){a.Model.CreationFailed=!1,a.Model.CreationInProcess=!1,a.Model.CreationRetryScheduled=!1,a.Model.CreationScheduled=!1});a.bulkEdit(function(){a.Model.CreationError=null,a.Model.CreationFailed=!1,a.Model.CreationInProcess=!0,a.Model.CreationRetryScheduled=!1,a.Model.CreationScheduled=!1});var g=a.getDirtyChecker(),h=g.getDelta()||{},i=g.getSnapshotToUpdate(),j=a.syncJobWithDataSource.then(function(){return d.add(h,{Master:c,Snapshot:i})}).then(function(d){c.bulkEdit(function(){g.ExistingInSource=!0,g.setSourceData(h),d&&a.onSourceDataReceivedInternal(d)}),a.bulkEdit(function(){a.Model.CreationInProcess=!1,a.checkForUpdate()}),b.resolve()}).fail(function(c){a.bulkEdit(function(){a.Model.CreationFailed=!0,a.Model.CreationError=c,a.Model.CreationInProcess=!1,a.Model.CreationRetryScheduled=!0,a.scheduler.retryForCreation(++f).done(e).fail(function(){a.Model.CreationRetryScheduled=!1,b.reject(c)})})});a.updateSyncJobWithDataSource(j)},f=0;e()})})},c.prototype.deleteWithDataSource=function(){var a=this,b=this.getDirtyChecker(),c=this.syncJobWithDataSource.then(function(){return a.dataSourcePromise}).then(function(c){var d=b.getSnapshotToUpdate();return c["delete"](d,{Master:a.master,Snapshot:d})}).then(function(){return b.ExistingInSource=!1});return this.updateSyncJobWithDataSource(c),c.done(function(){a.onUpdateDone(!1),a.deletionJob.resolve()}).fail(function(b){a.onUpdateFailed(b,!1,function(){a.deletionJob.reject(b)})})},c.prototype.queryWithDataSource=function(a){var b=this,c=this.syncJobWithDataSource.then(function(){return b.dataSourcePromise}).then(function(c){return b.bulkEdit(function(){b.Model.QueryError=null,b.Model.QueryInProcess=!0}),c.query(a,{Master:b.master,Snapshot:null})}).then(function(c){var d={};Object.keys(c).concat(a).forEach(function(a){return d[a]=c[a]}),b.onSourceDataReceivedInternal(d)});return this.updateSyncJobWithDataSource(c),c.done(function(){b.Model.QueryInProcess=!1}).fail(function(a){b.bulkEdit(function(){b.Model.QueryError=a,b.Model.QueryInProcess=!1})})},c.prototype.updateWithDataSource=function(){var a=this,b=this.getDirtyChecker(),c=b.getDelta(),d=b.getSnapshotToUpdate(),e=b.getSourceData();null==c&&Nerve.Debugger.warn("data is null when it's dirty.");var f=this.syncJobWithDataSource.then(function(){return a.dataSourcePromise}).then(function(b){return b.update(c,{Master:a.master,Snapshot:d,ValuesBefore:e})}).then(function(d){a.master.bulkEdit(function(){b.setSourceData(c),d&&a.onSourceDataReceivedInternal(d)})});return this.updateSyncJobWithDataSource(f),f.done(function(){return a.onUpdateDone(!0)}).fail(function(b){return a.onUpdateFailed(b,!0)})},c.prototype.onUpdateStart=function(){var a=this;this.updating=!0,this.updatePended=!1,this.scheduler.cancelRetryForUpdate(),this.bulkEdit(function(){a.Model.UpdateError=null,a.Model.UpdateFailed=!1,a.Model.UpdateInProcess=!0,a.Model.UpdateRetryScheduled=!1,a.Model.UpdateScheduled=!1})},c.prototype.onUpdateDone=function(a){var b=this;this.updating=!1,this.retryTimesForUpdate=0,this.scheduler.cancelRetryForUpdate(),this.bulkEdit(function(){b.Model.UpdateError=null,b.Model.UpdateFailed=!1,b.Model.UpdateInProcess=!1,b.Model.UpdateRetryScheduled=!1,b.Model.UpdateScheduled=!1,a&&(b.updatePended?b.update():b.checkForUpdate())})},c.prototype.onUpdateFailed=function(a,b,c){var d=this;return this.getDirtyChecker().isDirty()?(this.updating=!1,void this.bulkEdit(function(){d.Model.UpdateError=a,d.Model.UpdateFailed=!0,d.Model.UpdateInProcess=!1,d.Model.UpdateRetryScheduled=!0,d.Model.UpdateScheduled=!0,b&&d.updatePended?d.update():d.scheduler.retryForUpdate(++d.retryTimesForUpdate).done(function(){return d.update()}).fail(function(){d.bulkEdit(function(){d.Model.UpdateRetryScheduled=!1,d.Model.UpdateScheduled=!1}),c&&c()})})):void this.onUpdateDone()},c.prototype.onSourceDataReceivedInternal=function(b){var c=a.FieldSchema.cloneSourceData(b,this.master.Schema);this.getDirtyChecker().onSourceDataReceived(c)},c.prototype.updateSyncJobWithDataSource=function(b){var c=this;this.syncJobWithDataSource=a.always(b).then(function(){return c.flushReceivedDataDuringSync()})},c.prototype.flushReceivedDataDuringSync=function(){var a=this.getDirtyChecker(),b=this.dataReceivedDuringSync;this.dataReceivedDuringSync=[],this.master.bulkEdit(function(){b.forEach(function(b){return a.onSourceDataReceived(b)})})},c.prototype.getChangingPeriod=function(){return this.master.__nerve__.changeManager.getChangingPeriod()},c}(a.ObjectSynchronizerMaster);a.ObjectSynchronizer=b}(NerveImplementation||(NerveImplementation={}));var NerveImplementation;!function(a){var b=function(){function a(a,b,c){var d=this;this.name=a,this.fieldSchema=b;var e=c.Reserved.Membership;this.parentMaster=e.Parent,e.Property=this,this.isMounted=!1,c.Reserved.Mounted.done(function(){return d.isMounted=!0})}return Object.defineProperty(a.prototype,"Name",{get:function(){return this.name},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"FieldSchema",{get:function(){return this.fieldSchema},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"ParentMaster",{get:function(){return this.parentMaster},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Index",{get:function(){return this.index},set:function(a){if(a!==this.index){var b=this.index;this.index=a;var c=this.ParentMaster;this.indexDirtinessUpdateNeeded()&&c.__nerve__.dirtyChecker.updateDirtinessForIndexChange(this),this.Mounted&&c.__nerve__.changeManager.onPropertyIndexChange(this,b)}},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Mounted",{get:function(){return this.isMounted},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Deleted",{get:function(){return this.deleted},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"ParentDirtyChecker",{get:function(){return this.ParentMaster.__nerve__.dirtyChecker},enumerable:!0,configurable:!0}),a.prototype.markAsDeleted=function(a){this.deleted=!0,this.Index=void 0},a.prototype.getKey=function(){return this.fieldSchema.__nerve__.getKey(this.getter())},a}();a.PropertyBase=b}(NerveImplementation||(NerveImplementation={}));var NerveImplementation;!function(a){var b=function(a){function b(b,c,d){var e=a.call(this,b,c,d)||this,f=c.__nerve__.subMasterClassGetter();return e.master=new f(d),e}return __extends(b,a),Object.defineProperty(b.prototype,"Master",{get:function(){return this.master},enumerable:!0,configurable:!0}),b.prototype.getter=function(){return this.master.Model},b.prototype.setter=function(a){this.master.setData(a,this.master.Schema.__nerve__.subFields.toArray())},b.prototype.markAsDeleted=function(b){a.prototype.markAsDeleted.call(this,b),b&&(this.getDirtyChecker().ExistingInSource=!1),this.master.Deleted=!0},b.prototype.getDirtyChecker=function(){return this.master.__nerve__.dirtyChecker},b.prototype.indexDirtinessUpdateNeeded=function(){return!this.FieldSchema.__nerve__.withDataSource},b}(a.PropertyBase);a.PropertyAsBranch=b}(NerveImplementation||(NerveImplementation={}));var NerveImplementation;!function(a){var b=function(b){function c(a,c,d){var e=b.call(this,a,c,d)||this;e.value=e.normalizeValue(d.InitialData);var f=!c.__nerve__.info.Attributes.IsLocalField;return e.dirtyChecker=e.createDirtyChecker(f),e}return __extends(c,b),c.prototype.getter=function(){return this.value},c.prototype.setter=function(a){if(a=this.normalizeValue(a),this.value!==a){this.value=a,this.dirtyChecker.updateDirtiness();var b=this.ParentMaster.__nerve__.changeManager;b.markSubSnapshotAsDirty([this]),b.markAsChanged(this)}},c.prototype.getDirtyChecker=function(){return this.dirtyChecker},c.prototype.normalizeValue=function(a){return null==a?null:a},c.prototype.createDirtyChecker=function(b){return new a.LeafDirtyChecker(this,b)},c.prototype.indexDirtinessUpdateNeeded=function(){return!0},c}(a.PropertyBase);a.PropertyAsLeaf=b}(NerveImplementation||(NerveImplementation={}));var NerveImplementation;!function(a){var b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.normalizeValue=function(a){var b=typeof a;if("string"===b||"number"===b){var c=this.FieldSchema.__nerve__.enumType;if(a in c)return"string"===b?c[a]:a}return null},c.prototype.createDirtyChecker=function(b){return new a.EnumDirtyChecker(this,b)},c}(a.PropertyAsLeaf);a.PropertyAsEnum=b}(NerveImplementation||(NerveImplementation={}));var NerveImplementation;!function(a){var b=function(){function b(a){a?(this.creationRetryStabilizer=new c({retry:a.retryForCreation&&a.retryForCreation.bind(a),cancel:a.cancelRetryForCreation&&a.cancelRetryForCreation.bind(a)}),this.updateRetryStabilizer=new c({retry:a.retryForUpdate&&a.retryForUpdate.bind(a),cancel:a.cancelRetryForUpdate&&a.cancelRetryForUpdate.bind(a)})):(this.creationRetryStabilizer=new c,this.updateRetryStabilizer=new c),this.scheduler=a||{}}return b.prototype.scheduleUpdate=function(){return this.outputUpdateScheduleDeferred?(this.scheduler.postponeUpdate&&this.scheduler.postponeUpdate(),this.outputUpdateScheduleDeferred.promise()):this.createUpdateSchedule()},b.prototype.postponeUpdate=function(){this.scheduler.postponeUpdate&&this.scheduler.postponeUpdate()},b.prototype.flush=function(){if(this.creationRetryStabilizer.flush(),this.updateRetryStabilizer.flush(),this.cancelableUpdateSchedule&&(this.cancelableUpdateSchedule.cancel(),this.cancelableUpdateSchedule=void 0,this.scheduler.cancelUpdate&&this.scheduler.cancelUpdate()),this.outputUpdateScheduleDeferred){var a=this.outputUpdateScheduleDeferred;this.outputUpdateScheduleDeferred=void 0,a.resolve()}},b.prototype.cancelUpdate=function(){this.outputUpdateScheduleDeferred&&(this.outputUpdateScheduleDeferred.reject(),this.scheduler.cancelUpdate&&this.scheduler.cancelUpdate())},b.prototype.retryForCreation=function(a){return this.creationRetryStabilizer.retry(a)},b.prototype.cancelRetryForCreation=function(){return this.creationRetryStabilizer.cancel()},b.prototype.retryForUpdate=function(a){return this.updateRetryStabilizer.retry(a)},b.prototype.cancelRetryForUpdate=function(){return this.updateRetryStabilizer.cancel()},b.prototype.createUpdateSchedule=function(){var b=this;this.outputUpdateScheduleDeferred||(this.outputUpdateScheduleDeferred=$.Deferred());var c,d=this.outputUpdateScheduleDeferred;return c=this.scheduler.scheduleUpdate?this.scheduler.scheduleUpdate():a.getResolvedPromise(),this.cancelableUpdateSchedule=new a.Cancelable(c),this.cancelableUpdateSchedule.promise().always(function(){b.outputUpdateScheduleDeferred=void 0,b.cancelableUpdateSchedule=void 0}).done(function(){return d.resolve()}).fail(function(){return d.reject()}),d.promise()},b}();a.SchedulerStabilizer=b;var c=function(){function b(a){this.scheduler=a||{}}return b.prototype.retry=function(b){var c=this;if(!this.scheduler.retry)return a.getRejectedPromise();this.cancel();var d=$.Deferred();return this.deferred=d,this.cancelable=new a.Cancelable(this.scheduler.retry(b)),this.cancelable.promise().always(function(){c.deferred=void 0,c.cancelable=void 0}).done(function(){return d.resolve()}).fail(function(){return d.reject()}),d.promise()},b.prototype.flush=function(){if(this.cancelable&&(this.cancelable.cancel(),this.cancelable=void 0,this.scheduler.cancel&&this.scheduler.cancel()),this.deferred){var a=this.deferred;this.deferred=void 0,a.resolve()}},b.prototype.cancel=function(){this.cancelable&&(this.cancelable.cancel(),this.deferred=void 0,this.cancelable=void 0,this.scheduler.cancel&&this.scheduler.cancel())},b}()}(NerveImplementation||(NerveImplementation={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(a){a[a.Succeeded=0]="Succeeded",a[a.Failed=1]="Failed"}(b=a.AsyncResultStatus||(a.AsyncResultStatus={}))}(b=a.DataProvider||(a.DataProvider={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b=function(){function a(){}return a.logData=function(a){Forms.Telemetry.log({eventName:a.errorName,eventType:"error_event",extraData:a.errorInfo})},a}();a.ErrorEventDeprecated=b}(b=a.Event||(a.Event={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){}(b=a.Exports||(a.Exports={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){a[a.BackSpace=8]="BackSpace",a[a.Tab=9]="Tab",a[a.Enter=13]="Enter",a[a.Shift=16]="Shift",a[a.Esc=27]="Esc",a[a.Space=32]="Space",a[a.End=35]="End",a[a.Home=36]="Home",a[a.ArrowLeft=37]="ArrowLeft",a[a.ArrowUp=38]="ArrowUp",a[a.ArrowRight=39]="ArrowRight",a[a.ArrowDown=40]="ArrowDown",a[a.Delete=46]="Delete",a[a.Eight=56]="Eight",a[a.PlaceHolder=229]="PlaceHolder"}(b=a.KeyCode||(a.KeyCode={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){a[a.Unauthorized=401]="Unauthorized",a[a.Forbidden=403]="Forbidden",a[a.NotFound=404]="NotFound"}(b=a.HttpStatusCode||(a.HttpStatusCode={}));var c;!function(a){a[a.UpdateFormFailed=609]="UpdateFormFailed",a[a.GetFormFailed=612]="GetFormFailed",a[a.CDBColumnNotFound=621]="CDBColumnNotFound",a[a.CDBTopLevelError=631]="CDBTopLevelError",a[a.ExceedMaximumFormLimition=650]="ExceedMaximumFormLimition",a[a.CDBTableNotFound=674]="CDBTableNotFound",a[a.TableReadOnly=636]="TableReadOnly",a[a.CDBTableMoved=639]="CDBTableMoved",a[a.NoPermission=700]="NoPermission",a[a.RequireLogin=701]="RequireLogin",a[a.UserNotAllowed=702]="UserNotAllowed",a[a.DisabledByTenantAdmin=703]="DisabledByTenantAdmin",a[a.AntiForgeryTokenValidationError=704]="AntiForgeryTokenValidationError",a[a.UserNeedMultiFactorAuth=705]="UserNeedMultiFactorAuth",a[a.CDBUnauthorizedAccess=707]="CDBUnauthorizedAccess",a[a.NotAllowedBySetting=708]="NotAllowedBySetting",a[a.TokenExpired=711]="TokenExpired",a[a.NotRolloutMsaUser=712]="NotRolloutMsaUser",a[a.CoAuthNotAllowedForMsa=715]="CoAuthNotAllowedForMsa",a[a.NotAllowedByResponseOwnership=716]="NotAllowedByResponseOwnership",a[a.FailedToCheckUserLicense=750]="FailedToCheckUserLicense",a[a.LicenseNotFound=751]="LicenseNotFound",a[a.LicenseNotValid=752]="LicenseNotValid",a[a.AbusedForm=6100]="AbusedForm",a[a.ImageNotFound=805]="ImageNotFound",a[a.InvalidFormId=1001]="InvalidFormId",a[a.NotSupportComposeFormId=1002]="NotSupportComposeFormId",a[a.ResponseNotFound=1007]="ResponseNotFound",a[a.FormClosed=5e3]="FormClosed",a[a.MultiResponseNotAllowed=5001]="MultiResponseNotAllowed",a[a.FormNotStarted=5002]="FormNotStarted",a[a.FormEnded=5003]="FormEnded",a[a.FormSettingJSONParseError=5004]="FormSettingJSONParseError",a[a.NoODPermissionForOpenInExcel=5117]="NoODPermissionForOpenInExcel",a[a.FailedToCreatePermission=5501]="FailedToCreatePermission",a[a.FailedToDeletePermission=5503]="FailedToDeletePermission",a[a.CreateInfoNotCompletePermission=5504]="CreateInfoNotCompletePermission",a[a.DeleteNotExistPermission=5506]="DeleteNotExistPermission",a[a.CopyNotAllowed=5550]="CopyNotAllowed",a[a.FailedToTurnOnAllowCopy=5551]="FailedToTurnOnAllowCopy",a[a.FailedToTurnOffAllowCopy=5552]="FailedToTurnOffAllowCopy",a[a.IncorrectShareToken=5553]="IncorrectShareToken",a[a.ImageUploadFailed=5200]="ImageUploadFailed",a[a.ImageTypeConvertFailed=5201]="ImageTypeConvertFailed",a[a.ImageProviderGetCDBTokenFailed=5202]="ImageProviderGetCDBTokenFailed",a[a.CdbServiceUnavailable=6503]="CdbServiceUnavailable",a[a.OriginalOwnerIsEmpty=6700]="OriginalOwnerIsEmpty",a[a.OriginalOwnerNotFound=6701]="OriginalOwnerNotFound",a[a.CurrentSignedUserIsNotDelegator=6702]="CurrentSignedUserIsNotDelegator",a[a.CurrentOwnerIsActiveUser=6705]="CurrentOwnerIsActiveUser",a[a.EmbedFormNeedAuth=10001]="EmbedFormNeedAuth",a[a.WorkBookLostFocus=10100]="WorkBookLostFocus",a[a.GetTableDataFailed=10101]="GetTableDataFailed",a[a.InvalidWorkBookSchema=10102]="InvalidWorkBookSchema",a[a.DeleteFormFailed=10201]="DeleteFormFailed",a[a.DeleteFormSuccessed=10202]="DeleteFormSuccessed",a[a.DownloadExcelFileFailed=10203]="DownloadExcelFileFailed",a[a.DownloadExcelFileFailedOnIos=10204]="DownloadExcelFileFailedOnIos",a[a.ReexportToExcelFailed=10205]="ReexportToExcelFailed",a[a.DownloadExcelFileTimeout=10206]="DownloadExcelFileTimeout",a[a.NetworkIssue=15001]="NetworkIssue",a[a.GetGraphAPITokenFailed=15002]="GetGraphAPITokenFailed",a[a.LoginNotSupportInCurrentBrowser=15003]="LoginNotSupportInCurrentBrowser"}(c=a.InnerCode||(a.InnerCode={}))}(b=a.ErrorCode||(a.ErrorCode={}))}(b=a.DataProvider||(a.DataProvider={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(b,c){if(!b&&!a.EnvironmentConfig.isProduction()&&!a.EnvironmentConfig.isProdAlternative()){var d=(new Error).stack;console.assert(b,c,d)}}function d(){return _.omit(K.getQueries(),"embed","oembedsso","themecolor","preview")}function e(){return!!K.getQueries().embed}function f(){return OfficeFormServerInfo.isOembedSPO}function g(){return!!K.getQueries().oembedsso&&!!K.getQueries().preview}function h(){return a.EnvironmentSettings.IsAssignmentsIntegration||i()?!0:!1}function i(){return a.EnvironmentSettings.IsTeamsIntegration&&a.EnvironmentConfig.isProduction()&&"Analyze"!==a.EnvironmentConfig.getPageType()?!0:!1}function j(a){return!!a}function k(){var a=navigator.userAgent.toLowerCase();return-1!==a.search("windows nt 10.")}function l(){var a=navigator.userAgent.toLowerCase();return-1!==a.indexOf("msie")||-1!==a.indexOf("trident/")}function m(){var a=navigator.userAgent.toLowerCase();return-1!==a.indexOf("edge/")}function n(){var a=navigator.userAgent.toLowerCase();return-1!==a.indexOf("firefox/")}function o(){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4))}function p(){return $(window).width()<=768}function q(){return/ip(hone|od|ad)/.test(navigator.userAgent.toLowerCase())&&!window.MSStream}function r(){var a=navigator.userAgent.toLowerCase();return-1!==a.indexOf("mac os x")&&-1!==a.indexOf("version/9")&&-1!==a.indexOf("safari")}function s(){var a=navigator.userAgent;return!!a.match(/android/i)}function t(){var a=navigator.userAgent.toLowerCase();return-1!==a.indexOf("tbs/")}function u(){var a=navigator.userAgent.toLowerCase();return-1!==a.indexOf("micromessenger/")}function v(){var a,b;return a=document.createElement("div"),a.style.color="rgb(83,7,13)",document.body.appendChild(a),b=document.defaultView?document.defaultView.getComputedStyle(a,null).color:a.currentStyle.color,b=b.replace(/ /g,""),document.body.removeChild(a),"rgb(83,7,13)"!==b}function w(a){var b=_.clone(a);return _.each(b,function(a,c){_.isObject(a)&&(b[c]=w(a))}),b}function x(a){try{var b=JSON.parse(a);return b}catch(c){return a}}function y(a){return _.keys(a).filter($.isNumeric).map(function(a){return parseInt(a)})}function z(a){return _.keys(a).filter($.isNumeric).map(function(b){return a[b]})}function A(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];if(a=a.filter(function(a){return!!a}),!a.length)return $.Deferred().reject().promise();var c=$.Deferred(),d=a.length,e=function(a){0===--d&&c.reject(a)};return a.forEach(function(a){a.done(function(a){return c.resolve(a)}).fail(e)}),c.promise()}function B(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];var c=a.map(function(a){var b=$.Deferred();return a.then(function(a){return a?b.reject(!0).promise():b.resolve(!1).promise()},function(a){return b.resolve(!1).promise()})});return $.when.apply($,c).then(function(a){return $.Deferred().resolve(!1).promise()},function(a){return $.Deferred().resolve(!0).promise()})}function C(a,b,c){var d=new Date;d.setTime(d.getTime()+c);var e="expires="+d.toUTCString(),f="path=/";document.cookie=a+"="+b+"; "+e+"; "+f}function D(a){a+="=";var b=document.cookie.split(";").filter(function(b){return b.indexOf(a)>=0});if(b.length>0){var c=b[0].trim();return c.substring(a.length,c.length)}return null}function E(a){C(a,null,(new Date).getTime()-9999)}function F(a){for(var b=0,c=0;c<a.length;c++)b=a.charCodeAt(c)+((b<<5)-b);return b}function G(){return document&&document.body&&"rtl"===document.body.getAttribute("dir")}function H(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}a.Exports.Utilities=b;var I;!function(a){function b(a){return null===a?void 0:a}function c(a){return void 0===a?null:a}a.nullToUndefined=b,a.undefinedToNull=c}(I=b.Conversion||(b.Conversion={}));var J=function(){function a(){}return a.isLocalDateEqual=function(a,b){return a&&b?a.getFullYear()===b.getFullYear()&&a.getMonth()===b.getMonth()&&a.getDate()===b.getDate():void 0},a.compareLocalTime=function(a,b){if(a&&b){var c=1e3*(60*(60*a.getHours()+a.getMinutes())+a.getSeconds())+a.getMilliseconds(),d=1e3*(60*(60*b.getHours()+b.getMinutes())+b.getSeconds())+b.getMilliseconds();return c-d}return void 0},a.getTimeStamp=function(){return Date.now||(Date.now=function(){return(new Date).getTime()}),Math.floor(Date.now())},a}();b.DateTime=J;var K;!function(b){function c(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];var c=a.map(function(a){return a&&a.trim()}).filter(function(a){return!!a}).join(" ");return c||a.some(function(a){return""===a})||(c=void 0),c}function d(a){return f(a||window.location.search.substring(1))}function e(a){return f(a||window.location.hash.substring(1))}function f(a){var b={};return a&&a.trim().split("&").forEach(function(a){var c=a.split("="),d=c[0].trim();d&&(b[d]=decodeURIComponent(c[1]||"").trim())}),b}function g(a){var b=document.createElement("a");return b.href=a,b.href}function h(a){var b=document.createElement("a");return b.href=a,b.hostname}function i(a){var b=document.createElement("a");return b.href=a,b.search}function j(a,b){var c=a.indexOf("#"),d=-1===c?"":a.substr(c);a=-1===c?a:a.substr(0,c);var e=a.indexOf("?"),g=-1===e?"":a.substr(e);a=-1===e?a:a.substr(0,e);var h={};return g&&(h=f(g.substr(1))),_.extend(h,b),a+"?"+$.param(h)+d}function k(a,b,c){var d=a.indexOf("#"),e=-1===d?"":a.substr(d);a=-1===d?a:a.substr(0,d);var f=new RegExp("([?&])"+b+"=.*?(&|$)","i"),g=-1!==a.indexOf("?")?"&":"?";return a=a.match(f)?a.replace(f,"$1"+b+"="+c+"$2"):a+g+b+"="+c,a+e}function l(a,b,c,d,e){d=d||0,c=c||0;var f=b.height(),g=a.outerHeight();if(a.offset()&&b.offset()){var h=a.offset().top-b.offset().top;if(0>h)return void b.scrollTop(b.scrollTop()+h-(g+c>f?0:c));var i=Math.min(g,f),j=h+i-f;f>g+c+d?(i=g+d,j=h+i-f):f>g+c&&(i=g+c,j=h-c),j>0&&(e?b.animate({scrollTop:b.scrollTop()+j},"fast"):b.scrollTop(b.scrollTop()+j))}}function m(a,b){void 0===b&&(b=!0);var c=a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;");return b&&(c=c.replace(/'/g,"&apos;")),c}function n(a){return a?a.replace(/\\"/g,'"'):""}function o(a,b){var d=_.extend({},a);for(var e in b)switch(e){case"className":case"aria-labelledby":case"aria-describedby":d[e]=c(d[e],b[e]);break;case"children":case"defaultValue":case"value":b.hasOwnProperty(e)&&(null!=d[e]?d[e]=[].concat(d[e],b[e]):d[e]=b[e]);break;case"style":null!=d[e]?_.extend(d[e],b[e]):d[e]=b[e];break;case"onCopy":case"onCut":case"onPaste":case"onCompositionEnd":case"onCompositionStart":case"onCompositionUpdate":case"onFocus":case"onBlur":case"onChange":case"onInput":case"onSubmit":case"onLoad":case"onError":case"onKeyDown":case"onKeyPress":case"onKeyUp":case"onAbort":case"onCanPlay":case"onCanPlayThrough":case"onDurationChange":case"onEmptied":case"onEncrypted":case"onEnded":case"onLoadedData":case"onLoadedMetadata":case"onLoadStart":case"onPause":case"onPlay":case"onPlaying":case"onProgress":case"onRateChange":case"onSeeked":case"onSeeking":case"onStalled":case"onSuspend":case"onTimeUpdate":case"onVolumeChange":case"onWaiting":case"onClick":case"onContextMenu":case"onDoubleClick":case"onDrag":case"onDragEnd":case"onDragEnter":case"onDragExit":case"onDragLeave":case"onDragOver":case"onDragStart":case"onDrop":case"onMouseDown":case"onMouseEnter":case"onMouseLeave":case"onMouseMove":case"onMouseOut":case"onMouseOver":case"onMouseUp":case"onSelect":case"onTouchCancel":case"onTouchEnd":case"onTouchMove":case"onTouchStart":case"onScroll":case"onWheel":d[e]=p(d[e],b[e]);break;default:void 0!==b[e]&&(d[e]=b[e])}return d}function p(a,b){return function(c){a&&a(c),b&&b(c)}}function q(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];return function(c){(0===b.length||b.indexOf(c.keyCode)>=0)&&a(c)}}function r(a){var b=a.nativeEvent.explicitOriginalTarget;return a.relatedTarget||b||document.activeElement}function s(){return window.innerWidth}function t(b,c,d,e){if(a.EnvironmentSettings.IsTeamsIntegration){var f=$("<a></a>");return f.attr("href",b),c||(c="_blank"),f.attr("target",c),f[0].click(),f.remove(),null}return c||d||e?d||e?e?window.open(b,c,d,e):window.open(b,c,d):window.open(b,c):window.open(b)}function u(a){var b="hiddeon-open-iframe",c=document.getElementById(b);c&&c.parentNode.removeChild(c),c=document.createElement("iframe"),c.id=b,c.name=b,c.hidden=!0,document.body.appendChild(c),c.contentWindow.location.href=a}function v(a){var b=w(a);return x(b)}function w(a){var b=["b"],c=_.map(b,function(a){return"<"+a+">"}),d=_.map(b,function(a){return"</"+a+">"}),e=_.map(b,function(a){return"&lt;"+a+"&gt;"}),f=_.map(b,function(a){return"&lt;/"+a+"&gt;"}),g=_.escape(a);return b.forEach(function(a,b){g=g.replaceAll(e[b],c[b]).replaceAll(f[b],d[b])}),g}function x(a){var b=document.createElement("span");return b.innerHTML=a,a=b.innerHTML}b.combineAttributes=c,b.getQueries=d,b.getHashes=e,b.getAbsoluteUrl=g,b.getHostName=h,b.getSearchString=i,b.updateUrlParams=j,b.updateUrlParam=k,b.scrollToShowSubelement=l,b.encodeHTML=m,b.decodeJavascriptString=n,b.mergeReactProps=o,b.wrapReactEvent=p,b.onKeyboardEvent=q,b.getTargetElementOfFocusEvent=r,b.getWindowWidth=s,b.safeOpen=t,b.hiddenOpen=u,b.sanitize=v}(K=b.Html||(b.Html={}));var L;!function(a){function b(a){return k.test(a)&&l.test(a)}function c(){return e()}function d(a){var b=/[0-9a-fA-F]*/g,c=a.match(b),d="";return _.map(c,function(a){return d+=a}),!a||/^[0-]*$/.test(a)}function e(){var a=f();return h(a)}function f(){var a=[g()+g(),g(),g(),g(),g()+g()+g()];return a.join("-")}function g(){var a=Math.floor(65536*Math.random()).toString(16);return j(a,4,"0")}function h(a){var b=parseInt(a.charAt(19),16);b=3&b|8;var c=b.toString(16);return a=i(a,14,"4"),a=i(a,19,c)}function i(a,b,c){return a.substring(0,b)+c+a.substring(b+1)}function j(a,b,c){for(var d=a.length,e=c.length;b>d;d+=e)a=c+a;return a}var k=/^[0-9a-fA-F\-]*$/,l=/^[^\-]{8}(\-[^\-]{4}){4}[^\-]{8}$/;a.isValidGuid=b,a.newGuid=c,a.isNullOrEmpty=d}(L=b.Guid||(b.Guid={}));var M;!function(a){function b(a){var b=(a||"").trim().replace(/[,]/g,"");return $.isNumeric(b)}function c(a){var b=(a||"").trim().replace(/[,]/g,"");return $.isNumeric(b)?parseFloat(b).toString():""}function d(a){return Math.floor(a)===a}a.isFormatedAsFloat=b,a.formatAsFloat=c,a.isInteger=d}(M=b.NumberValidation||(b.NumberValidation={}));var N;!function(a){function b(a){return/^(https ?\:\/\/)?((www\.)?youtube\.com|youtu\.?be)\/.+$/.test(a);
}a.isYouTubeUrl=b}(N=b.UrlValidation||(b.UrlValidation={}));var O;!function(a){var b=function(){function a(a,b){void 0===b&&(b=0),this.functionToCall=a,this.timeToWaitInMs=b}return a.prototype.callOnceLater=function(){var a=this;0!==this.timeToWaitInMs&&null!=this.handler&&this.clear(),null==this.handler&&(this.handler=setTimeout(function(){a.callImmediately()},this.timeToWaitInMs))},a.prototype.flush=function(){null!=this.handler&&(this.clear(),this.functionToCall())},a.prototype.callImmediately=function(){null!=this.handler&&this.clear(),this.functionToCall()},a.prototype.clear=function(){clearTimeout(this.handler),this.handler=void 0},a}();a.CallLater=b;var c=function(){function a(){this.callbacks=[]}return a.prototype.register=function(a){this.callbacks.push(a)},a.prototype.unregister=function(a){this.callbacks=_.without(this.callbacks,a)},Object.defineProperty(a.prototype,"trigger",{get:function(){return this.triggerInternal},enumerable:!0,configurable:!0}),a.prototype.clear=function(){this.callbacks=[]},a.prototype.triggerInternal=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.callbacks.forEach(function(b){return b.apply(void 0,a)})},a}();a.CallbackManager=c;var d=function(){function a(){this.buffer=[]}return a.prototype.setFunctionToCall=function(a){var b=this;if(this.functionToCall!==a)if(this.functionToCall=a,a){var c=this.buffer;delete this.buffer,c&&c.length&&c.forEach(function(a){return b.functionToCall.apply(void 0,a)})}else this.buffer=this.buffer||[]},Object.defineProperty(a.prototype,"queue",{get:function(){return this.functionToCall?this.functionToCall:this.defaultQueue},enumerable:!0,configurable:!0}),a.prototype.defaultQueue=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.buffer.push(a)},a}();a.BufferForCall=d;var e=function(){function a(a){this.queue=[],this.jobCountLeft=a}return a.prototype.queueJob=function(a){a&&(this.queue.push(a),this.tryProcessQueuedJob())},a.prototype.stopProcessingNewJob=function(){this.jobCountLeft=-(1/0)},a.prototype.tryProcessQueuedJob=function(){for(var a=this;this.jobCountLeft>0&&this.queue.length;){--this.jobCountLeft;var b=this.queue.shift();b().always(function(){++a.jobCountLeft,a.tryProcessQueuedJob()})}},a}();a.Pool=e}(O=b.Process||(b.Process={}));var P;!function(a){function b(a){var b=$.Deferred();return b.reject(a).promise()}function c(a){var b=$.Deferred();return b.resolve(a).promise()}function d(a){return a?a.then(null,function(){return c()}):c()}function e(a){var b=$.Deferred();return a.then(function(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];return b.resolve.apply(b,a)})["catch"](function(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];return b.reject.apply(b,a)}),b.promise()}a.getRejectedPromise=b,a.getResolvedPromise=c,a.always=d,a.fromJavaScriptPromise=e;var f=function(){function a(){}return Object.defineProperty(a,"Pending",{get:function(){return"pending"},enumerable:!0,configurable:!0}),Object.defineProperty(a,"Resolved",{get:function(){return"resolved"},enumerable:!0,configurable:!0}),Object.defineProperty(a,"Rejected",{get:function(){return"rejected"},enumerable:!0,configurable:!0}),a}();a.State=f}(P=b.Promise||(b.Promise={}));var Q;!function(c){function d(){return _.pick(K.getQueries(),["d"])}function e(){return p("debug")}function f(){return p("d")}function g(){return f()&&!a.EnvironmentConfig.isProduction()}function h(){return p("msa")}function i(){return p("oembedssotrial")&&a.EnvironmentConfig.isProduction()||p("oembedsso")}function j(){return f()&&!a.EnvironmentConfig.isProduction()}function k(){return p("standalone")&&!a.EnvironmentConfig.isProduction()}function l(){if(p("pptcontentsso")){var a=b.Html.getQueries().hostplatform;if("PC"===a&&Forms.getPageContext().Flighting.isEnabled("PPTWin32ContentAddinSSO"))return!0;if("OfficeOnline"===a&&Forms.getPageContext().Flighting.isEnabled("PPTContentAddinSSO"))return!0}return!1}function m(){return p("pptintegration")}function n(){return p("runtimeautorefresh")}function o(){return p("streamsso")}function p(a,b){void 0===b&&(b=!1);var c=K.getQueries()[a];return""===c?!0:c?(Array.isArray(c)&&(c=c[0]),b?"false"!==c.toLowerCase():"true"===c.toLowerCase()):b}c.getFlightQuery=d,c.isDebugMode=e,c.isDarkFunctionalitiesEnabled=f,c.isIvyChartEnabled=g,c.isMsaLoginEnabled=h,c.isOembedTrialSSOEnabled=i,c.isDebugOpenExcelInOneDrive=j,c.isStandalone=k,c.isPPTContentAddinSSOEnabled=l,c.isPPTIntegration=m,c.isRuntimePageAutoRefreshEnabled=n,c.isStreamSSOEnabled=o}(Q=b.Flight||(b.Flight={}));var R;!function(a){function b(a){return"number"==typeof a}function c(a){return"string"==typeof a}a.isNumber=b,a.isString=c}(R=b.Type||(b.Type={}));var S;!function(a){function c(){if(OfficeFormServerInfo.isOembedSPO&&$(".office-form.office-form-theme-shadow").height()&&$(".office-form-footer-container").height()){var b=$(".office-form.office-form-theme-shadow").height()+$(".office-form-footer-container").height()+j;b+=$(".office-form-new-bottom-bar").height()?$(".office-form-new-bottom-bar").height():0;var c="ResponsePage";a.nofityPageHeightToParentWindow(c,b)}}function d(){if(OfficeFormServerInfo.isOembedSPO&&$(".analysis-page-content").height()){var b=$(".analysis-page-content").height()+i,c="AnalysisPage";a.nofityPageHeightToParentWindow(c,b)}}function e(b){OfficeFormServerInfo.isOembedSPO&&a.nofityPageHeightToParentWindow("ResponsePage",b)}function f(a,c){var d=b.Html.getQueries().hostId;if(d)parent.postMessage("FormsPageHeight:"+d+":"+c.toString(),"*");else{var e=b.Html.getQueries().id;parent.postMessage(a+"Height:"+e+":"+c.toString(),"*")}}function g(a){if(OfficeFormServerInfo.isOembedSPO){var c=a.Model.Title?a.Model.Title:"",d=a.Model.Description?a.Model.Description:"",e=b.Html.getQueries().hostId;parent.postMessage("FormsInfo:"+e+":"+encodeURIComponent(c)+":"+encodeURIComponent(d),"*")}}function h(a){if(OfficeFormServerInfo.isOembedSPO){var c=a&&(a.innerCode||a.message||""),d=b.Html.getQueries().hostId;parent.postMessage("FormsError:"+d+":"+encodeURIComponent(c),"*")}}var i=50,j=80;a.notifyResponsePageHeightToParentWindow=c,a.notifyAnalysisPageHeightToParentWindow=d,a.notifyResponsePageFixedHeightToParentWindow=e,a.nofityPageHeightToParentWindow=f,a.notifyFormInfoToParentWindow=g,a.notifyFormErrorToParentWindow=h}(S=b.OEmbed||(b.OEmbed={})),b.assert=c,b.getNonEmbedQuery=d,b.isOEmbed=e,b.isOEmbedSPO=f,b.isOEmbedSPOPreview=g,b.enterSSO=h,b.applyTeamSSO=i,b.isPhishingForm=j,b.isWin10=k,b.isIE=l,b.isEdge=m,b.isFireFox=n,b.isMobile=o,b.isSmallScreen=p,b.isIOS=q,b.isSafari9=r,b.isAndroid=s,b.isTbsBrowser=t,b.isMicroMessenger=u,b.isHighContrastMode=v,b.deepClone=w,b.tryParseJson=x,b.getAllEnumValues=y,b.getAllEnumValueNames=z,b.some=A,b.anyTrue=B,b.setCookie=C,b.getCookie=D,b.clearCookie=E,b.hashCode=F,b.isRtl=G;var T;!function(a){a.mathSeparator="⁣"}(T=b.MathHelper||(b.MathHelper={}));var U;!function(a){a.waitingForExport="WaitingForExport"}(U=b.ExcelHelper||(b.ExcelHelper={})),b.regExpEscape=H}(b=a.Utilities||(a.Utilities={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c=function(){function b(b){this.qos=null,this.event={Name:b,Duration:0,CorrelationId:a.Utilities.Guid.newGuid(),Data:{}},this.qos=new Forms.Telemetry.QosEvent(b)}return Object.defineProperty(b.prototype,"Name",{get:function(){return this.event.Name},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Duration",{get:function(){return this.event.Duration},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"CorrelationId",{get:function(){return this.qos.CorrelationId},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Data",{get:function(){return this.event.Data},enumerable:!0,configurable:!0}),b.prototype.start=function(){this.startTime=a.Utilities.DateTime.getTimeStamp(),this.qos.ExtraData=this.Data.extraData,this.qos.start()},b.prototype.end=function(a){var b=this.prepareEvent(a);this.qos.end({resultCode:b.Data.resultCode,resultType:b.Data.resultType,logLevel:"Info",extraData:b.Data.extraData})},b.prototype.log=function(a){var b=this.prepareEvent(a);this.qos.log({resultCode:b.Data.resultCode,resultType:b.Data.resultType,logLevel:"Info",extraData:b.Data.extraData})},b.prototype.prepareEvent=function(a){var b=_.clone(this.event);return b.Data=_.extend({},this.event.Data,a),b},b}();b.QosEventDeprecated=c}(b=a.Event||(a.Event={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a.AcquireToken="Auth.AcquireToken",a.GetToken="Auth.GetToken",a}();a.Auth=b}(b=a.Auth||(a.Auth={}));var c;!function(a){var b=function(){function a(){}return a.DataSync="AddinPage.SyncView.DataSync",a}();a.SyncView=b}(c=a.AddinPage||(a.AddinPage={}));var d;!function(a){var b=function(){function a(){}return a.InsertPoll="OutlookCreatePollPage.TaskPaneView.InsertPoll",a}();a.TaskPaneView=b}(d=a.OutlookCreatePollPage||(a.OutlookCreatePollPage={}));var e;!function(a){var b=function(){function a(){}return a.CreateExportFile="Action.CreateExportFile",a.CreateRespTable="Action.CreateRespTable",a.GetRespTable="Action.GetRespTable",a.OpenExcelInOneDrive="Action.OpenExcelInOneDrive",a.GetXlWorkbookId="Action.GetXlWorkbookId",a}();a.Action=b;var c=function(){function a(){}return a.ConnectToForms="Connection.ConnectToFormsSignalR",a.ConnectToCDB="Connection.ConnectToCDBSignalR",a.InvokeMethod="Connection.InvokeRemoteMethod",a}();a.Connection=c;var d=function(){function a(){}return a.BrowseImage="Decomposition.BrowseImage",a.SearchImage="Decomposition.SearchImage",a.GetCdbToken="Decomposition.GetCdbToken",a.GetOD4BToken="Decomposition.GetOD4BToken",a}();a.Decomposition=d;var e=function(){function a(){}return a.DuplicateFormForExcel="Excel.DuplicateFormForExcel",a}();a.Excel=e;var f=function(){function a(){}return a.GetGroups="Groups.Get",a.GetPhotoDefinition="Group.GetPhotoDefinition",a.GetPhotoValue="Group.GetPhotoValue",a.GetGroup="Group.Get",a.GetOwners="Group.GetOwners",a.GetMembers="Group.GetMembers",a.GetMemberPhotoDefinition="Group.GetMemberPhotoDefinition",a.GetMemberPhotoValue="Group.GetMemberPhotoValue",a}();a.Group=f;var g=function(){function a(){}return a.TurnOnFormSharing="FormDefinition.TurnOnFormSharing",a.TurnOffFormSharing="FormDefinition.TurnOffFormSharing",a.CreateForm="Form.Create",a.CreateImageFromUrl="FormImage.CreateFromUrl",a.DeleteForm="Form.Delete",a.GetForms="Forms.Get",a.SearchServerForms="Forms.SearchServer",a.SoftDeleted="Form.Updata.SoftDeleted",a.GetSharedWithMeForms="Forms.Get.SharedWithMe",a.GetDesignForm="DesignForm.Get",a.GetFormDefinition="FormDefinition.Get",a.GetRuntimeForm="ResponseForm.Get",a.GetRuntimeForm2="ResponseForm2.Get",a.GetAnalysisForm="AnalysisForm.Get",a.GetSharedForm="SharedForm.Get",a.SetFormDefinition="FormDefinition.Set",a.UpdateForm="Form.Update",a.CreateFormPermissionLink="FormDefinition.CreateFormPermissionLink",a.DeleteFormPermissionLink="FormDefinition.DeleteFormPermissionLink",a.GetFormPermissions="FormDefinition.GetFormPermissions",a.CreateFormPermissionToken="FormDefinition.CreateFormPermissionToken",a.DeleteFormPermissionToken="FormDefinition.DeleteFormPermissionToken",a.GetFormPermissionsToken="FormDefinition.GetFormPermissionsToken",a.CreateThemeImageFromUrl="ThemeImage.CreateFromUrl",a.GetIdentityProviderType="Form.GetIdentityProviderType",a.GetGroupId="Form.GetGroupId",a.GetTeamsInfo="Form.GetTeamsInfo",a.GetOrCreatePermissionToken="Form.GetOrCreatePermissionToken",a.GetInsights="Form.GetInsights",a.CreateOD4BSessionTempFolder="Form.CreateOD4BSessionTempFolder",a.PostShareAction="Form.PostShareAction",a}();a.Form=g;var h=function(){function a(){}return a.GetFormId="Function.GetFormId",a.GetUserInfo="Function.GetUserInfo",a.GetShellServiceInfo="Function.GetShellServiceInfo",a.GetConsumerShellServiceInfo="Function.GetConsumerShellServiceInfo",a.GetYouTubeVideoInfo="Function.GetYouTubeVideoInfo",a.DownloadExcelFileApi="Function.DownloadExcelFileApi",a.GetFormsTenantSettings="Function.GetFormsTenantSettings",a.GetRecentForms="Function.GetRecentForms",a.RemoveRecentForm="Function.RemoveRecentForm",a.MoveForm="Function.MoveForm",a.GetFormCreatorPhotoDefinition="Function.GetFormCreatorPhotoDefinition",a.GetFormCreatorPhotoValue="Function.GetFormCreatorPhotoValue",a.GetCurrentUserPhotoValue="Function.GetCurrentUserPhotoValue",a.GetMuid="Function.GetMuid",a.IsMemberOf="Function.IsMemberOf",a.GetPrivacySettings="Function.GetPrivacy",a.GetDataClassificationLabels="Function.GetDataClassificationLabels",a.GetDataClassificationLabelDetail="Function.GetDataClassificationLabelDetails",a}();a.Function=h;var i=function(){function a(){}return a.DeleteImage="Image.Delete",a.UploadImage="Image.Upload",a}();a.Image=i;var j=function(){function a(){}return a.SendMail="MSGraph.SendMail",a}();a.MSGraph=j;var k=function(){function a(){}return a.CreateImageFromUrl="QuestionImage.CreateFromUrl",a.CreateQuestion="Question.Create",a.DeleteQuestion="Question.Delete",a.GetQuestion="Question.Get",a.GetQuestionCount="QuestionCount.Get",a.GetQuestions="Questions.Get",a.UpdateQuestion="Question.Update",a.TextAnalysis="Question.TextAnalysis",a.MathCalculation="Question.MathCalculation",a.MathQuestionGeneration="Question.MathQuestionGeneration",a}();a.Question=k;var l=function(){function a(){}return a.Create="DescriptiveElement.Create",a.Delete="DescriptiveElement.Delete",a.Get="DescriptiveElement.Get",a.Update="DescriptiveElements.Update",a}();a.DescriptiveElement=l;var m=function(){function a(){}return a.CreateChoice="Choice.Create",a.GetChoice="Choice.Get",a.UpdateChoice="Choice.Update",a.DeleteChoice="Choice.Delete",a}();a.Choice=m;var n=function(){function a(){}return a.DeleteResp="Response.Delete",a.DeleteResps="Responses.Delete",a.GetRespCount="ResponseCount.Get",a.GetResps="Responses.Get",a.GetRuntimeResps="RuntimeResponses.Get",a.GetRuntimeResponse="RuntimeResponse.Get",a.GetAnalysisTimeResponses="AnalysisTimeResponses.Get",a.GetRespFilter="Responses.Get.Filter",a.SubmitAnswer="Answer.Submit",a.SubmitResp="Response.Submit",a.AddComment="Comment.Add",a.SetReleaseDate="Response.Update",a}();a.Response=n;var o=function(){function a(){}return a.ReportAbuse="OnlineSafety.ReportAbuse",a.CheckPhishingKeyword="OnlineSafety.CheckPhishingKeyword",a}();a.OnlineSafety=o;var p=function(){function a(){}return a.AggregateSurveyData="Analysis.AggregateSurveyData",a.ResultSharingAggregateSurveyData="Analysis.ResultSharingAggregateSurveyData",a.AggregateQuizData="Analysis.AggregateQuizData",a.ResultSharingAggregateQuizData="Analysis.ResultSharingAggregateQuizData",a}();a.Analysis=p;var q=function(){function a(){}return a.MethodNameFormat="PageMethod.{0}",a}();a.PageMethod=q;var r=function(){function a(){}return a.GetUserSettings="UserSettings.Get",a.UpdateUserSettings="UserSettings.Update",a}();a.UserSettings=r;var s=function(){function a(){}return a.GetAllLocales="Locale.GetAll",a.GetLocale="Locale.Get",a.DeleteLocale="Locale.Delete",a.CreateLocaleItem="LocaleItem.Create",a.UpdateLocaleItem="LocaleItem.Update",a.CopyLocaleItem="LocaleItem.Copy",a}();a.Multilingual=s;var t=function(){function a(){}return a.CreateElements="Elements.Create",a.DeleteElements="Elements.Delete",a.UpdateElements="Elements.Update",a}();a.FormElementBatch=t}(e=a.ServiceEndpoints||(a.ServiceEndpoints={}));var f=function(){function a(){}return a.NPSLoad="OfficeNPS.load",a}();a.OfficeNPS=f}(b=a.QosEventNames||(a.QosEventNames={}))}(b=a.Event||(a.Event={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b=function(){function a(){}return Object.defineProperty(a,"DefaultStorage",{get:function(){return a.defaultStorage||(a.defaultStorage=a.LocalStorage,a.defaultStorage instanceof c&&(a.defaultStorage=a.SessionStorage)),a.defaultStorage},enumerable:!0,configurable:!0}),Object.defineProperty(a,"LocalStorage",{get:function(){return a.localStorage||(a.supportsLocalStorage()?a.localStorage=window.localStorage:a.localStorage=a.NoStorage),a.localStorage},enumerable:!0,configurable:!0}),Object.defineProperty(a,"SessionStorage",{get:function(){return a.sessionStorage||(a.supportsSessionStorage()?a.sessionStorage=window.sessionStorage:a.sessionStorage=a.NoStorage),a.sessionStorage},enumerable:!0,configurable:!0}),Object.defineProperty(a,"NoStorage",{get:function(){return a.noStorage||(a.noStorage=new c),a.noStorage},enumerable:!0,configurable:!0}),a.supportsLocalStorage=function(){if(null==a.localStorageSupported)try{var b="officeforms.__storage_test__";localStorage.setItem(b,b),localStorage.removeItem(b),a.localStorageSupported=!0}catch(c){a.localStorageSupported=!1}return a.localStorageSupported},a.supportsSessionStorage=function(){if(null==a.sessionStorageSupported)try{var b="officeforms.__storage_test__";sessionStorage.setItem(b,b),sessionStorage.removeItem(b),a.sessionStorageSupported=!0}catch(c){a.sessionStorageSupported=!1}return a.sessionStorageSupported},a}();a.SafeStorage=b,a.Exports.SafeStorage=b;var c=function(){function a(){}return a.prototype.clear=function(){},a.prototype.getItem=function(a){},a.prototype.key=function(a){return null},a.prototype.removeItem=function(a){},a.prototype.setItem=function(a,b){},a}()}(OfficeForm||(OfficeForm={})),String.prototype.format||(String.prototype.format=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return this.replace(/{(\d+)}/g,function(b,c){return void 0!==a[c]?a[c]:b})}),String.prototype.trimEnd=function(a){for(var b=this,c=b.length;--c>=0&&!(a.indexOf(b.charAt(c))<0););return b.substr(0,c+1)},String.prototype.startsWith=function(a){if(null==a||0===a.length)return!0;var b=this;return null==b||b.length<a.length?!1:a===b.substr(0,a.length)},String.prototype.replaceAll=function(a,b){return this.replace(new RegExp(escapeRegExp(a),"g"),b)},"name"in Function.prototype||Object.defineProperty(Function.prototype,"name",{get:function(){var a=/function\s([^(]{1,})\(/,b=a.exec(this.toString());return b&&b.length>1?b[1].trim():""}});var stringDelimiter=/('[^']*'|"[^"]*")/g,dateLabelsRegExp=/('[^']*'|"[^"]*"|d{1,2}|M{1,2}|y{2,4}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|t{2})/g;Date.prototype.toFormatString=function(a,b){var c=this;if(null==c||null==a||null==b)return null;var d=a.split(dateLabelsRegExp).map(function(a){switch(a){case"d":case"dd":return formatNumber(c.getDate(),a.length);case"ddd":return b.DateTimeFormat.AbbreviatedDayNames[c.getDay()];case"M":case"MM":return formatNumber(c.getMonth()+1,a.length);case"MMM":return b.DateTimeFormat.AbbreviatedMonthNames[c.getMonth()];case"yy":var d=c.getFullYear(),e=formatNumber(d,4);return d>b.Calendar.TwoDigitYearMax-100&&d<=b.Calendar.TwoDigitYearMax?e.slice(2):e;case"yyy":case"yyyy":case"yyyyy":return formatNumber(c.getFullYear(),a.length);case"H":case"HH":return formatNumber(c.getHours(),a.length);case"h":case"hh":return formatNumber((c.getHours()+11)%12+1,a.length);case"m":case"mm":return formatNumber(c.getMinutes(),a.length);case"s":case"ss":return formatNumber(c.getSeconds(),a.length);case"t":case"tt":var f=c.getHours()<12?b.DateTimeFormat.AMDesignator:b.DateTimeFormat.PMDesignator;return 1===a.length?f.charAt(0):f;default:return removeQuatos(a)}}).join("");return d},Date.prototype.toDateShortString=function(a){var b=this;return b.toFormatString(a.DateTimeFormat.ShortDatePattern,a)},Date.prototype.toTimeShortString=function(a){var b=this;return b.toFormatString(a.DateTimeFormat.ShortTimePattern,a)},Date.parseDate=function(a,b,c){var d=parseStringToDateLabels(a,b,c),e=parseInt(d.yyyy||d.yyy),f=parseInt(d.yy);if(isNaN(e)&&!isNaN(f))if(f>=100)e=f;else{var g=OfficeFormServerInfo.cultureInfo.Calendar.TwoDigitYearMax%100;e=g>=f?OfficeFormServerInfo.cultureInfo.Calendar.TwoDigitYearMax-g+f:OfficeFormServerInfo.cultureInfo.Calendar.TwoDigitYearMax-g-100+f}var h=parseInt(d.MM||d.M),i=d.MMM;isNaN(h)&&i&&(h=c.DateTimeFormat.AbbreviatedMonthNames.indexOf(i)+1);var j=parseInt(d.dd||d.d),k=getTime(d,c);if(!(isNaN(e)||isNaN(h)||isNaN(j)||isNaN(k))){var l=new Date(e,h-1,j,0,0,0,k);if(l.getFullYear()===e&&l.getMonth()+1===h&&l.getDate()===j)return l}return null},Date.parseTime=function(a,b,c){var d=parseStringToDateLabels(a,b,c);return d.time=!0,getTime(d,c)};var OfficeForm;!function(a){var b=function(){function b(){}return b.getEnvironmentType=function(){if(null==b.currentEnvironmentType){var a=b.getHostUrl(),c=OfficeFormServerInfo.deployment.toLocaleLowerCase();c.indexOf("usgovdodproduction")>=0?b.currentEnvironmentType="USDoDProd":c.indexOf("usgovproduction")>=0?b.currentEnvironmentType="USGovProd":c.indexOf("usgovgccproduction")>=0?b.currentEnvironmentType="USGovGccProd":a.indexOf("forms.office.com")>=0||a.indexOf("forms.osi.office.net")>=0?b.currentEnvironmentType="WWProd":a.indexOf("forms.officeppe.com")>=0?b.currentEnvironmentType="EDog":a.indexOf("forms.office-int.com")>=0||a.indexOf("forms.osi.office-int.net")>=0?b.currentEnvironmentType="Int":a.indexOf("formweekly")>=0?b.currentEnvironmentType="Weekly":a.indexOf("formhotfix")>=0?b.currentEnvironmentType="Hotfix":a.indexOf("formdaily")>=0?b.currentEnvironmentType="Daily":a.indexOf("formpilot")>=0?b.currentEnvironmentType="Pilot":a.indexOf("formtrial")>=0?b.currentEnvironmentType="Trial":a.indexOf("formdrill")>=0?b.currentEnvironmentType="Drill":a.indexOf("localhost")>=0?b.currentEnvironmentType="DevHost":a.indexOf("forms.microsoft.com")>=0?b.currentEnvironmentType="MSProd":a.indexOf("forms.microsoft-ppe.com")>=0?b.currentEnvironmentType="MSEDog":a.indexOf("forms.microsoft-int.com")>=0&&(b.currentEnvironmentType="MSInt")}return b.currentEnvironmentType},b.getMuidHost=function(){switch(b.getEnvironmentType()){case"WWProd":return"https://c.office.com";case"EDog":return"https://c.officeppe.com";case"Int":return"https://c.office-int.com";default:return null}},b.getPageType=function(){var a=window.location.pathname.toLowerCase();switch(a){case"/pages/designpage.aspx":case"/pages/teamsdesignpage.aspx":case"/pages/onenoteaddinpage.aspx":case"/pages/delegatepage.aspx":return"Design";case"/pages/responsepage.aspx":case"/pages/teamsresponsepage.aspx":return"Response";case"/pages/analysispage.aspx":return"Analyze";case"/pages/teamsconfigpage.aspx":return"TeamsConfig";default:return"Unknown"}},b.isProdAlternative=function(){var a=b.getHostUrl();return a.indexOf(".forms.osi.office.net")>0},b.isProduction=function(){var a=b.getEnvironmentType();return"WWProd"===a||"MSProd"===a||"USGovProd"===a||"USDoDProd"===a||"USGovGccProd"===a},b.isSovereignProd=function(){var a=b.getEnvironmentType();return"USGovProd"===a||"USDoDProd"===a||"USGovGccProd"===a},b.isFairfax=function(){var a=b.getEnvironmentType();return"USGovProd"===a||"USDoDProd"===a},b.isUSGovGccProd=function(){return"USGovGccProd"===b.getEnvironmentType()},b.isMsftProduction=function(){return"72f988bf-86f1-41af-91ab-2d7cd011db47"===OfficeFormServerInfo.userInfo.TenantId},b.isOsi=function(){switch(b.getEnvironmentType()){case"Int":case"EDog":case"WWProd":case"MSInt":case"MSEDog":case"MSProd":case"USGovProd":case"USDoDProd":case"USGovGccProd":return!0;default:return!1}},b.getAadInstance=function(){var a=Forms.AuthRelatedLocalStorage.UseLegacyLoginDomain;return b.isProduction()?a?"https://login.windows.net/":"https://login.microsoftonline.com/":"https://login.windows-ppe.net/"},b.getMSGraphAPIHost=function(){return b.isProduction()?"https://graph.microsoft.com/":"https://graph.microsoft-ppe.com"},b.getAadClientId=function(){return"USGovProd"===b.getEnvironmentType()||"USDoDProd"===b.getEnvironmentType()?"032e56fd-dfe5-4a50-8017-89692bcbcb0e":"038ed4f5-da78-47bc-8176-9153c79e0edb"},b.getFormsResourceId=function(){return"USGovProd"===b.getEnvironmentType()||"USDoDProd"===b.getEnvironmentType()?"153a74ba-783f-4394-bc9a-a109ef69f5c2":"c9a559d2-7aab-4f13-a6ed-e7e9c52aec87"},b.getUserInfoUrl=function(){return"https://portal.{0}/account/#personalinfo".format(b.isProduction()?b.getOffice365Domain(b.getEnvironmentType(),!0):b.getOffice365Domain("EDog",!0))},b.getConsumerInfoUrl=function(){return"https://account.{0}".format(b.isProduction()?b.getOffice365ConsumerDomain(b.getEnvironmentType()):b.getOffice365ConsumerDomain("EDog"))},b.getHrdV2Url=function(){var a=b.getExplictLocale();return"https://{0}/odc/v2.1/hrd?{1}Ver=16&app=111&p=6&hm=0&fpEnabled=1".format(b.getHrdV2Domain(),null!=a?"rs={0}&".format(a):"")},b.getHrdV2Domain=function(){return b.isProduction()?"odc.officeapps.live.com":"odc.edog.officeapps.live.com"},b.getCollabDBResourceId=function(a){return"https://lists."+b.getOffice365Domain(a)},b.getMsftTenantId=function(){var a=b.getEnvironmentType();switch(a){case"WWProd":case"MSProd":return"72f988bf-86f1-41af-91ab-2d7cd011db47";default:return"f686d426-8d16-42db-81b7-ab578e110ccd"}},b.getMsaTenantId=function(){var a=b.getEnvironmentType();switch(a){case"WWProd":case"MSProd":case"EDog":case"MSEDog":return"9188040d-6c67-4c5b-b112-36a304b66dad";default:return"4925308c-f164-4d2d-bc7e-0631132e9375"}},b.getFastFoodTenantsId=function(){var a=b.getEnvironmentType();switch(a){case"WWProd":case"MSProd":return["89d8a01e-e5db-493e-8720-b820d953ef20","b6338c92-533e-4f6d-a327-994263712399"];default:return["f686d426-8d16-42db-81b7-ab578e110ccd"]}},b.getExplictLocale=function(){return a.Utilities.Html.getQueries().lang||null},b.getEnvironmentTypeForNonOSI=function(){var a=b.getDesiredProvider();if("int"===a)return"Int";if("edog"===a)return"EDog";switch(b.getEnvironmentType()){case"Trial":return"EDog";default:return"Int"}},b.getDesiredProvider=function(){var b=a.Utilities.Html.getQueries().dataprovider;switch(b){case"int":case"edog":return b;default:return null}},b.getOffice365Domain=function(a,c){switch(void 0===c&&(c=!1),null==a&&(a=b.getEnvironmentType()),a){case"USDoDProd":return c?"apps.mil":"osi.apps.mil";case"USGovProd":return c?"office365.us":"osi.office365.us";case"USGovGccProd":return c?"office.com":"gcc.osi.office365.us";case"WWProd":case"MSProd":return"office.com";case"EDog":case"MSEDog":case"Trial":return"officeppe.com";default:return"office-int.com"}},b.getOffice365ConsumerDomain=function(a){switch(null==a&&(a=b.getEnvironmentType()),a){case"WWProd":case"MSProd":return"microsoft.com";case"EDog":case"MSEDog":case"Trial":return"microsoft-ppe.com";default:return"microsoft-int.com"}},b.getAbsoluteUrl=function(a){var c=document.createElement("a");if(c.href=a,Forms.getPageContext().Flighting.isEnabled("PromptToUseMicrosoftDomain"))switch(b.getEnvironmentType()){case"WWProd":c.host="forms.microsoft.com";break;case"Int":c.host="forms.microsoft-int.com";break;case"EDog":c.host="forms.microsoft-ppe.com"}return c.href},b.getHostUrl=function(){var a=window.location.host;return a.toLocaleLowerCase()},b}();a.EnvironmentConfig=b,a.Exports.EnvironmentConfig=b}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){a.Exports.Flighting=b;var c=function(){function a(){}return a.isEnabled=function(a){return Forms.getPageContext().Flighting.isEnabled_Deprecated(a)},a}();b.Flight=c;var d=function(){function a(){}return a.isEnabled=function(a){return Forms.getPageContext().Flighting.isEnabled(a)},a}();b.EnvFlight=d}(b=a.Flighting||(a.Flighting={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b=function(){function b(){this.deferred=null,this.muid=null}return Object.defineProperty(b,"Instance",{get:function(){return null==b.instance&&(b.instance=new b),b.instance},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Muid",{get:function(){return this.muid},enumerable:!0,configurable:!0}),b.prototype.ensureMuid=function(){var c=this;if(null==this.deferred)if(this.deferred=$.Deferred(),this.muid=b.readMuid(),null==this.muid){var d=new a.Event.QosEventDeprecated(a.Event.QosEventNames.ServiceEndpoints.Function.GetMuid);d.start(),b.loadMuid(function(){c.muid=b.readMuid(),null!=c.muid?(c.deferred.resolve(c.muid),d.end({resultType:"Success"})):(c.deferred.reject(),d.end({resultType:navigator.cookieEnabled?"Failure":"ExpectedFailure"}))})}else this.deferred.resolve(this.muid);return this.deferred.promise()},b.loadMuid=function(b){var c=a.EnvironmentConfig.getMuidHost();if(c){var d=document.createElement("img");d.style.display="none",d.src=c+"/c.gif",d.hidden=!0,d["aria-hidden"]="true",d.onload=d.onerror=b}else b()},b.readMuid=function(){return a.Utilities.getCookie("MUID")},b.instance=null,b}();a.Muid=b,a.Exports.Muid=b}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c=function(){function b(){}return b.logData=function(a){Forms.Telemetry.log({eventName:a.name,eventType:"engagement_event",extraData:a.extraData})},b.logSessionStartEvent=function(){Forms.getPageContext().Flighting.isEnabled("EnableMuidForAnonymousUsers")&&a.Muid.Instance.ensureMuid(),Forms.Telemetry.log({eventName:"session_start",eventType:"session_start"})},b}();b.EngagementEventDeprecated=c}(b=a.Event||(a.Event={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(b){var c;!function(a){a.FilteredOutForms="PortalPage.FilteredOutForms";var b=function(){function a(){}return a.MyFormsButton="DesignPage.Form.MyFormsButton",a.Duplicate="PortalPage.MyForms.Duplicate",a.CancelMoveToRecycleBin="PortalPage.MyForms.CancelMoveToRecycleBin",a.ConfirmMoveToRecycleBin="PortalPage.MyForms.ConfirmMoveToRecycleBin",a.MoveToRecycleBin="PortalPage.MyForms.MoveToRecycleBin",a.Load="PortalPage.MyForms.Load",a.Navigate="PortalPage.MyForms.Navigate",a.New="PortalPage.MyForms.New",a.OpenStoreButton="PortalPage.MyForms.OpenStoreButton",a.NewFormCopyAllDone="PortalPage.MyForms.NewFromCopy",a.NewFromCopyFailure="PortalPage.MyForms.NewFromCopy.Failure",a.AutoLoginSuccess="PortalPage.MyForms.AutoLoginSuccess",a.ReadyToCopyForm="PortalPage.MyForms.ReadyToCopyForm",a.NewFromCopyQuestionDone="PortalPage.MyForms.NewFromCopyQuestionDone",a.TryTemplate="PortalPage.MyForms.TryTemplate",a.CollapseTemplate="PortalPage.MyForms.CollapseTemplate",a.ExpandTemplate="PortalPage.MyForms.ExpandTemplate",a.NewForm="PortalPage.MyForms.NewForm",a.NewQuiz="PortalPage.MyForms.NewQuiz",a.FormCount="PortalPage.MyForms.FormCount",a.Click="PortalPage.MyForms.Click",a.ExpandNewMenu="PortalPage.MyForms.ExpandNewMenu",a.ExceedFormQuota="PortalPage.MyForms.ExceedFormQuota",a}();a.MyForms=b;var c=function(){function a(){}return a.OtherFormsButton="DesignPage.Form.OtherFormsButton",a.Unpin="PortalPage.OtherForms.Unpin",a.Duplicate="PortalPage.OtherForms.Duplicate",a.FormCount="PortalPage.OtherForms.FormCount",a.Click="PortalPage.OtherForms.Click",a}();a.OtherForms=c;var d=function(){function a(){}return a.Click="PortalPage.SearchForms.Click",a}();a.SearchForms=d;var e=function(){function a(){}return a.Navigate="PortalPage.DelegateForms.Navigate",a}();a.DelegateForms=e;var f=function(){function a(){}return a.Navigate="PortalPage.FormIntroductionDialog.Navigate",a.CreatNewForm="PortalPage.FormIntroductionDialog.CreatNewForm",a.Close="PortalPage.FormIntroductionDialog.Close",a}();a.FormIntroductionDialog=f;var g=function(){function a(){}return a.GroupFormsButton="DesignPage.Form.GroupFormsButton",a}();a.GroupFormsPortal=g}(c=b.PortalPage||(b.PortalPage={}));var d;!function(a){var b=function(){function a(){}return a.StartGetResponses="AnalysisPage.Responses.StartGetResponses",a.Navigate="AnalysisPage.Analysis.Navigate",a}();a.Analysis=b}(d=b.AnalysisPage||(b.AnalysisPage={}));var e;!function(a){var b=function(){function a(){}return a.AddImage_Logo="DesignPage.Form.Logo.AddImage",a.SharedFormByOwner="DesignPage.Form.SharedFormByOwner",a.SharedOwnershipByOwner="DesignPage.Form.SharedOwnershipByOwner",a.Navigate="DesignPage.Form.Navigate",a.SuggestFormAdd="DesignPage.Form.SuggestFormAdd",a.SuggestFormTrigger="DesignPage.Form.SuggestFormTrigger",a}();a.Form=b;var c=function(){function a(){}return a.AddOption="DesignPage.Questions.AddOption",a.AddOtherOption="DesignPage.Questions.AddOtherOption",a.AnswerRequired="DesignPage.Questions.AnswerRequired",a.Create="DesignPage.Questions.Create",a.Delete="DesignPage.Questions.Delete",a.Duplicate="DesignPage.Questions.Duplicate",
a.LongAnswer="DesignPage.Questions.LongAnswer",a.MoveDown="DesignPage.Questions.MoveDown",a.MoveUp="DesignPage.Questions.MoveUp",a.MultipleAnswers="DesignPage.Questions.MultipleAnswers",a.Navigate="DesignPage.Questions.Navigate",a.AddRankingOption="DesignPage.Questions.AddRankingOption",a.DeleteRankingOption="DesignPage.Questions.DeleteRankingOption",a.SortableInitialization="DesignPage.Questions.SortableInitialization",a.AddImage="DesignPage.Questions.AddImage",a.ToggleCorrectChoice="DesignPage.Questions.ToggleCorrectChoice",a.PasteChoiceOptions="DesignPage.Questions.PasteChoiceOptions",a.ShortTextAnswerAdded="DesignPage.Questions.ShortTextAnswerAdded",a.ShortTextAnswerDeleted="DesignPage.Questions.ShortTextAnswerDeleted",a.FirstShortTextAnswerAdded="DesignPage.Questions.FirstShortTextAnswerAdded",a.LastRemainingShortTextAnswerDeleted="DesignPage.Questions.LastRemainingShortTextAnswerDeleted",a.AddLikertSubquestion="DesignPage.Questions.AddLikertSubquestion",a.DeleteLikertSubquestion="DesignPage.Questions.DeleteLikertSubquestion",a.AddLikertOption="DesignPage.Questions.AddLikertOption",a.DeleteLikertOption="DesignPage.Questions.DeleteLikertOption",a.RatingLevelModified="DesignPage.Questions.RatingLevelModified",a.RatingValueOutOfBounds="DesignPage.Questions.RatingValueOutOfBounds",a}();a.Questions=c;var d=function(){function a(){}return a.MathOption="DesignPage.QuestionMenu.MathOption",a.Navigate="DesignPage.QuestionMenu.Navigate",a.Quiz="DesignPage.QuestionMenu.Quiz",a.RatingLabel="DesignPage.QuestionMenu.RatingLabel",a.ShuffleOptions="DesignPage.QuestionMenu.ShuffleOptions",a.Subtitle="DesignPage.QuestionMenu.Subtitle",a.Validation="DesignPage.QuestionMenu.Validation",a.DropDown="DesignPage.QuestionMenu.DropDown",a}();a.QuestionMenu=d;var e=function(){function a(){}return a.AnswerHint="DesignPage.Quiz.AnswerHint",a.Point="DesignPage.Quiz.Point",a.SwitchTextToMathInput="DesignPage.Quiz.SwitchTextToMathInput",a.SwitchMathToTextInput="DesignPage.Quiz.SwitchMathToTextInput",a.EditMathFormula="DesignPage.Quiz.EditMathFormula",a}();a.Quiz=e;var f=function(){function a(){}return a.DeleteAllResponses="DesignPage.Responses.DeleteAllResponses",a.DeleteSingleResponse="DesignPage.Responses.DeleteSingleResponse",a.DetialDialogPaging="DesignPage.Responses.DetailDialogPaging",a.DetailDialogQuestionNavigate="DesignPage.Responses.DetailDialogQuestionNavigate",a.DownloadExcelFile="DesignPage.Responses.DownloadExcelFile",a.DownloadExcelFileDecreaseFileSize="DesignPage.Responses.DownloadExcelFileDecreaseFileSize",a.DownloadExcelFileFailed="DesignPage.Responses.DownloadExcelFileFailed",a.DownloadExcelFileStart="DesignPage.Responses.DownloadExcelFileStart",a.DownloadExcelFileSuccess="DesignPage.Responses.DownloadExcelFileSuccess",a.DownloadMultipleExcelFiles="DesignPage.Responses.DownloadMultipleExcelFiles",a.DownloadOnePagingExcelFile="DesignPage.Responses.DownloadOnePagingExcelFile",a.GradeResults="DesignPage.Responses.GradeResults",a.IndividualPaging="DesignPage.Responses.IndividualPageing",a.IndividualPrint="DesignPage.Responses.IndividualPrint",a.MeetLegacyChoiceAnswer="DesignPage.Responses.MeetLegacyChoiceAnswer",a.Navigate="DesignPage.Responses.Navigate",a.OpenExcelInOneDrive="DesignPage.Responses.OpenExcelInOneDrive",a.OpenInExcel="DesignPage.Responses.OpenInExcel",a.PrintAnalyzeView="DesignPage.Responses.PrintAnalyzeView",a.ReExportToExcel="DesignPage.Responses.ReExportToExcel",a.GetSummaryResult="DesignPage.Responses.GetSummaryResult",a.ReleaseResults="DesignPage.Responses.ReleaseResults",a.ShowResponsesDetail="DesignPage.Responses.ShowResponsesDetail",a.SwitchView="DesignPage.Responses.SwitchView",a.SwitchIvyChartType="DesignPage.Responses.SwitchIvyChartType",a.SwitchResponder="DesignPage.Responses.SwitchResponder",a.ViewResults="DesignPage.Responses.ViewResults",a.ExportToOneDriveWithBigData="DesignPage.Responses.ExportToOneDriveWithBigData",a.CopySummaryLink="DesignPage.Responses.CopySummaryLink",a.StartGetResponses="DesignPage.Responses.StartGetResponses",a.OpenFileFolder="DesignPage.Responses.OpenFileFolder",a.PopupReExportToExcelDialog="DesignPage.Responses.PopupReExportToExcelDialog",a.ShowInsightEntryPoint="DesignPage.Responses.ShowInsightEntryPoint",a.ClickInsightEntryPoint="DesignPage.Responses.ClickInsightEntryPoint",a.ClickInsightPreviousButton="DesignPage.Responses.ClickInsightPreviousButton",a.ClickInsightNextButton="DesignPage.Responses.ClickInsightNextButton",a.ReleaseInsightView="DesignPage.Responses.ReleaseInsightView",a.ShowInsights="DesignPage.Responses.ShowInsights",a}();a.Analysis=f;var g=function(){function a(){}return a.Navigate="DesignPage.PreView.Navigate",a}();a.Preview=g;var h=function(){function a(){}return a.Navigate="DesignPage.Theme.Navigate",a.SwitchTheme="DesignPage.Theme.SwitchTheme",a.AddCustomizedTheme="DesignPage.Theme.AddCustomizedTheme",a.EditCustomizedTheme="DesignPage.Theme.EditCustomizedTheme",a.AddImage="DesignPage.Theme.AddImage",a.DeleteImage="DesignPage.Theme.DeleteImage",a.AddColor="DesignPage.Theme.AddColor",a.DeleteColor="DesignPage.Theme.DeleteColor",a.ColorTooLight="DesignPage.Theme.ColorTooLight",a.ExpandShuggestion="DesignPage.Theme.ExpandShuggestion",a}();a.Theme=h;var i=function(){function a(){}return a.AddImage="DesignPage.ImagePicker.AddImage",a.AddVideo="DesignPage.MediaPicker.AddVideo",a.AddVideoFailure="DesignPage.MediaPicker.AddVideoFailure",a.Back="DesignPage.MediaPicker.Back",a.BingSearch="DesignPage.ImagePicker.UploadBingSearch",a.BingSearchLicense="DesignPage.ImagePicker.BingSearchLicense",a.ChooseImage="DesignPage.MediaPicker.ChooseImage",a.ChooseVideo="DesignPage.MediaPicker.ChooseVideo",a.Local="DesignPage.ImagePicker.UploadLocal",a.Navigate="DesignPage.ImagePicker.Navigate",a.OD4B="DesignPage.ImagePicker.UploadOD4B",a.Search="DesignPage.ImagePicker.Search",a.URL="DesignPage.ImagePicker.URL",a}();a.MediaPicker=i;var j=function(){function a(){}return a.ImageSize="DesignPage.ImageLayout.ImageSize",a}();a.ImageLayout=j;var k=function(){function a(){}return a.AltText="DesignPage.ImageEditPane.AltText",a.Delete="DesignPage.ImageEditPane.Delete",a.Edit="DesignPage.ImageEditPane.Edit",a.Style="DesignPage.ImageEditPane.Style",a.Zoom="DesignPage.ImageEditPane.Zoom",a.ZoomIn="DesignPage.ImageEditPane.ZoomIn",a.ZoomOut="DesignPage.ImageEditPane.ZoomOut",a}();a.ImageEditPane=k;var l=function(){function a(){}return a.Delete="DesignPage.VideoEditPane.Delete",a}();a.VideoEditPane=l;var m=function(){function a(){}return a.AcceptResponse="DesignPage.Setting.AcceptResponse",a.AllowAnonymous="DesignPage.Setting.AllowAnonymous",a.ApplyDeadline="DesignPage.Setting.ApplyDeadline",a.ApplyStartTime="DesignPage.Setting.ApplyStartTime",a.EditCloseMessage="DesignPage.Setting.EditCloseMessage",a.Navigate="DesignPage.Setting.Navigate",a.RecordIdentity="DesignPage.Setting.RecrodIdentity",a.RequireUniqueResponse="DesignPage.Setting.RequireUniqueResponse",a.RespondInAppOnly="DesignPage.Setting.RespondInAppOnly",a.SetDeadline="DesignPage.Setting.SetDeadline",a.SetStartTime="DesignPage.Setting.SetStartTime",a.ShowGradedResults="DesignPage.Setting.ShowGradedResults",a.ShowGradedScores="DesignPage.Setting.ShowGradedScores",a.ShuffleOption="DesignPage.Setting.ShuffleOption",a.ShuffleQuestion="DesignPage.Setting.ShuffleQuestion",a.ShuffleAllQuestions="DesignPage.Setting.ShuffleAllQuestions",a.LockGivenQuestions="DesignPage.Setting.LockGivenQuestions",a.AutoReleaseGrade="DesignPage.Setting.AutoReleaseGrade",a.EmailNotification="DesignPage.Setting.EmailNotification",a.EmailReceipt="DesignPage.Setting.EmailReceipt",a.ThankYouMessage="DesignPage.Setting.ThankYouMessage",a}();a.Setting=m;var n=function(){function a(){}return a.Navigate="DesignPage.MultiLingual.Navigate",a}();a.MultiLingual=n;var o=function(){function a(){}return a.Link="DesignPage.Send.Link",a.Email="DesignPage.Send.Email",a.Embed="DesignPage.Send.MoreOptions",a.Navigate="DesignPage.Send.Navigate",a.QRCode="DesignPage.Send.QRCode",a.Sharing="DesignPage.Send.Sharing",a.SocialShare="DesignPage.Send.Share",a.ActionFailed="DesignPage.Send.ActionFailed",a.ActionSuccess="DesignPage.Send.ActionSuccess",a.CopyEmbedCode="DesignPage.Send.CopyEmbedCode",a.CopyLink="DesignPage.Send.CopyLink",a.DownloadQRCode="DesignPage.Send.DownloadQRCode",a.SendEmails="DesignPage.Send.SendEmails",a.AllowCopyCheckBox="DesignPage.Send.AllowCopyCheckBox",a.ShareFormLink="DesignPage.Send.ShareFormLink",a}();a.Send=o;var p=function(){function a(){}return a.CopyShareAsTemplateLink="DesignPage.Share.CopyShareAsTemplateLink",a.CreateShareAsTemplateLink="DesignPage.Share.CreateShareAsTemplateLink",a.DeleteShareAsTemplateLink="DesignPage.Share.DeleteShareAsTemplateLink",a.CopyCollaborationLink="DesignPage.Share.CopyCollaborationLink",a.CreateCollaborationLink="DesignPage.Share.CreateCollaborationLink",a.DeleteCollaborationLink="DesignPage.Share.DeleteCollaborationLink",a.SwitchCollaborationLink="DesignPage.Share.SwitchCollaborationLink",a.CopyAnalysisResultLink="DesignPage.Share.CopyAnalysisResultLink",a.CreateAnalysisResulttLink="DesignPage.Share.CreateAnalysisResulttLink",a.DeleteAnalysisResultLink="DesignPage.Share.DeleteAnalysisResultLink",a.ChooseAllowAnonymous="DesignPage.Share.ChooseAllowAnonymous",a}();a.Share=p;var q=function(){function a(){}return a.Navigate="DesignPage.Feedback.Navigate",a.Suggestion="DesignPage.Feedback.Suggestion",a.Insights="DesignPage.Feedback.Insights",a}();a.Feedback=q;var r=function(){function a(){}return a.Navigate="DesignPage.Help.Navigate",a}();a.Help=r;var s=function(){function a(){}return a.Navigate="DesignPage.Menu.Navigate",a.SignOut="DesignPage.Menu.SignOut",a.UserInfo="DesignPage.Menu.UserInfo",a.PrintForm="DesignPage.Menu.PrintForm",a}();a.Menu=s;var t=function(){function a(){}return a.BranchChanged="DesignPage.Branch.BranchChanged",a.BranchDesignViewNavigate="DesignPage.Branch.BranchDesignViewNavigate",a}();a.Branch=t;var u=function(){function a(){}return a.GetShellServiceInfo="DesignPage.AppLauncher.GetShellServiceInfo",a.GetConsumerShellServiceInfo="DesignPage.AppLauncher.GetConsumerShellServiceInfo",a.LoadShellData="DesignPage.AppLauncher.LoadShellData",a.Navigate="DesignPage.AppLauncher.Navigate",a.RenderShellData="DesignPage.AppLauncher.RenderShellData",a.LoadError="DesignPage.AppLauncher.LoadShellData",a}();a.AppLauncher=u;var v=function(){function a(){}return a.Clipboard="DesignPage.ShortCut.Clipboard",a.UndoRedo="DesignPage.ShortCut.UndoRedo",a}();a.ShortCut=v;var w=function(){function a(){}return a.Navigate="DesignPage.MathKeyboard.Navigate",a}();a.MathKeyboard=w;var x=function(){function a(){}return a.ConnectionStarted="DesignPage.Notification.ConnectionStarted",a}();a.Notification=x;var y=function(){function a(){}return a.Navigate="DesignPage.QRCodePlus.Navigate",a.Download="DesignPage.QRCodePlus.Download",a.CopyUrlSuccess="DesignPage.QRCodePlus.Success",a.CopyUrlFail="DesignPage.QRCodePlus.Fail",a}();a.QRCodePlus=y}(e=b.DesignPage||(b.DesignPage={}));var f=function(){function a(){}return a.Navigate="DesignPage.RecycleBin.Navigate",a.formDelete="RecycleBin.MyForm.Delete",a.formRestore="RecycleBin.MyForm.Restore",a.groupBarClick="RecycleBin.GroupFormsRecycle.GroupBar.Click",a.groupFormDelete="RecycleBin.GroupForm.Delete",a.groupFormRestore="RecycleBin.GroupForm.Restore",a}();b.RecycleBin=f;var g;!function(a){var b=function(){function a(){}return a.Navigate="ResponsePage.Form.Navigate",a.QRCode="ResponsePage.Form.QRCode",a.Submit="ResponsePage.Form.Submit",a.OpenInTakeATest="ResponsePage.Form.OpenInTakeATest",a.TextQuestionInfoOfSubmit="ResponsePage.Form.TextQuestionInfoOfSubmit",a.TextFieldSubmissionMathInfo="ResponsePage.Form.TextFieldSubmissionMathInfo",a.SwitchTextToMathInput="ResponsePage.Form.SwitchTextToMathInput",a.SwitchMathToTextInput="ResponsePage.Form.SwitchMathToTextInput",a}();a.Form=b;var c=function(){function a(){}return a.LearnMoreForTakeATest="ResponsePage.ThanksView.LearnMoreForTakeATest",a.Navigate="ResponsePage.ThanksView.Navigate",a.NavigateToPortal="ResponsePage.ThanksView.NavigateToPortal",a.SubmitAnother="ResponsePage.ThanksView.SubmitAnother",a}();a.ThanksView=c;var d=function(){function a(){}return a.Navigate="ResponsePage.PollResultView.Navigate",a.NavigateToPortal="ResponsePage.PollResultView.NavigateToPortal",a.SubmitAnother="ResponsePage.PollResultView.SubmitAnother",a}();a.PollResultView=d;var e=function(){function a(){}return a.IsEmbeddedSession="ResponsePage.EmbedView.IsEmbeddedSession",a.BlockEmbed="ResponsePage.EmbedView.BlockEmbed",a.Navigate="ResponsePage.EmbedView.Navigate",a.NeedAuth="ResponsePage.EmbedView.NeedAuth",a.OpenInBrowser="ResponsePage.EmbedView.OpenInBrowser",a}();a.EmbedView=e;var f=function(){function a(){}return a.Navigate="ResponsePage.StudentView.Navigate",a}();a.StudentView=f;var g=function(){function a(){}return a.Navigate="ResponsePage.ViewResultView.Navigate",a}();a.ViewResultView=g;var h=function(){function a(){}return a.Error="ResponsePage.ErrorPage.Error",a.Information="ResponsePage.ErrorPage.Information",a}();a.ErrorPage=h;var i=function(){function a(){}return a.Failure="ResponsePage.LoadingScript.Failure",a.Start="ResponsePage.LoadingScript.Start",a.Success="ResponsePage.LoadingScript.Success",a}();a.LoadingScript=i;var j=function(){function a(){}return a.ChangeLanguage="ResponsePage.MultiLingual.ChangeLanguage",a}();a.MultiLingual=j}(g=b.ResponsePage||(b.ResponsePage={}));var h;!function(a){var b=function(){function a(){}return a.Navigate="ShareFormPage.Copy.Navigate",a.LoginToAutoCopy="ShareFormPage.Copy.LoginToAutoCopy",a.DuplicateButton="ShareFormPage.Copy.DuplicateButton",a}();a.Copy=b}(h=b.ShareFormPage||(b.ShareFormPage={}));var i;!function(a){a.Referrer="DefaultPage.Referrer";var b=function(){function a(){}return a.GetStarted="DefaultPage.LandingView.GetStarted",a.GetStartedHeaderBar="DefaultPage.LandingView.GetStartedHeaderBar",a.GetStartedWithForm="DefaultPage.LandingView.GetStartedWithForm",a.GetStartedSignIn="DefaultPage.LandingView.GetStartedSignIn",a.SignIn="DefaultPage.LandingView.SignIn",a.MsaSignIn="DefaultPage.LandingView.MsaSignIn",a.AadSignIn="DefaultPage.LandingView.AadSignIn",a.Navigate="DefaultPage.LandingView.Navigate",a.SignUp="DefaultPage.LandingView.SignUp",a.MsaSignUp="DefaultPage.LandingView.MsaSignUp",a.AadSignUp="DefaultPage.LandingView.AadSignUp",a.CloseSignDialog="DefaultPage.LandingView.CloseSignDialog",a.EmailHrdFailure="DefaultPage.LandingView.EmailHrdFailure",a.AccountNotInWhiteList="DefaultPage.LandingView.AccountNotInWhiteList",a.AccountTypeUnknown="DefaultPage.LandingView.AccountTypeUnknown",a.AccountTypeBoth="DefaultPage.LandingView.AccountTypeBoth",a.Office365="DefaultPage.LandingView.Office365",a.PowerApps="DefaultPage.LandingView.PowerApps",a}();a.LandingView=b;var c=function(){function a(){}return a.Loaded="DefaultPage.EmailHrd.Loaded",a.LoadFailed="DefaultPage.EmailHrd.LoadFailed",a.NextScreen="DefaultPage.EmailHrd.NextScreen",a}();a.EmailHrd=c}(i=b.DefaultPage||(b.DefaultPage={}));var j;!function(a){var b=function(){function a(){}return a.Success="Image.CanvasOnLoad.Success",a.Failure="Image.CanvasOnLoad.Failure",a}();a.CanvasOnLoad=b;var c=function(){function a(){}return a.Success="Image.CanvasRender.Success",a.Failure="Image.CanvasRender.Failure",a}();a.CanvasRender=c;var d=function(){function a(){}return a.Success="Image.ImageOnLoad.Success",a.Failure="Image.ImageOnLoad.Failure",a}();a.ImageOnLoad=d}(j=b.Image||(b.Image={}));var k;!function(a){var b=function(){function a(){}return a.GotoRegisterPage="Error.ErrorPage.GotoRegisterPage",a.Error="Error.ErrorPage.Error",a.Information="Error.ErrorPage.Information",a.OriginErrorJudgementNotMatch="Error.ErrorPage.OriginErrorJudgementNotMatch",a.ErrorOutOfOrigin="Error.ErrorPage.ErrorOutOfOrigin",a}();a.ErrorPage=b;var c=function(){function a(){}return a.Hide="Error.ErrorMessageBar.Hide",a.Show="Error.ErrorMessageBar.Show",a}();a.ErrorMessageBar=c;var d=function(){function a(){}return a.ShowAtSubmitResponse="Error.InlineError.ShowAtSubmitResponse",a}();a.InlineError=d;var e=function(){function a(){}return a.FailedToLoadCss="Error.CssLoadingError.FailedToLoadCss",a}();a.CssLoadingError=e;var f=function(){function a(){}return a.KatexFallbackToMathJax="Error.MathRendering.KatexFallbackToMathJax",a}();a.MathRendering=f;var g=function(){function a(){}return a.UniversalHeaderAndFooterError="Error.UHF.UniversalHeaderAndFooterError",a}();a.UHF=g}(k=b.Error||(b.Error={}));var l;!function(a){var b=function(){function a(){}return a.DisabledByTenantAdmin="Auth.DisabledByTenantAdmin",a.NotOnboardedTenant="Auth.NotOnboardedTenant",a.ThirdPartyCookieSupport="Auth.ThirdPartyCookieSupport",a.UserNeedMultiFactorAuth="Auth.UserNeedMultiFactorAuth",a.NoUserInfoForNonanonymousForm="Auth.NoUserInfoForNonanonymousForm",a}();a.Auth=b}(l=b.Auth||(b.Auth={}));var m;!function(a){var b=function(){function a(){}return a.Close="AddinPage.App.Close",a.Initial="AddinPage.App.Initial",a}();a.App=b;var c=function(){function a(){}return a.DataSync="AddinPage.SyncView.DataSync",a}();a.SyncView=c;var d=function(){function a(){}return a.GetAddinUserInfoSuccess="AddinPage.GetAddinUserInfo.Success",a.GetAddinUserInfoFailed="AddinPage.GetAddinUserInfo.Failed",a.GetFlightsSuccess="AddinPage.GetFlights.Success",a.GetFlightsFailed="AddinPage.GetFlights.Failed",a}();a.PageMethod=d}(m=b.AddinPage||(b.AddinPage={}));var n;!function(a){var b=function(){function a(){}return a.Close="OneNoteAddinPage.App.Close",a.Initial="OneNoteAddinPage.App.Initial",a}();a.App=b;var c=function(){function a(){}return a.Navigate="OneNoteAddinPage.AuthView.Navigate",a.Click="OneNoteAddinPage.AuthView.Click",a.Succeed="OneNoteAddinPage.AuthView.Succeed",a.NotLoggedIn="OneNoteAddinPage.AuthView.NotLoggedIn",a}();a.AuthView=c;var d=function(){function a(){}return a.Navigate="OneNoteAddinPage.SyncView.Navigate",a.IsNewUser="OneNoteAddinPage.SyncView.IsNewUser",a.InsertForm="OneNoteAddinPage.SyncView.InsertForm",a.InsertSuccess="OneNoteAddinPage.SyncView.InsertSuccess",a.CreateForm="OneNoteAddinPage.SyncView.CreateForm",a.CreateSuccess="OneNoteAddinPage.SyncView.CreateSuccess",a.EditForm="OneNoteAddinPage.SyncView.EditForm",a}();a.SyncView=d}(n=b.OneNoteAddinPage||(b.OneNoteAddinPage={}));var o;!function(a){var b=function(){function a(){}return a.Close="PowerPointTaskpaneAddinPage.App.Close",a.Initial="PowerPointTaskpaneAddinPage.App.Initial",a}();a.App=b;var c=function(){function a(){}return a.Navigate="PowerPointTaskpaneAddinPage.AuthView.Navigate",a.Click="PowerPointTaskpaneAddinPage.AuthView.Click",a.Succeed="PowerPointTaskpaneAddinPage.AuthView.Succeed",a.NotLoggedIn="PowerPointTaskpaneAddinPage.AuthView.NotLoggedIn",a}();a.AuthView=c;var d=function(){function a(){}return a.Navigate="PowerPointTaskpaneAddinPage.SyncView.Navigate",a.IsNewUser="PowerPointTaskpaneAddinPage.SyncView.IsNewUser",a.InsertForm="PowerPointTaskpaneAddinPage.SyncView.InsertForm",a.InsertSuccess="PowerPointTaskpaneAddinPage.SyncView.InsertSuccess",a.CreateForm="PowerPointTaskpaneAddinPage.SyncView.CreateForm",a.CreateSuccess="PowerPointTaskpaneAddinPage.SyncView.CreateSuccess",a.EditForm="PowerPointTaskpaneAddinPage.SyncView.EditForm",a.FetchFormList="PowerPointTaskpaneAddinPage.SyncView.FetchFormList",a.FetchFormListSuccess="PowerPointTaskpaneAddinPage.SyncView.FetchFormListSuccess",a}();a.SyncView=d}(o=b.PowerPointTaskpaneAddinPage||(b.PowerPointTaskpaneAddinPage={}));var p;!function(a){var b=function(){function a(){}return a.PrepareAddinContext="PowerPointContentAddinPage.Initialize.PrepareAddinContext",a.PrepareAddinContextCompleted="PowerPointContentAddinPage.Initialize.PrepareAddinContextCompleted",a.GetTokenThirdPartySSONotSupported="PowerPointContentAddinPage.Initialize.GetTokenThirdPartySSONotSupported",a}();a.Initialize=b;var c=function(){function a(){}return a.Click="PowerPointContentAddinPage.AuthView.Click",a.Succeed="PowerPointContentAddinPage.AuthView.Succeed",a.NotLoggedIn="PowerPointContentAddinPage.AuthView.NotLoggedIn",a}();a.AuthView=c;var d=function(){function a(){}return a.Render="PowerPointContentAddinPage.RenderView.Render",a.RenderFormPage="PowerPointContentAddinPage.RenderView.RenderFormPage",a.RenderSuccess="PowerPointContentAddinPage.RenderView.RenderSuccess",a.GetPPTView="PowerPointContentAddinPage.RenderView.GetPPTView",a.GetPPTViewSuccess="PowerPointContentAddinPage.RenderView.GetPPTViewSuccess",a.GetPPTViewNotSupported="PowerPointContentAddinPage.RenderView.GetPPTViewNotSupported",a.GetFormId="PowerPointContentAddinPage.RenderView.GetFormId",a.GetFormIdCompleted="PowerPointContentAddinPage.RenderView.GetFormIdCompleted",a.SaveFileSettings="PowerPointContentAddinPage.RenderView.SaveFileSettings",a.SaveFileSettingsCompleted="PowerPointContentAddinPage.RenderView.SaveFileSettingsCompleted",a.GetFormTitle="PowerPointContentAddinPage.RenderView.GetFormTitle",a.GetFormTitleCompleted="PowerPointContentAddinPage.RenderView.GetFormTitleCompleted",a.CheckAnonymous="PowerPointContentAddinPage.RenderView.CheckAnonymous",a.CheckAnonymousCompleted="PowerPointContentAddinPage.RenderView.CheckAnonymousCompleted",a.CookieBypass="PowerPointContentAddinPage.RenderView.CookieBypass",a.SSOBypass="PowerPointContentAddinPage.RenderView.SSOBypass",a}();a.RenderView=d;var e=function(){function a(){}return a.Click="PowerPointContentAddinPage.StartView.Click",a}();a.StartView=e}(p=b.PowerPointContentAddinPage||(b.PowerPointContentAddinPage={}));var q;!function(a){var b=function(){function a(){}return a.Navigate="AssignmentsFrame.Auth.Navigate",a.Success="AssignmentsFrame.Auth.Success",a.SsoSuccess="AssignmentsFrame.Auth.SsoSuccess",a}();a.Auth=b;var c=function(){function a(){}return a.Save="AssignmentsFrame.ConfigView.Save",a}();a.ConfigView=c}(q=b.AssignmentsFrame||(b.AssignmentsFrame={}));var r;!function(a){var b=function(){function a(){}return a.Save="TeamsTab.ConfigView.Save",a}();a.ConfigView=b}(r=b.TeamsTab||(b.TeamsTab={}));var s;!function(a){var b=function(){function a(){}return a.Close="OutlookCreatePollPage.App.Close",a.Initial="OutlookCreatePollPage.App.Initial",a}();a.App=b;var c=function(){function a(){}return a.Navigate="OutlookCreatePollPage.AuthView.Navigate",a.Click="OutlookCreatePollPage.AuthView.Click",a.Succeed="OutlookCreatePollPage.AuthView.Succeed",a.NotLoggedIn="OutlookCreatePollPage.AuthView.NotLoggedIn",a}();a.AuthView=c;var d=function(){function a(){}return a.Navigate="OutlookCreatePollPage.PollView.Navigate",a.OpenForms="OutlookCreatePollPage.PollView.OpenForms",a}();a.PollView=d;var e=function(){function a(){}return a.MultipleAnswers="OutlookCreatePollPage.Questions.MultipleAnswers",a}();a.Questions=e}(s=b.OutlookCreatePollPage||(b.OutlookCreatePollPage={}));var t;!function(a){var b=function(){function a(){}return a.ConnectionDisconnected="DataProvider.RealtimeClient.Connection.Disconnected",a.ConnectionError="DataProvider.RealtimeClient.Connection.Error",a.ConnectionFailed="DataProvider.RealtimeClient.Connection.Failed",a.ConnectionReconnected="DataProvider.RealtimeClient.Connection.Reconnected",a.ConnectionReconnecting="DataProvider.RealtimeClient.Connection.Reconnecting",a.ConnectionSlow="DataProvider.RealtimeClient.Connection.Slow",a.ConnectionStarting="DataProvider.RealtimeClient.Connection.Starting",a.ConnectionSuccess="DataProvider.RealtimeClient.Connection.Success",a}();a.RealtimeClient=b}(t=b.DataProvider||(b.DataProvider={}));var u;!function(a){var b=function(){function a(){}return a.Navigate="QuickSubmitPage.QuickSubmit.Navigate",a.Submit="QuickSubmitPage.QuickSubmit.Submit",a}();a.QuickSubmit=b}(u=b.QuickSubmitPage||(b.QuickSubmitPage={}));var v;!function(a){var b=function(){function a(){}return a.Show="IntelligenceStatistic.ChoiceOptionSuggestion.Show",a.NoShow="IntelligenceStatistic.ChoiceOptionSuggestion.NoShow",a.Choose="IntelligenceStatistic.ChoiceOptionSuggestion.Choose",a}();a.ChoiceOptionSuggestion=b;var c=function(){function a(){}return a.Show="IntelligenceStatistic.LikertOptionSuggestion.Show",a.Choose="IntelligenceStatistic.LikertOptionSuggestion.Choose",a}();a.LikertOptionSuggestion=c;var d=function(){function a(){}return a.Show="IntelligenceStatistic.QuestionSuggestion.Show",a}();a.QuestionSuggestion=d;var e=function(){function a(){}return a.Failure="IntelligenceStatistic.Templates.Failure",a}();a.TemplateSuggestion=e}(v=b.IntelligenceStatistic||(b.IntelligenceStatistic={}));var w;!function(a){var b=function(){function a(){}return a.Show="Intelligence.ChoiceOptionSuggestion.Show",a.Choose="Intelligence.ChoiceOptionSuggestion.Choose",a}();a.ChoiceOptionSuggestion=b;var c=function(){function a(){}return a.Show="Intelligence.LikertOptionSuggestion.Show",a.Choose="Intelligence.LikertOptionSuggestion.Choose",a}();a.LikertOptionSuggestion=c;var d=function(){function a(){}return a.Show="Intelligence.QuestionSuggestion.Show",a}();a.QuestionSuggestion=d;var e=function(){function a(){}return a.TagFailure="Intelligence.QuestionTagForIntelligence.Tag.Failure",a}();a.QuestionTagForIntelligence=e;var f=function(){function a(){}return a.ShowCallout="Intelligence.Theme.ShowCallout",a.CloseCallout="Intelligence.Theme.CloseCallout",a}();a.ThemeSuggestion=f}(w=b.Intelligence||(b.Intelligence={})),a.Exports.EngagementEventNames=b}(c=b.EngagementEventNames||(b.EngagementEventNames={}))}(b=a.Event||(a.Event={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c=function(){function a(){}return a.AADAcquireTokenError="AADAcquireTokenError",a.AADAcquireTokenMfaCheckError="AADAcquireTokenMfaCheckError",a.LoginIECrossZoneError="LoginIECrossZoneError",a.ThirdPartyCookieBlockedError="ThirdPartyCookieBlockedError",a.AuthNoStorageError="AuthNoStorageError",a.TeamSiteNoGroupError="TeamSiteNoGroupError",a.VariationMismatachError="VariationMismatachError",a.OutlookInsertCardAsPropError="OutlookInsertCardAsPropError",a}();b.ClientErrorNames=c,a.Exports.ClientErrorNames=c}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;if(function(a){var b;!function(b){function c(){return{R:255,G:255,B:255}}function d(){return{R:0,G:0,B:0}}function e(a){var b=[a.R,a.G,a.B].map(function(a){return a/=255,.03928>=a?a/12.92:Math.pow((a+.055)/1.055,2.4)});return.2126*b[0]+.7152*b[1]+.0722*b[2]}function f(a){return(e(c())+.05)/(e(a)+.05)>q}function g(a){for(var b=r;!f(a)&&b>=s;){var c=k(a);c.V=.01*b,a=l(c),b--}return a}function h(a){return f(a)?c():d()}function i(a){var b=a.toString(16);return 1===b.length?"0"+b:b}function j(a){return"#"+i(a.R)+i(a.G)+i(a.B)}function k(a){var b,c=a.R,d=a.G,e=a.B,f=Math.max(c,d,e),g=Math.min(c,d,e),h=f-g,i=0===f?0:h/f,j=f/255;switch(f){case g:b=0;break;case c:b=d-e+h*(e>d?6:0),b/=6*h;break;case d:b=e-c+2*h,b/=6*h;break;case e:b=c-d+4*h,b/=6*h}return{H:b,S:i,V:j}}function l(a){var b,c,d,e,f,g,h,i,j=a.H,k=a.S,l=a.V;switch(e=Math.floor(6*j),f=6*j-e,g=l*(1-k),h=l*(1-f*k),i=l*(1-(1-f)*k),e%6){case 0:b=l,c=i,d=g;break;case 1:b=h,c=l,d=g;break;case 2:b=g,c=l,d=i;break;case 3:b=g,c=h,d=l;break;case 4:b=i,c=g,d=l;break;case 5:b=l,c=g,d=h}return{R:Math.round(255*b),G:Math.round(255*c),B:Math.round(255*d)}}function m(a){a.startsWith("#")&&(a=a.substring(1));var b=parseInt(a,16);return{R:b>>16&255,G:b>>8&255,B:255&b}}function n(a){var b=m(a),c=k(b);return e(b)>186&&(c.V=.45,b=l(c)),j(b)}function o(a){var b=k(m(a)),c=l({H:b.H,S:b.S,V:b.V-.1});return j(c)}function p(a){var b,c=k(m(a));return b=c.S>.05?.05:0,j(l({H:c.H,S:b,V:.95}))}a.Exports.ColorHelper=b;var q=4.5,r=46,s=25;b.isValidColorContrast=f,b.adjustPrimaryThemeColor=g,b.contrastingColor=h,b.colorToHex=j,b.rGBToHSV=k,b.hSVToRGB=l,b.hexToRGB=m,b.normalizePrimaryColor=n,b.primaryHexToSecondaryHex=o,b.primaryHexToBackgroundHex=p}(b=a.ColorHelper||(a.ColorHelper={}))}(OfficeForm||(OfficeForm={})),!window.atob||!window.btoa){window.atob=window.atob||decode,window.btoa=window.btoa||encode;var PADCHAR_1="=",ALPHA_1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"}var OfficeForm;!function(a){var b;!function(b){function c(a){return h[a]||(h[a]=d(a)),h[a]}function d(b){var c=$.Deferred(),d=g[f[b]];if(!d)throw Error("No path for "+f[b]);var e=document.getElementsByTagName("head")[0];if(!e)return c.reject(Error("No head element found!")).promise();var h=document.createElement("link");return h.rel="stylesheet",h.href=d,h.onload=function(){return c.resolve()},h.onerror=function(){e.removeChild(h),c.reject(Error("Failed to load css file: "+d)),a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.Error.CssLoadingError.FailedToLoadCss,extraData:{name:f[b],url:d}})},e.appendChild(h),c.promise()}function e(){var b="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.0/katex.min.css",c="../scripts/vendors/katex/katex.min.css";return a.EnvironmentConfig.isOsi()?c:b}var f;!function(a){a[a.Katex=0]="Katex"}(f=b.CssLibraries||(b.CssLibraries={})),b.loadCss=c;var g={Katex:e()},h=[]}(b=a.CssLoader||(a.CssLoader={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b=function(){function b(){}return Object.defineProperty(b,"Host",{get:function(){return b._host||b.GetHostString()},set:function(a){b._host=a},enumerable:!0,configurable:!0}),b.GetHostString=function(){var c=b._host||a.Utilities.Html.getQueries()[b.HostParam]||a.Utilities.Html.getHashes()[b.HostParam];switch(c){case"OneNote":case"OneNoteUwp":case"Outlook":case"Teams":case"Excel":case"OneDrive":case"Excel_Win32":case"PowerPointContent":case"PowerPointTaskpane":case"Assignments":case"ProjectShimla":case"Stream":case"StreamMobile":case"Union":return c;default:return null}},Object.defineProperty(b,"GroupId",{get:function(){return b._groupId||a.Utilities.Html.getQueries()[b.GroupParam]||a.Utilities.Html.getHashes()[b.GroupParam]},enumerable:!0,configurable:!0}),Object.defineProperty(b,"TenantId",{get:function(){return b._tenantId||a.Utilities.Html.getQueries()[b.TenantParam]||a.Utilities.Html.getHashes()[b.TenantParam]},enumerable:!0,configurable:!0}),b.setGroupInfo=function(a,c,d){void 0===a&&(a=!1),b._showGroupFormOnly=a,b._tenantId=c,b._groupId=d},Object.defineProperty(b,"IsIntegration",{get:function(){var a=b.GetHostString();return a?!0:OfficeFormServerInfo.isOembedSPO?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(b,"IsTeamsIntegration",{get:function(){return"Teams"===b.Host&&"undefined"!=typeof microsoftTeams},enumerable:!0,configurable:!0}),Object.defineProperty(b,"IsTeamsLandingPage",{get:function(){return!!a.Utilities.Html.getQueries()[b.TeamsLandingParam]},enumerable:!0,configurable:!0}),Object.defineProperty(b,"IsMiniLandingView",{get:function(){return!!a.Utilities.Html.getQueries()[b.MiniLandingViewParam]},enumerable:!0,configurable:!0}),Object.defineProperty(b,"IsAssignmentsIntegration",{get:function(){return"Assignments"===b.Host},enumerable:!0,configurable:!0}),Object.defineProperty(b,"IsAssignmentsPage",{get:function(){return"/pages/assignmentsdesignpage.aspx"===window.location.pathname.toLowerCase()||"/pages/assignmentsresponsepage.aspx"===window.location.pathname.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(b,"IsExternalIntegration",{get:function(){return this.IsTeamsIntegration||this.IsAssignmentsIntegration},enumerable:!0,configurable:!0}),Object.defineProperty(b,"IsPPTIntegration",{get:function(){return"PowerPointTaskpane"===b.Host||"PowerPointContent"===b.Host},enumerable:!0,configurable:!0}),Object.defineProperty(b,"IsProjectShimlaIntegration",{get:function(){return"ProjectShimla"===b.Host},enumerable:!0,configurable:!0}),b.isDelegateMode=function(){if(null===b._isDelegateMode){var a=window.location.pathname.trimEnd("/").toLowerCase();b._isDelegateMode=a.lastIndexOf(b.DelegatePage)==a.length-b.DelegatePage.length}return b._isDelegateMode},Object.defineProperty(b,"IsUnionIntegration",{get:function(){return"Union"===b.Host},enumerable:!0,configurable:!0}),b.setEnvironmentHostAppWithName=function(a){b.Host=a},b.PopupNotifyTypeParam="popupNotifyType",b.AuthProviderParam="auth_pvr",b.AuthUpnParam="auth_upn",b.ShareToCollabTokenParam="Token",b.HostParam="Host",
b.TeamsLandingParam="TeamsLanding",b.MiniLandingViewParam="MiniLandingView",b.GroupParam="groupId",b.TenantParam="tid",b.DelegatePage="delegatepage.aspx",b._isDelegateMode=null,b}();a.EnvironmentSettings=b,a.Exports.EnvironmentSettings=b}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(a){function b(a,b,d,e){var f={};return f[s]=e?u:t,c(a,b,d,f)}function c(a,b,c,d){var e=g(a),i=g(b);d&&0!==Object.keys(d).length&&Object.keys(d).forEach(function(a){c+=r+a+"="+d[a]});var j=p-(n+o+c.length)%p;j=p>j?j:0,c=f(c,c.length+j,q);var k=h(c),l=e.concat(i,k),m=window.btoa(String.fromCharCode.apply(String,l));return m.replace(/\//g,"_").replace(/\+/g,"-")}function d(a){var b=e(a),c=!1;return b.MoreInfo&&b.MoreInfo[s]===u&&(c=!0),{OrgId:b.OrgId,OwnerId:b.OwnerId,TableId:b.TableId,IsGroupOwner:c}}function e(a){try{a=a.replace(/_/g,"/").replace(/-/g,"+");var b=i(a),c=b.slice(0,n),d=j(c),e=b.slice(n,n+o),f=j(e),g=b.slice(n+o),h=m(k(g),q),l={},p=h.split(r);if(p.length>1){h=p[0];for(var s=1;s<p.length;s++){var t=p[s].split("=");t&&2===t.length&&(l[t[0]]=t[1])}}return{OrgId:d,OwnerId:f,TableId:h,MoreInfo:l}}catch(u){return{OrgId:null,OwnerId:null,TableId:null,MoreInfo:null}}}function f(a,b,c){return a+Array(b-a.length+1).join(c||" ")}function g(a){var b=[];return a.split("-").forEach(function(a,c){var d=a.match(/.{2}/g);3>c&&(d=d.reverse()),d.forEach(function(a){b.push(parseInt(a,16))})}),b}function h(a){return a.split("").map(function(a){return a.charCodeAt(0)})}function i(a){return h(window.atob(a.replace(/ /g,"")))}function j(a){if(16!==a.length)return null;var b=[].concat(a.slice(0,4).reverse(),a.slice(4,6).reverse(),a.slice(6,8).reverse(),a.slice(8)),c=l(b);return c=c.slice(0,8)+"-"+c.slice(8,12)+"-"+c.slice(12,16)+"-"+c.slice(16,20)+"-"+c.slice(20)}function k(a){for(var b="",c=0;c<a.length;++c)b+=String.fromCharCode(a[c]);return b}function l(a){for(var b="",c="",d=0;d<a.length;d++)c=a[d].toString(16),c=1===c.length?"0"+c:c,b+=c;return b}function m(a,b){if(null===a||void 0===a||0===a.length)return a;for(var c=a.length;--c>=0&&!(b.indexOf(a.charAt(c))<0););return a.substr(0,c+1)}var n=16,o=16,p=3,q=".",r="$%@#",s="t",t="u",u="g";a.encodeFormId=b,a.decodeFormId=d}(b=a.FormId||(a.FormId={}))}(b=a.Utilities||(a.Utilities={}))}(OfficeForm||(OfficeForm={}));var Forms;!function(a){var b;!function(a){}(b=a.DesignPage||(a.DesignPage={}));var c;!function(a){}(c=a.Experimentation||(a.Experimentation={}));var d;!function(a){var b;!function(a){}(b=a.FormManager||(a.FormManager={}))}(d=a.Models||(a.Models={}));var e;!function(a){var b;!function(a){}(b=a.Utilities||(a.Utilities={}));var c;!function(a){}(c=a.Controls||(a.Controls={}));var d;!function(a){}(d=a.Analysis||(a.Analysis={}));var e;!function(a){}(e=a.FileUpload||(a.FileUpload={}));var f;!function(a){}(f=a.Intelligence||(a.Intelligence={}));var g;!function(a){}(g=a.MultiLingual||(a.MultiLingual={}));var h;!function(a){}(h=a.RecycleBin||(a.RecycleBin={}));var i;!function(a){}(i=a.Renderer||(a.Renderer={}));var j;!function(a){}(j=a.Designer||(a.Designer={}));var k;!function(a){}(k=a.FlexPane||(a.FlexPane={}));var l;!function(a){}(l=a.FormDesignView||(a.FormDesignView={}));var m;!function(a){}(m=a.Addin||(a.Addin={}));var n;!function(a){}(n=a.PowerPoint||(a.PowerPoint={}));var o;!function(a){}(o=a.TopViews||(a.TopViews={}));var p;!function(a){}(p=a.OutlookQuickPoll||(a.OutlookQuickPoll={}))}(e=a.UX||(a.UX={})),function(a){var b;!function(a){}(b=a.FileUpload||(a.FileUpload={}))}(e=a.UX||(a.UX={}));var f;!function(a){}(f=a.Mru||(a.Mru={}));var g;!function(a){}(g=a.FileUploadProcess||(a.FileUploadProcess={}));var h;!function(a){}(h=a.Grading||(a.Grading={}));var i;!function(a){}(i=a.PrintTemplate||(a.PrintTemplate={}));var j;!function(a){}(j=a.Common||(a.Common={}));var k;!function(a){}(k=a.DataProvider||(a.DataProvider={}));var l;!function(a){}(l=a.Experiment||(a.Experiment={}));var m;!function(a){}(m=a.Templates||(a.Templates={}));var n;!function(a){}(n=a.Telemetry||(a.Telemetry={}));var o;!function(a){}(o=a.Themes||(a.Themes={}));var p;!function(a){}(p=a.FormsProRelated||(a.FormsProRelated={}));var q;!function(a){}(q=a.FormElementBatchRelated||(a.FormElementBatchRelated={}));var r;!function(a){}(r=a.MultilingualBatchRelated||(a.MultilingualBatchRelated={}));var s;!function(a){}(s=a.MobileDesignPage||(a.MobileDesignPage={}));var t;!function(a){}(t=a.Routing||(a.Routing={}))}(Forms||(Forms={}));var OfficeForm;!function(a){var b;!function(b){function c(a){return $.when.apply($,a.map(d))}function d(a){return l[a]||(l[a]=c(k[a]||[]).then(function(){return e(a)}),"undefined"!=typeof Forms&&Forms.PerformanceAnalysis&&Forms.PerformanceAnalysis.requestWithPromise("script:"+a,l[a])),l[a]}function e(a){var b=$.Deferred(),c=j[a];if(!c)throw Error("No script path for "+a);var d=document.getElementsByTagName("head")[0];if(!d)return b.reject(Error("No head element found!")).promise();var e=document.createElement("script");return e.type="text/javascript",e.async=!0,e.src=c,e.onload=function(){b.resolve()},e.onerror=function(a){d.removeChild(e),b.reject(Error("Failed to load javascript file: "+c))},d.appendChild(e),b.promise()}function f(){var b="//cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML",c="../scripts/vendors/mathjax/MathJax.js?config=TeX-AMS_HTML";return a.EnvironmentConfig.isOsi()?c:b}function g(){var b="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.0/katex.min.js",c="../scripts/vendors/katex/katex.min.js";return a.EnvironmentConfig.isOsi()?c:b}function h(a,b){k[a]=b}a.Exports.JavaScriptLoader=b,b.loadJavaScripts=c,b.loadJavaScript=d;var i=OfficeFormServerInfo.scriptSuffix,j=("?v="+OfficeFormServerInfo.version,{"combined-design":"../Scripts/Vendors/combined/design_3fd6ce0.js","combined-response":"../Scripts/Vendors/combined/response_2e6ed61.js",BootStrap:"../Scripts/Vendors/bootstrap/3.3.5/bootstrap.min.js",DataTables:"../Scripts/Vendors/DataTables."+i,Chart:"../Scripts/Vendors/Chart-2.6."+i,Clipboard:"../Scripts/Vendors/clipboard-1.7.1.min.js",ColorThief:"../Scripts/Vendors/color-thief/color-thief.min.js",Cropper_Modified:"../Scripts/Vendors/cropper/cropper.modified."+i,D3:"../Scripts/Vendors/d3/d3."+i,FileSave:"../Scripts/Vendors/FileSaver.min.js",Heatmap:"../Scripts/Vendors/highcharts/heatmap.js",HighCharts:"../Scripts/Vendors/highcharts/highcharts.js",HighCharts_More:"../Scripts/Vendors/highcharts/highcharts-more.js",Ivy:"//edera.cloudapp.net/javascripts/api/ivy.js",OfficeBrowserFeedback:"../Scripts/Vendors/officebrowserfeedback/officebrowserfeedback_floodgate.js",JQuery_RateIt:"../Scripts/Vendors/rating-1.1.0/jquery.rateit."+i,JQuery_Picker:"../Scripts/Vendors/pickadate-3.5.6/picker."+i,JQuery_Picker_Date:"../Scripts/Vendors/pickadate-3.5.6/picker.date."+i,JQuery_Picker_Time:"../Scripts/Vendors/pickadate-3.5.6/picker.time."+i,JQuery_QRCode:"../Scripts/Vendors/jquery.qrcode.min.js",Katex:g(),Linkify:"../Scripts/Vendors/linkify/linkify.min.js",Linkify_JQuery:"../Scripts/Vendors/linkify/linkify-jquery.min.js",MathJax:f(),MathQuill:"../Scripts/Vendors/mathquill/mathquill."+i,Pattern_Fill:"../Scripts/Vendors/highcharts/pattern-fill.js",Mark:"../Scripts/Vendors/markjs-8.9.0/mark."+i,SignalR:"../Scripts/Vendors/SignalR/jquery.signalR-2.2.0.min.js",Sortable:"../Scripts/Vendors/sortablejs-1.5.1/Sortable.modified."+i,WordCloud:"../Scripts/Vendors/highcharts/wordcloud.js",Xlsx:"../Scripts/Vendors/xlsx.core.min.js"}),k={};h("JQuery_Picker_Date",["JQuery_Picker"]),h("JQuery_Picker_Time",["JQuery_Picker"]),h("Linkify_JQuery",["Linkify"]),h("WordCloud",["HighCharts"]),h("HighCharts_More",["HighCharts"]),h("Heatmap",["HighCharts"]),h("Pattern_Fill",["HighCharts"]);var l={}}(b=a.JavaScriptLoader||(a.JavaScriptLoader={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b=function(){function a(b){this.margin=10,this.containerWidth=b,this.maxImageRatio=b/a.miniHight,this.miniImageRatio=b/a.maxHight}return Object.defineProperty(a.prototype,"Margin",{get:function(){return this.margin},set:function(a){this.margin=a},enumerable:!0,configurable:!0}),a.prototype.layoutContent=function(a){for(var b=[],c=a,d=0,e=c.length,f=[];e>d;d++){var g=this.groupItems([].concat(f,c[d])),h=g.length;0>=h||(e-1>d&&this.getSumRatio(g[h-1])<this.miniImageRatio?(f=g[h-1],g.length=h-1):f=[],b=b.concat.apply(b,g))}return b},a.prototype.groupItems=function(a){for(var b=this.groupItemsByNodeType(a),c=0;c<b.length;c++){var d=this.getRowHeight(b[c]);1===b[c].length&&b[c][0].NaturalRatio>this.maxImageRatio?(b[c][0].Height=d,b[c][0].Width=this.containerWidth-this.margin):b[c].forEach(function(a){a.Height=d,a.Width=d*a.NaturalRatio})}return b},a.prototype.groupItemsByNodeType=function(a){var b=a.filter(function(a){return a.Type===e.Folder}),c=a.filter(function(a){return a.Type===e.Image});if(b.length<=0)return this.selectAndGroupItems(c);var d=this.selectAndGroupItems(b),f=d[d.length-1],g=this.getSumRatio(f);if(g<this.miniImageRatio)for(var h=0;h<c.length&&5>h;h++){var i=c[h].NaturalRatio;if(g+i<this.miniImageRatio)g+=i,f.push(c[h]),c.splice(h--,1);else if(g+i<this.maxImageRatio){f.push(c[h]),c.splice(h,1);break}}return d.concat(this.selectAndGroupItems(c))},a.prototype.selectAndGroupItems=function(a){for(var b=[],c=[],d=0;d<a.length;d++){c.push([d]);for(var e=c.length-1,f=0;e>f;f++){var g=a[d].NaturalRatio;g+=c[f].map(function(b){return a[b].NaturalRatio}).reduce(function(a,b){return a+b},0);var h=c[f].slice(0);if(h.push(d),g<this.miniImageRatio)c.push(h);else if(g>=this.miniImageRatio&&g<=this.maxImageRatio){b.push(h.map(function(b){return a[b]}));for(var i=c.length-1;i>=0;i--)c[i].some(function(a){return h.indexOf(a)>=0})&&c.splice(i,1);break}}}for(var j=c.filter(function(a){return 1===a.length}).map(function(b){return a[b[0]]}),k=[],d=0;d<j.length;d++)k.push(j[d]),this.getSumRatio(k)>this.maxImageRatio&&(b.push(k),k=[]);return k.length>0&&b.push(k),b},a.prototype.getRowHeight=function(b){var c=this.getSumRatio(b);if(c>this.maxImageRatio&&1===b.length)return a.miniHight;if(c<this.miniImageRatio)return a.maxHight;var d=this.containerWidth-b.length*this.margin;return d/c},a.prototype.getSumRatio=function(a){return a.map(function(a){return a.NaturalRatio}).reduce(function(a,b){return a+b})},a.maxHight=200,a.miniHight=140,a}();a.LiquidLayout=b;var c=function(){function a(){}return Object.defineProperty(a.prototype,"Type",{get:function(){return e.Image},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Width",{get:function(){return this.width},set:function(a){this.width=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Height",{get:function(){return this.height},set:function(a){this.height=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"NaturalWidth",{get:function(){return this.naturalWidth},set:function(a){this.naturalWidth=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"NaturalHeight",{get:function(){return this.naturalHeight},set:function(a){this.naturalHeight=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"NaturalRatio",{get:function(){return this.naturalWidth&&this.naturalHeight?this.naturalWidth/this.naturalHeight:1},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Src",{get:function(){return this.src},set:function(a){this.src=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"ThumbnailSrc",{get:function(){return this.thumbnailSrc},set:function(a){this.thumbnailSrc=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Title",{get:function(){return this.title},set:function(a){this.title=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Size",{get:function(){return this.size},set:function(a){this.size=a},enumerable:!0,configurable:!0}),a}();a.ImageLayoutNode=c;var d=function(){function a(){}return Object.defineProperty(a.prototype,"Type",{get:function(){return e.Folder},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"NaturalHeight",{get:function(){return 175},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"NaturalWidth",{get:function(){return 265},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"NaturalRatio",{get:function(){return this.NaturalWidth/this.NaturalHeight},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Height",{get:function(){return this.height},set:function(a){this.height=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Width",{get:function(){return this.width},set:function(a){this.width=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Title",{get:function(){return this.title},set:function(a){this.title=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"AlbumCount",{get:function(){return this.albumCount},set:function(a){this.albumCount=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"ResourceId",{get:function(){return this.resourceId},set:function(a){this.resourceId=a},enumerable:!0,configurable:!0}),a}();a.FolderLayoutNode=d;var e;!function(a){a[a.Image=0]="Image",a[a.Folder=1]="Folder"}(e=a.NodeType||(a.NodeType={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b=function(){function a(a){this.setItems(a||[])}return a.prototype.toArray=function(){for(var a=[],b=this.head.Next;b!==this.head;b=b.Next)a.push(b.Data);return a},a.prototype.getCount=function(){return this.count},a.prototype.getById=function(a){var b=this.map[a];return b&&b.Data},a.prototype.append=function(a){this.insertBefore(a)},a.prototype.update=function(a){var b=this.getIdFromData(a),c=this.map[b];if(!c)throw Error("No matched data to update.");c.Data=a},a.prototype.getNext=function(a){var b=this.map[a];return b?b.Next.Data:void 0},a.prototype.getPrevious=function(a){var b=this.map[a];return b?b.Previous.Data:void 0},a.prototype.insertBefore=function(a,b){var c=this.getIdFromData(a);if(this.map[c])throw Error("Data with duplicate id: "+c);this.insertItemBefore({Data:a},this.map[b])},a.prototype.insertAfter=function(a,b){var c=this.getIdFromData(a);if(this.map[c])throw Error("Data with duplicate id: "+c);this.insertItemAfter({Data:a},this.map[b])},a.prototype.moveBefore=function(a,b){if(a!==b){var c=this.removeItemById(a);c&&this.insertItemBefore(c,this.map[b])}},a.prototype.moveAfter=function(a,b){if(a!==b){var c=this.removeItemById(a);c&&this.insertItemAfter(c,this.map[b])}},a.prototype.removeById=function(a){var b=this.removeItemById(a);return b&&b.Data},a.prototype.setItems=function(a){var b=this;this.count=0,this.map={},this.head={},this.head.Next=this.head.Previous=this.head,a.forEach(function(a){return b.insertItemBefore({Data:a},b.head)})},a.prototype.getIdFromData=function(a){throw Error("to be overridden.")},a.prototype.insertItemBefore=function(a,b){b=b||this.head,a.Next=b,a.Previous=b.Previous,b.Previous.Next=a,b.Previous=a,this.map[this.getIdFromData(a.Data)]=a,++this.count},a.prototype.insertItemAfter=function(a,b){b=b||this.head,a.Previous=b,a.Next=b.Next,b.Next.Previous=a,b.Next=a,this.map[this.getIdFromData(a.Data)]=a,++this.count},a.prototype.removeItemById=function(a){var b=this.map[a];return b?(b.Next.Previous=b.Previous,b.Previous.Next=b.Next,delete this.map[a],--this.count,b):void 0},a}();a.MappingList=b}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c=function(){function b(){}return Object.defineProperty(b,"LocalizedStrings",{get:function(){return b.localizedStrings},enumerable:!0,configurable:!0}),Object.defineProperty(b,"UniversalHeaderAndFooter",{get:function(){return b.universalHeaderAndFooter},enumerable:!0,configurable:!0}),b.loadLocalizedStrings=function(){return b.deferredLocalizedStrings||(b.deferredLocalizedStrings=$.Deferred(),a.PageMethods.getResourceStrings(function(a){b.localizedStrings=a,b.deferredLocalizedStrings.resolve(a)},function(a){return b.deferredLocalizedStrings.reject(a)})),b.deferredLocalizedStrings.promise()},b.loadLanguageStrings=function(c){if(!c)return b.loadLocalizedStrings();var d=b.languageStrings[c];if(!d){var e=$.Deferred();d=e.then(function(a){return b.localizedStrings=a,a}),b.languageStrings[c]=d,a.PageMethods.getLocalizedResourceStrings(c,function(a){return e.resolve(a)},function(a){b.loadLocalizedStrings().done(function(a){return e.resolve(a)})})}return d},b.loadUniversalHeaderAndFooter=function(){var c=this;return b.deferredUniversalHeaderAndFooter||(b.deferredUniversalHeaderAndFooter=$.Deferred(),a.PageMethods.getUniversalHeaderAndFooter("headerId=OfficeFormsHeader&footerid=OfficeFormsFooter",function(a){c.universalHeaderAndFooter=a,b.deferredUniversalHeaderAndFooter.resolve(a)},function(a){return b.deferredUniversalHeaderAndFooter.reject(a)})),b.deferredUniversalHeaderAndFooter.promise()},b.languageStrings={},b}();b.Resources=c,a.Exports.Resources=c}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(a,b){o("TryAcquireToken",void 0,void 0,a,b)}function d(a,b,c){var d="GetResourceStrings",e=void 0;a&&(e="lang="+a),o(d,e,void 0,b,c)}function e(b,c){var e=a.EnvironmentConfig.getExplictLocale();return d(e,b,c)}function f(a,b){o("GetRefreshedAntiForgeryToken",void 0,void 0,function(b){OfficeFormServerInfo.antiForgeryToken=b,a&&a()},b)}function g(a,b){o("GetUserInfo",void 0,void 0,function(b){OfficeFormServerInfo.userInfo=b,a&&a()},b)}function h(){return n("GetFormTemplates",void 0,void 0,void 0)}function i(){return n("GetMSATemplates",void 0,void 0,void 0)}function j(){return n("GetThemes",void 0,void 0,void 0)}function k(a){return n("GetUserInfo",void 0,void 0,m(a)).then(function(a){a&&(OfficeFormServerInfo.userInfo=a)})}function l(a){return n("GetFlights",void 0,void 0,m(a)).then(function(a){a&&(OfficeFormServerInfo.flights=a)})}function m(a){return{Accept:"application/json",Authorization:a?"Bearer "+a:""}}function n(b,c,d,e){var f;f="/"===window.location.pathname?"/Default.aspx/"+b:window.location.pathname+"/"+b,c&&(f+="?"+c);var g=new a.Event.QosEventDeprecated(a.Event.QosEventNames.ServiceEndpoints.PageMethod.MethodNameFormat.format(b));return g.start(),$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:f,data:d||"{}",dataType:"json",headers:e}).then(function(a){return g.end({resultType:"Success"}),a.d},function(a,c,d){return g.end({resultType:"Failure",extraData:{url:f,message:d}}),{message:d,name:"PageMethod CallWebMethod Failure: "+b}})}function o(a,b,c,d,e){n(a,b,c,void 0).done(d).fail(e)}function p(b,c,d){var e=a.EnvironmentConfig.getExplictLocale()||navigator.language,f="https://uhf.microsoft.com/"+e+"/shell/xml/OfficeForms";b&&(f+="?"+b),$.ajax({type:"GET",url:f,dataType:"xml",success:function(a){c&&c(a)},error:function(b){d&&d(b),a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.Error.UHF.UniversalHeaderAndFooterError,extraData:{error:b}})}})}a.Exports.PageMethods=b,b.tryAcquireToken=c,b.getLocalizedResourceStrings=d,b.getResourceStrings=e,b.refreshAntiForgeryToken=f,b.refreshUserInfo=g,b.getFormTemplates=h,b.getMSATemplates=i,b.getThemes=j,b.refreshUserInfoWithToken=k,b.refreshFlightsWithToken=l,b.getUniversalHeaderAndFooter=p}(b=a.PageMethods||(a.PageMethods={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){function b(a,b,c){c&&c.stack&&console.log(c.stack);try{if(window.onerror){var d=ReactDOM.findDOMNode(a),e=d&&d.getAttribute("data-reactId")||"",f="Exception in "+a.constructor.name+"["+e+"]:"+b+".";c.message&&(f+=" Message: "+c.message),window.onerror(f,"",0,0,c)}}catch(c){}}function c(a){e.forEach(function(c){var d=a[c];d&&(a[c]=function(){try{return d.apply(a,arguments)}catch(e){return b(a,c,e),null}})})}var d=function(a){function b(b){var d=a.call(this,b)||this;return d.state={},c(d),d}return __extends(b,a),b}(React.Component);a.ReactComponent=d;var e=["componentWillMount","componentDidMount","componentWillReceiveProps","shouldComponentUpdate","componentWillUpdate","componentDidUpdate","componentWillUnmount","render"];if(!React.DOM){var f={a:null,b:null,button:null,div:null,iframe:null,img:null,input:null,label:null,li:null,ol:null,option:null,p:null,select:null,span:null,table:null,textarea:null,ul:null},g=function(a){f.hasOwnProperty(a)&&(f[a]=function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];return React.createElement.apply(React,[a].concat(b))})};for(var h in f)g(h);React.DOM=f}}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b=function(){function a(){}return a.getId=function(b){return a.currentIds[b]||(a.currentIds[b]=1),b+a.currentIds[b]++},a.getLabelId=function(){return a.getId("l")},a.getDropdownId=function(){return a.getId("Dropdown")},a.currentIds={},a}();a.UniqueIdentifier=b}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){function b(){return c||(c=new d)}var c;a.getUserRepository=b;var d=function(){function b(){this.userStateChangeCallbackManager=new a.Utilities.Process.CallbackManager,this.users={}}return b.prototype.registerUsersStateChange=function(a){this.userStateChangeCallbackManager.register(a)},b.prototype.unregisterUsersStateChange=function(a){this.userStateChangeCallbackManager.unregister(a)},b.prototype.getUser=function(a){return _.clone(this.users[a])},b.prototype.getAllUsers=function(){return _.values(a.Utilities.deepClone(this.users))},b.prototype.getUserCount=function(){return _.keys(this.users).length},b.prototype.addOrUpdateUser=function(a){if(b.isValidUser(a)){var c=this.users[a.userId];if(null!=c){if(b.isValidUser(c))return;_.extend(c,a)}else this.users[a.userId]=a;this.userStateChangeCallbackManager.trigger()}},b.prototype.removeUser=function(a){delete this.users[a.userId]&&this.userStateChangeCallbackManager.trigger()},b.prototype.removeAllUsers=function(){this.getUserCount()>0&&(this.users={},this.userStateChangeCallbackManager.trigger())},b.isValidUser=function(a){return a&&a.userId&&a.displayName&&a.firstName&&a.lastName&&a.email&&a.imageUri?!0:!1},b}();a.UserRepository=d}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(a){return React.createElement(e,__assign({},a))}var d;!function(a){a[a.Bar=0]="Bar",a[a.Pie=1]="Pie"}(d=b.ChartType||(b.ChartType={})),b.createChartControl=c;var e=function(c){function e(){var a=null!==c&&c.apply(this,arguments)||this;return a.backgroundColors=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],a.highlightColors=[],a}return __extends(e,c),e.prototype.render=function(){return this.isValidChart()?React.createElement("div",{"aria-label":a.Form.Resources.LocalizedStrings.ChartControl_GroupContainer,className:"chart-control-container",tabIndex:-1},this.createChartLegend(),this.createChartCanvas()):null},e.prototype.componentDidMount=function(){this.updateChartDataView()},e.prototype.shouldComponentUpdate=function(a){return!_.isEqual(this.props,a)||!this.wasChartVisible},e.prototype.componentDidUpdate=function(){this.updateChartDataView()},e.prototype.componentWillUnmount=function(){this.destroyChart()},e.prototype.isValidChart=function(){return this.props.Labels&&this.props.Data&&this.props.Labels.length===this.props.Data.data.length&&this.props.Labels.length>0},e.prototype.destroyChart=function(){this.chartInstance&&(this.chartInstance.destroy(),this.chartInstance=null)},e.prototype.updateChartDataView=function(){if(this.isValidChart()){var a=ReactDOM.findDOMNode(this.refs.canvas);if(this.wasChartVisible=$(a).is(":visible"),this.wasChartVisible){var b=a.getContext("2d");switch(this.generateColors(),this.props.Type){case d.Bar:this.createBarChart(b),this.setChartLegend();break;case d.Pie:this.createPieChart(b),this.setChartLegend()}}}},e.prototype.getChartCanvasLabels=function(){return this.props.Labels?this.props.Labels.map(function(c,d){return null!=c.labelName?b.RichTextUtil.stripSupportedTagsButLeaveDangerousOnes(c.labelName):a.Form.Resources.LocalizedStrings.Designer_Choices_DefaultDescription.format(d+1)}):void 0},e.prototype.createBarChart=function(a){var b="'wf_segoe-ui_light', 'Segoe UI Light','Segoe WP Light','Segoe UI','Segoe WP',Tahoma, Arial, sans-serif",c={responsive:!1,layout:{padding:{left:10}},animation:{duration:1e3},scales:{yAxes:[{ticks:{fontSize:10,min:0,fontFamily:b,fontColor:"#000000",callback:function(a){return a%1===0?a:void 0}}}],xAxes:[{ticks:{fontSize:10,fontFamily:b,fontColor:"#000000",callback:function(){return""}}}]},legend:{display:!1}};this.destroyChart(),this.chartInstance=new Chart(a,{type:"bar",data:this.generateChartData(),options:c})},e.prototype.generateColors=function(){var a=this;this.usingColors=this.props.Data.data.map(function(b,c){var d=a.backgroundColors[c%a.backgroundColors.length];return a.highlightColors.push(a.lightenDarkenColor(d,10)),d})},e.prototype.generateChartData=function(){var a={labels:this.getChartCanvasLabels(),datasets:[{backgroundColor:this.usingColors,data:this.props.Data.data,hoverBackgroundColor:this.highlightColors}]};return a},e.prototype.createPieChart=function(a){var b={responsive:!1,animation:{duration:1e3},cutoutPercentage:0,tooltips:{callbacks:{label:function(a,b){return b.labels[a.index]+": "+b.datasets[a.datasetIndex].data[a.index]+" ("+Math.round(this._active[0]._view.circumference/6.283*100)+"%)"}}},legend:{display:!1}};this.destroyChart(),this.chartInstance=new Chart(a,{type:"pie",data:this.generateChartData(),options:b})},e.prototype.lightenDarkenColor=function(a,b){var c=parseInt(a.slice(1),16),d=Math.round(2.55*b),e=(c>>16)+d,f=(c>>8&255)+d,g=(255&c)+d;return"#"+(16777216+65536*(255>e?1>e?0:e:255)+256*(255>f?1>f?0:f:255)+(255>g?1>g?0:g:255)).toString(16).slice(1)},e.prototype.setChartLegend=function(){var a=this;if(this.props.HasLegend){var b=ReactDOM.findDOMNode(this.refs["legend-table"]),c=ReactDOM.findDOMNode(this.refs["legend-table-tbody"]),d=c.childNodes;d&&d.length>0&&(_.each(d,function(b,c){Chart.helpers.addEvent(b,"mouseover",function(){a.handleEvent("mouseover",c)});var d=b.getElementsByClassName("chart-control-legend-canvas-color");if(d){var e=d[0].getContext("2d");e.fillStyle=a.chartInstance.data.datasets[0].backgroundColor[c],e.beginPath(),e.arc(7.5,7.5,7.5,0,2*Math.PI,!0),e.closePath(),e.fill()}}),Chart.helpers.addEvent(b,"mouseout",function(){a.handleEvent("mouseout",0)}))}},e.prototype.handleEvent=function(a,b){this.chartInstance.active="mouseout"===a?[]:[this.chartInstance.getDatasetMeta(0).data[b]],this.chartInstance.lastActive=this.chartInstance.lastActive||[],this.chartInstance.lastActive.length&&this.chartInstance.updateHoverStyle(this.chartInstance.lastActive,this.chartInstance.options.hover.mode,!1),this.chartInstance.active.length&&this.chartInstance.updateHoverStyle(this.chartInstance.active,this.chartInstance.options.hover.mode,!0);var c=!Chart.helpers.arrayEquals(this.chartInstance.active,this.chartInstance.lastActive);if(c){this.chartInstance.lastActive=this.chartInstance.active;var d=this.chartInstance.tooltip;d._active=this.chartInstance.active,d._lastActive=d._lastActive||[],d.update(!0),d.pivot();var e=this.chartInstance._bufferedRequest;e?this.chartInstance.render(e.duration,e.lazy):c&&!this.chartInstance.animating&&(this.chartInstance.stop(),this.chartInstance.render(this.chartInstance.options.hover.animationDuration,!0)),this.chartInstance._bufferedRender=!1,this.chartInstance._bufferedRequest=null}},e.prototype.createChartLegend=function(){var c=this;return this.props.HasLegend?React.createElement("div",{"aria-label":a.Form.Resources.LocalizedStrings.ChartControl_LegendGroup,className:"chart-control-legend",tabIndex:-1},React.createElement("table",{className:"chart-control-legend-table",ref:"legend-table"},React.createElement("tbody",{ref:"legend-table-tbody"},this.props.Labels.map(function(a,d){return React.createElement("tr",{className:"chart-control-legend-table-row",key:d},React.createElement("td",{role:"presentation"},React.createElement("canvas",{role:"presentation",className:"chart-control-legend-canvas-color",width:"15px",height:"15px"})),React.createElement("td",{role:"presentation",className:"chart-control-legend-label"},null!=a.displayElement?a.displayElement:React.createElement(b.UserTextRenderer,{Text:a.labelName,RenderMode:b.UserTextRenderMode.RichText})),React.createElement("td",{role:"presentation",className:"chart-control-legend-value"},c.props.Data.data[d]),c.getLegendCorrectTag(a.labelName))})))):void 0},e.prototype.createChartCanvas=function(){var b,c={className:"chart-control",tabIndex:-1,"aria-label":a.Form.Resources.LocalizedStrings.ChartControl_ChartGroup},e=a.Utilities.Html.getWindowWidth()<400||a.Utilities.isMobile(),f=e?187:250,g=e?300:400;return b=this.props.Type===d.Bar?{role:"presentation",className:"chart-control-canvas",width:g,height:f,ref:"canvas"}:{role:"presentation",className:"",width:300,height:150,ref:"canvas"},React.createElement("div",__assign({},c),React.createElement("canvas",__assign({},b)))},e.prototype.getLegendCorrectTag=function(c){var d,e={role:"presentation",className:"chart-control-legend-table-correct",title:this.props.TagLabels[c]?a.Form.Resources.LocalizedStrings.Quiz_CorrectAnswer:void 0};return this.props.TagLabels[c]&&(d=React.createElement(b.FontIconControl,{IconName:"CheckMark",HTMLAttributes:{className:"forms-icon-size14x14"}})),React.createElement("td",__assign({},e),d)},e}(a.ReactComponent);b.ChartControl=e}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.render=function(){var b,c=_.extend({},this.props.HTMLAttributes);return this.props.ValidationStyle&&(c.className=a.Utilities.Html.combineAttributes(c.className,this.props.ValidationStyle)),this.props.Hidden&&(c.style=c.style||{},c.style.display="none"),(b=React.DOM).div.apply(b,[c].concat(this.createReactNodes()))},c.prototype.createReactNodes=function(){throw Error("to be overridden.")},c}(a.ReactComponent);b.ControlBase=c}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(a){return React.createElement(d,a)}b.createCheckBox=c;var d=function(c){function d(){return null!==c&&c.apply(this,arguments)||this}return __extends(d,c),d.prototype.createReactNodes=function(){var c=this.props,d=c.RadioCheckbox?"radio":"checkbox",e=c.Options,f=e&&e.classNameForInnerDiv,g=a.Utilities.Html.combineAttributes(d,e&&e.classNameForInnerLabel),h=c.Disabled,i=c.HelpText||void 0,j=a.Utilities.Html.mergeReactProps(e&&e.HTMLPropsForInnerElement,{checked:c.Value,disabled:h,type:d,onChange:this.onChange.bind(this),className:this.props.ClassName,ref:this.props.CheckboxRef,autoFocus:c.CheckboxAutoFocus}),k=([].concat(c.children),React.DOM.div({className:g},React.DOM.label({disabled:h},React.DOM.input(j),React.DOM.span({className:this.props.SpanClassName},c.Description),c.ShowRequiredStar?React.createElement(b.RequiredStar):void 0)));return[React.DOM.div({className:f,id:c.Id,disabled:h,title:i},k,c.children)]},d.prototype.onChange=function(a){this.props.onValueChange(a.nativeEvent.target.checked)},d}(b.ControlBase)}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c=function(){function a(){}return Object.defineProperty(a,"None",{get:function(){return""},enumerable:!0,configurable:!0}),Object.defineProperty(a,"Success",{get:function(){return"has-success"},enumerable:!0,configurable:!0}),Object.defineProperty(a,"Warning",{get:function(){return"has-warning"},enumerable:!0,configurable:!0}),Object.defineProperty(a,"Error",{get:function(){return"has-error"},enumerable:!0,configurable:!0}),a}();b.ValidationStyles=c;var d=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.render=function(){return React.DOM.span({className:"required-star"})},b}(a.ReactComponent);b.RequiredStar=d}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){
var b;!function(b){a.Exports.Control=b}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(a){return React.createElement(e,a)}var d;!function(a){a[a.DatePicker=0]="DatePicker",a[a.TimePicker=1]="TimePicker",a[a.DateTimePicker=2]="DateTimePicker"}(d=b.PickerType||(b.PickerType={})),b.createDateTimePicker=c;var e=function(c){function e(){return null!==c&&c.apply(this,arguments)||this}return __extends(e,c),e.prototype.createReactNodes=function(){var a=this.props,b=a.Options,c=b&&b.classNameForInnerDiv,d=b&&b.classNameForInnerLabel,e=a.Disabled;return[a.Label?React.DOM.span({className:d,disabled:e},a.Label):void 0,React.DOM.div({className:c,disabled:e},this.hasDatePicker()?this.createDatePicker():void 0,this.hasTimePicker()?this.createTimePicker():void 0,a.children)]},e.prototype.componentWillMount=function(){void 0===e.timeFormat&&this.hasTimePicker()&&(e.timeFormat=OfficeFormServerInfo.cultureInfo.DateTimeFormat.ShortTimePattern,e.timeFormat=e.timeFormat.replace(/mm/g,"i").replace(/tt/g,"A").replace(/s/g,"0"),(e.timeFormat.indexOf("m")>=0||e.timeFormat.indexOf("t")>=0)&&(e.timeFormat=null))},e.prototype.componentDidMount=function(){var b=this,c=a.Form.Resources.LocalizedStrings;if(this.hasDatePicker()){var d=ReactDOM.findDOMNode(this.refs.date_picker),f=$(d).pickadate({monthsShort:OfficeFormServerInfo.cultureInfo.DateTimeFormat.AbbreviatedMonthNames,weekdaysShort:OfficeFormServerInfo.cultureInfo.DateTimeFormat.AbbreviatedDayNames,firstDay:OfficeFormServerInfo.cultureInfo.DateTimeFormat.FirstDayOfWeek,today:c.DateTimePicker_Button_Today||void 0,clear:this.props.ShowClearButton?c.DateTimePicker_Button_Clear||void 0:"",close:c.DateTimePicker_Button_Close||void 0,labelMonthNext:c.DateTimePicker_Label_NextMonth||void 0,labelMonthPrev:c.DateTimePicker_Label_PrevMonth||void 0,labelMonthSelect:c.DateTimePicker_Label_SelectMonth||void 0,labelYearSelect:c.DateTimePicker_Label_SelectYear||void 0,closeOnClear:!1,editable:!0,selectYears:200,selectMonths:!1,showMonthsShort:!0,onSet:function(c){if(void 0!==c.clear)return void b.setDate(void 0);if(null!=c.select){var d;d=a.Utilities.Type.isNumber(c.select)?new Date(c.select):c.select.obj,b.setDate(d)}}});this.datePicker=f.pickadate("picker")}if(this.hasTimePicker()){var g=ReactDOM.findDOMNode(this.refs.time_picker),h=$(g).pickatime({clear:"",format:e.timeFormat,editable:!0,interval:30,select:this.getTimeNumber(),onSet:function(c){if(null!=c.select){var d;if(b.hasDatePicker()){var e,f,g=new Date(b.props.Value);a.Utilities.Type.isNumber(c.select)?(e=c.select%60,f=(c.select-e)/60):(f=c.select.hour,e=c.select.mins),g.setHours(f,e,0,0),d=g.toJSON()}else d=c.select.toString();b.props.Value!==d&&(b.props.onValueChange(d),b.forceUpdate())}}});this.timePicker=h.pickatime("picker")}this.updateDateTimePickers()},e.prototype.componentDidUpdate=function(){this.updateDateTimePickers()},e.prototype.createDatePicker=function(){var c=this,d=this.props,e=d.Options&&d.Options.HTMLPropsForInnerElement;return React.DOM.div({className:"office-form-date-time-picker office-form-theme-focus-border"},React.DOM.input(a.Utilities.Html.mergeReactProps(e,{className:"form-control border-no-radius datepicker",disabled:d.Disabled,placeholder:d.Placeholder||OfficeFormServerInfo.cultureInfo.DateTimeFormat.ShortDatePattern,ref:"date_input",onFocus:function(){d.onValueValidation&&d.onValueValidation(!0,!0)},onBlur:function(){var a=ReactDOM.findDOMNode(c.refs.date_input),b=a.value,d=c.props;if(""===b&&null!=d.Value&&d.ShowClearButton)c.datePicker.clear(),c.setDate(void 0);else if(b&&b!==c.getDateString()){var e=Date.parseDate(b,OfficeFormServerInfo.cultureInfo.DateTimeFormat.ShortDatePattern,OfficeFormServerInfo.cultureInfo);null==e?d.onValueValidation&&d.onValueValidation(!1,!0):c.setDate(e)}},onClick:function(){d.Disabled||c.datePicker.open()},onKeyUp:a.Utilities.Html.onKeyboardEvent(function(a){return a.stopPropagation()},a.KeyCode.Esc)})),b.createGlyphButton({ButtonStyle:"LightBackground",GlyphButtonStyle:b.GlyphButtonStyle.GlyphOnly,Icon:"Calendar",IconClassName:"dateIcon forms-icon-size20x20",HTMLAttributes:{disabled:d.Disabled,tabIndex:-1,onClick:function(){d.Disabled||c.datePicker.open()},title:d.DateTitle,"aria-label":d.DateTitle}}),React.DOM.input({ref:"date_picker",style:{display:"none"}}))},e.prototype.createTimePicker=function(){var c=this,d=this.props;return React.DOM.div({className:"office-form-date-time-picker office-form-theme-focus-border"},React.DOM.input({className:"form-control border-no-radius datepicker",disabled:d.Disabled,placeholder:OfficeFormServerInfo.cultureInfo.DateTimeFormat.ShortTimePattern,readOnly:!0,tabIndex:-1,ref:"time_picker",onFocus:function(){d.onValueValidation&&d.onValueValidation(!0,!1)},onBlur:function(){var a=ReactDOM.findDOMNode(c.refs.time_picker),b=a.value;if(b&&b!==c.getTimeString()){var d=c.props,e=void 0;e=c.hasDatePicker()?new Date(d.Value):new Date;var f=Date.parseTime(b,OfficeFormServerInfo.cultureInfo.DateTimeFormat.ShortTimePattern,OfficeFormServerInfo.cultureInfo);if(isNaN(f))d.onValueValidation&&d.onValueValidation(!1,!1);else{var g=Math.floor(f/1e3/60/60),h=f/1e3/60%60,i=f/1e3%60;e.setHours(g,h,i),c.setDate(e,!0)}}},onKeyUp:a.Utilities.Html.onKeyboardEvent(function(a){return a.stopPropagation()},a.KeyCode.Esc)}),b.createGlyphButton({ButtonStyle:"LightBackground",GlyphButtonStyle:b.GlyphButtonStyle.GlyphOnly,Icon:"ChevronDown",IconClassName:"dateCaretDown forms-icon-size16x16",HTMLAttributes:a.Utilities.Html.mergeReactProps(d.Options&&d.Options.HTMLPropsForInnerElement,{disabled:d.Disabled,onClick:function(){d.Disabled||c.timePicker.open()},title:d.TimeTitle,"aria-label":d.TimeTitle})}))},e.prototype.hasDatePicker=function(){return this.props.Type!==d.TimePicker},e.prototype.hasTimePicker=function(){return this.props.Type!==d.DatePicker},e.prototype.isValueInvalid=function(){var a=this.props.Value;return this.hasDatePicker()?isNaN(Date.parse(a)):isNaN(Number(a))},e.prototype.getDateNumber=function(){if(!this.hasDatePicker()||this.isValueInvalid())return void 0;if(this.props.IsLocaleInvariant){var a=e.parseLocaleInvariantString(this.props.Value);return a.valueOf()}return Date.parse(this.props.Value)},e.prototype.getDateString=function(){if(!this.hasDatePicker())return void 0;if(this.isValueInvalid())return"";var a=this.props.IsLocaleInvariant?Date.parseDate(this.props.Value,"yyyy-MM-dd",OfficeFormServerInfo.cultureInfo):new Date(this.props.Value);return a.toDateShortString(OfficeFormServerInfo.cultureInfo)},e.prototype.getTimeNumber=function(){if(!this.hasTimePicker()||this.isValueInvalid())return void 0;if(this.hasDatePicker()){var a=new Date(this.props.Value);return 60*a.getHours()+a.getMinutes()}return parseInt(this.props.Value)},e.prototype.getTimeString=function(){if(!this.hasTimePicker())return void 0;if(this.isValueInvalid())return"";var a=new Date(this.props.Value);return a.toLocaleTimeString(OfficeFormServerInfo.cultureInfo.Name)},e.prototype.setDate=function(a,b){var c=this.props,d=void 0;if(null!=a){var f=new Date(c.Value);f.setFullYear(a.getFullYear(),a.getMonth(),a.getDate()),b&&f.setHours(a.getHours(),a.getMinutes(),a.getSeconds()),d=c.IsLocaleInvariant?e.formatLocaleInvariantString(f,!this.hasTimePicker()):f.toJSON()}c.Value!==d&&(c.onValueChange(d),this.forceUpdate())},e.prototype.updateDateTimePickers=function(){var b=this.props,c=new Date(b.Value),d={Start:void 0,End:void 0},e=!1,f=!1;if(b.AllowedDateTime&&(b.AllowedDateTime.Start&&(d.Start=new Date(b.AllowedDateTime.Start.toJSON()),d.Start.setMinutes(60,0,0),e=a.Utilities.DateTime.isLocalDateEqual(d.Start,c),a.Utilities.DateTime.compareLocalTime(d.Start,c)>0&&d.Start.setDate(d.Start.getDate()+1)),b.AllowedDateTime.End&&(d.End=new Date(b.AllowedDateTime.End.toJSON()),d.End.setMinutes(0,0,0),f=a.Utilities.DateTime.isLocalDateEqual(d.End,c),a.Utilities.DateTime.compareLocalTime(d.End,c)<0&&d.End.setDate(d.End.getDate()-1))),this.hasDatePicker()){this.datePicker.set({min:void 0!==d.Start&&d.Start,max:void 0!==d.End&&d.End,select:this.getDateNumber()});var g=ReactDOM.findDOMNode(this.refs.date_input);g.value=this.getDateString()}this.hasTimePicker()&&this.timePicker.set({min:e&&d.Start,max:f&&d.End,select:this.getTimeNumber()})},e.formatLocaleInvariantString=function(a,b){var c=new Date;c.setUTCFullYear(a.getFullYear(),a.getMonth(),a.getDate()),c.setUTCHours(a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds());var d=c.toISOString();return d.slice(0,d.indexOf(b?"T":"Z"))},e.parseLocaleInvariantString=function(a){var b=new Date(a);return b.setFullYear(b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate()),b.setHours(b.getUTCHours(),b.getUTCMinutes(),b.getUTCSeconds(),b.getUTCMilliseconds()),b},e.parseJSONArray=function(a){try{var b=JSON.parse(a);if(Array.isArray(b))return b}catch(c){}return void 0},e}(b.ControlBase)}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(a){return React.createElement(d,__assign({},a))}b.createFontIconControl=c;var d=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.render=function(){var b=_.clone(this.props.HTMLAttributes)||{};return b.className=a.Utilities.Html.combineAttributes("ms-Icon",this.props.IconName?"ms-Icon--"+this.props.IconName:"",b.className),this.props.Accessible||(b.role="presentation",b["aria-hidden"]="true"),React.createElement("i",__assign({},b))},c}(a.ReactComponent);b.FontIconControl=d}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){function b(b){return a.createMathjaxFormulaRenderer(b)}a.createFormulaRenderer=b}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(a){return React.createElement(d,__assign({},a))}b.createMathjaxFormulaRenderer=c;var d=function(b){function c(){var a=null!==b&&b.apply(this,arguments)||this;return a.mounted=!0,a}return __extends(c,b),c.prototype.componentWillMount=function(){var b=this;a.JavaScriptLoader.loadJavaScript("MathJax").done(function(){b.mounted&&b.setState({MathJaxLoaded:!0}),MathJax.Hub.processSectionDelay=2})},c.prototype.componentDidMount=function(){this.state.MathJaxLoaded&&this.props.Formula&&this.renderFormula()},c.prototype.componentDidUpdate=function(){this.state.MathJaxLoaded&&this.props.Formula&&this.renderFormula()},c.prototype.componentWillUnmount=function(){this.mounted=!1},c.prototype.shouldComponentUpdate=function(a,b){return a.Formula!==this.props.Formula||b.MathJaxLoaded!==this.state.MathJaxLoaded},c.prototype.render=function(){if(this.props.Formula){var a="formula-renderer-container unselectable-text";return c.isSafari9&&(a+=" formula-renderer-container-safari9"),React.createElement("div",{className:a,"aria-hidden":"true",onContextMenu:function(){return!1}},React.createElement("div",{className:"formula-loading",ref:"formulaLoading"},React.createElement("div",{className:"spinner-tile-animation"})),React.createElement("span",{className:"NotVisible",ref:"formulaElement"},this.props.Formula?"$"+this.props.Formula+"$":""))}return React.createElement("div",{className:"formula-renderer-container"})},c.prototype.renderFormula=function(){var b=this,c=function(c){var d=ReactDOM.findDOMNode(b.refs.formulaElement);if(!d)return void(c&&c());var f=b.props.Formula,g=e.get(f);return g?(b.hideSpinnerAndShowFormula(d),d.innerHTML=g.dom,b.props.onRenderComplete&&b.props.onRenderComplete(g.originalText,g.mathML),void(c&&c())):(MathJax.Hub.Queue(["Typeset",MathJax.Hub,d]),void MathJax.Hub.Queue(function(){if(b.mounted){b.hideSpinnerAndShowFormula(d);var g=MathJax.Hub.getAllJax(d),h=null,i=null;if(g.length>0)try{h=g[0].root.toMathML(""),i=g[0].originalText}catch(j){a.Utilities.assert(!1,"Failed to get mathML:"+f)}e.set(f,{dom:d.innerHTML,originalText:i,mathML:h}),b.props.onRenderComplete&&b.props.onRenderComplete(i,h)}c&&c()}))};e.get(this.props.Formula)?c(null):f.enqueue(this.props.Formula,c)},c.prototype.hideSpinnerAndShowFormula=function(a){var b=ReactDOM.findDOMNode(this.refs.formulaLoading);b&&(b.className="dn"),a.className=""},c.isSafari9=a.Utilities.isSafari9(),c}(a.ReactComponent);b.MathjaxFormulaRenderer=d;var e=function(){function a(){}return a.set=function(b,c){if(b&&!a.cache[b]&&(a.order.push(b),a.cache[b]=c,a.order.length>a.cacheLimit)){var d=a.order.shift();delete a.cache[d]}},a.get=function(b){return b?a.cache[b]:null},a.cacheLimit=200,a.cache={},a.order=[],a}(),f=function(){function b(){}return b.enqueue=function(a,c){b.priorityMap[a]?(b.priorityMap[a].count++,b.internalEnqueue({key:a,priority:b.priorityMap[a].priority,task:c})):(b.currentPriority++,b.priorityMap[a]={priority:b.currentPriority,count:1},b.internalEnqueue({key:a,priority:b.currentPriority,task:c}))},b.internalEnqueue=function(a){b.queue.push(a),b.bubbleUp(b.queue.length-1),b.isProcessing||b.process()},b.process=function(){b.isProcessing=!0,b.queue[0].task(b.onRenderComplete)},b.onRenderComplete=function(){var c=b.queue.shift().key;b.priorityMap[c].count--,0===b.priorityMap[c].count&&delete b.priorityMap[c],b.queue.length>0?b.process():(a.Utilities.assert(_.isEqual(b.priorityMap,{}),"FormulaRenderQueue: priority map should be empty"),b.isProcessing=!1,b.currentPriority=0)},b.bubbleUp=function(a){for(var c=b.getParent(a);c>=0&&b.queue[c].priority>b.queue[a].priority;)b.swap(c,a),a=c,c=b.getParent(a)},b.swap=function(a,c){var d=b.queue[a];b.queue[a]=b.queue[c],b.queue[c]=d},b.getParent=function(a){return Math.floor((a-1)/2)},b.queue=[],b.priorityMap={},b.currentPriority=0,b.isProcessing=!1,b}()}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(c){var f=_.clone(c)||{};switch(f.HTMLAttributes=_.clone(f.HTMLAttributes)||{},c.GlyphButtonStyle){case d.Vertical:case"Vertical":f.HTMLAttributes.className=a.Utilities.Html.combineAttributes(f.HTMLAttributes.className,"glyph-button-control-vertical");break;case d.GlyphOnly:case"GlyphOnly":case d.Horizontal:case"Horizontal":default:f.HTMLAttributes.className=a.Utilities.Html.combineAttributes(f.HTMLAttributes.className,"glyph-button-control-horizontal")}!f.HTMLAttributes.title&&c.Text&&(f.HTMLAttributes.title=c.Text),!f.HTMLAttributes["aria-label"]&&c.Text&&(f.HTMLAttributes["aria-label"]=c.Text);var g;if(c.Icon){var h={HTMLAttributes:{className:c.IconClassName},IconName:c.Icon,key:"icon"};g=React.createElement(b.FontIconControl,__assign({},h))}f.ButtonStyle=c.ButtonStyle;var i;switch("GlyphOnly"!==c.GlyphButtonStyle&&c.GlyphButtonStyle!==d.GlyphOnly&&(i=React.DOM.span({className:c.TextClassName,key:"text"},c.Text)),c.GlyphLocation){case e.Right:case"Right":f.children=[i,c.children,g];break;case e.Left:default:f.children=[g,i,c.children]}return Forms.UX.Controls.createButton(f)}var d;!function(a){a[a.Horizontal=0]="Horizontal",a[a.Vertical=1]="Vertical",a[a.GlyphOnly=2]="GlyphOnly"}(d=b.GlyphButtonStyle||(b.GlyphButtonStyle={}));var e;!function(a){a[a.Left=0]="Left",a[a.Right=1]="Right"}(e=b.GlyphLocation||(b.GlyphLocation={})),b.createGlyphButton=c}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(a){a[a.Bar=0]="Bar",a[a.Pie=1]="Pie",a[a.PieMainOthers=2]="PieMainOthers"}(c=b.InsightChartType||(b.InsightChartType={}));var d=function(b){function d(){var a=null!==b&&b.apply(this,arguments)||this;return a.backgroundColors=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],a.highlightColors=[],a}return __extends(d,b),d.prototype.render=function(){if(this.isValidChart()){var a={className:"insight-chart-control-container",tabIndex:-1};return React.createElement("div",__assign({},a),this.createChartCanvas())}return null},d.prototype.componentDidMount=function(){this.updateChartDataView()},d.prototype.shouldComponentUpdate=function(a){return!_.isEqual(this.props,a)||!this.wasChartVisible},d.prototype.componentDidUpdate=function(){this.updateChartDataView()},d.prototype.componentWillUnmount=function(){this.destroyChart()},d.prototype.isValidChart=function(){return this.props.Labels&&this.props.DataSets&&this.props.Labels.length>0},d.prototype.destroyChart=function(){this.chartInstance&&(this.chartInstance.destroy(),this.chartInstance=null)},d.prototype.updateChartDataView=function(){if(this.isValidChart()){var a=ReactDOM.findDOMNode(this.refs.canvas);if(this.wasChartVisible=$(a).is(":visible"),this.wasChartVisible){var b=a.getContext("2d");switch(this.props.Type){case c.Bar:this.generateBarColors(),this.createBarChart(b);break;case c.PieMainOthers:case c.Pie:this.generatePieColors(),this.createPieChart(b)}}}},d.prototype.createBarChart=function(a){var b="'wf_segoe-ui_light', 'Segoe UI Light','Segoe WP Light','Segoe UI','Segoe WP',Tahoma, Arial, sans-serif",c={responsive:!1,layout:{padding:{left:10}},animation:{duration:1e3},scales:{yAxes:[{ticks:{fontSize:10,min:0,fontFamily:b,fontColor:"#000000"}}],xAxes:[{ticks:{fontSize:10,fontFamily:b,fontColor:"#000000"}}]},legend:{display:!0}};this.destroyChart(),this.chartInstance=new Chart(a,{type:"bar",data:this.generateBarChartData(),options:c})},d.prototype.generateBarColors=function(){var a=this;this.usingColors=this.props.DataSets.map(function(b,c){var d=a.backgroundColors[c%a.backgroundColors.length];return a.highlightColors.push(a.lightenDarkenColor(d,10)),d})},d.prototype.generatePieColors=function(){var a=this;this.props.Type===c.PieMainOthers?(this.usingColors=["#FFC000","#CFCFCF"],this.highlightColors=this.usingColors.map(function(b){return a.lightenDarkenColor(b,10)})):this.usingColors=this.props.Labels.map(function(b,c){var d=a.backgroundColors[c%a.backgroundColors.length];return a.highlightColors.push(a.lightenDarkenColor(d,10)),d})},d.prototype.generateBarChartData=function(){var a=this,b={labels:this.props.Labels,datasets:this.props.DataSets.map(function(b,c){return{label:b.Label,data:b.Data,backgroundColor:a.usingColors[c],hoverBackgroundColor:a.highlightColors[c]}})};return b},d.prototype.generatePieChartData=function(){var a=this,b={labels:this.props.Labels,datasets:this.props.DataSets.map(function(b){return{backgroundColor:a.usingColors,data:b.Data,hoverBackgroundColor:a.highlightColors}})};return b},d.prototype.createPieChart=function(a){var b={responsive:!1,animation:{duration:1e3},cutoutPercentage:0,tooltips:{callbacks:{label:function(a,b){return b.labels[a.index]+": "+b.datasets[a.datasetIndex].data[a.index]+" ("+Math.round(this._active[0]._view.circumference/6.283*100)+"%)"}}},legend:{display:!0,position:"bottom",labels:{boxWidth:15}}};this.destroyChart(),this.chartInstance=new Chart(a,{type:"pie",data:this.generatePieChartData(),options:b})},d.prototype.lightenDarkenColor=function(a,b){var c=parseInt(a.slice(1),16),d=Math.round(2.55*b),e=(c>>16)+d,f=(c>>8&255)+d,g=(255&c)+d;return"#"+(16777216+65536*(255>e?1>e?0:e:255)+256*(255>f?1>f?0:f:255)+(255>g?1>g?0:g:255)).toString(16).slice(1)},d.prototype.createChartCanvas=function(){var b={className:"insight-chart-control",tabIndex:-1},c=a.Utilities.Html.getWindowWidth()<400||a.Utilities.isMobile(),d=c?187:250,e=c?300:400,f={className:"insight-chart-control-canvas",width:e,height:d,ref:"canvas"};return React.createElement("div",__assign({},b),React.createElement("canvas",__assign({},f)))},d}(a.ReactComponent);b.InsightChartControl=d}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(a){function b(a){var b=d(a);return e(b)}function c(a){return f.openingTags.forEach(function(b){a=a.replaceAll(b,"")}),f.closingTags.forEach(function(b){a=a.replaceAll(b,"")}),a}function d(a){var b=_.escape(a);return f.tagNames.forEach(function(a,c){b=b.replaceAll(f.encodedOpeningTags[c],f.openingTags[c]).replaceAll(f.encodedClosingTags[c],f.closingTags[c])}),b}function e(a){var b=document.createElement("span");return b.innerHTML=a,a=b.innerHTML}var f=function(){function a(){}return a.tagNames=["strong","em","u","sup","sub"],a.openingTags=_.map(a.tagNames,function(a){return"<"+a+">"}),a.closingTags=_.map(a.tagNames,function(a){return"</"+a+">"}),a.encodedOpeningTags=_.map(a.tagNames,function(a){return"&lt;"+a+"&gt;"}),a.encodedClosingTags=_.map(a.tagNames,function(a){return"&lt;/"+a+"&gt;"}),a}();a.SupportedTags=f,a.keepOnlyRichTextHtml=b,a.stripSupportedTagsButLeaveDangerousOnes=c,a.escapeHtmlWhilePreservingSupportedTags=d}(b=a.RichTextUtil||(a.RichTextUtil={}))}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(a){return React.createElement(d,__assign({},a))}b.createRichTextControl=c;var d=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}return __extends(c,a),c.prototype.render=function(){var a=this.props,c=b.RichTextUtil.keepOnlyRichTextHtml(a.Html);return React.createElement("span",{dangerouslySetInnerHTML:{__html:c}})},c}(a.ReactComponent);b.RichTextControl=d}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(a){return React.createElement(e,__assign({},a))}var d;!function(a){a[a.PlainText=0]="PlainText",a[a.RichText=1]="RichText"}(d=b.UserTextRenderMode||(b.UserTextRenderMode={})),b.createUserTextRenderer=c;var e=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}return __extends(c,a),c.prototype.render=function(){var a=this.props.RenderMode||d.PlainText;return a===d.RichText?React.createElement(b.RichTextControl,{Html:this.props.Text}):React.createElement("span",null,this.props.Text)},c}(a.ReactComponent);b.UserTextRenderer=e}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){function b(a){return React.createElement(c,a)}a.createLabel=b;var c=function(b){function c(){var a=null!==b&&b.apply(this,arguments)||this;return a.alerting=!1,a}return __extends(c,b),c.prototype.componentDidMount=function(){var a=this;this.alerting||window.setTimeout(function(){a.alerting=!0,a.forceUpdate()})},c.prototype.createReactNodes=function(){var b=this.props,c=b.ShowRequiredStar?React.createElement(a.RequiredStar):void 0,d=b.ShowOrdinal?React.DOM.span({className:"ordinal-number",key:"ordinalNumber"},this.props.Ordinal+"."):void 0;if(!b.Alert||this.alerting)var e=a.createUserTextRenderer({Text:b.Label,RenderMode:a.UserTextRenderMode.RichText});return b.Bold?[React.DOM.b(void 0,d,e,c),b.children]:[d,e,c,b.children]},c}(a.ControlBase);a.Label=c}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(a){return React.createElement(d,__assign({},a))}b.createLikertChartControl=c;var d=function(b){function c(){var a=null!==b&&b.apply(this,arguments)||this;return a.backgroundColors=["#FF7F0E","#FF993E","#FFB26E","#FFCC9F","#FFE5CF","#E5E5E5","#D2E4F0","#A5C9E1","#79ADD2","#4C92C3","#1F77B4"],a}return __extends(c,b),c.prototype.render=function(){if(this.isValidChart()){var b={className:"chart-control-container chart-likert-control-container",tabIndex:-1};return b["aria-label"]=a.Form.Resources.LocalizedStrings.ChartControl_GroupContainer,React.createElement("div",__assign({},b),this.createDetailLegend(),React.createElement("div",{className:"chart-likert-body-control-container"},this.createChartLegend(),this.createChartCanvas()))}return null},c.prototype.componentWillMount=function(){this.initializeChartData()},c.prototype.componentDidMount=function(){this.updateChartDataView()},c.prototype.shouldComponentUpdate=function(a){return!_.isEqual(this.props,a)||!this.wasChartVisible},c.prototype.componentDidUpdate=function(){this.updateChartDataView()},c.prototype.componentWillUnmount=function(){this.destroyChart()},c.prototype.isValidChart=function(){return this.props.Labels&&this.props.Labels.length>0&&this.props.Data&&this.props.Data.length>0},c.prototype.destroyChart=function(){this.chartInstance&&(this.chartInstance.destroy(),this.chartInstance=null)},c.prototype.updateChartDataView=function(){if(this.isValidChart()){var a=ReactDOM.findDOMNode(this.refs.canvas);if(this.wasChartVisible=$(a).is(":visible"),this.wasChartVisible){var b=a.getContext("2d");this.createStackedBarChart(b),this.setChartLegend()}}},c.prototype.generateChartOption=function(){var a=this,b="'wf_segoe-ui_light', 'Segoe UI Light','Segoe WP Light','Segoe UI','Segoe WP',Tahoma, Arial, sans-serif",c={responsive:!1,scales:{xAxes:[{gridLines:{display:!0,drawTicks:!1,drawBorder:!0,zeroLineColor:"#ECECEC",zeroLineWidth:1,zeroLineBorderDash:[5]},ticks:{display:!0,beginAtZero:!0,fontFamily:b,fontSize:12,min:-100,max:100,maxTicksLimit:3,callback:function(a,b,c){return Math.abs(a)+"%"}},stacked:!0}],yAxes:[{barPercentage:.67,categoryPercentage:1,gridLines:{display:!1,drawTicks:!1,drawBorder:!1},ticks:{display:!1},stacked:!0}]},tooltips:{enabled:!1,mode:"nearest",intersect:!0,bodyFontSize:12,bodyFontFamily:b,custom:function(b){var c=a.chartInstance.canvas.parentNode,d=c.getElementsByClassName("chart-custom-tooltip")[0];if(d||(d=document.createElement("div"),d.className="chart-custom-tooltip",d.innerHTML="<table></table>",c.appendChild(d)),0===b.opacity)return void(d.style.opacity="0");if(b.body){var e=b.body.map(function(a){return a.lines});if(e.length>1){var f=e.length/2;a.isOdd&&(e.splice(f,1),b.labelColors.splice(f,1));var g=e.splice(0,f).reverse();g=g.concat(e);var h=b.labelColors.splice(0,f).reverse();h=h.concat(b.labelColors),e=[];var i=[];g.forEach(function(a,b){/\:\s0%$/g.test(a[0])||(e.push(a),i.push(h[b]))}),b.labelColors=i}var j="";e.forEach(function(a,c){var d=b.labelColors[c],e="background:"+d.backgroundColor+";border-color:"+d.borderColor+"; border-width: 2px;",f='<span class="chart-custom-tooltip-box" style="'+e+'"></span>',g='<span class="chart-custom-tooltip-text">'+a+"</span>";j+="<tr><td>"+f+g+"</td></tr>"}),j+="</tbody>";var k=d.querySelector("table");k.innerHTML=j}var l=a.chartInstance.canvas.offsetTop,m=a.chartInstance.canvas.offsetLeft;d.style.opacity="1",d.style.left=m+b.caretX+"px",d.style.top=l+b.caretY+"px",d.style.fontFamily=b._bodyFontFamily,d.style.fontSize=b._bodyFontSize,d.style.fontStyle=b._fontStyle,d.style.padding=b.yPadding+"px "+b.xPadding+"px"},callbacks:{label:function(b,c){var d=c.datasets[b.datasetIndex].label+": ",e=b.xLabel;return a.isOdd&&(0===b.datasetIndex||c.datasets.length/2===b.datasetIndex)&&(e*=2),d+Math.abs(e)+"%"}}},legend:{display:!1}};return c},c.prototype.createStackedBarChart=function(a){var b,c,d=Math.floor(this.chartData.length/2);if(this.chartData.length%2===0){this.isOdd=!1;var e=this.chartData.splice(0,d);e.reverse().forEach(function(a,b){a.data=a.data.map(function(a){return-a})}),(b=this.chartData).splice.apply(b,[0,0].concat(e))}else{this.isOdd=!0;var e=this.chartData.splice(0,d+1);e.reverse(),e[0].data=e[0].data.map(function(a){return a/2});var f=_.clone(e[0]);e.forEach(function(a){a.data=a.data.map(function(a){return-a})}),e.push(f),(c=this.chartData).splice.apply(c,[0,0].concat(e))}var g={labels:this.props.Labels,datasets:this.chartData},h=this.generateChartOption();this.destroyChart(),this.chartInstance=new Chart(a,{type:"horizontalBar",data:g,options:h})},c.prototype.initializeChartData=function(){for(var a=this,b=[],c=function(a){b.push(d.props.Data.reduce(function(b,c){return b+c.data[a]},0))},d=this,e=0;e<this.props.Data[0].data.length;e++)c(e);var f=[[0],[0,10],[0,5,10],[0,2,8,10],[0,2,5,8,10],[0,2,4,6,8,10],[0,2,4,5,6,8,10],[0,2,3,4,6,7,8,10],[0,2,3,4,5,6,7,8,10],[0,1,2,3,4,6,7,8,9,10]];this.usingColors=f[Math.min(this.props.Data.length,f.length)-1].map(function(b){return a.backgroundColors[b]}),this.chartData=this.props.Data.map(function(c,d){var e=c.backgroundColor?c.backgroundColor:a.usingColors[d%a.usingColors.length];return{label:c.label,backgroundColor:e,hoverBackgroundColor:a.lightenDarkenColor(e,10),data:c.data.map(function(a,c){return b[c]?Math.round(1e3*a/b[c])/10:0})}})},c.prototype.lightenDarkenColor=function(a,b){function c(a,b){var c=parseInt(a.slice(1),16),d=Math.round(2.55*b),e=(c>>16)+d,f=(c>>8&255)+d,g=(255&c)+d;return"#"+(16777216+65536*(255>e?1>e?0:e:255)+256*(255>f?1>f?0:f:255)+(255>g?1>g?0:g:255)).toString(16).slice(1)}return _.isArray(a)?a.map(function(a){return c(a,b)}):c(a,b)},c.prototype.setChartLegend=function(){var a=this;if(this.props.HasLegend){var b=ReactDOM.findDOMNode(this.refs["legend-contaner"]),c=b.childNodes;c&&c.length>0&&(_.each(c,function(b,c){Chart.helpers.addEvent(b,"mouseover",function(){a.handleEvent("mouseover",c)})}),Chart.helpers.addEvent(b,"mouseout",function(){a.handleEvent("mouseout",0)}));var d=ReactDOM.findDOMNode(this.refs["stacked-detail-container"]),e=d.getElementsByClassName("chart-control-detail-canvas");e&&e.length>0&&_.each(e,function(b,c){var d=b.getContext("2d");d.fillStyle=a.props.Data[c].backgroundColor?a.props.Data[c].backgroundColor:a.usingColors[c%a.usingColors.length],d.beginPath(),d.fillRect(0,0,8,8),d.closePath(),d.fill()})}},c.prototype.handleEvent=function(a,b){var c=this;"mouseout"===a?this.chartInstance.active=[]:this.chartInstance.active=this.chartInstance.data.datasets.map(function(a,d){return c.chartInstance.getDatasetMeta(d).data[b]}),this.chartInstance.lastActive=this.chartInstance.lastActive||[],this.chartInstance.lastActive.length&&this.chartInstance.updateHoverStyle(this.chartInstance.lastActive,this.chartInstance.options.hover.mode,!1),this.chartInstance.active.length&&this.chartInstance.updateHoverStyle(this.chartInstance.active,this.chartInstance.options.hover.mode,!0);var d=!Chart.helpers.arrayEquals(this.chartInstance.active,this.chartInstance.lastActive);if(d){this.chartInstance.lastActive=this.chartInstance.active;var e=this.chartInstance.tooltip;e._active=this.chartInstance.active,e._lastActive=e._lastActive||[],e.update(!0),e.pivot();var f=this.chartInstance._bufferedRequest;f?this.chartInstance.render(f.duration,f.lazy):d&&!this.chartInstance.animating&&(this.chartInstance.stop(),this.chartInstance.render(this.chartInstance.options.hover.animationDuration,!0)),this.chartInstance._bufferedRender=!1,this.chartInstance._bufferedRequest=null}},c.prototype.createChartLegend=function(){if(this.props.HasLegend){var b={className:"chart-likert-control-legend",tabIndex:-1,ref:"legend-contaner"};b["aria-label"]=a.Form.Resources.LocalizedStrings.ChartControl_LegendGroup;var c=this.props.Labels.map(function(a,b){return React.createElement("div",{className:"chart-likert-control-legend-row",key:b},React.createElement("span",{className:"chart-likert-control-legend-label",title:a.toString()},a))});return React.createElement("div",__assign({},b),c)}},c.prototype.createChartCanvas=function(){var b={className:"chart-likert-control",tabIndex:-1};b["aria-label"]=a.Form.Resources.LocalizedStrings.ChartControl_ChartGroup;var c=a.Utilities.Html.getWindowWidth()<400||a.Utilities.isMobile(),d=c?300:432,e=18+48*this.props.Labels.length;e=c?300*e/350:e;var f={role:"presentation",className:"chart-control-canvas",width:d,height:e,ref:"canvas"};return React.createElement("div",__assign({},b),React.createElement("canvas",__assign({},f)))},c.prototype.createDetailLegend=function(){var a="chart-likert-control-detail-container",b="chart-likert-control-detail-item";return React.createElement("div",{className:a,ref:"stacked-detail-container"},this.props.Data.map(function(a){return React.createElement("div",{className:b,title:a.label},React.createElement("canvas",{role:"presentation",className:"chart-control-detail-canvas",width:"8",height:"8"}),React.createElement("span",null,a.label))}))},c}(a.ReactComponent);b.LikertChartControl=d}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(a){return React.createElement(e,a)}var d;!function(a){a[a.None=0]="None",a[a.CheckMark=1]="CheckMark"}(d=b.ItemStyle||(b.ItemStyle={})),b.createList=c;var e=function(a){function c(){return null!==a&&a.apply(this,arguments)||this;
}return __extends(c,a),c.prototype.render=function(){return React.DOM.div({className:"list-control-contanier"},this.createList())},c.prototype.createList=function(){var a=this,b=this.props.ListItems,c=b.map(function(b,c){return React.DOM.li({key:c},a.createListItem(b))});return React.DOM.ul({className:"list-control-ul",role:"listbox"},c)},c.prototype.createListItem=function(a){var c=null;switch(this.props.ItemStyle){case d.CheckMark:c=b.createFontIconControl({HTMLAttributes:{className:"list-control-icon"},IconName:"CheckMark"})}return React.DOM.div({className:"list-control-item",title:a.Tooltip},c,React.DOM.span({className:"list-control-item-text"},a.DisplayName))},c}(a.ReactComponent);b.List=e}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.render=function(){var b=this.props.Ignorable?a.Utilities.Html.combineAttributes(this.props.ClassName,"optional-cell"):this.props.ClassName;return React.createElement("div",{className:b},React.createElement("div",{className:"loading-spinner-animation"}),this.createLoadingDescription())},c.prototype.createLoadingDescription=function(){return this.props.LoadingDescription?React.createElement("div",{className:"loading-control-description",role:"status"},this.props.LoadingDescription):void 0},c}(a.ReactComponent);b.LoadingControl=c}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(a){return React.createElement(f,__assign({},a))}function d(){return React.createElement("hr",{className:"menu-control-hr"})}var e;!function(a){a[a.Normal=0]="Normal",a[a.CheckBox=1]="CheckBox",a[a.RadioButton=2]="RadioButton"}(e=b.MenuItemType||(b.MenuItemType={})),b.createMenuControl=c,b.createMenuBreakerProps=d;var f=function(c){function d(a){var b=c.call(this,a)||this;return b.triggerRef=React.createRef(),b.menuTableRef=React.createRef(),b.resizeTimeId=null,b.blurTimeId=null,b.triggerFocused=!1,b.selectedElement=null,b.controlId=_.uniqueId("menu"),b.allowScrollBar=!b.props.SubMenu,b.state={MenuExpanded:!1},b.getRoot=b.getRoot.bind(b),b.onMenuBlur=b.onMenuBlur.bind(b),b.onKeyDownForMenuTriggerButton=b.onKeyDownForMenuTriggerButton.bind(b),b.handleKeyDownOnTable=b.handleKeyDownOnTable.bind(b),b.resizeWindowCallback=b.resizeWindowCallback.bind(b),b.focusOnMenuItem=b.focusOnMenuItem.bind(b),b.setSelectedElement=b.setSelectedElement.bind(b),b.handleTriggerFocus=b.handleTriggerFocus.bind(b),b.handleTriggerClick=b.handleTriggerClick.bind(b),b.collapseMenu=b.collapseMenu.bind(b),b}return __extends(d,c),d.prototype.componentWillReceiveProps=function(a){a.Reset&&(this.setState({MenuExpanded:!1}),a.onMenuReset&&a.onMenuReset())},d.prototype.componentDidMount=function(){window.addEventListener("resize",this.resizeWindowCallback)},d.prototype.componentDidUpdate=function(a,b){if(!this.state.MenuExpanded&&this.triggerFocused&&(this.focus(),this.triggerFocused=!1),!b.MenuExpanded&&this.state.MenuExpanded){this.props.DisableAdjustPopupPosition||this.adjustPopupPosition();var c=this.menuTableRef.current;c&&c.focus(),this.props.onMenuExpand&&this.props.onMenuExpand()}b.MenuExpanded&&!this.state.MenuExpanded&&(this.selectedElement=null,this.props.onMenuCollapse&&this.props.onMenuCollapse())},d.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.resizeWindowCallback),this.resizeTimeId&&window.clearTimeout(this.resizeTimeId),this.blurTimeId&&window.clearTimeout(this.blurTimeId)},d.prototype.render=function(){var b,c=a.Utilities.Html.combineAttributes(this.props.ClassNameForContainer,"menu-control-dropup");return this.props.SubMenu?(b=this.getTriggerProps(),b.className=a.Utilities.Html.combineAttributes(b.className,c)):b={className:c},React.createElement("div",__assign({},b),this.createMenuTrigger(),this.createMenuTable())},d.prototype.resizeWindowCallback=function(){var a=this;this.resizeTimeId||(this.resizeTimeId=window.setTimeout(function(){a.resizeTimeId=null,a.adjustPopupPosition()},100))},d.prototype.focus=function(){var a=this.triggerRef.current;a&&!this.state.MenuExpanded&&a.focus()},d.prototype.setFocusOnMenuItem=function(a){a&&a.focus()},d.prototype.switchMenuExpandedState=function(a){this.triggerFocused=this.state.MenuExpanded&&!!a,this.setState({MenuExpanded:!this.state.MenuExpanded})},d.prototype.collapseMenu=function(){this.setState({MenuExpanded:!1})},d.prototype.createMenuTrigger=function(){return this.props.SubMenu?this.props.HTMLAttributes.children:Forms.UX.Controls.createButton({HTMLAttributes:this.getTriggerProps(),ButtonStyle:this.props.ButtonStyle,children:this.props.HTMLAttributes.children})},d.prototype.handleTriggerFocus=function(a){this.props.SubMenu&&this.props.setSelectedElement(a.currentTarget),this.props.onButtonFocus&&this.props.onButtonFocus()},d.prototype.getTriggerProps=function(){var b={tabIndex:this.props.SubMenu?-1:0,autoFocus:this.props.AutoFocused,"aria-expanded":this.state.MenuExpanded,"aria-haspopup":!0,"aria-disabled":this.props.Disabled,"aria-controls":this.state.MenuExpanded?this.controlId:void 0,className:"menu-control-trigger",ref:this.triggerRef};return this.props.Disabled||(b=_.extend(b,{onClick:this.handleTriggerClick,onFocus:this.handleTriggerFocus,onKeyDown:this.onKeyDownForMenuTriggerButton})),a.Utilities.Html.mergeReactProps(b,this.props.HTMLAttributes)},d.prototype.getMenuItemRole=function(a){switch(a){case e.Normal:return"menuitem";case e.RadioButton:return"menuitemradio";case e.CheckBox:default:return"menuitemcheckbox"}},d.prototype.onMenuBlur=function(b){var c=this;b.stopPropagation();var d=a.Utilities.Html.getTargetElementOfFocusEvent(b);if(this.props.SubMenu){var e=this.props.Root.current;if(!e||!e.contains(d))return void(this.blurTimeId=window.setTimeout(function(){c.blurTimeId=null,c.props.collapseRootMenu()},150))}var f=this.menuTableRef.current;f&&f.contains(d)||(this.blurTimeId=window.setTimeout(function(){c.blurTimeId=null,c.collapseMenu()},150))},d.prototype.createUnorderedListMenuItem=function(c,d){var f=this,g=!!c.IsDisabled,h=function(){g||c.onExecute()},i={"aria-disabled":g,className:a.Utilities.Html.combineAttributes("separator",g?"menu-item-disabled":"menu-item-active",c.Checked?"checked":""),key:c.Key,onFocus:this.focusOnMenuItem,title:c.Title,role:this.getMenuItemRole(this.props.MenuItemType),tabIndex:g?void 0:-1,onClick:function(){h(),f.switchMenuExpandedState()},onBlur:this.onMenuBlur,onKeyDown:function(a){return f.onKeyDownForMenuItem(a,h)}};this.props.MenuItemType!==e.Normal&&(i["aria-checked"]=c.Checked);var j={HTMLAttributes:{className:"forms-icon-size18x18 question-menu-check-icon"},IconName:"CheckMark"},k=c.Checked?React.createElement(b.FontIconControl,__assign({},j)):void 0;return React.createElement("li",__assign({},i),k,React.createElement("span",null,c.Description))},d.prototype.createUnorderListMenu=function(){var b=this,c=[],d=this.props.UnorderListMenuItems,e=!1;d&&d.filter(function(a){return!!a}).forEach(function(a,d){c.push(b.createUnorderedListMenuItem(a,d)),e=e||a.Checked});var f={className:a.Utilities.Html.combineAttributes("menu-control-options-box",this.props.ClassName),id:this.controlId,ref:this.menuTableRef,role:"menu",tabIndex:-1,onBlur:this.onMenuBlur,onKeyDown:this.handleKeyDownOnTable},g=a.Utilities.Html.combineAttributes("menu-control-options-content","menu-control","border-no-radius",e?"checked":"");return React.createElement("div",__assign({},f),React.createElement("ul",{className:g},c))},d.prototype.createCustomizedMenu=function(){var b=this.createCustomizedMenuItems(),c={className:a.Utilities.Html.combineAttributes("menu-control-options-box",this.props.ClassName),id:this.controlId,ref:this.menuTableRef,role:"menu",tabIndex:-1,onKeyDown:this.handleKeyDownOnTable,onBlur:this.onMenuBlur,style:this.allowScrollBar?{overflowY:"auto"}:void 0};return React.createElement("div",__assign({},c),React.createElement("div",{className:"menu-control-options-content"},b))},d.prototype.createCustomizedMenuItems=function(){var b=this,c=React.Children.toArray(this.props.children).filter(function(a){return a.props.Active}).length,e=0;return React.Children.map(this.props.children,function(f,g){f=React.Children.only(f);var h=_.clone(f.props);if(h.Active){var i=b.getMenuItemRole(b.props.MenuItemType),j=_.extend({key:g.toString(),"aria-disabled":h.Disabled,"aria-posinset":++e,"aria-setsize":c,role:i},h.HTMLAttributes);return h.Disabled?j.className=a.Utilities.Html.combineAttributes(j.className,"menu-item-disabled"):(j.tabIndex=-1,j.className=a.Utilities.Html.combineAttributes(j.className,"menu-item-active")),h.SubMenu?(b.allowScrollBar=!1,React.createElement(d,{MenuItemType:b.props.MenuItemType,SubMenu:!0,Disabled:h.Disabled,setSelectedElement:b.setSelectedElement,HTMLAttributes:j,collapseRootMenu:b.props.collapseRootMenu||b.collapseMenu,Root:b.props.Root||b.menuTableRef},h.children)):(h.Disabled||(j=_.extend(j,{onFocus:b.focusOnMenuItem,onClick:function(a){a.stopPropagation(),a.preventDefault(),h.onClick(),b.props.SubMenu?b.props.collapseRootMenu():b.switchMenuExpandedState()},onKeyDown:function(a){return b.onKeyDownForMenuItem(a,h.onClick)}})),h.HTMLAttributes=j,React.cloneElement(f,h))}return f})},d.prototype.setSelectedElement=function(a){this.selectedElement=a},d.prototype.getRoot=function(){return this.menuTableRef},d.prototype.createMenuTable=function(){return this.state.MenuExpanded?this.props.UnorderListMenuItems?this.createUnorderListMenu():this.createCustomizedMenu():null},d.prototype.handleTriggerClick=function(a){this.props.SubMenu&&(a.stopPropagation(),a.preventDefault()),this.switchMenuExpandedState()},d.prototype.focusOnMenuItem=function(a){a.stopPropagation(),this.selectedElement=a.currentTarget},d.prototype.handleKeyDownOnTable=function(b){switch(b.keyCode){case a.KeyCode.Home:b.stopPropagation(),b.preventDefault(),this.setFocusOnMenuItem(this.getMenuItemElements()[0]);break;case a.KeyCode.End:b.stopPropagation(),b.preventDefault();var c=this.getMenuItemElements();this.setFocusOnMenuItem(c[c.length-1]);break;case a.KeyCode.ArrowUp:b.stopPropagation(),b.preventDefault(),this.setFocusOnMenuItem(this.getPreviousElement());break;case a.KeyCode.ArrowRight:case a.KeyCode.ArrowDown:b.stopPropagation(),b.preventDefault(),this.setFocusOnMenuItem(this.getNextElement());break;case a.KeyCode.ArrowLeft:case a.KeyCode.Esc:case a.KeyCode.Tab:b.stopPropagation(),b.preventDefault(),this.switchMenuExpandedState(!0)}},d.prototype.getMenuItemElements=function(){var a=this.menuTableRef.current;return a.firstElementChild.querySelectorAll(".menu-item-active")},d.prototype.getPreviousElement=function(){var a=this,b=this.getMenuItemElements();if(b.length>0){if(this.selectedElement&&this.selectedElement!==b[0]){var c=_.findIndex(b,function(b){return a.selectedElement===b});return b[--c]}return b[b.length-1]}},d.prototype.getNextElement=function(){var a=this,b=this.getMenuItemElements();if(b.length>0){if(this.selectedElement&&this.selectedElement!==b[b.length-1]){var c=_.findIndex(b,function(b){return a.selectedElement===b});return b[++c]}return b[0]}},d.prototype.onKeyDownForMenuTriggerButton=function(b){switch(b.keyCode){case a.KeyCode.ArrowDown:this.props.SubMenu||(b.preventDefault(),this.switchMenuExpandedState());break;case a.KeyCode.Enter:b.stopPropagation(),b.preventDefault(),this.switchMenuExpandedState();break;case a.KeyCode.ArrowRight:this.state.MenuExpanded||(b.stopPropagation(),b.preventDefault(),this.switchMenuExpandedState())}},d.prototype.onKeyDownForMenuItem=function(b,c){switch(b.keyCode){case a.KeyCode.Space:b.stopPropagation(),b.preventDefault(),c&&c(),this.props.MenuItemType!==e.CheckBox&&(this.props.SubMenu?this.props.collapseRootMenu():this.switchMenuExpandedState());break;case a.KeyCode.Enter:b.stopPropagation(),b.preventDefault(),c&&c(),this.props.SubMenu?this.props.collapseRootMenu():this.switchMenuExpandedState()}},d.prototype.adjustPopupPosition=function(){var a=ReactDOM.findDOMNode(this.triggerRef.current),b=this.menuTableRef.current;if(a&&b){var c=b.offsetWidth,d=b.offsetHeight,e=b.offsetParent;if(!e)return;for(b.style.display="none";e;){var f=window.getComputedStyle(e,""),g=f.overflowX,h=f.overflowY;if(g&&"visible"!==g||h&&"visible"!==h||"BODY"===e.tagName)break;e=e.parentElement}var i,j=e.getBoundingClientRect(),k=a.getBoundingClientRect(),l=void 0;this.props.SubMenu?(l=e.clientWidth+j.left-k.right-c>0?k.width:-c,i=e.clientHeight+j.top-k.top-d>0?0:-d):(l=Math.min(e.clientWidth+j.left-k.left-c,0),i=Math.min(e.clientHeight+j.top-k.top-d-5,k.height)),b.style.display="block",b.style.left=l+"px",b.style.top=i+"px"}},d}(a.ReactComponent);b.MenuControl=f}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(a){return React.createElement(d,a)}b.createNumberRating=c;var d=function(c){function d(){var a=null!==c&&c.apply(this,arguments)||this;return a.ariaLabelId=_.uniqueId("ratingAccessibilityLabel."),a}return __extends(d,c),d.prototype.createReactNodes=function(){var c=this.props,d=null!=c.Value&&""!==c.Value;if(!d&&c.ToRenderIfNoRatingAlreadyGiven)return[c.ToRenderIfNoRatingAlreadyGiven];var e,f=10,g=c.MinRating;return null==g&&(g=1),e=c.ShowRatingLabel?b.RatingUtilities.createRatingContainer(b.RatingUtilities.RatingType.Number,null,c.LeftDescription,c.RightDescription,g.toString(),c.Length.toString(),this.createRatingTable(),c.Length,f):[React.createElement("div",{className:"office-form-question-rating-container"},this.createRatingTable())],c.ShouldAccessibleTextReadSelectedValue?[React.createElement("div",{"aria-labelledby":this.ariaLabelId},React.createElement("div",{id:this.ariaLabelId,className:"screenReaderVisible"},a.Form.Resources.LocalizedStrings.GradingView_RatingAnswer_LabelFormat.format(this.getSelectedValue(),c.Length)),React.createElement("div",{"aria-hidden":"true",role:"presentation"},e))]:e},d.prototype.createRatingTable=function(){var b=this,c=this.props.MinRating;null==c&&(c=1);var d=_.range(c,this.props.Length+1),e=this.getSelectedValue(),f=a.Utilities.Html.combineAttributes("office-form-question-rating-body","Center"===this.props.Layout?"justifyContentSpaceBetween":"");return React.createElement("div",{className:f},d.map(function(a){var c=e===a;return React.createElement("div",{className:"office-form-question-rating-item",key:a},React.createElement("label",{htmlFor:b.getRatingInputId(a)},a),React.createElement("input",{id:b.getRatingInputId(a),"aria-checked":c,"aria-label":""+a,"aria-posinset":a,"aria-setsize":d.length,type:"radio",disabled:b.props.Disabled,checked:c,onClick:function(){return b.props.onValueChange(a)}}))}))},d.prototype.getRatingInputId=function(a){return this.ariaLabelId+"-number-rating-"+a},d.prototype.getSelectedValue=function(){return parseInt(this.props.Value)},d}(b.ControlBase);b.NumberRating=d}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(a){return React.createElement(e,__assign({},a))}var d;!function(a){a[a.QuizRanking=0]="QuizRanking",a[a.SurveyRanking=1]="SurveyRanking",a[a.Likert=2]="Likert"}(d=b.StackedBarType||(b.StackedBarType={})),b.createRankingChartControl=c;var e=function(b){function c(){var a=null!==b&&b.apply(this,arguments)||this;return a.backgroundColors=["#FF7F0E","#FF993E","#FFB26E","#FFCC9F","#FFE5CF","#E5E5E5","#D2E4F0","#A5C9E1","#79ADD2","#4C92C3","#1F77B4"],a}return __extends(c,b),c.prototype.render=function(){if(this.isValidChart()){var b={className:"chart-control-container chart-stacked-control-container",tabIndex:-1};return b["aria-label"]=a.Form.Resources.LocalizedStrings.ChartControl_GroupContainer,React.createElement("div",__assign({},b),this.createChartLegend(),this.createChartCanvas())}return null},c.prototype.componentWillMount=function(){this.initializeChartData()},c.prototype.componentDidMount=function(){this.updateChartDataView()},c.prototype.shouldComponentUpdate=function(a){return!_.isEqual(this.props,a)||!this.wasChartVisible},c.prototype.componentDidUpdate=function(){this.updateChartDataView()},c.prototype.componentWillUnmount=function(){this.destroyChart()},c.prototype.isValidChart=function(){return this.props.Labels&&this.props.Labels.length>0&&this.props.Data&&this.props.Data.length>0},c.prototype.destroyChart=function(){this.chartInstance&&(this.chartInstance.destroy(),this.chartInstance=null)},c.prototype.updateChartDataView=function(){if(this.isValidChart()){var a=ReactDOM.findDOMNode(this.refs.canvas);if(this.wasChartVisible=$(a).is(":visible"),this.wasChartVisible){var b=a.getContext("2d");this.createStackedBarChart(b),this.setChartLegend()}}},c.prototype.generateChartOption=function(){var a={responsive:!1,scales:{xAxes:[{gridLines:{display:!1,drawTicks:!0,drawBorder:!0},ticks:{display:!1,min:0,max:100},stacked:!0}],yAxes:[{gridLines:{display:!1,drawTicks:!1,drawBorder:!0},ticks:{display:!1},stacked:!0}]},tooltips:{enabled:!0,filter:function(a){return 0!==a.xLabel},callbacks:{title:function(a){return a.length?a[0].yLabel:""},label:function(a,b){return b.datasets[a.datasetIndex].label+": "+a.xLabel+"%"}}},legend:{display:!1}};return a},c.prototype.createStackedBarChart=function(a){var b={labels:this.props.Labels,datasets:this.chartData},c=this.generateChartOption();this.destroyChart(),this.chartInstance=new Chart(a,{type:"horizontalBar",data:b,options:c})},c.prototype.initializeChartData=function(){for(var a=this,b=[],c=function(a){b.push(d.props.Data.reduce(function(b,c){return b+c.data[a]},0))},d=this,e=0;e<this.props.Data[0].data.length;e++)c(e);var f=[[0],[0,10],[0,5,10],[0,2,8,10],[0,2,5,8,10],[0,2,4,6,8,10],[0,2,4,5,6,8,10],[0,2,3,4,6,7,8,10],[0,2,3,4,5,6,7,8,10],[0,1,2,3,4,6,7,8,9,10]];this.usingColors=f[Math.min(this.props.Data.length,f.length)-1].map(function(b){return a.backgroundColors[b]}),this.chartData=this.props.Data.map(function(c,d){var e=c.backgroundColor?c.backgroundColor:a.usingColors[d%a.usingColors.length];return{label:c.label,borderWidth:1,borderColor:"#FFFFFF",backgroundColor:e,hoverBackgroundColor:a.lightenDarkenColor(e,10),data:c.data.map(function(a,c){return b[c]?Math.round(1e3*a/b[c])/10:0})}})},c.prototype.lightenDarkenColor=function(a,b){function c(a,b){var c=parseInt(a.slice(1),16),d=Math.round(2.55*b),e=(c>>16)+d,f=(c>>8&255)+d,g=(255&c)+d;return"#"+(16777216+65536*(255>e?1>e?0:e:255)+256*(255>f?1>f?0:f:255)+(255>g?1>g?0:g:255)).toString(16).slice(1)}return _.isArray(a)?a.map(function(a){return c(a,b)}):c(a,b)},c.prototype.setChartLegend=function(){var a=this;if(this.props.HasLegend){var b=ReactDOM.findDOMNode(this.refs["legend-table"]),c=ReactDOM.findDOMNode(this.refs["legend-table-tbody"]),d=c.childNodes;d&&d.length>0&&(_.each(d,function(b,c){Chart.helpers.addEvent(b,"mouseover",function(){a.handleEvent("mouseover",c)})}),Chart.helpers.addEvent(b,"mouseout",function(){a.handleEvent("mouseout",0)}));var e=ReactDOM.findDOMNode(this.refs["stacked-detail-container"]),f=e.getElementsByClassName("chart-control-detail-canvas");f&&f.length>0&&_.each(f,function(b,c){var d=b.getContext("2d");d.fillStyle=a.chartData[c].backgroundColor,d.beginPath(),d.fillRect(0,0,10,10),d.closePath(),d.fill()})}},c.prototype.handleEvent=function(a,b){var c=this;"mouseout"===a?this.chartInstance.active=[]:this.chartInstance.active=this.chartInstance.data.datasets.map(function(a,d){return c.chartInstance.getDatasetMeta(d).data[b]}),this.chartInstance.lastActive=this.chartInstance.lastActive||[],this.chartInstance.lastActive.length&&this.chartInstance.updateHoverStyle(this.chartInstance.lastActive,this.chartInstance.options.hover.mode,!1),this.chartInstance.active.length&&this.chartInstance.updateHoverStyle(this.chartInstance.active,this.chartInstance.options.hover.mode,!0);var d=!Chart.helpers.arrayEquals(this.chartInstance.active,this.chartInstance.lastActive);if(d){this.chartInstance.lastActive=this.chartInstance.active;var e=this.chartInstance.tooltip;e._active=this.chartInstance.active,e._lastActive=e._lastActive||[],e.update(!0),e.pivot();var f=this.chartInstance._bufferedRequest;f?this.chartInstance.render(f.duration,f.lazy):d&&!this.chartInstance.animating&&(this.chartInstance.stop(),this.chartInstance.render(this.chartInstance.options.hover.animationDuration,!0)),this.chartInstance._bufferedRender=!1,this.chartInstance._bufferedRequest=null}},c.prototype.createChartLegend=function(){var b=this;if(this.props.HasLegend){var c={className:"chart-control-legend",tabIndex:-1};c["aria-label"]=a.Form.Resources.LocalizedStrings.ChartControl_LegendGroup;var e=void 0,f=void 0;return this.props.Type===d.QuizRanking?(e=React.createElement("tr",{className:"chart-control-legend-table-title"},React.createElement("th",{className:"chart-control-legend-label"}," "),React.createElement("th",{className:"chart-control-legend-value"}," ")),f=this.props.Labels.map(function(a,c){return React.createElement("tr",{className:"chart-control-legend-table-row",key:c},React.createElement("td",{role:"presentation",className:"chart-control-legend-label",title:a.toString()},a),React.createElement("td",{role:"presentation",className:"chart-control-legend-value"},b.chartData[0].data[c]+"%"))})):(e=React.createElement("tr",{className:"chart-control-legend-table-title"},React.createElement("th",{role:"presentation",className:"chart-control-legend-value"},a.Form.Resources.LocalizedStrings.AnalyzeView_Chart_Rank),React.createElement("th",{role:"presentation",className:"chart-control-legend-label"},a.Form.Resources.LocalizedStrings.AnalyzeView_Chart_Options)),f=this.props.Labels.map(function(a,c){return React.createElement("tr",{className:"chart-control-legend-table-row",key:c},React.createElement("td",{role:"presentation",className:"chart-control-legend-value"},b.props.yLabels[c]),React.createElement("td",{role:"presentation",className:"chart-control-legend-label",title:a.toString()},a))})),React.createElement("div",__assign({},c),React.createElement("table",{className:"chart-control-legend-table",ref:"legend-table"},React.createElement("thead",null,e),React.createElement("tbody",{ref:"legend-table-tbody"},f)))}},c.prototype.createChartCanvas=function(){var b={"aria-label":a.Form.Resources.LocalizedStrings.ChartControl_ChartGroup,className:"chart-control chart-control-stacked",tabIndex:-1},c=a.Utilities.Html.getWindowWidth()<400||a.Utilities.isMobile(),d=c?300:350,e=10+31*this.props.Labels.length;e=c?300*e/350:e;var f={role:"presentation",className:"chart-control-canvas",width:d,height:e,ref:"canvas"};return React.createElement("div",__assign({},b),this.createDetailLegend(),React.createElement("canvas",__assign({},f)))},c.prototype.createDetailLegend=function(){var b=this;if(this.props.Type===d.SurveyRanking){var c=a.Form.Resources.LocalizedStrings.AnalyzeView_Chart_Pick;return React.createElement("div",{className:"chart-control-stacked-detail-container",ref:"stacked-detail-container"},this.props.Labels.map(function(d,e){return 0===e?React.createElement("div",{className:"chart-control-stacked-detail-item"},React.createElement("span",null,c.format(a.Form.Resources.LocalizedStrings.Ordinal_Numera_First)),React.createElement("canvas",{role:"presentation",className:"chart-control-detail-canvas",width:"10",height:"10"})):e===b.props.Labels.length-1?React.createElement("div",{className:"chart-control-stacked-detail-item"},React.createElement("canvas",{role:"presentation",className:"chart-control-detail-canvas",width:"10",height:"10"}),React.createElement("span",null,c.format(a.Form.Resources.LocalizedStrings.Ordinal_Numera_Last))):React.createElement("div",{className:"chart-control-stacked-detail-item"},React.createElement("canvas",{role:"presentation",className:"chart-control-detail-canvas",width:"10",height:"10"}))}))}return React.createElement("div",{className:"chart-control-stacked-detail-container",ref:"stacked-detail-container"},this.props.Data.map(function(a){return React.createElement("div",{className:"chart-control-stacked-detail-item",title:a.label},React.createElement("canvas",{role:"presentation",className:"chart-control-detail-canvas",width:"10",height:"10"}),React.createElement("span",null,a.label))}))},c}(a.ReactComponent);b.RankingChartControl=e}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(a){return React.createElement(d,a)}b.createRating=c;var d=function(c){function d(){var a=null!==c&&c.apply(this,arguments)||this;return a.containerRef=React.createRef(),a.containerWidth=0,a}return __extends(d,c),d.prototype.createReactNodes=function(){var a=this.props,c=10,d=this.containerRef.current;d&&d.clientWidth>0&&(this.containerWidth=d.clientWidth);var e=this.getRateitConfig(),f={className:"rateit margin-left office-form-theme-primary-foreground","data-rateit-icon":"","data-rateit-iconforempty":"","data-rateit-mode":"font","data-rateit-marginleft":e.MarginLeft,"data-rateit-marginright":e.MarginRight,"data-rateit-starwidth":e.FontSize,"data-rateit-max":a.Length,"data-rateit-value":a.Value,"data-rateit-step":1,"data-rateit-resetable":!1,"data-rateit-ispreset":!0,style:{fontSize:e.FontSize},ref:"rateit",key:"rateit"},g=React.DOM.div(f);return a.ShowRatingLabel?b.RatingUtilities.createRatingContainer(b.RatingUtilities.RatingType.Star,this.containerRef,a.LeftDescription,a.RightDescription,a.LeftDescriptionTitle,a.RightDescriptionTitle,g,a.Length,c,this.ratingDescriptionId):[React.DOM.div({className:"office-form-question-rating-container",key:"container",ref:this.containerRef},g)]},d.prototype.componentWillMount=function(){this.ratingDescriptionId=a.UniqueIdentifier.getLabelId(),this.adjustStarStyleWhenResize=this.adjustStarStyleWhenResize.bind(this)},d.prototype.componentDidMount=function(){this.initialzeRateit(),window.addEventListener("resize",this.adjustStarStyleWhenResize);var a=this.containerRef.current;a&&a.clientWidth>0?(this.containerWidth=a.clientWidth,this.forceUpdate()):this.updateRatingAttributes()},d.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.adjustStarStyleWhenResize)},d.prototype.componentDidUpdate=function(){this.updateRatingAttributes()},d.prototype.initialzeRateit=function(){var b=this,c=this.props,d=$(ReactDOM.findDOMNode(this.refs.rateit));d.rateit(),d.on("rated",function(){return c.onValueChange(d.rateit("value"))}),d.on("over",function(a,c){return b.updateTooltip(c)});var e=d.find(".rateit-range");if(e&&c.Options&&c.Options.HTMLPropsForInnerElement){e.removeAttr("aria-label");for(var f in c.Options.HTMLPropsForInnerElement)e.attr(f,c.Options.HTMLPropsForInnerElement[f])}if(e){var g=e.attr("aria-labelledby");g&&(g=a.Utilities.Html.combineAttributes(g,this.ratingDescriptionId),e.attr("aria-labelledby",g))}},d.prototype.adjustStarStyleWhenResize=function(){var a=this;this.resizeTimeId||(this.resizeTimeId=window.setTimeout(function(){a.resizeTimeId=null,a.forceUpdate()},100))},d.prototype.updateRatingAttributes=function(){var a=$(ReactDOM.findDOMNode(this.refs.rateit));if(a.rateit("readonly",this.props.Disabled),this.props.NoTabFocus){var b=a.find(".rateit-range");b&&b.removeAttr("tabindex")}var c=a.children(".rateit-range");c.removeAttr("aria-readonly");var d=this.getRateitConfig();a.rateit("batchUpdate",{value:this.props.Value,max:this.props.Length,starwidth:d.FontSize,marginleft:d.MarginLeft,marginright:d.MarginRight}),this.updateTooltip(),this.checkRatingValue()},d.prototype.updateTooltip=function(b){b=b||this.props.Value||0;var c=$(ReactDOM.findDOMNode(this.refs.rateit)),d=a.Form.Resources.LocalizedStrings.Renderer_RatingControlText.format(b);c.attr("title",d)},d.prototype.getRateitConfig=function(){var a={MarginLeft:4,MarginRight:4,FontSize:24};if(this.containerWidth>0)if(this.isMobile()){a.MarginLeft=4;var b=this.props.Length,c=b>6?24:28;a.FontSize=c,4>b?a.MarginRight=27:a.MarginRight=(this.containerWidth-a.MarginLeft*(b+1)-c*b)/(b-1)}else if(this.containerWidth>380)return{MarginLeft:5,MarginRight:5,FontSize:28};return a},d.prototype.checkRatingValue=function(){this.props.Value>this.props.Length&&a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.DesignPage.Questions.RatingValueOutOfBounds,extraData:{operation:"RatingValueOutOfBounds"}})},d.prototype.isMobile=function(){return this.props.IsMobile||a.Utilities.isMobile()},d}(b.ControlBase);b.Rating=d}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(b){function c(b,c,e,f,g,h,i,j,k,l){var m;m=b===d.Star?"star":"number";var n={className:"office-form-rating-container-"+m+" container-margin-right"},o={className:"office-form-rating-container-"+m+" container-margin-left"};""===e&&(n.className=a.Utilities.Html.combineAttributes(n.className,"container-empty")),j===k&&(n.className=a.Utilities.Html.combineAttributes(n.className,"container-"+m+"-max-width"),o.className=a.Utilities.Html.combineAttributes(o.className,"container-"+m+"-max-width"));var p=React.DOM.div(n,React.DOM.div({className:"office-form-question-rating-description-"+m},e)),q=React.DOM.div(o,React.DOM.div({className:"office-form-question-rating-description-"+m},f));if(e||f){var r=React.DOM.div({className:"office-form-response-rating-description"},React.DOM.div({className:"office-form-rating-description-label"},g),React.DOM.div({className:"rating-option-description"},a.Form.Resources.LocalizedStrings.Colon.format(e))),s=React.DOM.div({className:"office-form-response-rating-description"},React.DOM.div({className:"office-form-rating-description-label"},h),React.DOM.div({className:"rating-option-description"},a.Form.Resources.LocalizedStrings.Colon.format(f))),t=React.DOM.div({className:"office-form-rating-description-container",id:l},r,s);return[React.DOM.div({className:"office-form-question-rating-container",key:"container",ref:c},p,i,q),t]}return[React.DOM.div({className:"office-form-question-rating-container",key:"container",ref:c},p,i,q)]}var d;!function(a){a[a.Star=0]="Star",a[a.Number=1]="Number"}(d=b.RatingType||(b.RatingType={})),b.createRatingContainer=c}(c=b.RatingUtilities||(b.RatingUtilities={}))}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(a){return React.createElement(d,__assign({},a))}b.createRenderNewlines=c;var d=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.renderLine=function(a){return React.createElement("span",null,a,React.createElement("br",null))},b.prototype.splitContentIntoLines=function(){var a=this.props.content;return(_.isUndefined(this.props.trim)||this.props.trim)&&(a=a.trim()),a.split("\n")},b.prototype.render=function(){var a=this.splitContentIntoLines();return React.createElement("span",null,a.map(function(b,c){var d=c!==a.length-1,e=d?React.createElement("br",null):void 0;return React.createElement("span",null,b,e)}))},b}(a.ReactComponent);b.RenderNewlines=d}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(a){return React.createElement(d,__assign({},a))}b.createSelect=c;var d=function(c){function d(a){var b=c.call(this,a)||this;return b.controlId=_.uniqueId(d.name),b.placeholderId=b.controlId+"_placeholder",b.placeholderRef=React.createRef(),b.onBlur=b.onBlur.bind(b),b.onKeyDown=b.onKeyDown.bind(b),b}return __extends(d,c),d.prototype.componentWillUpdate=function(a,b){var c=_.findIndex(a.SelectOptions,function(b){return b.Value===a.Value});this.selectedOptionKey=0>c?void 0:a.SelectOptions[c].Key},d.prototype.componentWillMount=function(){var a=this,b=_.findIndex(this.props.SelectOptions,function(b){return b.Value===a.props.Value});this.selectedOptionKey=0>b?void 0:this.props.SelectOptions[b].Key,this.setState({Expanded:!1})},d.prototype.componentDidUpdate=function(){if(this.scrollToSelectedOption(),this.state.Expanded){this.adjustOptionPanelLayout();var a=this.refs[this.selectedOptionKey];
if(a){var b=ReactDOM.findDOMNode(a);b&&b.focus()}}},d.prototype.adjustOptionPanelLayout=function(){var a=document.getElementById(this.controlId),b=window.getComputedStyle(a),c=a.offsetWidth,d=ReactDOM.findDOMNode(this.refs.menu);(this.props.AllowWrap||d.offsetWidth<c)&&(d.style.width=c+"px"),d.style.top=a.offsetHeight-parseInt(b.borderTopWidth)+"px",d.style.left="-"+b.borderLeftWidth},d.prototype.render=function(){var b=this,c=_.extend({},this.props.HTMLAttributes),d=a.Utilities.Html.mergeReactProps(c,{"aria-describedby":this.placeholderId,"aria-expanded":this.state.Expanded,"aria-label":c["aria-label"]||this.props.Label||this.props.Placeholder,className:"select-control",id:this.controlId,onBlur:this.onBlur,onClick:c.disabled?void 0:function(){return b.onClick()},onKeyDown:this.onKeyDown,ref:this.placeholderRef,role:"combobox",tabIndex:c.disabled?-1:0});return React.createElement("div",__assign({},d),this.createPlaceholder(),this.createOptions())},d.prototype.createPlaceholder=function(){var a,c=this,d=_.findIndex(this.props.SelectOptions,function(a){return void 0===c.selectedOptionKey?a.Value===c.props.Value:a.Key===c.selectedOptionKey});d>=0&&(a=this.props.DisplayValue?this.props.Value:this.props.SelectOptions[d].DisplayContent||this.props.SelectOptions[d].DisplayName),a||(a=this.props.Placeholder||"");var e=this.selectedOptionKey?"select-placeholder-text":"select-placeholder-text default",f=this.state.Expanded?"off":"polite",g=this.props.PlaceholderIcon&&React.createElement("div",{className:"select-placeholder-icon"},React.createElement(b.FontIconControl,{IconName:this.props.PlaceholderIcon}));return React.createElement("div",{className:"select-placeholder"},g,React.createElement("span",{"aria-live":f,id:this.placeholderId,className:e,role:"textbox"},a),this.createArrow())},d.prototype.createArrow=function(){var a={HTMLAttributes:{className:"select-placeholder-arrow forms-icon-size14x14"},IconName:this.state.Expanded?"ChevronUp":"ChevronDown"};return React.createElement(b.FontIconControl,__assign({},a))},d.prototype.createOptions=function(){var a=this;if(this.state.Expanded){var b={className:"select-option-menu-container",ref:"menu",onWheel:function(b){b.preventDefault();var c=b.deltaY,d=ReactDOM.findDOMNode(a.refs.menu),e=d.scrollTop+c;if(c>=0){var f=d.scrollHeight-d.clientHeight;d.scrollTop=Math.min(e,f)}else d.scrollTop=Math.max(e,0)},role:"listbox"};return React.createElement("ul",__assign({},b),this.props.SelectOptions.map(function(b){return a.createOption(b)}))}},d.prototype.createOption=function(c){var d=this,e=c.Key===this.selectedOptionKey,f={"aria-selected":e,"aria-disabled":c.Disabled,className:this.props.AllowWrap?"select-option-nocheck":"select-option",tabIndex:e?0:-1,key:c.Key,ref:c.Key&&c.Key.toString(),role:"option"};c.Disabled?f.className=a.Utilities.Html.combineAttributes(f.className,"disabled"):f.onClick=function(a){var b=ReactDOM.findDOMNode(d);b.focus(),d.selectedOptionKey&&d.selectedOptionKey===c.Key||d.props.onValueChange(c.Value),d.setState({Expanded:!1}),a.stopPropagation()};var g="select-option-state forms-icon-size14x14";this.props.PlaceholderIcon&&(g=a.Utilities.Html.combineAttributes(g,"hasPlaceholderIcon"));var h;this.props.AllowWrap||(h=React.createElement(b.FontIconControl,{HTMLAttributes:{className:g},IconName:"CheckMark"})),e&&(f.className=a.Utilities.Html.combineAttributes(f.className,"selected"));var i=c.DisplayContent;return i||(i=React.createElement("span",null,c.DisplayName)),React.createElement("li",__assign({},f),React.createElement("div",{className:"select-option-content"},h,i))},d.prototype.onBlur=function(b){var c=ReactDOM.findDOMNode(this),d=a.Utilities.Html.getTargetElementOfFocusEvent(b);c.contains(d)||this.setState({Expanded:!1})},d.prototype.onKeyDown=function(b){var c=this;switch(b.stopPropagation(),b.keyCode){case a.KeyCode.Space:this.setState({Expanded:!0}),b.preventDefault();break;case a.KeyCode.Enter:this.onClick(!0),b.preventDefault();break;case a.KeyCode.Tab:this.state.Expanded&&(this.setState({Expanded:!1},function(){c.placeholderRef.current&&c.placeholderRef.current.focus()}),b.preventDefault());break;case a.KeyCode.Esc:this.state.Expanded&&this.setState({Expanded:!1},function(){c.placeholderRef.current&&c.placeholderRef.current.focus()}),b.preventDefault();break;case a.KeyCode.ArrowLeft:case a.KeyCode.ArrowRight:this.state.Expanded||(b.keyCode===a.KeyCode.ArrowLeft?this.selectPreviousOption():this.selectNextOption()),b.preventDefault();break;case a.KeyCode.ArrowUp:case a.KeyCode.ArrowDown:b.altKey?this.setState({Expanded:!this.state.Expanded}):b.keyCode===a.KeyCode.ArrowUp?this.selectPreviousOption():this.selectNextOption(),b.preventDefault()}},d.prototype.selectPreviousOption=function(){for(var a=this,b=_.findIndex(this.props.SelectOptions,function(b){return b.Key===a.selectedOptionKey});b>0;){var c=this.props.SelectOptions[b-1];if(!c.Disabled){this.props.onValueChange(c.Value);break}b--}},d.prototype.selectNextOption=function(){for(var a=this,b=_.findIndex(this.props.SelectOptions,function(b){return b.Key===a.selectedOptionKey});b<this.props.SelectOptions.length-1;){var c=this.props.SelectOptions[b+1];if(!c.Disabled){this.props.onValueChange(c.Value);break}b++}},d.prototype.onClick=function(a){if(this.state.Expanded){var b=ReactDOM.findDOMNode(this);b.focus()}else a&&void 0===this.selectedOptionKey&&this.props.SelectOptions[0]&&this.props.onValueChange(this.props.SelectOptions[0].Value);this.setState({Expanded:!this.state.Expanded})},d.prototype.scrollToSelectedOption=function(){if(this.state.Expanded){var b=$(ReactDOM.findDOMNode(this.refs.menu)),c=b.find(".select-option.selected");a.Utilities.Html.scrollToShowSubelement(c,b)}},d.prototype.focus=function(){var a=ReactDOM.findDOMNode(this);a.focus()},d}(a.ReactComponent);b.Select=d}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(a){return React.createElement(d,__assign({},a))}b.createSimpleDialog=c;var d=function(c){function d(){return null!==c&&c.apply(this,arguments)||this}return __extends(d,c),d.prototype.componentDidMount=function(){Forms.UX.Utilities.trapFocusInsideElement(ReactDOM.findDOMNode(this))},d.prototype.shouldComponentUpdate=function(a){return!_.isEqual(this.props,a)},d.prototype.render=function(){var b=this;if(this.props.ShowDialog){var c={className:this.props.ClassName||"simple-dialog-container",key:"dialogContainer",ref:"dialogContainer",tabIndex:-1,onBlur:function(c){var d=a.Utilities.Html.getTargetElementOfFocusEvent(c),e=ReactDOM.findDOMNode(b.refs.dialogContainer);e.contains(d)||b.props.onBlur&&b.props.onBlur()},onKeyDown:function(a){return b.onKeyDown(a)},onMouseLeave:this.props.onMouseLeave,onMouseOver:this.props.onMouseOver};return React.createElement("div",__assign({},c),this.createDescription(),this.createButtons())}return null},d.prototype.createDescription=function(){if(this.props.Description){var b=a.Utilities.Html.combineAttributes("description-container",this.props.TextClassName);return React.createElement("div",{className:b,key:"descriptionContainer"},this.props.Description)}return null},d.createButtonWithProps=function(c,d){return b.createGlyphButton({ButtonStyle:c.ButtonStyle,GlyphButtonStyle:c.GlyphButtonStyle,HTMLAttributes:{autoFocus:0===d,className:c.ClassName,title:c.Title,onClick:function(a){a.preventDefault(),a.stopPropagation(),c.onClick&&c.onClick(a)}},Icon:c.IconClass,IconClassName:a.Utilities.Html.combineAttributes(c.IconClassName,"forms-icon-size24x24"),key:c.Key,ref:c.ref,Text:c.Text,TextClassName:c.TextClassName})},d.prototype.createButtons=function(){var a=this.props.ButtonsProps||[],b="buttons-container";return React.createElement("div",{className:b,key:"buttonsContainer"},a.filter(function(a){return!!a}).map(d.createButtonWithProps))},d.prototype.onKeyDown=function(b){b.keyCode===a.KeyCode.Esc&&(b.stopPropagation(),b.preventDefault(),this.props.onDismiss&&this.props.onDismiss())},d}(a.ReactComponent);b.SimpleDialog=d}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(a){return React.createElement(f,a)}function d(a){return React.createElement(g,a)}var e;!function(a){a[a.SingleLine=0]="SingleLine",a[a.FixHeightMultiline=1]="FixHeightMultiline",a[a.AutoHeightMultiline=2]="AutoHeightMultiline"}(e=b.TextFieldType||(b.TextFieldType={})),b.createTextField=c;var f=function(c){function f(){var a=null!==c&&c.apply(this,arguments)||this;return a.textFieldRef=React.createRef(),a}return __extends(f,c),f.prototype.componentDidMount=function(){this.props.AutoFocus&&this.focus()},f.prototype.focus=function(){this.textFieldRef.current&&this.textFieldRef.current.focus()},f.prototype.createReactNodes=function(){return[this.createLabel(),this.createValueContainer()]},f.prototype.createLabel=function(){var a=this.props,c=a.Options;return a.Label||a.ShowRequiredStar?React.DOM.div(null,React.DOM.span({className:c&&c.classNameForInnerLabel},a.Label),a.ShowRequiredStar?React.createElement(b.RequiredStar):void 0):void 0},f.prototype.createValueContainer=function(){var b,c,g,h=this,i=this.props,j=i.Options,k=a.Utilities.Html.mergeReactProps(j&&j.HTMLPropsForInnerElement,{value:i.Value||"",className:"office-form-textfield-input form-control border-no-radius",placeholder:i.Placeholder,ref:this.textFieldRef,style:{height:i.MinimalHeight+"px",overflowY:i.TextFieldType===e.FixHeightMultiline?"auto":void 0},spellCheck:!0,disabled:i.Disabled,onChange:this.onChange.bind(this),maxLength:i.MaxLength?i.MaxLength:a.Form.FormLimitation.DefaultTextLength,onFocus:i.AutoSelection?function(){if(h.textFieldRef.current){var a=ReactDOM.findDOMNode(h.textFieldRef.current);a&&a.select()}}:void 0,onKeyDown:a.Utilities.Html.onKeyboardEvent(function(b){if(b.ctrlKey){var c=new Date,d=String.fromCharCode(b.keyCode),e="Ctrl+"+d;switch(d){case"C":case"X":h.duration(f.prevTimeKeyDown,c.getTime())>f.minDuration&&h.logEngagementEvent(b,a.Event.EngagementEventNames.DesignPage.ShortCut.Clipboard,e),f.prevTimeKeyDown=c.getTime();break;case"V":h.logEngagementEvent(b,a.Event.EngagementEventNames.DesignPage.ShortCut.Clipboard,e);break;case"Y":case"Z":h.logEngagementEvent(b,a.Event.EngagementEventNames.DesignPage.ShortCut.UndoRedo,e)}}}),onCopy:function(b){var c=new Date;h.duration(f.prevTimeOnCopy,c.getTime())>f.minDuration&&h.logEngagementEvent(b,a.Event.EngagementEventNames.DesignPage.ShortCut.Clipboard,"onCopy"),f.prevTimeOnCopy=c.getTime()},onPaste:function(b){h.logEngagementEvent(b,a.Event.EngagementEventNames.DesignPage.ShortCut.Clipboard,"onPaste")},onCut:function(b){var c=new Date;h.duration(f.prevTimeOnCut,c.getTime())>f.minDuration&&h.logEngagementEvent(b,a.Event.EngagementEventNames.DesignPage.ShortCut.Clipboard,"onCut"),f.prevTimeOnCut=c.getTime()}});switch(i.TextFieldType){case e.AutoHeightMultiline:var l=80,m=k,n=null==i.MinimalHeight?l:i.MinimalHeight>0?i.MinimalHeight:0;m.MinHeight=n.toString()+"px",b=d(m);break;case e.FixHeightMultiline:c=React.DOM.textarea(k);break;case e.SingleLine:default:g=React.DOM.input(k)}var o;if(i.ShowCharCounter){var p=!i.Value||k.maxLength>i.Value.length?"office-form-textfield-counter":"office-form-textfield-counter textfield-counter-warning";o=React.DOM.label({className:p},this.getCounterString(i.Value,k.maxLength))}var q=a.Utilities.Html.combineAttributes("office-form-textfield",i.Options&&i.Options.classNameForInnerDiv);return React.DOM.div({className:q},b,c,g,o)},f.prototype.onChange=function(a){if(!this.props.Disabled){var b=a.target,c=b.value;if(c&&c.length>b.maxLength&&(c=c.slice(0,b.maxLength)),this.props.onValueChange(c),this.props.ShowCharCounter){var d=ReactDOM.findDOMNode(b).nextSibling;d&&(d.innerText=this.getCounterString(c,b.maxLength))}}},f.prototype.getCounterString=function(a,b){return(a||"").length.toString()+" / "+b.toString()},f.prototype.logEngagementEvent=function(b,c,d){var e;this.props.HTMLAttributes&&(e=this.props.HTMLAttributes.className),a.Event.EngagementEventDeprecated.logData({name:c,extraData:{targetClassName:e,operation:d}})},f.prototype.duration=function(a,b){return b-a},f.prevTimeKeyDown=0,f.prevTimeOnCopy=0,f.prevTimeOnCut=0,f.minDuration=500,f}(b.ControlBase);b.TextField=f;var g=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.textFieldRef=React.createRef(),b}return __extends(b,a),b.prototype.componentDidMount=function(){this.updateHeight(),this.windowResizeCallback=this.updateHeight.bind(this),window.addEventListener("resize",this.windowResizeCallback)},b.prototype.componentDidUpdate=function(){this.updateHeight()},b.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.windowResizeCallback)},b.prototype.focus=function(){this.textFieldRef.current&&this.textFieldRef.current.focus()},b.prototype.render=function(){var a=_.clone(this.props);return a.ref=this.textFieldRef,delete a.MinHeight,React.DOM.textarea(a)},b.prototype.updateHeight=function(){var a=ReactDOM.findDOMNode(this),b=this.props,c=a.parentElement,d=c.style.height;c.style.height=window.getComputedStyle(c).height,a.style.height=b.MinHeight;var e=a.offsetHeight-a.clientHeight;a.style.height=a.scrollHeight+e+"px",c.style.height=d,a.style.minHeight=b.MinHeight},b}(a.ReactComponent)}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(a){return React.createElement(d,a)}b.createToggleButton=c;var d=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.createReactNodes=function(){var a=[this.createToggleElement(),this.createLabel()];return a.concat(this.props.children)},c.prototype.createLabel=function(){var b=this.props.Options,c=b&&b.classNameForInnerLabel;return this.props.Disabled&&(c=a.Utilities.Html.combineAttributes(c,"disabled")),this.props.Label?React.DOM.span({className:c},this.props.Label):void 0},c.prototype.createToggleElement=function(){var b=this.props,c=b.Options,d=a.Utilities.Html.combineAttributes(c&&c.classNameForInnerDiv,b.Disabled?"toggle-button disabled":"toggle-button",b.Value?"office-form-theme-toggle active":void 0);return React.DOM.div({className:d,tabIndex:b.Disabled?-1:0,role:"button","aria-label":b.Label,"aria-pressed":!!b.Value,onClick:b.Disabled?function(){}:function(){b.onValueChange(!b.Value)},onKeyDown:function(c){(c.keyCode===a.KeyCode.Enter||c.keyCode===a.KeyCode.Space)&&b.onValueChange(!b.Value)}})},c}(b.ControlBase)}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(b){var c=function(){function c(c,d){this.controlId=null,this.isTabable=!0,this.isVisible=!1,this.isMouseDown=!1,this.onMathEditorInsertion=new a.Utilities.Process.CallbackManager,this.onInputCompleted=new a.Utilities.Process.CallbackManager,this.onExitEditingMath=new a.Utilities.Process.CallbackManager,this.mathEditor=null,this.editorAndKeysContainer=null,this.editorContainer=null,this.editorInput=null,this.keysContainer=null,this.keyMap=[],this.keyLayoutRowCount=null,this.keyLayoutColumnCount=null,this.keyStrokeManager=new b.KeyStrokeManager,this.keyUsageManager=new b.KeyUsageManager,this.outsiderContainerSelector="#body-scrollable-content",d?this.controlId=d:this.controlId=a.Utilities.Guid.newGuid(),this.createLayout(c),this.activateKeyboard()}return c.prototype.show=function(){this.isVisible||(this.editorAndKeysContainer.show(),this.mathEditor.focus(),this.isVisible=!0)},c.prototype.close=function(){var b=this.keyUsageManager.getClickUsage(),c=this.keyUsageManager.getKeyDownUsage();a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.DesignPage.MathKeyboard.Navigate,extraData:{clickCount:b,keydownCount:c}}),$(this.outsiderContainerSelector).off("click",this.onBodyClick),this.isVisible&&(this.editorAndKeysContainer.hide(),this.isVisible=!1)},c.prototype.attachEvent=function(a,c){if(c)switch(a){case b.KeyboardEventName.onMathEditorInsertion:this.onMathEditorInsertion.register(c);break;case b.KeyboardEventName.onInputCompleted:this.onInputCompleted.register(c);break;case b.KeyboardEventName.onExitEditingMath:this.onExitEditingMath.register(c)}},c.prototype.detachEvent=function(a,c){switch(a){case b.KeyboardEventName.onMathEditorInsertion:this.onMathEditorInsertion.unregister(c);break;case b.KeyboardEventName.onInputCompleted:this.onInputCompleted.unregister(c);break;case b.KeyboardEventName.onExitEditingMath:this.onExitEditingMath.unregister(c)}},c.prototype.setValue=function(a){this.mathEditor.select(),this.mathEditor.write(a),this.mathEditor.focus()},c.prototype.getValue=function(){return this.mathEditor.latex()},c.prototype.reset=function(){this.mathEditor.select(),this.mathEditor.keystroke("Backspace"),this.mathEditor.focus()},c.prototype.getElementId=function(a){return[this.controlId,a].join(b.KeyboardConstants.idNameJoiner)},c.prototype.parseKeyId=function(a){var c=a.split(b.KeyboardConstants.idNameJoiner);return c.length>=2?Number(c[1]):null},c.prototype.createLayout=function(a){this.editorAndKeysContainer=$("<div/>",{id:this.getElementId(b.KeyboardConstants.editorAndKeysContainerId),dir:"ltr"}).addClass(b.KeyboardConstants.editorAndKeysContainerClass).appendTo(a),this.createEditorLayout(),this.createKeysLayout()},c.prototype.activateKeyboard=function(){var a=this;this.onBodyClick=function(b){a.editorAndKeysContainer&&!a.editorAndKeysContainer.is(b.target)&&0===a.editorAndKeysContainer.has(b.target).length&&(a.isMouseDown?(b.preventDefault(),b.stopPropagation(),a.isMouseDown=!1):a.onInputCompleted.trigger(b))},$(this.outsiderContainerSelector).click(this.onBodyClick),this.editorInput.mousedown(function(b){b.preventDefault(),b.stopPropagation(),a.isMouseDown=!0}),this.editorInput.mouseup(function(b){a.isMouseDown=!1}),this.activateEditor(),this.activateKeys()},c.prototype.createEditorLayout=function(){this.editorContainer=$("<div/>").addClass(b.KeyboardConstants.editorContainerClass).attr({"aria-live":"polite"}).appendTo(this.editorAndKeysContainer),this.editorInput=$("<span/>").addClass(b.KeyboardConstants.editorInputClass).appendTo(this.editorContainer)},c.prototype.createKeysLayout=function(){this.keysContainer=$("<div/>").addClass(b.KeyboardConstants.keysContainerClass).appendTo(this.editorAndKeysContainer);var a=$("<div/>").addClass(b.KeyboardConstants.algebraKeysContainerClass).attr({role:"grid"}).appendTo(this.keysContainer);this.createSubKeysLayout(a)},c.prototype.createSubKeysLayout=function(c){var d=this,e=c.attr("class"),f=[];if(e!==b.KeyboardConstants.algebraKeysContainerClass)throw Error("className is not found.");f=b.KeysLayoutManager.getAlgebraLayout(),f.forEach(function(e){var f=$("<div/>").addClass(b.KeyboardConstants.keysRowClass).attr({role:"row"}).appendTo(c);e.forEach(function(c){var e=d.keyStrokeManager.getDefinition(c);if(e){var g={"class":a.Utilities.Html.combineAttributes("office-form-theme-interactive-color",b.KeyboardConstants.keyClass),id:d.getElementId(e.id.toString()),tabindex:-1,title:e.title,role:"gridcell","aria-label":e.title};g[b.KeyboardConstants.keyCommandAttribute]=e.command,g[b.KeyboardConstants.keyValueAttribute]=e.value,g[b.KeyboardConstants.keyCategoryAttribute]=e.category;var h=e.id===b.KeyboardConstants.KeyIdEnum.KeyEmpty?$("<div/>"):$("<button/>");h.attr(g).appendTo(f);$("<span/>").addClass([b.KeyboardConstants.keyClass,e.type].join("-")).text(e.displayValue).attr({"aria-hidden":!0}).appendTo(h);d.isTabable&&(h.removeAttr("tabindex"),d.isTabable=!1),e.command===b.KeyboardConstants.keyCommandSubmit&&(h.removeClass("office-form-theme-interactive-color"),h.addClass("office-form-theme-button"),h.removeAttr(b.KeyboardConstants.keyCategoryAttribute))}})})},c.prototype.activateEditor=function(){var c=this;if(!(this.editorInput&&this.editorInput.length>0))throw Error("Can not render mathField, editorInput is undefined.");var d=MathQuill.getInterface(2).MathField(this.editorInput[0]);this.mathEditor=d,this.editorInput.on("mousedown",".mq-text-mode",function(a){a.preventDefault(),a.stopPropagation()}),this.editorInput.on("keypress",function(a){var d=a.charCode||a.which,e=String.fromCharCode(d);e&&e.match(/^[(0-9.=+*\-)]$/)&&("*"===e&&(a.preventDefault(),a.stopPropagation(),e=c.keyStrokeManager.getDefinition(b.KeyboardConstants.KeyIdEnum.KeyMultiple).value,c.mathEditor.write(e),e="\\"+e),c.keyAnimation(e))}),this.editorInput.on("keydown",function(b){var d=b.keyCode||b.which,e=null;switch(d){case a.KeyCode.ArrowLeft:e="Left";break;case a.KeyCode.ArrowRight:e="Right";break;case a.KeyCode.BackSpace:e="Backspace"}c.keyAnimation(e),d===a.KeyCode.Enter?(b.preventDefault(),b.stopPropagation(),c.onInputCompleted.trigger(b)):d===a.KeyCode.PlaceHolder?b.key&&b.key.match(/^[a-zA-Z]$|^Unidentified$/)&&(b.preventDefault(),b.stopPropagation()):b.shiftKey&&d===a.KeyCode.Tab?c.onInputCompleted.trigger(b):d===a.KeyCode.Esc&&c.onExitEditingMath.trigger(b)})},c.prototype.activateKeys=function(){var c=this,d=this.keysContainer.find("."+[b.KeyboardConstants.keyClass,b.KeyboardConstants.keyTypeSymbol].join("-")),e=b.KeysLayoutManager.getAlgebraLayout();this.keyMap=b.KeysLayoutManager.getKeyMap(e),this.keyLayoutColumnCount=b.KeysLayoutManager.getLayoutColumnCount(e);for(var f=0;f<d.length;f++)MathQuill.getInterface(2).StaticMath(d[f]);this.keysContainer.on("mousedown",function(a){a.preventDefault(),a.stopPropagation(),c.mathEditor.focus()}),this.keysContainer.find("."+b.KeyboardConstants.keyClass).on("mousedown",function(a){if(!c.mathEditor)throw Error("mathEditor undefined.");a.preventDefault(),a.stopPropagation();var b=$(a.currentTarget);c.keyUsageManager.setClickUsage(c.getKeyId(b)),c.sendMathCommand(b),c.mathEditor.focus()}),this.keysContainer.find(".mq-root-block").on("mousedown",function(a){a.preventDefault(),a.stopPropagation();var d=$(a.currentTarget).closest("."+b.KeyboardConstants.keyClass);c.sendMathCommand(d)}),this.keysContainer.find("."+b.KeyboardConstants.keyClass).on("keydown",function(b){var d=b.which||b.keyCode,e=b.shiftKey;if(!e){var f=$(b.currentTarget);switch(d){case a.KeyCode.ArrowDown:case a.KeyCode.ArrowUp:case a.KeyCode.ArrowLeft:case a.KeyCode.ArrowRight:b.preventDefault(),b.stopPropagation();var g=c.getNextKeyId(f,d);if(g>=0){var h=c.getElementId(g.toString());$("#"+h).focus()}break;case a.KeyCode.Enter:case a.KeyCode.Space:b.preventDefault(),b.stopPropagation(),c.keyUsageManager.setKeyDownUsage(c.getKeyId(f)),c.sendMathCommand(f),f.focus();break;case a.KeyCode.BackSpace:b.preventDefault(),b.stopPropagation(),c.mathEditor.keystroke("Backspace");break;case a.KeyCode.Esc:c.onExitEditingMath.trigger(b)}}}),this.keysContainer.find("."+b.KeyboardConstants.keyClass).on("keypress",function(a){a.charCode>0&&c.mathEditor.typedText(String.fromCharCode(a.charCode))})},c.prototype.sendMathCommand=function(a){var c=a.attr(b.KeyboardConstants.keyCommandAttribute),d=a.attr(b.KeyboardConstants.keyValueAttribute);switch(c){case b.KeyboardConstants.keyCommandCmd:this.mathEditor.cmd(d);break;case b.KeyboardConstants.keyCommandWrite:this.mathEditor.write(d);break;case b.KeyboardConstants.keyCommandStroke:this.mathEditor.keystroke(d);break;case b.KeyboardConstants.keyCommandSubmit:this.onInputCompleted.trigger()}var e=this.parseKeyId(a.attr("id"));this.adjustCursor(e)},c.prototype.getNextKeyId=function(c,d){var e=this.parseKeyId(c.attr("id")),f=this.keyMap.indexOf(e);if(f>=0){var g=[-1,-1*this.keyLayoutColumnCount,1,this.keyLayoutColumnCount],h=f+g[d-a.KeyCode.ArrowLeft];if(h>=this.keyMap.length||-1>=h)return e;for(;this.keyMap[h]===b.KeyboardConstants.KeyIdEnum.KeyEmpty;)h+=d===a.KeyCode.ArrowRight?1:-1;return this.keyMap[h]}},c.prototype.keyAnimation=function(a){if(a){var c=this.keysContainer.find("["+b.KeyboardConstants.keyValueAttribute+"='"+a+"']");c&&(c.css("background-color","#D2D2D2"),setTimeout(function(){c.css("background-color","")},200))}},c.prototype.getKeyId=function(a){var b=a.attr("id");if(b)return this.parseKeyId(b)},c.prototype.adjustCursor=function(a){-1!==b.KeyboardConstants.cursorResetKeyIds.indexOf(a)&&this.mathEditor.keystroke("Left")},c}();b.VirtualKeyboard=c}(c=b.VirtualKeyboard||(b.VirtualKeyboard={}))}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){a.editorAndKeysContainerId="virtualkeyboard",a.algebraKeysContainerClass="vk-keys-algebrakeys",a.editorAndKeysContainerClass="vk-container",a.editorContainerClass="vk-editor-container",a.editorInputClass="vk-editor-input",a.keyClass="vk-keys-row-key",a.keysContainerClass="vk-keys-container",a.keysRowClass="vk-keys-row",a.keyCategoryAttribute="mq-category",a.keyCommandAttribute="mq-command",a.keyValueAttribute="mq-value",a.keyCategoryAlgebra="algebra",a.keyCategoryBasic="basic",a.keyCategoryCalculating="calculating",a.keyCategoryEmpty="empty",a.keyCategoryFunction="function",a.keyCommandWrite="write",a.keyCommandCmd="cmd",a.keyCommandStroke="keystroke",a.keyCommandSubmit="submit",a.keyTypeString="string",a.keyTypeSymbol="symbol",a.idNameJoiner="_";var b;!function(a){a[a.KeyEmpty=-1]="KeyEmpty",a[a.KeyZero=0]="KeyZero",a[a.KeyOne=1]="KeyOne",a[a.KeyTwo=2]="KeyTwo",a[a.KeyThree=3]="KeyThree",a[a.KeyFour=4]="KeyFour",a[a.KeyFive=5]="KeyFive",a[a.KeySix=6]="KeySix",a[a.KeySeven=7]="KeySeven",a[a.KeyEight=8]="KeyEight",a[a.KeyNine=9]="KeyNine",a[a.KeyEqual=10]="KeyEqual",a[a.KeyDot=11]="KeyDot",a[a.KeyComma=12]="KeyComma",a[a.KeyBackSpace=13]="KeyBackSpace",a[a.KeyLeftArrow=14]="KeyLeftArrow",a[a.KeyRightArrow=15]="KeyRightArrow",a[a.KeyAdd=16]="KeyAdd",a[a.KeyMinus=17]="KeyMinus",a[a.KeyMultiple=18]="KeyMultiple",a[a.KeyDivision=19]="KeyDivision",a[a.KeyGreaterOrEqual=20]="KeyGreaterOrEqual",a[a.KeyLessOrEqual=21]="KeyLessOrEqual",a[a.KeyParenthesis=22]="KeyParenthesis",a[a.KeyBracket=23]="KeyBracket",a[a.KeyAbs=24]="KeyAbs",a[a.KeyDenominator=25]="KeyDenominator",a[a.KeySquareRoot=26]="KeySquareRoot",a[a.KeyNthRoot=27]="KeyNthRoot",a[a.KeyX=28]="KeyX",a[a.KeyY=29]="KeyY",a[a.KeySquare=30]="KeySquare",a[a.KeyCaret=31]="KeyCaret",a[a.KeySubscript=32]="KeySubscript",a[a.KeyPi=33]="KeyPi",a[a.KeyAlpha=34]="KeyAlpha",a[a.KeyBeta=35]="KeyBeta",a[a.KeyDelta=36]="KeyDelta",a[a.KeyTheta=37]="KeyTheta",a[a.KeyGamma=38]="KeyGamma",a[a.KeySigma=39]="KeySigma",a[a.KeyLambda=40]="KeyLambda",a[a.KeyVarepsilon=41]="KeyVarepsilon",a[a.KeyCapitalSigma=42]="KeyCapitalSigma",a[a.KeyPhi=43]="KeyPhi",a[a.KeyCapitalDelta=44]="KeyCapitalDelta",a[a.KeyLog=45]="KeyLog",a[a.KeyLn=46]="KeyLn",a[a.KeyFactorial=47]="KeyFactorial",a[a.KeyInfinity=48]="KeyInfinity",a[a.KeyGreater=49]="KeyGreater",a[a.KeyLess=50]="KeyLess",a[a.KeyNotEqual=51]="KeyNotEqual",a[a.KeyMod=52]="KeyMod",a[a.KeyFloor=53]="KeyFloor",a[a.KeyCeil=54]="KeyCeil",a[a.KeySum=55]="KeySum",a[a.KeyProd=56]="KeyProd",a[a.KeyEnter=57]="KeyEnter",a[a.KeySin=58]="KeySin",a[a.KeyCos=59]="KeyCos",a[a.KeyTan=60]="KeyTan",a[a.KeyCot=61]="KeyCot",a[a.KeyDegree=62]="KeyDegree"}(b=a.KeyIdEnum||(a.KeyIdEnum={}));var c;!function(a){a[a.AlgebraKeyboard=0]="AlgebraKeyboard",a[a.BasicKeyboard=1]="BasicKeyboard"}(c=a.KeyboardTypeEnum||(a.KeyboardTypeEnum={})),a.cursorResetKeyIds=[b.KeyLog,b.KeyFactorial,b.KeyCeil,b.KeyFloor]}(b=a.KeyboardConstants||(a.KeyboardConstants={}))}(b=a.VirtualKeyboard||(a.VirtualKeyboard={}))}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){a.onMathEditorInsertion="onMathInsertion",a.onInputCompleted="onInputCompleted",a.onExitEditingMath="onExitEditingMath"}(b=a.KeyboardEventName||(a.KeyboardEventName={}))}(b=a.VirtualKeyboard||(a.VirtualKeyboard={}))}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(a){var b=function(){function b(){}return b.getAlgebraLayout=function(){return b.algebraLayoutArray},b.getLayoutRowCount=function(a){return a?0:a.length},b.getLayoutColumnCount=function(a){return a&&a.length>0?a[0].length:0},b.getKeyMap=function(a){var c=[];if(!a)return c;for(var d=a.length,e=b.getLayoutColumnCount(a),f=0,g=0;d>g;g++)for(var h=0;e>h;h++)c[f]=a[g][h],f++;return c},b.algebraLayoutArray=[[a.KeyboardConstants.KeyIdEnum.KeyX,a.KeyboardConstants.KeyIdEnum.KeyY,a.KeyboardConstants.KeyIdEnum.KeySubscript,a.KeyboardConstants.KeyIdEnum.KeyDenominator,a.KeyboardConstants.KeyIdEnum.KeyBracket,a.KeyboardConstants.KeyIdEnum.KeyParenthesis,a.KeyboardConstants.KeyIdEnum.KeySeven,a.KeyboardConstants.KeyIdEnum.KeyEight,a.KeyboardConstants.KeyIdEnum.KeyNine,a.KeyboardConstants.KeyIdEnum.KeyDivision],[a.KeyboardConstants.KeyIdEnum.KeyGreater,a.KeyboardConstants.KeyIdEnum.KeyLess,a.KeyboardConstants.KeyIdEnum.KeyGreaterOrEqual,a.KeyboardConstants.KeyIdEnum.KeyLessOrEqual,a.KeyboardConstants.KeyIdEnum.KeyNotEqual,a.KeyboardConstants.KeyIdEnum.KeyAbs,a.KeyboardConstants.KeyIdEnum.KeyFour,a.KeyboardConstants.KeyIdEnum.KeyFive,a.KeyboardConstants.KeyIdEnum.KeySix,a.KeyboardConstants.KeyIdEnum.KeyMultiple],[a.KeyboardConstants.KeyIdEnum.KeySquareRoot,a.KeyboardConstants.KeyIdEnum.KeyNthRoot,a.KeyboardConstants.KeyIdEnum.KeySquare,a.KeyboardConstants.KeyIdEnum.KeyCaret,a.KeyboardConstants.KeyIdEnum.KeyLog,a.KeyboardConstants.KeyIdEnum.KeyLn,a.KeyboardConstants.KeyIdEnum.KeyOne,a.KeyboardConstants.KeyIdEnum.KeyTwo,a.KeyboardConstants.KeyIdEnum.KeyThree,a.KeyboardConstants.KeyIdEnum.KeyMinus],[a.KeyboardConstants.KeyIdEnum.KeyPi,a.KeyboardConstants.KeyIdEnum.KeyFactorial,a.KeyboardConstants.KeyIdEnum.KeySum,a.KeyboardConstants.KeyIdEnum.KeyProd,a.KeyboardConstants.KeyIdEnum.KeyFloor,a.KeyboardConstants.KeyIdEnum.KeyCeil,a.KeyboardConstants.KeyIdEnum.KeyZero,a.KeyboardConstants.KeyIdEnum.KeyDot,a.KeyboardConstants.KeyIdEnum.KeyEqual,a.KeyboardConstants.KeyIdEnum.KeyAdd],[a.KeyboardConstants.KeyIdEnum.KeyInfinity,a.KeyboardConstants.KeyIdEnum.KeyDegree,a.KeyboardConstants.KeyIdEnum.KeyEmpty,a.KeyboardConstants.KeyIdEnum.KeyBackSpace,a.KeyboardConstants.KeyIdEnum.KeyLeftArrow,a.KeyboardConstants.KeyIdEnum.KeyRightArrow,a.KeyboardConstants.KeyIdEnum.KeyEnter]],b}();a.KeysLayoutManager=b}(b=a.VirtualKeyboard||(a.VirtualKeyboard={}))}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(b){var c=function(){function c(){this.keyStorage=[{id:b.KeyboardConstants.KeyIdEnum.KeyEmpty,command:null,type:null,value:null,displayValue:null,category:b.KeyboardConstants.keyCategoryEmpty,title:null},{id:b.KeyboardConstants.KeyIdEnum.KeyZero,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:"0",displayValue:"0",category:b.KeyboardConstants.keyCategoryBasic,title:"0"},{id:b.KeyboardConstants.KeyIdEnum.KeyOne,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:"1",displayValue:"1",category:b.KeyboardConstants.keyCategoryBasic,title:"1"},{id:b.KeyboardConstants.KeyIdEnum.KeyTwo,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:"2",displayValue:"2",category:b.KeyboardConstants.keyCategoryBasic,title:"2"},{id:b.KeyboardConstants.KeyIdEnum.KeyThree,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:"3",displayValue:"3",category:b.KeyboardConstants.keyCategoryBasic,title:"3"},{id:b.KeyboardConstants.KeyIdEnum.KeyFour,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:"4",displayValue:"4",category:b.KeyboardConstants.keyCategoryBasic,title:"4"},{id:b.KeyboardConstants.KeyIdEnum.KeyFive,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:"5",displayValue:"5",category:b.KeyboardConstants.keyCategoryBasic,title:"5"},{id:b.KeyboardConstants.KeyIdEnum.KeySix,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:"6",displayValue:"6",category:b.KeyboardConstants.keyCategoryBasic,title:"6"},{id:b.KeyboardConstants.KeyIdEnum.KeySeven,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,
value:"7",displayValue:"7",category:b.KeyboardConstants.keyCategoryBasic,title:"7"},{id:b.KeyboardConstants.KeyIdEnum.KeyEight,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:"8",displayValue:"8",category:b.KeyboardConstants.keyCategoryBasic,title:"8"},{id:b.KeyboardConstants.KeyIdEnum.KeyNine,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:"9",displayValue:"9",category:b.KeyboardConstants.keyCategoryBasic,title:"9"},{id:b.KeyboardConstants.KeyIdEnum.KeyEqual,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:"=",displayValue:"=",category:b.KeyboardConstants.keyCategoryCalculating,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Equal},{id:b.KeyboardConstants.KeyIdEnum.KeyDot,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:".",displayValue:".",category:b.KeyboardConstants.keyCategoryBasic,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Dot},{id:b.KeyboardConstants.KeyIdEnum.KeyComma,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:",",displayValue:",",category:b.KeyboardConstants.keyCategoryBasic,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Comma},{id:b.KeyboardConstants.KeyIdEnum.KeyBackSpace,command:b.KeyboardConstants.keyCommandStroke,type:b.KeyboardConstants.keyTypeString,value:"Backspace",displayValue:"CE",category:b.KeyboardConstants.keyCategoryFunction,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Backspace},{id:b.KeyboardConstants.KeyIdEnum.KeyLeftArrow,command:b.KeyboardConstants.keyCommandStroke,type:b.KeyboardConstants.keyTypeString,value:"Left",displayValue:"←",category:b.KeyboardConstants.keyCategoryFunction,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Leftarrow},{id:b.KeyboardConstants.KeyIdEnum.KeyRightArrow,command:b.KeyboardConstants.keyCommandStroke,type:b.KeyboardConstants.keyTypeString,value:"Right",displayValue:"→",category:b.KeyboardConstants.keyCategoryFunction,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Rightarrow},{id:b.KeyboardConstants.KeyIdEnum.KeyAdd,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:"+",displayValue:"+",category:b.KeyboardConstants.keyCategoryCalculating,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Add},{id:b.KeyboardConstants.KeyIdEnum.KeyMinus,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:"-",displayValue:"-",category:b.KeyboardConstants.keyCategoryCalculating,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Minus},{id:b.KeyboardConstants.KeyIdEnum.KeyMultiple,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:"\\times",displayValue:"×",category:b.KeyboardConstants.keyCategoryCalculating,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Multiply},{id:b.KeyboardConstants.KeyIdEnum.KeyDivision,command:b.KeyboardConstants.keyCommandCmd,type:b.KeyboardConstants.keyTypeString,value:"\\div",displayValue:"÷",category:b.KeyboardConstants.keyCategoryCalculating,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Division},{id:b.KeyboardConstants.KeyIdEnum.KeyGreaterOrEqual,command:b.KeyboardConstants.keyCommandCmd,type:b.KeyboardConstants.keyTypeString,value:"\\ge",displayValue:"≥",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_GreaterOrEqual},{id:b.KeyboardConstants.KeyIdEnum.KeyLessOrEqual,command:b.KeyboardConstants.keyCommandCmd,type:b.KeyboardConstants.keyTypeString,value:"\\le",displayValue:"≤",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_LessOrEqual},{id:b.KeyboardConstants.KeyIdEnum.KeyParenthesis,command:b.KeyboardConstants.keyCommandCmd,type:b.KeyboardConstants.keyTypeString,value:"(",displayValue:"( )",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Parenthesis},{id:b.KeyboardConstants.KeyIdEnum.KeyBracket,command:b.KeyboardConstants.keyCommandCmd,type:b.KeyboardConstants.keyTypeString,value:"[",displayValue:"[ ]",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Bracket},{id:b.KeyboardConstants.KeyIdEnum.KeyAbs,command:b.KeyboardConstants.keyCommandCmd,type:b.KeyboardConstants.keyTypeString,value:"|",displayValue:"|x|",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Absolute},{id:b.KeyboardConstants.KeyIdEnum.KeyDenominator,command:b.KeyboardConstants.keyCommandCmd,type:b.KeyboardConstants.keyTypeSymbol,value:"/",displayValue:"\\frac{x}{}",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Fraction},{id:b.KeyboardConstants.KeyIdEnum.KeySquareRoot,command:b.KeyboardConstants.keyCommandCmd,type:b.KeyboardConstants.keyTypeSymbol,value:"\\sqrt",displayValue:"\\sqrt{}",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_SquareRoot},{id:b.KeyboardConstants.KeyIdEnum.KeyNthRoot,command:b.KeyboardConstants.keyCommandCmd,type:b.KeyboardConstants.keyTypeSymbol,value:"\\nthroot",displayValue:"\\sqrt[]{}",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_NthRoot},{id:b.KeyboardConstants.KeyIdEnum.KeyX,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:"x",displayValue:"x",category:b.KeyboardConstants.keyCategoryAlgebra,title:"x"},{id:b.KeyboardConstants.KeyIdEnum.KeyY,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:"y",displayValue:"y",category:b.KeyboardConstants.keyCategoryAlgebra,title:"y"},{id:b.KeyboardConstants.KeyIdEnum.KeySquare,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeSymbol,value:"^2",displayValue:"x^2",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Square},{id:b.KeyboardConstants.KeyIdEnum.KeyCaret,command:b.KeyboardConstants.keyCommandCmd,type:b.KeyboardConstants.keyTypeSymbol,value:"^",displayValue:"x^{}",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Exponent},{id:b.KeyboardConstants.KeyIdEnum.KeySubscript,command:b.KeyboardConstants.keyCommandCmd,type:b.KeyboardConstants.keyTypeSymbol,value:"_",displayValue:"x_{}",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Subscript},{id:b.KeyboardConstants.KeyIdEnum.KeyPi,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:"\\pi",displayValue:"π",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Pi},{id:b.KeyboardConstants.KeyIdEnum.KeyAlpha,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:"\\alpha",displayValue:"α",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Alpha},{id:b.KeyboardConstants.KeyIdEnum.KeyBeta,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:"\\beta",displayValue:"β",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Beta},{id:b.KeyboardConstants.KeyIdEnum.KeyDelta,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:"\\delta",displayValue:"δ",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Delta},{id:b.KeyboardConstants.KeyIdEnum.KeyTheta,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:"\\theta",displayValue:"θ",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Theta},{id:b.KeyboardConstants.KeyIdEnum.KeyGamma,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:"\\gamma",displayValue:"γ",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Gamma},{id:b.KeyboardConstants.KeyIdEnum.KeySigma,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:"\\sigma",displayValue:"σ",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Sigma},{id:b.KeyboardConstants.KeyIdEnum.KeyLambda,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:"\\lambda",displayValue:"λ",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Lambda},{id:b.KeyboardConstants.KeyIdEnum.KeyVarepsilon,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:"\\varepsilon",displayValue:"ε",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Varepsilon},{id:b.KeyboardConstants.KeyIdEnum.KeyCapitalSigma,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:"\\Sigma",displayValue:"Σ",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_CapitalSigma},{id:b.KeyboardConstants.KeyIdEnum.KeyPhi,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:"\\phi",displayValue:"ϕ",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Phi},{id:b.KeyboardConstants.KeyIdEnum.KeyCapitalDelta,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:"\\Delta",displayValue:"Δ",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_CapitalDelta},{id:b.KeyboardConstants.KeyIdEnum.KeyLog,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeSymbol,value:"\\log_{}",displayValue:"\\log_{}",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Log},{id:b.KeyboardConstants.KeyIdEnum.KeyLn,command:b.KeyboardConstants.keyCommandCmd,type:b.KeyboardConstants.keyTypeString,value:"\\ln",displayValue:"ln",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Ln},{id:b.KeyboardConstants.KeyIdEnum.KeyFactorial,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:"!",displayValue:"x!",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Factorial},{id:b.KeyboardConstants.KeyIdEnum.KeyInfinity,command:b.KeyboardConstants.keyCommandCmd,type:b.KeyboardConstants.keyTypeString,value:"\\infty",displayValue:"∞",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Infinity},{id:b.KeyboardConstants.KeyIdEnum.KeyGreater,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:">",displayValue:">",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Greater},{id:b.KeyboardConstants.KeyIdEnum.KeyLess,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:"<",displayValue:"<",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Less},{id:b.KeyboardConstants.KeyIdEnum.KeyNotEqual,command:b.KeyboardConstants.keyCommandCmd,type:b.KeyboardConstants.keyTypeString,value:"\\neq",displayValue:"≠",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_NotEqual},{id:b.KeyboardConstants.KeyIdEnum.KeyMod,command:b.KeyboardConstants.keyCommandCmd,type:b.KeyboardConstants.keyTypeString,value:"\\mod",displayValue:"mod",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Mod},{id:b.KeyboardConstants.KeyIdEnum.KeyFloor,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:"\\lfloor{}\\rfloor",displayValue:"⌊x⌋",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Floor},{id:b.KeyboardConstants.KeyIdEnum.KeyCeil,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeString,value:"\\lceil{}\\rceil",displayValue:"⌈x⌉",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Ceil},{id:b.KeyboardConstants.KeyIdEnum.KeySum,command:b.KeyboardConstants.keyCommandCmd,type:b.KeyboardConstants.keyTypeString,value:"\\sum",displayValue:"∑",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Sum},{id:b.KeyboardConstants.KeyIdEnum.KeyProd,command:b.KeyboardConstants.keyCommandCmd,type:b.KeyboardConstants.keyTypeString,value:"\\prod",displayValue:"∏",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Prod},{id:b.KeyboardConstants.KeyIdEnum.KeyEnter,command:b.KeyboardConstants.keyCommandSubmit,type:b.KeyboardConstants.keyTypeString,value:"Enter",displayValue:"OK",category:b.KeyboardConstants.keyCategoryFunction,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Enter},{id:b.KeyboardConstants.KeyIdEnum.KeySin,command:b.KeyboardConstants.keyCommandCmd,type:b.KeyboardConstants.keyTypeString,value:"\\sin",displayValue:"sin",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Sin},{id:b.KeyboardConstants.KeyIdEnum.KeyCos,command:b.KeyboardConstants.keyCommandCmd,type:b.KeyboardConstants.keyTypeString,value:"\\cos",displayValue:"cos",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Cos},{id:b.KeyboardConstants.KeyIdEnum.KeyTan,command:b.KeyboardConstants.keyCommandCmd,type:b.KeyboardConstants.keyTypeString,value:"\\tan",displayValue:"tan",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Tan},{id:b.KeyboardConstants.KeyIdEnum.KeyCot,command:b.KeyboardConstants.keyCommandCmd,type:b.KeyboardConstants.keyTypeString,value:"\\cot",displayValue:"cot",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Cot},{id:b.KeyboardConstants.KeyIdEnum.KeyDegree,command:b.KeyboardConstants.keyCommandWrite,type:b.KeyboardConstants.keyTypeSymbol,value:"^\\circ",displayValue:"^\\circ",category:b.KeyboardConstants.keyCategoryAlgebra,title:a.Form.Resources.LocalizedStrings.VirtualKeyboard_Button_Degree}]}return c.prototype.getDefinition=function(a){var b=this.keyStorage.filter(function(b){return b.id===a});return b[0]},c}();b.KeyStrokeManager=c}(c=b.VirtualKeyboard||(b.VirtualKeyboard={}))}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(b){var c=function(){function c(){this.clickUsage={},this.keydownUsage={},this.keyCategory=[{id:b.KeyboardConstants.KeyIdEnum.KeyDot,category:d.Decimal},{id:b.KeyboardConstants.KeyIdEnum.KeyX,category:d.Variable},{id:b.KeyboardConstants.KeyIdEnum.KeyY,category:d.Variable},{id:b.KeyboardConstants.KeyIdEnum.KeySubscript,category:d.Variable},{id:b.KeyboardConstants.KeyIdEnum.KeyDenominator,category:d.Variable},{id:b.KeyboardConstants.KeyIdEnum.KeyPi,category:d.Constant},{id:b.KeyboardConstants.KeyIdEnum.KeyInfinity,category:d.Constant},{id:b.KeyboardConstants.KeyIdEnum.KeyBracket,category:d.Group},{id:b.KeyboardConstants.KeyIdEnum.KeyParenthesis,category:d.Group},{id:b.KeyboardConstants.KeyIdEnum.KeyGreater,category:d.Comparison},{id:b.KeyboardConstants.KeyIdEnum.KeyGreaterOrEqual,category:d.Comparison},{id:b.KeyboardConstants.KeyIdEnum.KeyLess,category:d.Comparison},{id:b.KeyboardConstants.KeyIdEnum.KeyLessOrEqual,category:d.Comparison},{id:b.KeyboardConstants.KeyIdEnum.KeyNotEqual,category:d.Comparison},{id:b.KeyboardConstants.KeyIdEnum.KeyNthRoot,category:d.Exponent},{id:b.KeyboardConstants.KeyIdEnum.KeySquareRoot,category:d.Exponent},{id:b.KeyboardConstants.KeyIdEnum.KeySquare,category:d.Exponent},{id:b.KeyboardConstants.KeyIdEnum.KeyCaret,category:d.Exponent},{id:b.KeyboardConstants.KeyIdEnum.KeyLog,category:d.Logarithm},{id:b.KeyboardConstants.KeyIdEnum.KeyLn,category:d.Logarithm},{id:b.KeyboardConstants.KeyIdEnum.KeyFactorial,category:d.Sequence},{id:b.KeyboardConstants.KeyIdEnum.KeySum,category:d.Sequence},{id:b.KeyboardConstants.KeyIdEnum.KeyProd,category:d.Sequence},{id:b.KeyboardConstants.KeyIdEnum.KeyCeil,category:d.Approximate},{id:b.KeyboardConstants.KeyIdEnum.KeyFloor,category:d.Approximate},{id:b.KeyboardConstants.KeyIdEnum.KeyAbs,category:d.Absolute},{id:b.KeyboardConstants.KeyIdEnum.KeyDegree,category:d.Degree}];for(var c=a.Utilities.getAllEnumValueNames(d),e=0;e<c.length;e++)this.clickUsage[c[e]]=0,this.keydownUsage[c[e]]=0}return c.prototype.setClickUsage=function(a){var b=this.getCategoryByKeyId(a);b>=0&&this.clickUsage[d[b]]++},c.prototype.setKeyDownUsage=function(a){var b=this.getCategoryByKeyId(a);b>=0&&this.keydownUsage[d[b]]++},c.prototype.getClickUsage=function(){return this.clickUsage},c.prototype.getKeyDownUsage=function(){return this.keydownUsage},c.prototype.getCategoryByKeyId=function(a){var b=this.keyCategory.filter(function(b){return b.id===a});return b&&b[0]?b[0].category:-1},c}();b.KeyUsageManager=c;var d;!function(a){a[a.Decimal=0]="Decimal",a[a.Variable=1]="Variable",a[a.Constant=2]="Constant",a[a.Group=3]="Group",a[a.Comparison=4]="Comparison",a[a.Exponent=5]="Exponent",a[a.Logarithm=6]="Logarithm",a[a.Sequence=7]="Sequence",a[a.Approximate=8]="Approximate",a[a.Absolute=9]="Absolute",a[a.Degree=10]="Degree"}(d||(d={}))}(c=b.VirtualKeyboard||(b.VirtualKeyboard={}))}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c=function(c){function d(){var b=null!==c&&c.apply(this,arguments)||this;return b.state={MathQuillLoaded:!1},b.onBlur=function(c){var d=a.Utilities.Html.getTargetElementOfFocusEvent(c),e=ReactDOM.findDOMNode(b);e.contains(d)||(b.props.onExit&&b.props.onExit(),b.props.onBoxBlur&&b.props.onBoxBlur(c))},b}return __extends(d,c),d.prototype.render=function(){return React.createElement("div",{onBlur:this.onBlur,ref:"VirtualKeyboard"})},d.prototype.componentWillMount=function(){var b=this;a.JavaScriptLoader.loadJavaScript("MathQuill").done(function(){b.setState({MathQuillLoaded:!0})})},d.prototype.componentDidMount=function(){this.renderVirtualKeyboard()},d.prototype.componentDidUpdate=function(){this.renderVirtualKeyboard()},d.prototype.componentWillUnmount=function(){this.keyborad&&(this.props.onValueChange(this.keyborad.getValue()),this.keyborad.close(),this.keyborad.detachEvent(b.VirtualKeyboard.KeyboardEventName.onInputCompleted,this.onValueChange),this.keyborad.detachEvent(b.VirtualKeyboard.KeyboardEventName.onExitEditingMath,this.onExitEdit))},d.prototype.renderVirtualKeyboard=function(){var a=this;if(this.state.MathQuillLoaded&&!this.keyborad){var c=$(ReactDOM.findDOMNode(this.refs.VirtualKeyboard));this.keyborad=new b.VirtualKeyboard.VirtualKeyboard(c,this.props.QuestionId),this.keyborad.show(),this.keyborad.setValue(this.props.Value),this.onExitEdit=function(b){a.props.onExit&&a.props.onExit(!0),a.props.onBoxBlur&&a.props.onBoxBlur()},this.onValueChange=function(b,c){a.props.onValueChange(a.keyborad.getValue()),a.onExitEdit(b)},this.keyborad.attachEvent(b.VirtualKeyboard.KeyboardEventName.onInputCompleted,this.onValueChange),this.keyborad.attachEvent(b.VirtualKeyboard.KeyboardEventName.onExitEditingMath,this.onExitEdit)}},d}(a.ReactComponent);b.VirtualKeyboardControl=c}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){a.Exports.DataProvider=b}(b=a.DataProvider||(a.DataProvider={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(a){a[a.OFFICE_FORMS_PLAN_2=0]="OFFICE_FORMS_PLAN_2",a[a.OFFICE_FORMS_PLAN_3=1]="OFFICE_FORMS_PLAN_3"}(c=b.EduLicenseName||(b.EduLicenseName={}));var d;!function(a){a[a.FORMS_PLAN_E1=0]="FORMS_PLAN_E1",a[a.FORMS_PLAN_E3=1]="FORMS_PLAN_E3",a[a.FORMS_PLAN_E5=2]="FORMS_PLAN_E5",a[a.FORMS_PLAN_K=3]="FORMS_PLAN_K"}(d=b.BusinessLicenseName||(b.BusinessLicenseName={}));var e;!function(a){a[a.FORMS_PRO=0]="FORMS_PRO"}(e||(e={}));var f=function(){function f(){}return f.isEduUser=function(){return f.getUserInfo().then(function(){return f.userHasEduLicense},function(){return $.Deferred().resolve(!1).promise()})},f.isBusinessUser=function(){return f.getUserInfo().then(function(){return f.userHasBusinessLicense},function(){return $.Deferred().resolve(!1).promise()})},f.isMsaFreeUser=function(){return f.getUserInfo().then(function(){return f.isMsaUser()&&!f.userHasMsaPaidLicense},function(){return $.Deferred().resolve(!1).promise()})},f.isMsaPaidUser=function(){return f.getUserInfo().then(function(){return f.isMsaUser()&&f.userHasMsaPaidLicense},function(){return $.Deferred().resolve(!1).promise()})},f.isFormsProUser=function(){return f.getUserInfo().then(function(){return f.userHasFormsProLicense},function(){return $.Deferred().resolve(!1).promise()})},f.isMsaUser=function(){var b=OfficeFormServerInfo.userInfo.TenantId;return!(!b||b.toLowerCase()!==a.EnvironmentConfig.getMsaTenantId())},f.isMsftUser=function(){var b=OfficeFormServerInfo.userInfo.TenantId;return!(!b||b.toLowerCase()!==a.EnvironmentConfig.getMsftTenantId())},f.isFastFoodTenant=function(){var b=OfficeFormServerInfo.userInfo.TenantId;return b&&-1!==a.EnvironmentConfig.getFastFoodTenantsId().indexOf(b.toLowerCase())},f.isFastFoodUser=function(){return a.Utilities.anyTrue(f.checkFastFoodUser("226a6eec-ea8c-4fad-a271-a956d378dc05"),f.checkFastFoodUser("0152e40c-08b6-4c80-8237-1ed743bc1f61"),f.checkFastFoodUser("bec3c99a-0246-4948-afa5-0e625c24e8b0"),f.checkFastFoodUser("7dec8ae0-a475-4883-a38a-537e74b6c036"))},f.getUserType=function(){return f.getUserInfo().then(function(){var a=b.Models.UserType.Unknown;return f.userHasEduLicense&&(a=b.Models.UserType.Edu),f.userHasBusinessLicense&&(a|=b.Models.UserType.Biz),f.isMsftUser()&&(a|=b.Models.UserType.MSIT),f.isMsaUser()&&(a|=f.userHasMsaPaidLicense?b.Models.UserType.MsaPaid:b.Models.UserType.MsaFree),f.userHasFormsProLicense&&(a|=b.Models.UserType.Pro),a},function(){return b.Models.UserType.Unknown})},f.setUserEduLicenseState=function(a){for(var b in c)if(a.hasOwnProperty(c[b])){var d=a[c[b]];if(d&&d.length>0)return void(f.userHasEduLicense=!0)}f.userHasEduLicense=!1},f.setUserBusinessLicenseState=function(a){for(var b in d)if(a.hasOwnProperty(d[b])){var c=a[d[b]];if(c&&c.length>0)return void(f.userHasBusinessLicense=!0)}f.userHasBusinessLicense=!1},f.setUserMsaLicenseState=function(a){return f.isMsaUser()&&a?void(f.userHasMsaPaidLicense=!0):void(f.userHasMsaPaidLicense=!1)},f.setUserFormsProLicenseState=function(a){for(var b in e)if(a.hasOwnProperty(e[b])){var c=a[e[b]];if(c&&c.length>0)return void(f.userHasFormsProLicense=!0)}f.userHasFormsProLicense=!1},f.getUserInfo=function(){return f.licenseReady||(f.licenseReady=$.Deferred(),$(document).ready(function(){if(OfficeFormServerInfo.userInfo.UserId){var b=a.DataProvider.ProviderManager.getInstance().createDataProvider();try{b.getUserInfo().then(function(a){var b=_.object(a.licenses.map(function(a){var b=a.licenseName,c=a.skus;return[b,JSON.parse(c)]}));f.setUserEduLicenseState(b),f.setUserBusinessLicenseState(b),f.setUserMsaLicenseState(a.isPaidUser),f.setUserFormsProLicenseState(b),f.licenseReady.resolve(b)},function(a){return f.licenseReady.reject(a)})}catch(c){f.licenseReady.reject(c)}}else f.licenseReady.resolve({});f.licenseReady.fail(function(b){a.Event.ErrorEventDeprecated.logData({errorName:"UserInfoGetFailure",errorInfo:b})})})),f.licenseReady.promise()},f.getDataClassificationLevels=function(){return f.dataClassification||(f.dataClassification=$.Deferred(),$(document).ready(function(){var b=a.DataProvider.ProviderManager.getInstance().createDataProvider();b.getDataClassificationLabels().then(function(a){f.dataClassification.resolve(a)},function(a){return f.dataClassification.reject(a)}),f.dataClassification.fail(function(b){a.Event.ErrorEventDeprecated.logData({errorName:"TenantDataClassificationLevelsGetFailure",errorInfo:b})})})),f.dataClassification.promise()},f.getDataClassificationLabelDetail=function(b,c){if(!this.dataClassificationLabelDetail){var d=a.DataProvider.ProviderManager.getInstance().createDataProvider();this.dataClassificationLabelDetail=d.getDataClassificationLabelDetail(b,c),this.dataClassificationLabelDetail.fail(function(b){a.Event.ErrorEventDeprecated.logData({errorName:"TenantDataClassificationLevelDetailGetFailure",errorInfo:b})})}return this.dataClassificationLabelDetail},f.checkFastFoodUser=function(b){if(!f.checkFastFoodPromises[b]){var c=a.DataProvider.ProviderManager.getInstance().createDataProvider();f.checkFastFoodPromises[b]=c.isMemberOf(b)}return f.checkFastFoodPromises[b]},f.checkFastFoodPromises={},f}();b.FeaturePlanProvider=f}(b=a.DataProvider||(a.DataProvider={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c,d=b.ErrorCode.InnerCode,e=a.Event.QosEventNames.ServiceEndpoints.FormElementBatch;!function(c){function f(){return n||(n="USGovGccProd"===a.EnvironmentConfig.getEnvironmentType()?$.Deferred().resolve("gcc").promise():b.FeaturePlanProvider.isMsaUser()||Forms.Common.isOwnerMsaUser()?$.Deferred().resolve("msa").promise():b.FeaturePlanProvider.isMsftUser()?a.Flighting.Flight.isEnabled("EnableFFUserGating")?b.FeaturePlanProvider.isFastFoodUser().then(function(a){return a?"fastfood":"msft"}):$.Deferred().resolve("msft").promise():Forms.Common.isOwnerMsftUser()?$.Deferred().resolve("msft").promise():b.FeaturePlanProvider.isFastFoodTenant()||Forms.Common.isOwnerOnFastFoodTenant()?$.Deferred().resolve("fastfood").promise():$.Deferred().resolve("business").promise()),n}function g(){var b="ms-formweb";if(a.EnvironmentSettings.IsIntegration){var c=a.EnvironmentSettings.GetHostString();c&&(b="ms-"+c.toLowerCase()),OfficeFormServerInfo.isOembedSPO&&(b="forms-webpart")}return b}function h(c,d){d=d||{};var h,k,l,n=$.Deferred(),o=[];if(!d.disableLog)if(d.batchSend){var p=c;k=c.data.PatchQuestions||c.data,l=new Forms.Telemetry.QosEvent(p.qosEventNameForBatch),l.ExtraData=p.qosExtraDataForBatch,l.start(),k.forEach(function(a,b){var c=new Forms.Telemetry.QosEvent(p.qosEventNameForEach);c.start(),void 0!==p.qosExtraDataForEach&&(c.ExtraData=p.qosExtraDataForEach[b],c.ExtraData.formBatch=!0,c.ExtraData.batchCorrelationId=l.CorrelationId),o.push(c)}),c.headers["X-CorrelationId"]=l.CorrelationId}else h=new a.Event.QosEventDeprecated(c.qosEventName),_.extend(h.Data,{extraData:_.clone(c.qosExtraData)}),h.start(),c.headers["X-CorrelationId"]=h.CorrelationId;d.disableXMsHeader||(c.headers["x-ms-form-request-source"]=g(),f().done(function(a){c.headers["x-ms-form-request-ring"]=a}));var q=-1,r=function(){q++,j(c,function(a){n.resolve(a)},function(a){if(q>=5)return void n.reject(a);var b,d=i(c,a),e=parseInt(d.statusCode),f=d.innerCode;if(0===e||502===e||503===e)b="Forms_Http_"+e.toString();else if(500===e&&6503===f)b="CDB_Http_"+f.toString();else{if(624!==f)return void n.reject(a);b="CDB_Http_"+f.toString()}h?h.log({resultCode:b,extraData:{RetryCount:q,ServiceError:a}}):l&&(_.extend(l.ExtraData,{RetryCount:q,ServiceError:a}),l.log({resultCode:b,extraData:l.ExtraData}),o&&o.forEach(function(c){_.extend(c.ExtraData,{RetryCount:q,ServiceError:a}),c.log({resultCode:b,extraData:c.ExtraData})})),r()},d.skipExpiredTokenCheck)};return r(),h?n.promise().done(function(b){var d={};if(d.resultCode=b&&b.response?b.response.statusCode:"",d.resultType="Success",c.qosEventName===a.Event.QosEventNames.ServiceEndpoints.Form.CreateForm){var e=m.parseResponseDataValue(b);d.extraData={FormId:e.id,XLWorkbookId:e.xlWorkbookId||void 0,Origin:Forms.Telemetry.getOrigin()||void 0,RetryCount:q||void 0}}h.end(d)}).fail(function(a){var b=i(c,a),d=parseInt(b.statusCode);h.end({resultCode:a&&a.response?a.response.statusCode:"",resultType:""===b.statusCode||d>=500?"Failure":"ExpectedFailure",extraData:{ServiceError:b,RetryCount:q||void 0}})}):l?n.promise().done(function(a){var d={resultCode:"200",resultType:"Success"};o&&o.forEach(function(f,g){var h=a[g]?b.HttpStatusCode[a[g].status]:"";if(a[g].status.toString()===b.HttpStatusCode[201]&&c.qosEventNameForBatch===e.CreateElements||a[g].status.toString()===b.HttpStatusCode[204]&&c.qosEventNameForBatch!==e.CreateElements){var i={};i.resultCode=h,i.resultType="Success",f.end(i)}else _.extend(f.ExtraData,{ServiceError:{statusCode:h,sourceUrl:c.requestUri.toString(),correlationId:f.CorrelationId,statusText:a[g]?a[g].status:"",innerCode:a[g]?a[g].errorMessage.errorCode:"",innerMessage:a[g]?a[g].errorMessage.message:""},RetryCount:q||void 0}),f.end({resultCode:h,resultType:""===b.HttpStatusCode[a[g].status]||a[g].status>=500?"Failure":"ExpectedFailure",extraData:f.ExtraData}),_.extend(l.ExtraData,{FailureQuestionCorrelationId:f.CorrelationId,ErrorCode:h}),"200"===d.resultCode&&(d.resultCode="207",d.resultType="PartialSuccess")}),l.end(d)}).fail(function(a){var b=i(c,a),d=parseInt(b.statusCode);_.extend(l.ExtraData,{ServiceError:b,RetryCount:q||void 0}),l.end({resultCode:a&&a.response?a.response.statusCode:"",resultType:""===b.statusCode||d>=500?"Failure":"ExpectedFailure",extraData:l.ExtraData}),o&&o.forEach(function(c){_.extend(c.ExtraData,{ServiceError:b,RetryCount:q||void 0}),c.end({resultCode:a&&a.response?a.response.statusCode:"",resultType:""===b.statusCode||d>=500?"Failure":"ExpectedFailure",extraData:c.ExtraData})})}):n.promise()}function i(a,b){var c=m.convertToResponseError(b);return{statusCode:b&&b.response?b.response.statusCode:"",sourceUrl:a.requestUri.toString(),correlationId:b&&b.response?b.response.headers["X-CorrelationId"]:"",statusText:b&&b.response?b.response.statusText:"",innerCode:c?c.innerCode:-1,innerMessage:c?c.innerMessage:"",failureReason:b&&b.response?b.response.headers["X-FailureReason"]:""}}function j(b,c,d,e){function f(e){Forms.AuthTokenHelper.isAuthTokenExpiredFailure(e)?Forms.AuthTokenHelper.refreshAuthToken(function(){a.Flighting.Flight.isEnabled("RefreshServerInfoInFrame")?b.blobResponseType?k(b,c,d):odatajs.oData.request(b,c,d):a.PageMethods.refreshAntiForgeryToken(function(){b.headers.__RequestVerificationToken=OfficeFormServerInfo.antiForgeryToken,g().always(function(){return odatajs.oData.request(b,c,d)})},function(){return Forms.Common.reloadPage()})},function(){Forms.Authenticator.signInThenRefresh()}):d(e)}function g(){var b=$.Deferred();return OfficeFormServerInfo.userInfo.UserId?b.resolve().promise():(a.PageMethods.refreshUserInfo(function(){return b.resolve()},function(){return b.resolve()}),b.promise())}void 0===e&&(e=!1),b.blobResponseType?k(b,c,e?d:f):odatajs.oData.request(b,c,e?d:f)}function k(a,b,c){var d=new XMLHttpRequest,e=a.requestUri;if(d.onreadystatechange=function(){if(null!=d&&4===d.readyState){var f=d.status,g=d.statusText;1223===f&&(f=204,g="No Content");var h=d.response;if(f>=200&&299>=f)d=null,b(h);else{var i=l(d);d=null,c({message:"HTTP request failed",request:a,response:{requestUri:e,statusCode:f,statusText:g,headers:i,body:h}})}}},d.open(a.method||"GET",e,!0),d.responseType="blob",a.headers)for(var f in a.headers)d.setRequestHeader(f,a.headers[f]);d.send(a.body)}function l(a){for(var b={},c=0,d=a.getAllResponseHeaders().split(/\r?\n/);c<d.length;c++){
var e=d[c];if(e){var f=e.split(": ");b[f[0]]=f[1]}}return b}var m=function(){function c(){}return c.parseAndTryHandleError=function(e){var f=c.convertToResponseError(e);if(f.statusCode!==b.ErrorCode.HttpStatusCode.Unauthorized||a.EnvironmentSettings.IsPPTIntegration)return f;if(c.logNonRecoverableError(f),a.Utilities.Html.getQueries().embed)return f.innerCode=d.EmbedFormNeedAuth,f;if(f.innerCode!==d.NoPermission&&f.innerCode!==d.RequireLogin)return f;var g=!(a.Utilities.isTbsBrowser()&&a.Utilities.isMicroMessenger()&&a.Utilities.isAndroid());return g?(Forms.Authenticator.signInThenRefresh(),$.Deferred().promise()):(f.innerCode=d.LoginNotSupportInCurrentBrowser,f)},c.logNonRecoverableError=function(b){if(b){var c=void 0;switch(b.innerCode){case d.UserNotAllowed:c=a.Event.EngagementEventNames.Auth.Auth.NotOnboardedTenant;break;case d.DisabledByTenantAdmin:c=a.Event.EngagementEventNames.Auth.Auth.DisabledByTenantAdmin;break;case d.UserNeedMultiFactorAuth:c=a.Event.EngagementEventNames.Auth.Auth.UserNeedMultiFactorAuth;break;default:c="Undefined auth error in ResponseHandler"}a.Event.EngagementEventDeprecated.logData({name:c,extraData:{tenantId:OfficeFormServerInfo.userInfo.TenantId}})}},c.parseResponseDataValue=function(a){return c.convertToAsyncResult(a).value},c.convertToAsyncResult=function(c){var d={status:b.AsyncResultStatus.Succeeded};if(null==c)d.value=c;else{var e=c["@odata.count"]&&parseInt(c["@odata.count"]);isNaN(e)||(d.count=e),d.value=a.Utilities.tryParseJson(void 0===c.value?c:c.value)}return d},c.convertToResponseError=function(b){var c={statusCode:b&&b.response&&b.response.statusCode,statusText:b&&b.response&&b.response.statusText,headers:b&&b.response&&b.response.headers,correlationId:b&&b.response&&b.response.headers["X-CorrelationId"]},e=b&&b.response&&a.Utilities.tryParseJson(b.response.body),f=e.error&&parseInt(e.error.code);return isNaN(f)?c.innerCode=0===c.statusCode?d.NetworkIssue:void 0:c.innerCode=f,c.innerMessage=e.error&&e.error.message,c},c}();c.ResponseHandler=m;var n;c.getRequestTargetRing=f,c.getExtendedSource=g,c.send=h}(c=b.OData||(b.OData={})),a.Exports.DataProvider.OData=c}(b=a.DataProvider||(a.DataProvider={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c=function(){function c(b,c){this.aadLauncherSesstionStorageKey="aadFormLauncher",this.msaLauncherSesstionStorageKey="msaFormLauncher",this.isAccessTokenFromHostReceived=!1,this.authContext=Forms.getPageContext().AuthContext,this.serviceUrl=b,this.ownerServiceUrl=c,this.partialUpdateHttpMethod=a.Flighting.Flight.isEnabled("PartialPut")?"PUT":"PATCH"}return Object.defineProperty(c,"AnalysisFormEntityCollectionName",{get:function(){return"analysisForms"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"FormEntityCollectionName",{get:function(){return"forms"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"RuntimeFormEntityCollectionName",{get:function(){return"runtimeForms"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"RuntimeFormEntityCollectionName2",{get:function(){return"runtimeForms2"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"QuestionEntityCollectionName",{get:function(){return"questions"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"DescriptiveElementEntityCollectionName",{get:function(){return"descriptiveQuestions"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"ChoiceEntityCollectionName",{get:function(){return"choices"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"ResponseEntityCollectionName",{get:function(){return"responses"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"RuntimeResponseEntityCollectionName",{get:function(){return"runtimeresponses"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"CommentEntityCollectionName",{get:function(){return"comments"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"GetSharedForm",{get:function(){return"GetSharedForm"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"PermissionEntityCollectionName",{get:function(){return"permissions"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"PermissionTokenEntityCollectionName",{get:function(){return"permissionTokens"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"SharedWithMeFormEntityCollectionName",{get:function(){return"sharedWithMeForms"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"GetAggregateQuizDataFunctionName",{get:function(){return"GetAggregateQuizData"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"GetAggregateSurveyDataFunctionName",{get:function(){return"GetAggregateSurveyData"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"GetOrCreatePermissionTokenFunctionName",{get:function(){return"Microsoft.FormServices.GetOrCreatePermissionToken"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"RemoveRecentFormFunctionName",{get:function(){return"RemoveFromRecent"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"CreateOneDriveSessionTempFolderFunctionName",{get:function(){return"Microsoft.FormServices.CreateOneDriveSessionTempFolder"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"MoveFormFunctionName",{get:function(){return"MoveForm"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"LocaleResourceEntityCollectionName",{get:function(){return"localeResource"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"BatchKeyword",{get:function(){return"batch"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"DeleteElementKeyword",{get:function(){return"delete"},enumerable:!0,configurable:!0}),c.addDefaultHeader=function(a,b){null===c.customizedHeaders&&(c.customizedHeaders={}),c.customizedHeaders[a]=b},c.prototype.getForms=function(b,d){var e=this.getSurveyWebOwnerServiceUrl()+"light/";return e+=c.FormEntityCollectionName+c.getQueryParameters("?",b,d),Forms.Common.logFlightStatus("SocialSharing"),this.sendRequest({requestUri:e,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.GetForms})},c.prototype.getFormsSharedWithCurrentUser=function(){var b=this.getSurveyWebOwnerServiceUrl()+c.SharedWithMeFormEntityCollectionName;return this.sendRequest({requestUri:b,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.GetSharedWithMeForms})},c.prototype.getFormId=function(b,c,d){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"GetFormId(tenantid='{0}',userid='{1}',tableid='{2}')".format(b,c,d),method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Function.GetFormId})},c.prototype.getDesignForm=function(b,d){var e=this.getSurveyWebOwnerServiceUrl()+"light/";return e+=c.FormEntityCollectionName+"('"+b+"')",e+=c.getQueryParameters("?",d),Forms.Common.logFlightStatus("SocialSharing"),this.sendRequest({requestUri:e,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.GetDesignForm})},c.prototype.getRuntimeForm=function(b,d){var e=this.getSurveyWebOwnerServiceUrl()+"light/"+c.RuntimeFormEntityCollectionName+"('"+b+"')";return e+=c.getQueryParameters("?",d),Forms.Common.logFlightStatus("SocialSharing"),this.sendRequest({requestUri:e,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.GetRuntimeForm})},c.prototype.getRuntimeFormV2=function(b,d){var e=this.getSurveyWebOwnerServiceUrl()+"light/"+c.RuntimeFormEntityCollectionName2+"('"+b+"')";return e+=c.getQueryParameters("?",d),Forms.Common.logFlightStatus("SocialSharing"),this.sendRequest({requestUri:e,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.GetRuntimeForm2})},c.prototype.getAnalysisTimeForm=function(b){var d="$expand="+c.QuestionEntityCollectionName+"($expand="+c.ChoiceEntityCollectionName+")",e=this.getSurveyWebOwnerServiceUrl()+"light/"+c.AnalysisFormEntityCollectionName+"('"+b+"')?"+d;return Forms.Common.logFlightStatus("SocialSharing"),this.sendRequest({requestUri:e,method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.GetAnalysisForm})},c.prototype.getSharedForm=function(b){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.GetSharedForm+"(formid='"+b+"',token='"+a.Utilities.Html.getQueries().sharetoken+"')",method:"GET",headers:{"Content-Type":"application/json;odata.metadata=minimal"},body:'{"value" : "'+a.Utilities.Html.getQueries().sharetoken+'"}',qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.GetSharedForm})},c.prototype.createOD4BSessionTempFolder=function(b){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.RuntimeFormEntityCollectionName+"('"+b+"')/"+c.CreateOneDriveSessionTempFolderFunctionName,method:"POST",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.CreateOD4BSessionTempFolder}).then(function(a){return a?a.itemId:$.Deferred().reject(new Error("Failed to create OneDriveForBusiness session temp folder.")).promise()})},c.prototype.changeSharingStatus=function(b,c){var d=c?"On":"Off";return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"/forms('"+b+"')/Microsoft.FormServices.Turn"+d+"AllowCopySetting",method:"POST",qosEventName:c?a.Event.QosEventNames.ServiceEndpoints.Form.TurnOnFormSharing:a.Event.QosEventNames.ServiceEndpoints.Form.TurnOffFormSharing})},c.prototype.createPermissionLink=function(b,d){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.PermissionEntityCollectionName,method:"POST",data:d,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.CreateFormPermissionLink})},c.prototype.deletePermissionLink=function(b,d){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.PermissionEntityCollectionName+"('"+d+"')",method:"DELETE",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.DeleteFormPermissionLink})},c.prototype.getFormPermissions=function(b){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.PermissionEntityCollectionName,method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.GetFormPermissions})},c.prototype.createPermissionToken=function(b,d){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.PermissionTokenEntityCollectionName,method:"POST",data:d,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.CreateFormPermissionToken})},c.prototype.getOrCreateFormPermissionToken=function(b,d,e){var f={};return a.EnvironmentSettings.IsTeamsIntegration&&(f["x-ms-form-request-source"]="ms-teams"),this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.GetOrCreatePermissionTokenFunctionName,method:"POST",headers:f,data:{type:d,name:e},qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.GetOrCreatePermissionToken})},c.prototype.deletePermissionToken=function(b,d){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.PermissionTokenEntityCollectionName+"('"+d+"')",method:"DELETE",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.DeleteFormPermissionToken})},c.prototype.getFormPermissionsTokens=function(b){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.PermissionTokenEntityCollectionName,method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.GetFormPermissionsToken})},c.prototype.getIdentityProviderType=function(b){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"authinfo/idptype?username="+encodeURIComponent(b),method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.GetIdentityProviderType}).then(function(a){return a.ProviderType})},c.prototype.createForm=function(b){var d={__TimezoneOffset:(new Date).getTimezoneOffset().toString()};return Forms.Common.logFlightStatus("SocialSharing"),this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName,method:"POST",data:b,headers:d,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.CreateForm,qosExtraData:{FormType:this.getFormType(b)}})},c.prototype.updateForm=function(b,d){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')",method:this.partialUpdateHttpMethod,data:d,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.UpdateForm,qosExtraData:{SoftDeleted:d.softDeleted}})},c.prototype.postFormShareAction=function(b){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/"+c.FormEntityCollectionName+"('"+b+"')/shareaction",method:"POST",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.PostShareAction})},c.prototype.createFormImageFromUrl=function(b,d,e){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+d,method:"POST",data:e,qosEventName:"logo"===d?a.Event.QosEventNames.ServiceEndpoints.Form.CreateImageFromUrl:a.Event.QosEventNames.ServiceEndpoints.Form.CreateThemeImageFromUrl,qosExtraData:{FormProperty:d}})},c.prototype.deleteForm=function(b){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')",method:"DELETE",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.DeleteForm})},c.prototype.dupFormForExcel=function(b,d){var e={id:b,xlWorkbookId:d};return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName,method:"POST",data:e,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Excel.DuplicateFormForExcel})},c.prototype.moveForm=function(b,d,e){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/"+c.FormEntityCollectionName+"('"+b+"')/"+c.MoveFormFunctionName,method:"POST",data:{newOwnerId:d,isNewOwnerGroup:e},qosEventName:a.Event.QosEventNames.ServiceEndpoints.Function.MoveForm,qosExtraData:{FormId:b,NewOwnerId:d,IsNewOwnerGroup:e}})},c.prototype.getRecentForms=function(b,c,d){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"GetRecentForms(pinnedState='{0}',extension='{1}',knowledge='{2}',count=250)".format(b,c,d),method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Function.GetRecentForms})},c.prototype.removeRecentForm=function(b){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.RemoveRecentFormFunctionName,method:"POST",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Function.RemoveRecentForm})},c.prototype.getFormsTenantSettings=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"GetFormsTenantSettings",method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Function.GetFormsTenantSettings})},c.prototype.getFormCreatorPhotoDefinition=function(b){return this.sendRequestWithToken({requestUri:this.getSurveyWebServiceUrl()+("light/GetFormCreatorDefinition('"+b+"','')"),method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Function.GetFormCreatorPhotoDefinition})},c.prototype.getFormCreatorPhotoValue=function(b){return this.sendRequestWithToken({blobResponseType:!0,requestUri:this.getSurveyWebServiceUrl()+("light/GetFormCreatorPhotoValue('"+b+"','')/$value"),method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Function.GetFormCreatorPhotoValue})},c.prototype.getCurrentUserPhotoValue=function(){return this.sendRequestWithToken({blobResponseType:!0,requestUri:this.getSurveyWebServiceUrl()+"GetCurrentUserPhotoValue",method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Function.GetCurrentUserPhotoValue})},c.prototype.getPrivacySettings=function(b,c){var d={};return b&&(d.ownerTenantId=b),c&&(d.currentUserTenantId=c),this.sendRequest({method:"GET",requestUri:this.getSurveyWebServiceUrl()+"privacy?"+$.param(d),qosEventName:a.Event.QosEventNames.ServiceEndpoints.Function.GetPrivacySettings})},c.prototype.getDataClassificationLabels=function(){return this.sendRequest({method:"GET",requestUri:this.getSurveyWebServiceUrl()+"/GetDataClassificationLabels",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Function.GetDataClassificationLabels})},c.prototype.getDataClassificationLabelDetail=function(b,c){return this.sendRequestWithoutToken({method:"GET",requestUri:this.getSurveyWebServiceUrl()+"/dataClassificationLabelInfo/"+b+"/"+encodeURIComponent(c),qosEventName:a.Event.QosEventNames.ServiceEndpoints.Function.GetDataClassificationLabelDetail})},c.prototype.getFormQuestion=function(b,d,e){var f=this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.QuestionEntityCollectionName+"('"+d+"')";return e&&(f=f+"?$select="+e.toString()),this.sendRequest({requestUri:f,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Question.GetQuestion})},c.prototype.getFormQuestionCount=function(b){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.QuestionEntityCollectionName+"/$count",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Question.GetQuestionCount})},c.prototype.createFormQuestion=function(b,d,e){var f=__assign({IsQuiz:d.isQuiz,QuestionId:d.id,QuestionType:d.type},e);return a.Flighting.Flight.isEnabled("QuestionBatchOperation")?Forms.FormElementBatchRelated.createElementBatch(d,b,f):this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.QuestionEntityCollectionName,method:"POST",data:d,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Question.CreateQuestion,qosExtraData:f})},c.prototype.createQuestionImageFromUrl=function(b,d,e){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.QuestionEntityCollectionName+"('"+d+"')/image",method:"POST",data:e,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Question.CreateImageFromUrl,qosExtraData:{QuestionId:d}})},c.prototype.updateFormQuestion=function(b,d,e,f,g){var h=this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.QuestionEntityCollectionName+"('"+d+"')",i=__assign({QuestionType:e},g);return a.Flighting.Flight.isEnabled("QuestionBatchOperation")?Forms.FormElementBatchRelated.updateElementBatch(f,b,d,i):this.sendRequest({requestUri:h,method:this.partialUpdateHttpMethod,data:f,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Question.UpdateQuestion,qosExtraData:i},{disableLog:!0})},c.prototype.deleteFormQuestion=function(b,d,e,f){var g=__assign({QuestionType:e},f);return a.Flighting.Flight.isEnabled("QuestionBatchOperation")?Forms.FormElementBatchRelated.deleteElementBatch(b,d,g):this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.QuestionEntityCollectionName+"('"+d+"')",method:"DELETE",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Question.DeleteQuestion,qosExtraData:g})},c.prototype.getFormDescriptiveElement=function(b,d,e){var f=this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.DescriptiveElementEntityCollectionName+"('"+d+"')";return e&&(f=f+"?$select="+e.toString()),this.sendRequest({requestUri:f,qosEventName:a.Event.QosEventNames.ServiceEndpoints.DescriptiveElement.Get})},c.prototype.createFormDescriptiveElement=function(b,d,e){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.DescriptiveElementEntityCollectionName,method:"POST",data:d,qosEventName:a.Event.QosEventNames.ServiceEndpoints.DescriptiveElement.Create,qosExtraData:__assign({QuestionId:d.id,QuestionType:d.type},e)})},c.prototype.updateFormDescriptiveElement=function(b,d,e,f,g){var h=this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.DescriptiveElementEntityCollectionName+"('"+d+"')";return this.sendRequest({requestUri:h,method:this.partialUpdateHttpMethod,data:f,qosEventName:a.Event.QosEventNames.ServiceEndpoints.DescriptiveElement.Update,qosExtraData:__assign({QuestionType:e},g)},{disableLog:!0})},c.prototype.deleteFormDescriptiveElement=function(b,d,e,f){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.DescriptiveElementEntityCollectionName+"('"+d+"')",method:"DELETE",qosEventName:a.Event.QosEventNames.ServiceEndpoints.DescriptiveElement.Delete,qosExtraData:__assign({QuestionType:e},f)})},c.prototype.createFormElements=function(b,d){if(!b||0===b.length)throw Error("The request list of batch create question API is empty.");return this.sendRequest({requestUri:""+this.getSurveyWebOwnerServiceUrl()+c.BatchKeyword+"/"+c.FormEntityCollectionName+"('"+d+"')/"+c.QuestionEntityCollectionName,method:"POST",data:b.map(function(a){return a.element}),qosEventNameForBatch:a.Event.QosEventNames.ServiceEndpoints.FormElementBatch.CreateElements,qosExtraDataForBatch:{elementList:b.map(function(a){return a.element.id})},qosEventNameForEach:a.Event.QosEventNames.ServiceEndpoints.Question.CreateQuestion,qosExtraDataForEach:b.map(function(a){return a.extraQosData})},{batchSend:!0})},c.prototype.deleteFormElements=function(b,d){if(!b||0===b.length)throw Error("The request list of batch delete question API is empty.");return this.sendRequest({requestUri:""+this.getSurveyWebOwnerServiceUrl()+c.BatchKeyword+"/"+c.DeleteElementKeyword+"/"+c.FormEntityCollectionName+"('"+d+"')/"+c.QuestionEntityCollectionName,method:"POST",data:b.map(function(a){return a.questionId}),qosEventNameForBatch:a.Event.QosEventNames.ServiceEndpoints.FormElementBatch.DeleteElements,qosExtraDataForBatch:{elementList:b.map(function(a){return a.questionId})},qosEventNameForEach:a.Event.QosEventNames.ServiceEndpoints.Question.DeleteQuestion,qosExtraDataForEach:b.map(function(a){return a.extraQosData})},{batchSend:!0})},c.prototype.updateFormElements=function(b,d){if(!b||0===b.length)throw Error("The request list of batch update question API is empty.");var e=b.map(function(a){return a.questionId}),f=b.map(function(a){return a.element}),g=b.map(function(a){return a.extraQosData}),h={QuestionIds:e,PatchQuestions:f};return this.sendRequest({requestUri:""+this.getSurveyWebOwnerServiceUrl()+c.BatchKeyword+"/"+c.FormEntityCollectionName+"('"+d+"')/"+c.QuestionEntityCollectionName,method:this.partialUpdateHttpMethod,data:h,qosEventNameForBatch:a.Event.QosEventNames.ServiceEndpoints.FormElementBatch.UpdateElements,qosExtraDataForBatch:{elementList:e},qosEventNameForEach:a.Event.QosEventNames.ServiceEndpoints.Question.UpdateQuestion,qosExtraDataForEach:g},{batchSend:!0})},c.prototype.createQuestionChoice=function(b,d,e){var f=this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.QuestionEntityCollectionName+"('"+d+"')/"+c.ChoiceEntityCollectionName;return this.sendRequest({requestUri:f,method:"POST",data:e,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Choice.CreateChoice})},c.prototype.getQuestionChoice=function(b,d,e){var f=this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.QuestionEntityCollectionName+"('"+d+"')/"+c.ChoiceEntityCollectionName+"("+e+")";return this.sendRequest({requestUri:f,method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Choice.GetChoice})},c.prototype.updateQuestionChoice=function(b,d,e,f){var g=this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.QuestionEntityCollectionName+"('"+d+"')/"+c.ChoiceEntityCollectionName+"("+e+")";return this.sendRequest({requestUri:g,method:this.partialUpdateHttpMethod,data:f,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Choice.UpdateChoice})},c.prototype.deleteQuestionChoice=function(b,d,e){var f=this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.QuestionEntityCollectionName+"('"+d+"')/"+c.ChoiceEntityCollectionName+"("+e+")";return this.sendRequest({requestUri:f,method:"DELETE",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Choice.DeleteChoice})},c.prototype.getFormResponses=function(b,d,e,f){var g=["$expand="+c.CommentEntityCollectionName];d&&g.push("$filter={0}+{1}+{2}".format(d.name,d.operator,d.value)),e>=0&&f>=0&&g.push("$top={0}&$skip={1}".format(e,f));var h=g.filter(function(a){return!!a}).join("&");h=h&&"?"+h;var i=this.getSurveyWebOwnerServiceUrl()+"light/";return this.sendRequest({requestUri:i+c.FormEntityCollectionName+"('"+b+"')/"+c.ResponseEntityCollectionName+h,qosEventName:_.any(g,function(a){return-1===a.indexOf("$filter")})?a.Event.QosEventNames.ServiceEndpoints.Response.GetResps:a.Event.QosEventNames.ServiceEndpoints.Response.GetRespFilter})},c.prototype.getRuntimeResponses=function(b,d){var e="?$expand="+c.CommentEntityCollectionName,f=d?"&$filter=responder+eq+'"+encodeURIComponent(d.replace(/\'/g,"''"))+"'":"",g=this.getSurveyWebOwnerServiceUrl();return this.sendRequest({requestUri:g+c.FormEntityCollectionName+"('"+b+"')/"+c.RuntimeResponseEntityCollectionName+e+f,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Response.GetRuntimeResps})},c.prototype.getRuntimeResponse=function(b,d){var e="?$expand="+c.CommentEntityCollectionName,f=a.Utilities.Html.getQueries(),g={};return f.GetResponseToken&&(g={GetResponseToken:f.GetResponseToken}),this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/"+c.FormEntityCollectionName+"('"+b+"')/"+c.RuntimeResponseEntityCollectionName+"("+d+")"+e,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Response.GetRuntimeResponse,headers:g})},c.prototype.getAnalysisTimeResponses=function(b,d,e){var f="?$expand="+c.CommentEntityCollectionName,g=this.getSurveyWebOwnerServiceUrl()+c.AnalysisFormEntityCollectionName+"('"+b+"')/"+c.ResponseEntityCollectionName+f;return d>=0&&e>=0&&(g+="&$top={0}&$skip={1}".format(d,e)),this.sendRequest({requestUri:g,method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Response.GetAnalysisTimeResponses})},c.prototype.getFormsResponseCount=function(){return this.sendRequestWithToken({requestUri:this.getSurveyWebServiceUrl()+"light/GetRespCounts()",method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Function.GetFormCreatorPhotoDefinition})},c.prototype.getFormResponseCount=function(b){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.ResponseEntityCollectionName+"/$count",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Response.GetRespCount},{disableLog:!0})},c.prototype.submitFormResponse=function(b,d){var e=a.Utilities.FormId.decodeFormId(b),f="AAD";return null==e.OrgId?f="Unknown":e.OrgId.toLowerCase()===a.EnvironmentConfig.getMsaTenantId()&&(f="MSA"),Forms.Common.logFlightStatus("SocialSharing"),this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.ResponseEntityCollectionName,method:"POST",data:d,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Response.SubmitResp,qosExtraData:{OwnerSource:f}})},c.prototype.deleteFormResponses=function(b){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.ResponseEntityCollectionName,method:"DELETE",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Response.DeleteResps})},c.prototype.deleteFormResponse=function(b,d){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.ResponseEntityCollectionName+"("+d+")/",method:"DELETE",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Response.DeleteResp})},c.prototype.addFormResponseComment=function(b,d,e){var f={feedback:e.feedback,score:e.score,questionId:e.questionId};return e.id&&(f.id=e.id),this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.ResponseEntityCollectionName+"("+d+")/"+c.CommentEntityCollectionName,method:"POST",data:f,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Response.AddComment})},c.prototype.setResponseReleaseDate=function(b,d,e){var f={releaseDate:e};return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.ResponseEntityCollectionName+"("+d+")",method:this.partialUpdateHttpMethod,data:f,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Response.SetReleaseDate})},c.prototype.createExportFile=function(a){var b=this;return this.getToken().then(function(d){var e,f="cdb-export-iframe",g=b.createHiddenIFrame(f);if(e=document.createElement("form"),e.style.display="none",e.method="POST",e.action=b.getSurveyWebServiceUrl()+c.FormEntityCollectionName+"('"+a+"')/Microsoft.FormServices.CreateExportFile",e.target=f,null!==d){var h=document.createElement("input");h.type="hidden",h.name="Authorization",h.value="Bearer "+d,e.appendChild(h)}if(null!==OfficeFormServerInfo.antiForgeryToken){var i=document.createElement("input");i.type="hidden",i.name="__RequestVerificationToken",i.value=OfficeFormServerInfo.antiForgeryToken,e.appendChild(i)}document.body.appendChild(g),$(g).ready(function(){g.contentDocument.body.appendChild(e)}),e.submit()})},c.prototype.downloadExcelFile=function(c,d,e){var f=this;return this.getToken().then(function(g){var h=new a.Event.QosEventDeprecated(a.Event.QosEventNames.ServiceEndpoints.Function.DownloadExcelFileApi);h.start();var i=$.Deferred(),j="download-excel-iframe",k=f.createHiddenIFrame(j);return document.body.appendChild(k),$(k).ready(function(){var j="downloadCookie"+(new Date).getTime(),l=f.getDownloadExcelRequestUrlParameters(c,d,e,j,h.CorrelationId,g),m=f.getDownloadExcelRequestUrl(l),n={sourceUrl:m,innerCode:b.ErrorCode.InnerCode.DownloadExcelFileFailed,innerMessage:void 0},o=24,p=o,q=5e3,r=function(){var c=a.Utilities.getCookie(j);if("success"===c)return h.end({resultType:"Success"}),window.clearInterval(s),a.Utilities.clearCookie(j),void i.resolve();if(p--<0){k.onload=null,window.clearInterval(s);var d=_.clone(n);if(!a.EnvironmentConfig.isOsi())return h.end({resultType:"Success"}),void i.resolve();d.innerMessage="TimeOut",d.innerCode=b.ErrorCode.InnerCode.DownloadExcelFileTimeout,h.end({resultType:"Failure",extraData:{ServiceError:d}}),i.reject({innerCode:b.ErrorCode.InnerCode.DownloadExcelFileTimeout,innerMessage:d.innerMessage})}},s=window.setInterval(r,q),t=3,u=function(){p=o,s=window.setInterval(r,q),k.contentWindow.location.href=m};$(k).on("load",function(){var c="";if(a.Flighting.Flight.isEnabled("LogDownloadExcelErrorMessage"))try{c=k.contentDocument.body.innerText}catch(d){c="Cross-origin so doesn't get the error message."}if(window.clearInterval(s),t>0)t--,f.downloadExcelCheckAndHandleAuthFailure(c,u);else{var e=_.clone(n);e.innerMessage="Error",h.end({resultType:"Failure",extraData:{ServiceError:e,errorMessage:c}}),i.reject({innerCode:b.ErrorCode.InnerCode.DownloadExcelFileFailed,innerMessage:e.innerMessage})}}),k.contentWindow.location.href=m}),i.promise()})},c.prototype.getShellServiceInfo=function(b){var c=this,d=null,e=a.SafeStorage.SessionStorage;if(d=e.getItem(this.aadLauncherSesstionStorageKey)){var f=$.Deferred();return f.resolve(JSON.parse(d)).promise()}return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"GetShellServiceInfo(culture='{0}')".format(b),method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Function.GetShellServiceInfo}).then(function(a){return e.setItem(c.aadLauncherSesstionStorageKey,JSON.stringify(a)),a})},c.prototype.getConsumerShellServiceInfo=function(b){var c=this,d=null,e=a.SafeStorage.SessionStorage;if(d=e.getItem(this.msaLauncherSesstionStorageKey)){var f=$.Deferred();return f.resolve(JSON.parse(d)).promise()}return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"GetConsumerShellServiceInfo(culture='{0}')".format(b),method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Function.GetConsumerShellServiceInfo}).then(function(a){return window.sessionStorage.setItem(c.msaLauncherSesstionStorageKey,JSON.stringify(a)),a})},c.prototype.getOrNewExcelInOneDrive=function(b,c){var d=this.getSurveyWebOwnerServiceUrl()+"GetOrNewExcelInOneDrive(formid='"+b+"',forcereexport='"+c+"')";return this.sendRequest({requestUri:d,method:"GET",headers:{__TimezoneOffset:(new Date).getTimezoneOffset().toString()
},qosEventName:a.Event.QosEventNames.ServiceEndpoints.Action.OpenExcelInOneDrive})},c.prototype.getYoutubeVideoInfo=function(b){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"embed?youtubeurl="+encodeURIComponent(b),method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Function.GetYouTubeVideoInfo})},c.prototype.getUserInfo=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"userInfo",method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Function.GetUserInfo})},c.prototype.getXlWorkbookId=function(b){var c=this.getSurveyWebServiceUrl()+"GetXlWorkbookId(formid='"+b+"')";return this.sendRequest({requestUri:c,method:"GET",headers:{__TimezoneOffset:(new Date).getTimezoneOffset().toString()},qosEventName:a.Event.QosEventNames.ServiceEndpoints.Action.GetXlWorkbookId})},c.prototype.isMemberOf=function(b){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"light/IsMemberOf('"+b+"')",method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Function.IsMemberOf},{disableXMsHeader:!0})},c.prototype.mathCalculation=function(b){if(!b||!b.Mathml){var c={Aria:"",Responses:[]};return $.Deferred().resolve(c).promise()}var d={Context:b.Context,Formulas:[b.Mathml],InputFormat:"MathML",Locale:navigator.language,Mode:1,OutputFormat:"latex",RequiredIncorrectAnswerCount:b.IncorrectAnswerCount};return this.sendRequest({data:d,method:"POST",requestUri:this.getSurveyWebServiceUrl()+"math/calculation?formId="+b.FormId+"&questionId="+b.QuestionId,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Question.MathCalculation})},c.prototype.mathQuestionGeneration=function(b){if(!b.Context){var c={Features:0,Results:[]};return $.Deferred().resolve(c).promise()}var d={Features:b.Features,Input:b.Context,InputFormat:"MathML",Locale:navigator.language,OutputFormat:"latex",RequiredQuestionsCount:b.QuestionCount,RequiredIncorrectAnswerCount:b.IncorrectAnswerCount};return this.sendRequest({data:d,method:"POST",requestUri:this.getSurveyWebServiceUrl()+"mathapi/questions?formId="+b.FormId+"&questionId="+b.QuestionId,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Question.MathQuestionGeneration})},c.prototype.browseImage=function(b,c,d){var e={resourceId:b,itemCount:c,skipToken:d};return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/browseimage",method:"POST",data:e,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Decomposition.BrowseImage})},c.prototype.getToken=function(){return this.authContext.getFormApiToken()},c.prototype.searchImage=function(b,c,d,e,f){var g={query:b,itemCount:d,lcid:OfficeFormServerInfo.cultureInfo.Name.toLowerCase(),parameters:{license:c},skipToken:e.toString(),url:f};return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/searchimage",method:"POST",data:g,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Decomposition.SearchImage})},c.prototype.getCdbToken=function(){var b=$.Deferred();return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/getTokenForResource?resourceType=CollabDB",method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Decomposition.GetCdbToken}).then(function(a){a?b.resolve(a):b.reject(new Error("Failed to get CDB token via GetTokenForResource"))},function(a){b.reject(a)}),b.promise()},c.prototype.getOD4BToken=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/getTokenForResource?resourceType=MSGraph",method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Decomposition.GetOD4BToken}).then(function(a){return a?"Bearer "+a:$.Deferred().reject(new Error("Failed to get OneDriveForBusiness token via GetTokenForResource")).promise()})},c.prototype.reportAbuse=function(b){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"contentvalidation/report",method:"POST",data:b,qosEventName:a.Event.QosEventNames.ServiceEndpoints.OnlineSafety.ReportAbuse,qosExtraData:{Category:b.Category}})},c.prototype.checkPhishingKeyword=function(b){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"contentvalidation/checkphishing",method:"POST",data:b,qosEventName:a.Event.QosEventNames.ServiceEndpoints.OnlineSafety.CheckPhishingKeyword})},c.prototype.getGroups=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"groups",method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Group.GetGroups})},c.prototype.getGroupId=function(b){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"groupinfo/getgroupid?onedriveweburl="+encodeURIComponent(b),method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.GetGroupId})},c.prototype.getGroup=function(b){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+("groups('"+b+"')"),method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Group.GetGroup})},c.prototype.getGroupOwners=function(b){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+("groups('"+b+"')/owners"),method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Group.GetOwners})},c.prototype.getGroupMembers=function(b){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+("groups('"+b+"')/members"),qosEventName:a.Event.QosEventNames.ServiceEndpoints.Group.GetMembers})},c.prototype.getGroupPhotoDefinition=function(b){return this.sendRequestWithToken({requestUri:this.getSurveyWebServiceUrl()+("groups('"+b+"')/photo"),method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Group.GetPhotoDefinition})},c.prototype.getGroupPhotoValue=function(b){return this.sendRequestWithToken({blobResponseType:!0,requestUri:this.getSurveyWebServiceUrl()+("groups('"+b+"')/photo/$value"),method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Group.GetPhotoValue})},c.prototype.getGroupMemberPhotoDefinition=function(b,c){return this.sendRequestWithToken({requestUri:this.getSurveyWebServiceUrl()+("groups('"+b+"')/members('"+c+"')/photo"),method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Group.GetMemberPhotoDefinition})},c.prototype.getGroupMemberPhotoValue=function(b,c){return this.sendRequestWithToken({blobResponseType:!0,requestUri:this.getSurveyWebServiceUrl()+("groups('"+b+"')/members('"+c+"')/photo/$value"),method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Group.GetMemberPhotoValue})},c.prototype.getAnalysisSurveyData=function(b){var d=this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.GetAggregateSurveyDataFunctionName;return this.sendRequest({requestUri:d,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Analysis.AggregateSurveyData})},c.prototype.getAnalysisQuizData=function(b){var d=this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.GetAggregateQuizDataFunctionName;return this.sendRequest({requestUri:d,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Analysis.AggregateQuizData})},c.prototype.getResultSharingAnalysisSurveyData=function(b){var d=this.getSurveyWebOwnerServiceUrl()+c.AnalysisFormEntityCollectionName+"('"+b+"')/"+c.GetAggregateSurveyDataFunctionName;return this.sendRequest({requestUri:d,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Analysis.ResultSharingAggregateSurveyData})},c.prototype.getResultSharingAnalysisQuizData=function(b){var d=this.getSurveyWebOwnerServiceUrl()+c.AnalysisFormEntityCollectionName+"('"+b+"')/"+c.GetAggregateQuizDataFunctionName;return this.sendRequest({requestUri:d,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Analysis.ResultSharingAggregateQuizData})},c.prototype.getInsights=function(b){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"insights/getinsights?formId="+encodeURIComponent(b),method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.GetInsights})},c.prototype.getFormsWithToken=function(b,d,e){void 0===b&&(b=!1);var f=this.getSurveyWebServiceUrl()+c.FormEntityCollectionName+c.getQueryParameters("?",d);return Forms.Common.logFlightStatus("SocialSharing"),this.sendRequestWithToken({requestUri:f,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.GetForms},{skipExpiredTokenCheck:!!e},e)},c.prototype.createFormWithToken=function(b,d){var e={__TimezoneOffset:(new Date).getTimezoneOffset().toString()};return this.sendRequestWithToken({requestUri:this.getSurveyWebServiceUrl()+c.FormEntityCollectionName,method:"POST",data:b,headers:e,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.CreateForm,qosExtraData:{FormType:this.getFormType(b)}},{},d)},c.prototype.checkAnonymousAccess=function(a){var d=this.getSurveyWebOwnerServiceUrl()+"light/"+c.RuntimeFormEntityCollectionName+"('"+a+"')";return b.OData.send({requestUri:d,headers:[]},{disableLog:!0,skipExpiredTokenCheck:!0}).then(function(){return!0},function(a){var c=b.OData.ResponseHandler.convertToResponseError(a);return c.statusCode===b.ErrorCode.HttpStatusCode.Unauthorized?$.Deferred().resolve(!1).promise():c})},c.prototype.experimentationGetVariations=function(){var a=this.getSurveyWebServiceUrl()+"experimentation/getvariations";return this.sendRequest({requestUri:a,method:"GET"})},c.prototype.experimentationActivate=function(a){var b=this.getSurveyWebServiceUrl()+"experimentation/activate?experimentKey="+a;return this.sendRequest({requestUri:b,method:"GET"})},c.prototype.experimentationTrack=function(a,b){var c=this.getSurveyWebServiceUrl()+"experimentation/track?experimentKey="+a+"&eventKey="+b;return this.sendRequest({requestUri:c,method:"GET"})},c.prototype.getInactiveUserByIdOrEmail=function(a){var b=this.getSurveyWebServiceUrl()+"deleteduserinfo/byidemail/"+encodeURIComponent(a);return this.sendRequest({requestUri:b,method:"GET"})},c.prototype.getUserSettings=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"userSettings",method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.UserSettings.GetUserSettings})},c.prototype.updateUserSettings=function(b){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"userSettings",method:this.partialUpdateHttpMethod,data:b,qosEventName:a.Event.QosEventNames.ServiceEndpoints.UserSettings.UpdateUserSettings})},c.prototype.getAllLocaleResources=function(b){var c=this.getMultilingualBaseUrl(b);return this.sendRequest({requestUri:c,method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Multilingual.GetAllLocales})},c.prototype.getLocaleResource=function(b,c){var d=this.getMultilingualBaseUrl(b)+"/'"+c+"'";return this.sendRequest({requestUri:d,method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Multilingual.GetLocale})},c.prototype.createLocaleItem=function(b,c){return this.sendRequest({requestUri:this.getMultilingualBaseUrl(b),method:"POST",data:c,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Multilingual.CreateLocaleItem})},c.prototype.updateLocaleItem=function(b,c){var d=this.getMultilingualBaseUrl(b)+"/'"+c.locale+"'/";return d+=c.questionId?"question/'"+c.questionId+"'/'":"form/'",d+=c.elementKey+"'",this.sendRequest({requestUri:d,method:this.partialUpdateHttpMethod,data:{ElementValue:c.elementValue},qosEventName:a.Event.QosEventNames.ServiceEndpoints.Multilingual.UpdateLocaleItem})},c.prototype.deleteLocale=function(b,c){return this.sendRequest({requestUri:this.getMultilingualBaseUrl(b)+"/'"+c+"'",method:"DELETE",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Multilingual.DeleteLocale})},c.prototype.copyLocaleResources=function(b,d){var e=this.getSurveyWebOwnerServiceUrl()+"batch/"+c.FormEntityCollectionName+"('"+b+"')/"+c.LocaleResourceEntityCollectionName;return this.sendRequest({requestUri:e,method:"POST",data:d,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Multilingual.CopyLocaleItem})},c.getQueryParameters=function(a,b,d){if(!b)return a+"$expand="+c.QuestionEntityCollectionName;b=_.union(["id"],b);var e="$select="+b.join(","),f={permissions:"permissions"};f[c.QuestionEntityCollectionName]=c.QuestionEntityCollectionName+"($expand="+c.ChoiceEntityCollectionName+")",f[c.PermissionTokenEntityCollectionName]="permissionTokens";var g=b.map(function(a){return f[a]}).filter(function(a){return a});return g.length&&(e+="&$expand="+g.join(",")),d&&(e+="&$filter="+d.name+"+"+d.operator+"+"+d.value),e&&a+e},c.prototype.sendRequestWithToken=function(a,c,d){var e=this;return $.when(d||this.getToken()).then(function(d){return a.headers=$.extend(!0,a.headers,e.getCommonHeaders(d)),b.OData.send(a,c).then(b.OData.ResponseHandler.parseResponseDataValue,b.OData.ResponseHandler.parseAndTryHandleError)})},c.prototype.sendRequestWithoutToken=function(a,c){return a.headers=$.extend(!0,a.headers,this.getCommonHeaders("")),b.OData.send(a,c).then(b.OData.ResponseHandler.parseResponseDataValue,b.OData.ResponseHandler.parseAndTryHandleError)},c.prototype.getDownloadExcelRequestUrlParameters=function(a,b,c,d,e,f){var g=(new Date).getTimezoneOffset().toString(),h={formid:a,timezoneOffset:g,downloadCookie:d,minResponseId:b,maxResponseId:c,"X-CorrelationId":e};return Forms.getPageContext().Flighting.isEnabled("CookieAuth")||(h.Authorization=f),h},c.prototype.getDownloadExcelRequestUrl=function(a){return this.getExcelServiceBaseUrl()+"formapi/DownloadExcelFile.ashx?"+$.param(a)},c.prototype.downloadExcelCheckAndHandleAuthFailure=function(c,d){var e=a.Utilities.tryParseJson(c),f=e&&(e.error&&parseInt(e.error.code)||parseInt(e.ErrorCode));f===b.ErrorCode.InnerCode.TokenExpired||f===b.ErrorCode.InnerCode.RequireLogin?Forms.AuthTokenHelper.refreshAuthToken(function(){a.Flighting.Flight.isEnabled("RefreshServerInfoInFrame")?d():a.PageMethods.refreshAntiForgeryToken(d,function(){return Forms.Common.reloadPage()})},function(){Forms.Authenticator.signInThenRefresh()}):d()},c.prototype.sendRequestInner=function(a,c,d){var e=this;return this.getToken().then(function(a){return c.headers=$.extend(!0,c.headers,e.getCommonHeaders(a)),b.OData.send(c,d).then(b.OData.ResponseHandler.convertToAsyncResult,b.OData.ResponseHandler.parseAndTryHandleError)}).then(a)},c.prototype.sendRequest=function(a,b){return this.sendRequestInner(function(a){return a&&a.value},a,b)},c.prototype.createHiddenIFrame=function(a){var b=document.getElementById(a);return b&&b.parentNode.removeChild(b),b=document.createElement("iframe"),b.id=a,b.name=a,b.hidden=!0,b},c.prototype.getCommonHeaders=function(b){var d={Accept:"application/json",Authorization:b?"Bearer "+b:"",__RequestVerificationToken:OfficeFormServerInfo.antiForgeryToken,ShareInvitationKey:a.Utilities.Html.getHashes().Token,AnalyzerToken:a.Utilities.Html.getQueries().AnalyzerToken,ValidationToken:a.Utilities.Html.getQueries().vt};return d=_.extend({},d,c.customizedHeaders)},c.prototype.getSurveyWebServiceUrl=function(){return this.serviceUrl},c.prototype.getSurveyWebOwnerServiceUrl=function(){return this.ownerServiceUrl},c.prototype.getExcelServiceBaseUrl=function(){return this.serviceUrl.slice(0,-12)},c.prototype.getMultilingualBaseUrl=function(a){return this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+a+"')/"+c.LocaleResourceEntityCollectionName},c.prototype.getFormType=function(a){var b=null;if(a&&a.settings){var c=null;try{c=JSON.parse(a.settings)}catch(d){}a.category&&a.category.split(" ").indexOf("Poll")>=0?b="Poll":c&&void 0!==c.IsQuizMode&&(b=c.IsQuizMode?"Quiz":"Form")}return b||void 0},c.customizedHeaders={},c}();b.FormApi=c}(b=a.DataProvider||(a.DataProvider={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(a){a[a.Continue=100]="Continue",a[a.SwitchingProtocols=101]="SwitchingProtocols",a[a.OK=200]="OK",a[a.Created=201]="Created",a[a.Accepted=202]="Accepted",a[a.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",a[a.NoContent=204]="NoContent",a[a.ResetContent=205]="ResetContent",a[a.PartialContent=206]="PartialContent",a[a.MultiStatus=207]="MultiStatus",a[a.MultipleChoices=300]="MultipleChoices",a[a.Ambiguous=300]="Ambiguous",a[a.MovedPermanently=301]="MovedPermanently",a[a.Moved=301]="Moved",a[a.Found=302]="Found",a[a.Redirect=302]="Redirect",a[a.SeeOther=303]="SeeOther",a[a.RedirectMethod=303]="RedirectMethod",a[a.NotModified=304]="NotModified",a[a.UseProxy=305]="UseProxy",a[a.Unused=306]="Unused",a[a.TemporaryRedirect=307]="TemporaryRedirect",a[a.RedirectKeepVerb=307]="RedirectKeepVerb",a[a.BadRequest=400]="BadRequest",a[a.Unauthorized=401]="Unauthorized",a[a.PaymentRequired=402]="PaymentRequired",a[a.Forbidden=403]="Forbidden",a[a.NotFound=404]="NotFound",a[a.MethodNotAllowed=405]="MethodNotAllowed",a[a.NotAcceptable=406]="NotAcceptable",a[a.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",a[a.RequestTimeout=408]="RequestTimeout",a[a.Conflict=409]="Conflict",a[a.Gone=410]="Gone",a[a.LengthRequired=411]="LengthRequired",a[a.PreconditionFailed=412]="PreconditionFailed",a[a.RequestEntityTooLarge=413]="RequestEntityTooLarge",a[a.RequestUriTooLong=414]="RequestUriTooLong",a[a.UnsupportedMediaType=415]="UnsupportedMediaType",a[a.RequestedRangeNotSatisfiable=416]="RequestedRangeNotSatisfiable",a[a.ExpectationFailed=417]="ExpectationFailed",a[a.UpgradeRequired=426]="UpgradeRequired",a[a.InternalServerError=500]="InternalServerError",a[a.NotImplemented=501]="NotImplemented",a[a.BadGateway=502]="BadGateway",a[a.ServiceUnavailable=503]="ServiceUnavailable",a[a.GatewayTimeout=504]="GatewayTimeout",a[a.HttpVersionNotSupported=505]="HttpVersionNotSupported"}(b=a.HttpStatusCode||(a.HttpStatusCode={}))}(b=a.DataProvider||(a.DataProvider={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b,c=a.ErrorCode.InnerCode;!function(a){function b(a){var b=new FileReader;b.readAsDataURL(a);var c=$.Deferred();return b.onload=function(){c.resolve(b.result).promise()},c.promise()}function d(a){var b=$.Deferred();try{for(var d=a.split(","),e=(d[0].match(/:(.*?);/)[1],window.atob(d[1])),f=e.length,g=new Uint8Array(f);f--;)g[f]=e.charCodeAt(f);b.resolve(new Blob([g]))}catch(h){b.reject({correlationId:null,statusCode:0,innerCode:c.ImageTypeConvertFailed,innerMessage:"Image Type Convert Error",statusText:"Image Converting from Base64 to Blob Error"})}return b.promise()}a.convertImageBlobToBase64=b,a.convertImageDataURLToBlob=d}(b=a.ImageProcessing||(a.ImageProcessing={}))}(b=a.DataProvider||(a.DataProvider={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c=b.ErrorCode.InnerCode,d=function(){function b(a){for(this.authContext=Forms.getPageContext().AuthContext,this.serviceUrl=a.trim();"/"===this.serviceUrl.charAt(this.serviceUrl.length-1);)this.serviceUrl=this.serviceUrl.substr(0,this.serviceUrl.length-1)}return b.prototype.deleteQuestionImage=function(a,c,d){var e=this,f=this.getToken();return f.then(function(f){return b.deleteImageInternal(f,e.getAbsoluteUrl(b.getQuestionImageUrl(a,c,d)))})},b.prototype.uploadQuestionImage=function(a,c,d,e){var f=this,g=this.getToken();return g.then(function(g){return b.uploadImageInternal(g,f.getAbsoluteUrl(b.getQuestionImageUrl(a,c,d)),d,e)})},b.prototype.deleteFormImage=function(a,c){var d=this,e=this.getToken();return e.then(function(e){return b.deleteImageInternal(e,d.getAbsoluteUrl(b.getFormImageUrl(a,c)))})},b.prototype.uploadFormImage=function(a,c,d){var e=this,f=this.getToken();return f.then(function(f){return b.uploadImageInternal(f,e.getAbsoluteUrl(b.getFormImageUrl(a,c)),c,d)})},b.getFormImageUrl=function(a,c){return b.formImageUrlPattern.format(a,c)},b.getQuestionImageUrl=function(a,c,d){return b.questionImageUrlPattern.format(a,c,d)},b.deleteImageInternal=function(c,d){var e=new a.Event.QosEventDeprecated(a.Event.QosEventNames.ServiceEndpoints.Image.DeleteImage);e.start();var f={type:"DELETE",url:d,headers:{Authorization:c?"Bearer "+c:"","X-CorrelationId":e.CorrelationId}},g=function(){return e.end({resultType:"Success"})},h=function(a){var b={correlationId:e.CorrelationId,innerCode:a.responseJSON&&a.responseJSON.error&&a.responseJSON.error.code,statusCode:a.status,innerMessage:a.responseJSON&&a.responseJSON.error&&a.responseJSON.error.message,statusText:a.statusText};return e.end({resultType:"Failure",extraData:{imageUrl:d,error:b}}),b};return b.sendRequest(f,g,h)},b.uploadImageInternal=function(d,e,f,g){var h=new a.Event.QosEventDeprecated(a.Event.QosEventNames.ServiceEndpoints.Image.UploadImage);h.start();var i={type:"PUT",url:e,headers:{Authorization:d?"Bearer "+d:"","Content-Type":g.ImageType,"Content-Disposition":"attachment; name={0}; filename={1}".format(a.Utilities.Guid.newGuid(),g.ImageName),"X-CorrelationId":h.CorrelationId},processData:!1,data:g.ImageBlob},j=function(a){if(!a||!a.resourceId){var b={correlationId:h.CorrelationId,innerCode:c.ImageUploadFailed,statusCode:0,innerMessage:"Upload image return bad response",statusText:"CollabDb bad response"};return h.end({resultType:"Failure",extraData:{imageUrl:e,error:b,imageType:f}}),$.Deferred().reject(b).promise()}h.end({resultType:"Success",extraData:{imageType:f}});var d={};return d.altText=a.altText,d.contentType=a.contentType,d.fileIdentifier=a.fileIdentifier,d.originalFileName=a.originalFileName,d.resourceId=a.resourceId,d.resourceUrl=a.resourceUrl,d.height=a.height,d.width=a.width,d},k=function(a){var b={correlationId:h.CorrelationId,innerCode:a.responseJSON&&a.responseJSON.error&&a.responseJSON.error.code,statusCode:a.status,innerMessage:a.responseJSON&&a.responseJSON.error&&a.responseJSON.error.message,statusText:a.statusText};return h.end({resultType:"Failure",extraData:{imageUrl:i.url,error:b}}),b};return b.sendRequest(i,j,k)},b.sendRequest=function(b,c,d){Forms.getPageContext().Flighting.isEnabled("CookieAuth")&&(b.headers.__RequestVerificationToken=OfficeFormServerInfo.antiForgeryToken);var e=$.ajax(b);return e.then(c,function(e){return Forms.AuthTokenHelper.isAuthTokenExpiredFailure(e)?void Forms.AuthTokenHelper.refreshAuthToken(function(){if(a.Flighting.Flight.isEnabled("RefreshServerInfoInFrame")){b.headers.__RequestVerificationToken=OfficeFormServerInfo.antiForgeryToken;var e=$.ajax(b);return e.then(c,d)}a.PageMethods.refreshAntiForgeryToken(function(){b.headers.__RequestVerificationToken=OfficeFormServerInfo.antiForgeryToken;var a=$.ajax(b);return a.then(c,d)},function(){return Forms.Common.reloadPage()})},function(){Forms.Authenticator.signInThenRefresh()}):d(e)})},b.prototype.getToken=function(){return this.authContext.getFormApiToken()},b.prototype.getAbsoluteUrl=function(a){return this.serviceUrl+"/"+a},b.formImageUrlPattern="forms('{0}')/{1}",b.questionImageUrlPattern="forms('{0}')/questions('{1}')/{2}",b}();b.ImageProvider=d}(b=a.DataProvider||(a.DataProvider={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(b){var c;!function(a){a[a.None=0]="None",a[a.SpellChecker=1]="SpellChecker",a[a.AutoSuggest=2]="AutoSuggest",a[a.KeyPhrase=4]="KeyPhrase",a[a.ChoiceQuestionTypeSuggest=256]="ChoiceQuestionTypeSuggest",a[a.SuggestionForm=512]="SuggestionForm",a[a.SuggestionQuestion=2048]="SuggestionQuestion",a[a.OptionsSuggest=4096]="OptionsSuggest",a[a.LikertQuestionTypeSuggest=8192]="LikertQuestionTypeSuggest",a[a.AdoptKeyWord=16384]="AdoptKeyWord",a[a.ThemeSuggest=32768]="ThemeSuggest"}(c=b.TextAnalyzerFeatures||(b.TextAnalyzerFeatures={}));var d;!function(a){a[a.None=0]="None",a[a.SimilarMathQuestionSuggestions=1]="SimilarMathQuestionSuggestions"}(d=b.MathAnalyzerFeatures||(b.MathAnalyzerFeatures={}));var e;!function(a){a[a.Unknown=0]="Unknown",a[a.Edu=1]="Edu",a[a.Biz=2]="Biz",a[a.MsaFree=4]="MsaFree",a[a.MSIT=8]="MSIT",a[a.MsaPaid=16]="MsaPaid",a[a.FastFood=32]="FastFood",a[a.Pro=64]="Pro"}(e=b.UserType||(b.UserType={})),a.Exports.DataProvider.TextAnalyzerFeatures=c,a.Exports.DataProvider.MathAnalyzerFeatures=d}(c=b.Models||(b.Models={}))}(b=a.DataProvider||(a.DataProvider={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c=function(){function c(b,d){return c._instance?c._instance:(c._instance=this,this._serviceUrl=b,this._tokenRetriever=d,a.Utilities.assert(this._serviceUrl,"math service url is null"),void 0)}return c.getInstance=function(a,b){return new c(a,b)},c.prototype.mathFormulaCalculation=function(b){if(!b||!b.Mathml){var c={Aria:"",Responses:[]};return $.Deferred().resolve(c).promise()}var d={Context:b.Context,Formulas:[b.Mathml],InputFormat:"MathML",Locale:navigator.language,Mode:1,OutputFormat:"latex",RequiredIncorrectAnswerCount:b.IncorrectAnswerCount};return this.sendRequest({data:d,method:"POST",requestUri:this._serviceUrl+"mathapi/calculation?formId="+b.FormId+"&questionId="+b.QuestionId,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Question.MathCalculation})},c.prototype.mathQuestionGeneration=function(b){if(!b.Context){var c={Features:0,Results:[]};return $.Deferred().resolve(c).promise()}var d={Features:b.Features,Input:b.Context,InputFormat:"MathML",Locale:navigator.language,OutputFormat:"latex",RequiredQuestionsCount:b.QuestionCount,RequiredIncorrectAnswerCount:b.IncorrectAnswerCount};return this.sendRequest({data:d,method:"POST",requestUri:this._serviceUrl+"mathapi/questions?formId="+b.FormId+"&questionId="+b.QuestionId,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Question.MathQuestionGeneration})},c.prototype.textAnalyze=function(a){var c=b.Models.TextAnalyzerFeatures.ChoiceQuestionTypeSuggest;return this.textAnalyzeWithFeatures(c,a)},c.prototype.textAnalyzeWithFeatures=function(b,c){if(!c){var d={Features:0,Results:[]};return $.Deferred().resolve(d).promise()}var e={Features:b,Text:c};return this.sendRequest({requestUri:this._serviceUrl+"textanalysis2",method:"POST",data:e,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Question.TextAnalysis,qosExtraData:{Features:b}})},c.prototype.sendRequest=function(c){return this._tokenRetriever.getToken().then(function(d){return c.headers=$.extend(!0,c.headers,{Accept:"application/json",Authorization:d?"Bearer "+d:"",__RequestVerificationToken:OfficeFormServerInfo.antiForgeryToken}),b.OData.send(c).then(function(c){a.Utilities.assert(c,"math calculation result is null");var d=b.OData.ResponseHandler.parseResponseDataValue(c);return a.Utilities.assert(d,"math calculation result parse failure"),d},b.OData.ResponseHandler.parseAndTryHandleError)})},c}();b.MathProvider=c}(b=a.DataProvider||(a.DataProvider={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(){return f.getInstance().createDataProvider()}function d(a){return f.getInstance().createDataProvider(e.Group,OfficeFormServerInfo.userInfo.TenantId,a)}var e;!function(a){a[a.Default=0]="Default",a[a.Personal=1]="Personal",a[a.Group=2]="Group",a[a.Me=3]="Me"}(e=b.DataProviderType||(b.DataProviderType={}));var f=function(){function c(){return c.instance?c.instance:(c.instance=this,void(this.environment=a.EnvironmentConfig.getEnvironmentType()))}return c.getInstance=function(){return new c},c.prototype.getOwnerServiceUrl=function(a,b,c){return a===e.Default?this.FormApiServiceUrl:a===e.Me?this.FormApiServiceUrl+"me/":b&&c?this.FormApiServiceUrl+b+(a===e.Group?"/groups/":"/users/")+c+"/":null},c.prototype.createDataProvider=function(a,c,d){if(void 0===a&&(a=e.Default),void 0===c&&(c=null),void 0===d&&(d=null),a===e.Default)return this.defaultDataProvider||(this.defaultDataProvider=new b.FormApi(this.FormApiServiceUrl,this.FormApiServiceUrl)),this.defaultDataProvider;var f=this.getOwnerServiceUrl(a,c,d);return f&&new b.FormApi(this.FormApiServiceUrl,f)},c.prototype.createImageProvider=function(a,c,d){if(void 0===a&&(a=e.Default),void 0===c&&(c=null),void 0===d&&(d=null),a===e.Default)return this.currentImageProvider||(this.currentImageProvider=new b.ImageProvider(this.FormApiServiceUrl)),this.currentImageProvider;var f=this.getOwnerServiceUrl(a,c,d);return f&&new b.ImageProvider(f)},c.prototype.createIntelligenceProvider=function(a,b,c){return new Forms.DataProvider.IntelligenceProvider(this.BaseServiceUrl,this.createDataProvider(),b,c,a===e.Group?"groups":"users")},Object.defineProperty(c.prototype,"CurrentNotificationProvider",{get:function(){return this.currentNotificationProvider||(this.currentNotificationProvider=new b.PushNotificationProvider),this.currentNotificationProvider},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"CurrentMathProvider",{get:function(){return this.currentMathProvider||(this.currentMathProvider=b.MathProvider.getInstance(this.FormMathServiceUrl,this.createDataProvider())),this.currentMathProvider},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"FormApiServiceUrl",{get:function(){return this.getServiceUrl(c.formApiEndpointPostfix)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"FormMathServiceUrl",{get:function(){return this.getServiceUrl(c.formMathApiEndpointPostfix)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"CollabDBServiceUrl",{get:function(){var b;return b=a.EnvironmentConfig.isOsi()?a.EnvironmentConfig.getEnvironmentType():a.EnvironmentConfig.getEnvironmentTypeForNonOSI(),a.EnvironmentConfig.getCollabDBResourceId(b)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"BaseServiceUrl",{get:function(){if(!a.EnvironmentConfig.isOsi()){var b=a.EnvironmentConfig.getEnvironmentTypeForNonOSI();return"EDog"===b?c.apiEndpointEDog:c.apiEndpointInt}var d;switch(this.environment){case"USDoDProd":d=c.apiEndpointUSDoDProd;break;case"USGovProd":d=c.apiEndpointUSGovProd;break;case"USGovGccProd":d=c.apiEndpointProd;break;case"WWProd":d=c.apiEndpointProd;break;case"MSProd":d=c.apiEndpointMSProd;break;case"EDog":d=c.apiEndpointEDog;break;case"MSEDog":d=c.apiEndpointMSEDog;break;default:"edog"===a.EnvironmentConfig.getDesiredProvider()?("Int"===this.environment?d=c.apiEndpointEDog:"MSInt"===this.environment&&(d=c.apiEndpointMSEDog),d=c.apiEndpointEDog):d="https://"+window.location.host+"/"}return d},enumerable:!0,configurable:!0}),c.prototype.getServiceUrl=function(a){return this.BaseServiceUrl+a},c.apiEndpointUSDoDProd="https://forms.osi.apps.mil/",c.apiEndpointUSGovProd="https://forms.osi.office365.us/",c.apiEndpointProd="https://forms.office.com/",c.apiEndpointEDog="https://forms.officeppe.com/",c.apiEndpointInt="https://forms.office-int.com/",c.apiEndpointMSProd="https://forms.microsoft.com/",c.apiEndpointMSEDog="https://forms.microsoft-ppe.com/",c.apiEndpointMSInt="https://forms.microsoft-int.com/",c.formApiEndpointPostfix="formapi/api/",c.formMathApiEndpointPostfix="formmath/api/",c}();b.ProviderManager=f,b.createDataProvider=c,b.createGroupDataProvider=d}(b=a.DataProvider||(a.DataProvider={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c=function(){function a(){this.clients={}}return a.prototype.close=function(a){this.clients[a]&&(this.clients[a].close(),delete this.clients[a])},a.prototype.open=function(a,c,d){if(this.close(a),null==d)throw new Error("PushNotificationProvider.open method: cdbTable should not be null.");return this.clients[a]=new e(b.ProviderManager.getInstance().CollabDBServiceUrl,d.OwnerTenantId,d.OwnerId,d.TableId,d.IsGroupTable),this.clients[a].open(c)},a}();b.PushNotificationProvider=c;var d=function(){function b(b){this.clientId=a.Utilities.Guid.newGuid(),this.clientName=b}return Object.defineProperty(b.prototype,"ClientId",{get:function(){return this.clientId},enumerable:!0,configurable:!0}),b.prototype.log=function(b){for(var c=[],d=1;d<arguments.length;d++)c[d-1]=arguments[d];if(a.Utilities.Flight.isDebugMode()||!a.EnvironmentConfig.isOsi()){var e=new Date;console.log("[%s] %s[%s]: %s",e.toTimeString(),this.clientName,this.clientId,b.format.apply(b,c))}},b}(),e=function(c){function d(a,b,d,e,g){var h=c.call(this,"CdbSignalR")||this;return h.disposed=!0,h.hubConnection=null,h.reconnectingCount=0,h.remainingRetryCount=f.MaxRetryCount,h.rtcUrl=(g?f.CDBUrlForGroupsFormat:f.CDBUrlForUsersFormat).format(a.trimEnd("/"),b,d,e),h}return __extends(d,c),d.prototype.close=function(){var a=this;this.log("Closing connection"),this.disposed=!0;var b=function(){4!==a.hubConnection.state&&a.invokeHubMethod(f.UserHubName,f.Leave).always(function(){
a.hubConnection.stop(!0,!0),a.log("Connection closed")})};null!=this.hubConnection&&(0===this.hubConnection.state||2===this.hubConnection.state?this.hubConnection.stateChanged(b):b())},d.prototype.open=function(c){var d=this;this.log("Creating connection"),this.createHubConnection(this.rtcUrl),this.log("Initializing connection"),c=_.clone(c),c.onFormUpdated&&this.onHubEvent(f.TableDefinitionHubName,f.TableUpdated,function(a,b){c.onFormUpdated(g.toFormUpdatePayload(b),g.toUserPayload(b._modifiedBy))}),c.onFormElementAdded&&this.onHubEvent(f.TableDefinitionHubName,f.ColumnAdded,function(a,b){"Comments"!==a.propertyName&&"ReleaseDate"!==a.propertyName&&c.onFormElementAdded(g.toFormElementPayload(b),g.toUserPayload(b._modifiedBy))}),c.onFormElementDeleted&&this.onHubEvent(f.TableDefinitionHubName,f.ColumnDeleted,function(a,b){c.onFormElementDeleted(a.propertyName,g.toUserPayload(b._modifiedBy))}),c.onFormElementUpdated&&this.onHubEvent(f.TableDefinitionHubName,f.ColumnUpdated,function(a,b){c.onFormElementUpdated(a.propertyName,g.toFormElementUpdatePayload(b),g.toUserPayload(b._modifiedBy))}),c.onChoiceAdded&&this.onHubEvent(f.TableDefinitionHubName,f.ChoiceAdded,function(a,b){c.onChoiceAdded(a.propertyName,g.toChoicePayload(a,b),g.toUserPayload(b._modifiedBy))}),c.onChoiceDeleted&&this.onHubEvent(f.TableDefinitionHubName,f.ChoiceDeleted,function(a,b){c.onChoiceDeleted(a.propertyName,a.choiceId,g.toUserPayload(b._modifiedBy))}),c.onChoiceUpdated&&this.onHubEvent(f.TableDefinitionHubName,f.ChoiceUpdated,function(a,b){c.onChoiceUpdated(a.propertyName,a.choiceId,g.toChoicePayload(a,b),g.toUserPayload(b._modifiedBy))}),c.onResponseAdded&&this.onHubEvent(f.TableDataHubName,f.RowAdded,function(a,b){c.onResponseAdded(g.toResponsePayload(b))}),c.onResponseDeleted&&this.onHubEvent(f.TableDataHubName,f.RowDeleted,function(a,b){c.onResponseDeleted(Number(a._id),{modifiedBy:g.toUserPayload(b._modifiedBy),modifiedDateTime:new Date(b._modifiedBy.ModifiedDateTime)})}),c.onResponsesAllDeleted&&this.onHubEvent(f.TableDataHubName,f.RowsAllDeleted,function(a,b){c.onResponsesAllDeleted({modifiedBy:g.toUserPayload(b._modifiedBy),modifiedDateTime:new Date(b._modifiedBy.ModifiedDateTime)})}),c.onResponseUpdated&&this.onHubEvent(f.TableDataHubName,f.RowUpdated,function(a,b){c.onResponseUpdated(Number(a._id),g.toResponseUpdatePayload(b))}),c.onCommentAdded&&this.onHubEvent(f.TableDataHubName,f.RelatedRecordAdded,function(a,b,d){g.isCommentPayload(a)&&c.onCommentAdded(Number(a.rowId),g.toCommentPayload(d),{modifiedBy:g.toUserPayload(b.modifiedBy),modifiedDateTime:new Date(b.modifiedDateTime)})}),c.onCommentDeleted&&this.onHubEvent(f.TableDataHubName,f.RelatedRecordDeleted,function(a,b,d){g.isCommentPayload(a)&&c.onCommentDeleted(Number(a.rowId),Number(a.id),{modifiedBy:g.toUserPayload(b.modifiedBy),modifiedDateTime:new Date(b.modifiedDateTime)})}),c.onLocaleResourceAdded&&this.onHubEvent(f.TableDefinitionHubName,f.LocaleResourceAdded,function(a,b){if(b){var e=b.localeResources;e.forEach(function(a){a.elementKey=d.mapLocaleItemKeyName(a.elementKey)}),c.onLocaleResourceAdded(e,g.toUserPayload(b._modifiedBy))}}),c.onLocaleResourceUpdated&&this.onHubEvent(f.TableDefinitionHubName,f.LocaleResourceUpdated,function(a,b){if(b){var e=_.clone(b);delete e._modifiedBy,e.elementKey=d.mapLocaleItemKeyName(e.elementKey),c.onLocaleResourceUpdated(e,g.toUserPayload(b._modifiedBy))}}),c.onLocaleResourceDeleted&&this.onHubEvent(f.TableDefinitionHubName,f.LocaleResourceDeleted,function(a,b){b&&c.onLocaleResourceDeleted(b,g.toUserPayload(b._modifiedBy))}),c.onUserConnected&&this.onHubEvent(f.UserHubName,f.UserConnected,function(a,b){c.onUserConnected(g.toUserPayload(a))}),c.onUserDisconnected&&this.onHubEvent(f.UserHubName,f.UserDisconnected,function(a,b){c.onUserDisconnected(g.toUserPayload(a))});var e=void 0;return this.hubConnection.starting(function(){d.log("connection starting"),a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.DataProvider.RealtimeClient.ConnectionStarting,extraData:{clientId:d.ClientId,connectionId:d.hubConnection.id,connectionType:f.ConnectionType_CDB}})}),this.hubConnection.connectionSlow(function(){d.log("connection slow"),a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.DataProvider.RealtimeClient.ConnectionSlow,extraData:{clientId:d.ClientId,connectionId:d.hubConnection.id,connectionType:f.ConnectionType_CDB}}),c.onConnectionSlow&&c.onConnectionSlow()}),this.hubConnection.error(function(b){d.log("connection error: {0}",JSON.stringify(b)),a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.DataProvider.RealtimeClient.ConnectionError,extraData:{clientId:d.ClientId,connectionId:d.hubConnection.id,connectionType:f.ConnectionType_CDB,error:b}}),e={errorCause:f.ConnectionType_CDB,errorObject:b},c.onConnectionError&&c.onConnectionError(b)}),this.hubConnection.reconnecting(function(){d.log("connection reconnecting"),a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.DataProvider.RealtimeClient.ConnectionReconnecting,extraData:{clientId:d.ClientId,connectionId:d.hubConnection.id,connectionType:f.ConnectionType_CDB}}),c.onConnectionReconnecting&&c.onConnectionReconnecting()}),this.hubConnection.reconnected(function(){a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.DataProvider.RealtimeClient.ConnectionReconnected,extraData:{clientId:d.ClientId,connectionId:d.hubConnection.id,connectionType:f.ConnectionType_CDB}}),d.log("connection reconnected"),c.onConnectionReconnected&&c.onConnectionReconnected(void 0)}),this.hubConnection.disconnected(function(){if(d.log("connection disconnected"),a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.DataProvider.RealtimeClient.ConnectionDisconnected,extraData:{clientId:d.ClientId,connectionId:d.hubConnection.id,type:e&&e.errorCause,remainingRetryCount:d.remainingRetryCount,lastError:e&&e.errorObject}}),d.remainingRetryCount-->0){d.reconnectingCount++;var g={reconnectingCause:e&&e.errorCause,reconnectingCount:d.reconnectingCount,refreshToken:e&&e.errorObject&&e.errorObject.context&&e.errorObject.context.status===b.ErrorCode.HttpStatusCode.Unauthorized,retryCount:f.MaxRetryCount-d.remainingRetryCount,onSuccess:c.onConnectionReconnected,onError:c.onConnectionFailed};d.startConnection(g).done(function(){e=void 0}).fail(function(a){})}else a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.DataProvider.RealtimeClient.ConnectionFailed,extraData:{clientId:d.ClientId,connectionId:d.hubConnection.id,errorCause:e&&e.errorCause,lastError:e&&e.errorObject}}),c.onConnectionDisconnected&&c.onConnectionDisconnected()}),(a.Utilities.Flight.isDebugMode()||!a.EnvironmentConfig.isOsi())&&(this.hubConnection.logging=!0,this.hubConnection.received(function(a){d.log("Received message: {0}",JSON.stringify(a))})),this.disposed=!1,this.startConnection({onSuccess:c.onConnectionStarted,onError:c.onConnectionFailed})},d.prototype.mapLocaleItemKeyName=function(a){switch(a){case"thankyoumessage":return"thankYouMessage";case"formclosemessage":return"formCloseMessage";case"leftdescription":return"leftDescription";case"rightdescription":return"rightDescription";default:return a}},d.prototype.createHubConnection=function(a){this.hubConnection=$.hubConnection(a,{useDefaultPath:!1}),this.hubConnection.createHubProxy(f.TableDefinitionHubName),this.hubConnection.createHubProxy(f.TableDataHubName),this.hubConnection.createHubProxy(f.UserHubName)},d.prototype.getHubProxy=function(a){if(null==this.hubConnection)throw Error("Realtime connection has not been created yet.");var b=this.hubConnection.proxies[a.toLocaleLowerCase()];if(null==b)throw Error("Cannot find hub proxy {0}".format(a));return b},d.prototype.handleAuth=function(a){var c=this;return b.ProviderManager.getInstance().createDataProvider().getCdbToken().then(function(a){c.hubConnection.qs={Authorization:a}})},d.prototype.invokeHubMethod=function(b,c){for(var d=this,e=[],f=2;f<arguments.length;f++)e[f-2]=arguments[f];var g;if(this.isHubConnected()){var h=new a.Event.QosEventDeprecated(a.Event.QosEventNames.ServiceEndpoints.Connection.InvokeMethod);return h.start(),(g=this.getHubProxy(b)).invoke.apply(g,[c].concat(e)).then(function(a){return h.end({resultType:"Success",extraData:{clientId:d.ClientId,connectionId:d.hubConnection.id,methodName:c}}),a},function(a){return h.end({resultType:d.isHubConnected()?"Failure":"ExpectedFailure",extraData:{clientId:d.ClientId,connectionId:d.hubConnection.id,methodName:c,error:JSON.stringify(a,["message","description","source","context","data"])}}),a})}return a.Utilities.Promise.getRejectedPromise(Error("Realtime connection has not been established yet."))},d.prototype.isHubConnected=function(){return null!=this.hubConnection&&1===this.hubConnection.state},d.prototype.onHubEvent=function(a,b,c){c&&this.getHubProxy(a).on(b,c)},d.prototype.startConnection=function(b){var c=this;if(this.disposed)return a.Utilities.Promise.getRejectedPromise("Connection disposed");var d=$.Deferred();b.onSuccess&&d.done(function(a){return b.onSuccess(a)}),b.onError&&d.fail(function(a){return b.onError(a)});var e=new a.Event.QosEventDeprecated(a.Event.QosEventNames.ServiceEndpoints.Connection.ConnectToCDB),g=function(){e.end({resultType:"Success",extraData:{clientId:c.ClientId,connectionId:c.hubConnection.id,connectionType:f.ConnectionType_CDB,reconnectingCause:b.reconnectingCause,reconnectingCount:b.reconnectingCount,retryCount:b.retryCount}}),c.log("Realtime connection started"),c.remainingRetryCount=f.MaxRetryCount,c.invokeHubMethod(f.UserHubName,f.Join),c.invokeHubMethod(f.UserHubName,f.GetActiveUsers).then(function(a){d.resolve(a)},function(a){d.reject(a)})},h=function(a){e.end({resultType:"Failure",extraData:{clientId:c.ClientId,connectionId:c.hubConnection.id,connectionType:f.ConnectionType_CDB,reconnectingCause:b.reconnectingCause,reconnectingCount:b.reconnectingCount,retryCount:b.retryCount,connectionError:a.source?JSON.stringify(a,["message","description","source","context","transport"]):void 0,serviceError:a.source?void 0:JSON.stringify(a,["message","statusCode","statusText","innerCode"])}}),d.reject(a)};return e.start(),this.handleAuth(b.refreshToken).then(function(){return c.hubConnection.start().then(g,h)},function(b){h(b),a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.DataProvider.RealtimeClient.ConnectionFailed,extraData:{clientId:c.ClientId,connectionId:c.hubConnection.id,errorCause:f.ConnectionType_Client,lastError:b}})}),d.promise()},d}(d),f=function(){function a(){}return a.TableDefinitionHubName="TableDefinitionChangeHub",a.TableDataHubName="TableChangeHub",a.UserHubName="TableActivityHub",a.TableUpdated="tableDefinitionUpdated",a.ColumnAdded="columnDefinitionAdded",a.ColumnDeleted="columnDefinitionDeleted",a.ColumnUpdated="columnDefinitionUpdated",a.ChoiceAdded="choiceAdded",a.ChoiceUpdated="choiceUpdated",a.ChoiceDeleted="choiceDeleted",a.RowAdded="rowAdded",a.RowDeleted="rowDeleted",a.RowsAllDeleted="rowsAllDeleted",a.RowUpdated="rowUpdated",a.RelatedRecordAdded="relatedRecordAdded",a.RelatedRecordDeleted="relatedRecordDeleted",a.RelatedRecordUpdated="relatedRecordUpdated",a.LocaleResourceAdded="localeResourceAdded",a.LocaleResourceUpdated="localeResourceUpdated",a.LocaleResourceDeleted="localeResourceDeleted",a.UserConnected="userConnected",a.UserDisconnected="userDisconnected",a.GetActiveUsers="GetActiveUsers",a.Join="Join",a.Leave="Leave",a.MaxRetryCount=5,a.ConnectionType_Client="client",a.ConnectionType_Server="server",a.ConnectionType_CDB="CDB",a.FormsUrlFormat="{0}/forms/{1}/$notifications",a.CDBUrlForUsersFormat="{0}/realtime/beta/{1}/users/{2}/tables/{3}/$notifications",a.CDBUrlForGroupsFormat="{0}/realtime/beta/{1}/groups/{2}/tables/{3}/$notifications",a}(),g=function(){function b(){}return b.toFormUpdatePayload=function(a){return a&&b.normalize({id:void 0,tableId:a.id,title:a.displayName,createdBy:a.createBy,modifiedDate:a.dateTimeLastUpdated,description:a.description,settings:a.formSettings,otherInfo:a.otherInfo,questions:void 0,header:b.toImagePayload(a.header),logo:b.toImagePayload(a.logo),background:b.toImagePayload(a.background),thankYouMessage:a.thankYouMessage,version:a.version,xlWorkbookId:a.xlWorkbookId,xlExportingTag:a.xlExportingTag,xlFileUnSynced:a.xlFileUnSynced,permissionTokens:b.toPermissionTokenPayload(a.permissionTokens)})},b.toFormElementPayload=function(a){return a&&{id:a.propertyName,title:a.description||a.title||a.displayName,defaultValue:a.defaultValue,subtitle:a.subtitle,required:a.required,type:a.questionType,questionInfo:a.questionInfo,order:a.order,version:void 0,modifiedDate:a.questionModifiedDate,status:a.status,image:b.toImagePayload(a.image),isQuiz:a.isQuiz,choices:a.choices,groupId:a.columnGroupName,fileUploadFolderId:a.fileUploadFolderId,questionTagForIntelligence:a.questionTagForIntelligence,isFromSuggestion:a.isFromSuggestion}},b.toChoicePayload=function(a,c){return c&&b.normalize({id:a.choiceId,customProperties:c.customProperties,description:c.description,displayText:c.displayText,key:c.key,order:c.order})},b.toFormElementUpdatePayload=function(a){return b.normalize(b.toFormElementPayload(a))},b.toUserPayload=function(a){return{userId:a.Id||a.userId,displayName:a.DisplayName||a.displayName,firstName:a.FirstName||a.firstName,lastName:a.LastName||a.lastName,email:a.Email||a.email,imageUri:a.ImageUri||a.imageUri}},b.toImagePayload=function(b){return b?null!=b.ResourceId&&null==b.ResourceUrl?void a.Event.ErrorEventDeprecated.logData({errorName:"InvalidCdbImagePayload"}):{altText:b.AltText,contentType:b.ContentType,fileIdentifier:b.FileIdentifier,originalFileName:b.OriginalFileName,resourceId:b.ResourceId,resourceUrl:b.ResourceUrl}:b},b.toPermissionTokenPayload=function(a){if(a){var b=JSON.parse(a);return b.map(function(a){return{principalId:a.PrincipalId,name:a.Name,type:a.Type}})}return a},b.toResponsePayload=function(a){if(null==a)return a;var c=null==a._id?void 0:Number(a._id);return{id:c,startDate:a.StartDate,submitDate:a.SubmitDate,responder:a.Responder,responderName:a.ResponderName,answers:b.toAnswers(a),quizResult:void 0,releaseDate:a.ReleaseDate}},b.toAnswers=function(a){var b=["SubmitDate","ResponderName","Responder","StartDate","Comments_comments","Comments","ReleaseDate"],c=_.difference(Object.keys(a).filter(function(a){return"_"!==a[0]}),b);return JSON.stringify(c.map(function(b){return{questionId:b,answer1:a[b]}}))},b.toResponseUpdatePayload=function(a){var c=b.normalize(b.toResponsePayload(a));return delete c.answers,c},b.isCommentPayload=function(a){return a&&"Comments_comments"===a.propertyName},b.toCommentPayload=function(a){return a&&{id:a.id,feedback:a.text,score:a.number,questionId:a.columnReference,createdDateTime:a.createdDateTime,createdBy:b.toUserPayload(a.createdBy)}},b.normalize=function(a){var b=a;for(var c in b)void 0===b[c]&&delete b[c];return b},b}()}(b=a.DataProvider||(a.DataProvider={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c=function(){function b(){}return b.getUserInfoInItem=function(b){return b?a.SafeStorage.DefaultStorage.getItem(b):null},b.setUserInfo=function(b,c){b&&a.SafeStorage.DefaultStorage.setItem(b,c)},b}();b.UserProfileProvider=c}(b=a.DataProvider||(a.DataProvider={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){Object.defineProperty(a,"convertToArray",{configurable:!1,enumerable:!0,value:Nerve.convertToArray})}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c=function(){function b(){}return Object.defineProperty(b,"FormNumber",{get:function(){return 200},enumerable:!0,configurable:!0}),Object.defineProperty(b,"FormTitleLength",{get:function(){return 90},enumerable:!0,configurable:!0}),Object.defineProperty(b,"FormSubtitleLength",{get:function(){return 4e3},enumerable:!0,configurable:!0}),Object.defineProperty(b,"QuestionNumber",{get:function(){return OfficeFormServerInfo.userInfo.IsMsa?100:a.Flighting.Flight.isEnabled("Question200Limit")?200:100},enumerable:!0,configurable:!0}),Object.defineProperty(b,"QuestionTitleLength",{get:function(){return 4e3},enumerable:!0,configurable:!0}),Object.defineProperty(b,"QuestionSubtitleLength",{get:function(){return 2e3},enumerable:!0,configurable:!0}),Object.defineProperty(b,"QuestionOptionLength",{get:function(){return 1e3},enumerable:!0,configurable:!0}),Object.defineProperty(b,"ImageAltTextLength",{get:function(){return 128},enumerable:!0,configurable:!0}),Object.defineProperty(b,"OtherOptionLength",{get:function(){return 1e3},enumerable:!0,configurable:!0}),Object.defineProperty(b,"AnswerHintLength",{get:function(){return 1e3},enumerable:!0,configurable:!0}),Object.defineProperty(b,"AnswerTextfieldLength",{get:function(){return 4e3},enumerable:!0,configurable:!0}),Object.defineProperty(b,"OpenTypeLength",{get:function(){return 4e3},enumerable:!0,configurable:!0}),Object.defineProperty(b,"ResponseNumber",{get:function(){return 5e3},enumerable:!0,configurable:!0}),Object.defineProperty(b,"DefaultTextLength",{get:function(){return 1e3},enumerable:!0,configurable:!0}),Object.defineProperty(b,"ImagePickerQueryCount",{get:function(){return 50},enumerable:!0,configurable:!0}),Object.defineProperty(b,"ImageMaxWidth",{get:function(){return 800},enumerable:!0,configurable:!0}),Object.defineProperty(b,"ImageMaxHeight",{get:function(){return 600},enumerable:!0,configurable:!0}),Object.defineProperty(b,"QuestionCarMaxWidth",{get:function(){return 719},enumerable:!0,configurable:!0}),Object.defineProperty(b,"ImagePlaceHolderWidth",{get:function(){return 320},enumerable:!0,configurable:!0}),Object.defineProperty(b,"ImagePlaceHolderHeight",{get:function(){return 240},enumerable:!0,configurable:!0}),Object.defineProperty(b,"LogoImagePlaceHolder",{get:function(){return 120},enumerable:!0,configurable:!0}),Object.defineProperty(b,"ImageMaxSize",{get:function(){return 5242880},enumerable:!0,configurable:!0}),Object.defineProperty(b,"ImageCompressRate",{get:function(){return.6},enumerable:!0,configurable:!0}),Object.defineProperty(b,"ClientSideErrorDefaultInnerCode",{get:function(){return-1},enumerable:!0,configurable:!0}),Object.defineProperty(b,"DefaultVideoHeight",{get:function(){return 422},enumerable:!0,configurable:!0}),Object.defineProperty(b,"ImageSupportMimeType",{get:function(){return["image/bmp","image/gif","image/jpeg","image/png"]},enumerable:!0,configurable:!0}),Object.defineProperty(b,"MaxRankingItemNumber",{get:function(){return 10},enumerable:!0,configurable:!0}),Object.defineProperty(b,"DefaultQuestionStartOrder",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(b,"DefaultMiddleScreenSize",{get:function(){return 375},enumerable:!0,configurable:!0}),Object.defineProperty(b,"DefaultSmallScreenSize",{get:function(){return 300},enumerable:!0,configurable:!0}),Object.defineProperty(b,"AnalysisTokenName",{get:function(){return"AnalyzerToken"},enumerable:!0,configurable:!0}),Object.defineProperty(b,"LikertColumnMaxSize",{get:function(){return 7},enumerable:!0,configurable:!0}),Object.defineProperty(b,"LikertRowMaxSize",{get:function(){return Forms.getPageContext().Flighting.isEnabled("LikertSubQuestions20Limit")?20:10},enumerable:!0,configurable:!0}),Object.defineProperty(b,"FileUploadSmallFileBytes",{get:function(){return 4194304},enumerable:!0,configurable:!0}),Object.defineProperty(b,"FileUploadMaxChunkBytes",{get:function(){return 5242880},enumerable:!0,configurable:!0}),Object.defineProperty(b,"DateQuestionAnswerFormat",{get:function(){return"yyyy-MM-dd"},enumerable:!0,configurable:!0}),Object.defineProperty(b,"CustomizedThankYouMessageMaxLength",{get:function(){return 4e3},enumerable:!0,configurable:!0}),Object.defineProperty(b,"DefaultTextFieldHeight",{get:function(){return 40},enumerable:!0,configurable:!0}),Object.defineProperty(b,"MathInputLength",{get:function(){return 3e3},enumerable:!0,configurable:!0}),Object.defineProperty(b,"maxLocaleCount",{get:function(){return 10},enumerable:!0,configurable:!0}),b}();b.FormLimitation=c,a.Exports.FormLimitation=c}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(a){function b(a){return Nerve.getObjectMasterFromModel(a)}var c,d=Nerve.Spec,e={TargetQuestionId:d.string(),ToTheEnd:d["boolean"](),IsQuestionBranchingValid:d["boolean"]({IsLocalField:!0})};!function(a){a[a.End=0]="End",a[a.Next=1]="Next",a[a.Pending=2]="Pending",a[a.Specified=3]="Specified"}(c=a.BranchingType||(a.BranchingType={})),a.getBranchInfoMaster=b;var f=function(b){function d(a){var c=b.call(this,a)||this;return c.observedQuestionChangeCallback=function(a){return c.onObservedQuestionChange()},a.MasterTreeReady.done(function(){c.Question;c.Deleted||(d.normalize(c,{}),c.observeTargetQuestion(),c.addRule({Name:"normalize",onChange:function(a){return d.normalize(c,a.OldValues)}}),c.observe(function(a){c.Deleted||c.observeTargetQuestion()}))}),c}return __extends(d,b),Object.defineProperty(d.prototype,"Question",{get:function(){var b=this.Parent;do if(b instanceof a.QuestionMaster)return b;while(b=b.Parent);return null},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"TargetQuestionMaster",{get:function(){if(this.Deleted)return null;var a=this.Question.Form.getQuestionById(this.Model.TargetQuestionId);return a&&a.Deleted?null:a},enumerable:!0,configurable:!0}),d.prototype.resetToDefault=function(){var a=this;this.bulkEdit(function(){a.Model.ToTheEnd=null,a.Model.TargetQuestionId=null})},d.prototype.isDefault=function(){return!this.Model.ToTheEnd&&!this.Model.TargetQuestionId},d.prototype.getBranchingResult=function(){var a=this.Model;return a.IsQuestionBranchingValid?a.ToTheEnd?{Type:c.End}:{Type:c.Specified,TargetQuestion:this.TargetQuestionMaster}:{Type:c.Next}},d.normalize=function(a,b){var c=a.Model;c.ToTheEnd?b.ToTheEnd&&c.TargetQuestionId||(c.TargetQuestionId=null):c.ToTheEnd=null,c.IsQuestionBranchingValid=!(!c.ToTheEnd&&!a.TargetQuestionMaster)},d.prototype.observeTargetQuestion=function(){var a=this.TargetQuestionMaster;a!==this.observedQuestion&&(this.observedQuestion&&this.observedQuestion.unobserve(this.observedQuestionChangeCallback),this.observedQuestion=a,a&&a.observe(this.observedQuestionChangeCallback))},d.prototype.onObservedQuestionChange=function(){this.observedQuestion.Deleted&&(this.Model.TargetQuestionId=null)},d}(Nerve.createObjectMasterClass("BranchInfoMaster",e));a.BranchInfoMaster=f}(b=a.Model||(a.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(b){function c(a){return Nerve.getObjectMasterFromModel(a)}function d(b){if(b.BeingDeleted&&b.Master.Synchronizer.Model.UpdateScheduled)try{throw Error("DeletingComment")}catch(c){a.Event.ErrorEventDeprecated.logData({errorName:"ModelError",errorInfo:c.stack})}}var e=Nerve.Spec,f={QuestionId:e.string({IsKeyField:!0,SourceFieldName:"questionId"}),Id:e.number({SourceFieldName:"id"}),Feedback:e.string({SourceFieldName:"feedback"}),Score:e.number({SourceFieldName:"score"}),SavingState:e.reference({IsLocalField:!0})};b.getCommentMaster=c;var g=function(a,c){return new b.CommentDataSource(a,c)},h=function(a){function c(c){var e=a.call(this,c,{Scheduler:new b.Scheduler})||this;return b.keepSavingStateUpdated(e),e.observe(d),e}return __extends(c,a),Object.defineProperty(c.prototype,"Response",{get:function(){return this.Parent.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"FormId",{get:function(){return this.Response.FormId},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"ResponseId",{get:function(){return this.Response.ResponseId},enumerable:!0,configurable:!0}),c}(Nerve.createObjectMasterClass("Comment",f,g));b.CommentMaster=h}(c=b.Model||(b.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(b){var c=function(){function c(a,c){this.choice=a,this.receiver=c,this.dataProvider=b.FormDataSource.getDataProviderByFormMaster(this.choice.Form)}return Object.defineProperty(c.prototype,"FormId",{get:function(){return this.choice.FormId},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"QuestionId",{get:function(){return this.choice.QuestionId},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"ChoiceId",{get:function(){return this.choice.Model.Id},enumerable:!0,configurable:!0}),c.prototype.add=function(a){return this.choice.Form.SyncContext===b.FormSyncContext.DesignTimeForm?this.dataProvider.createQuestionChoice(this.FormId,this.QuestionId,a):void Nerve.Debugger.throwError("Trying to create a choice out of design time.")},c.prototype["delete"]=function(a){return this.choice.Form.SyncContext===b.FormSyncContext.DesignTimeForm?this.dataProvider.deleteQuestionChoice(this.FormId,this.QuestionId,this.ChoiceId):void Nerve.Debugger.throwError("Trying to delete a choice out of design time.")},c.prototype.query=function(a){return this.dataProvider.getQuestionChoice(this.FormId,this.QuestionId,this.ChoiceId)},c.prototype.update=function(c,d){if(this.choice.Form.SyncContext===b.FormSyncContext.DesignTimeForm){if(c)return this.dataProvider.updateQuestionChoice(this.FormId,this.QuestionId,this.ChoiceId,c);try{throw Error("patch choice body null error")}catch(e){a.Event.ErrorEventDeprecated.logData({errorName:"DataSourceUpdatingChoiceNull",errorInfo:{stack:e.stack}})}return $.Deferred().resolve().promise()}Nerve.Debugger.throwError("Trying to update a choice out of design time.")},c}();b.ChoiceDataSource=c}(c=b.Model||(b.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(a){var b=function(){function b(b,c){this.comment=b,this.receiver=c,this.dataProvider=a.FormDataSource.getDataProviderByFormMaster(this.comment.Response.Form)}return Object.defineProperty(b.prototype,"FormId",{get:function(){return this.comment.FormId},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"ResponseId",{get:function(){return this.comment.ResponseId},enumerable:!0,configurable:!0}),b.prototype.add=function(a,b,c){return this.dataProvider.addFormResponseComment(this.FormId,this.ResponseId,b.Snapshot)},b.prototype["delete"]=function(a){return $.Deferred().promise()},b.prototype.query=function(a){return Nerve.Debugger.throwError("No scenario to call this method currently.")},b.prototype.update=function(b,c){var d=this.comment.Response.Form.SyncContext;return d!==a.FormSyncContext.DesignTimeForm&&d!==a.FormSyncContext.AnalysisTimeForm?$.Deferred().promise():this.add(b,c,!0)},b}();a.CommentDataSource=b}(b=a.Model||(a.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(b){var c=function(){function c(a,d){if(this.form=a,this.receiver=d,this.dataProvider=c.getDataProviderByFormMaster(a),this.dataProvider){var e=this.dataProvider.getDesignForm;switch(this.form.SyncContext){case b.FormSyncContext.SharedTimeForm:e=this.dataProvider.getSharedForm;break;case b.FormSyncContext.ResponseTimeForm:e=this.dataProvider.getRuntimeForm;break;case b.FormSyncContext.AnalysisTimeForm:e=this.dataProvider.getAnalysisTimeForm;break;case b.FormSyncContext.ResponseDetailTimeForm:e=this.dataProvider.getRuntimeFormV2}this.getForm=e.bind(this.dataProvider)}}return c.getAllForms=function(d,e,f){var g=c.getSourceFieldNames(d);g.push("status");var h=Nerve.getFieldSchemaInfo(b.FormMaster.Schema.Version).Attributes.SourceFieldName;g.indexOf(h)&&g.push(h);var i=a.DataProvider.DataProviderType.Me,j=null,k=null;e&&(j=e.OwnerTenantId,k=e.OwnerId,i=e.IsGroupForm?a.DataProvider.DataProviderType.Group:a.DataProvider.DataProviderType.Personal);var l=a.DataProvider.ProviderManager.getInstance().createDataProvider(i,j,k),m=l.getForms(g,f);return m.then(function(c){var d=[],e=0,f=[];return c.forEach(function(a){if("Deleted"===a.status)++e,l.deleteForm(a.id);else if(a.version){var c=Nerve.convertFromSourceData(a,b.FormMaster.Schema);f.push(c)}else d.push(a.id)}),(d.length||e)&&a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.PortalPage.FilteredOutForms,extraData:{deletedFormCount:e,oldVersionForms:d}}),f})},c.getAllFormsResponseCount=function(){var b=a.DataProvider.ProviderManager.getInstance().createDataProvider();return b.getFormsResponseCount()},c.getAllLocaleResources=function(a){var b=c.getDataProviderByFormId(a);return b.getAllLocaleResources(a)},c.getAllSharedWithMeForms=function(){var c=a.DataProvider.ProviderManager.getInstance().createDataProvider(a.DataProvider.DataProviderType.Me),d=c.getFormsSharedWithCurrentUser();return d.then(function(a){return a.map(function(a){return Nerve.convertFromSourceData(a,b.FormMaster.Schema)})})},c.getDataProviderByFormMaster=function(c){if(!c.isFieldReady(b.FormMaster.Schema.OwnerTenantId)||!c.isFieldReady(b.FormMaster.Schema.OwnerId))return a.DataProvider.ProviderManager.getInstance().createDataProvider();var d=a.DataProvider.DataProviderType.Default;if(c.IsGroupForm)d=a.DataProvider.DataProviderType.Group;else{if(!c.Model.OwnerTenantId||!c.Model.OwnerId)return null;d=a.DataProvider.DataProviderType.Personal}return a.DataProvider.ProviderManager.getInstance().createDataProvider(d,c.Model.OwnerTenantId,c.Model.OwnerId)},c.getDataProviderByFormId=function(b){var c=a.Utilities.FormId.decodeFormId(b),d=a.DataProvider.DataProviderType.Default;return c.IsGroupOwner?d=a.DataProvider.DataProviderType.Group:c.OrgId&&c.OwnerId&&(d=a.DataProvider.DataProviderType.Personal),a.DataProvider.ProviderManager.getInstance().createDataProvider(d,c.OrgId,c.OwnerId)},c.createExportFile=function(a){var b=c.getDataProviderByFormMaster(a);return b.createExportFile(a.Model.Id)},c.downloadExcelFile=function(a,b,d){var e=c.getDataProviderByFormMaster(a);return e.downloadExcelFile(a.Model.Id,b,d)},c.getResponseCount=function(a){var b=c.getDataProviderByFormMaster(a);return b.getFormResponseCount(a.Model.Id)},c.duplicateExcelForm=function(c,d){var e=a.DataProvider.ProviderManager.getInstance().createDataProvider(),f=e.dupFormForExcel(c,d);return f.then(function(a){return Nerve.convertFromSourceData(a,b.FormMaster.Schema)})},c.getAggregateSurveyData=function(a){var b=c.getDataProviderByFormId(a);return b.getAnalysisSurveyData(a)},c.getAggregateQuizData=function(a){var b=c.getDataProviderByFormId(a);return b.getAnalysisQuizData(a)},c.getResultSharingAnalysisSurveyData=function(a){var b=c.getDataProviderByFormId(a);return b.getResultSharingAnalysisSurveyData(a)},c.getResultSharingAnalysisQuizData=function(a){var b=c.getDataProviderByFormId(a);return b.getResultSharingAnalysisQuizData(a)},c.getFormInsights=function(a){var b=c.getDataProviderByFormId(a);return b.getInsights(a)},c.getResoucesByLocale=function(a,d){var e=Nerve.Collection.getItemWithKeyFields(a.Model.LocalizedResources,{localeId:d});if(!e){var f=c.getDataProviderByFormId(a.Model.Id);return f.getLocaleResource(a.Model.Id,d).then(function(c){Forms.Models.appendLocalizedResources(c,b.exportConverter(a))})}return $.Deferred().resolve().promise()},c.prototype.add=function(a){return this.form.SyncContext===b.FormSyncContext.LocalForm?$.Deferred().promise():this.form.SyncContext===b.FormSyncContext.DesignTimeForm?this.dataProvider.createForm(a):void Nerve.Debugger.throwError("Trying to create a form without design type.")},c.prototype["delete"]=function(a){return this.form.SyncContext===b.FormSyncContext.DesignTimeForm?(this.removeFromMRU(),this.dataProvider.deleteForm(this.form.Model.Id)):void Nerve.Debugger.throwError("Trying to delete a form without design type.")},c.prototype.query=function(b){if(!this.getForm){var c={innerCode:a.DataProvider.ErrorCode.InnerCode.InvalidFormId};return $.Deferred().reject(c).promise()}var d=Nerve.getFieldSchemaInfo(this.form.Schema.LocalizedResources).Attributes.SourceFieldName,e=b.filter(function(a){
return a!==d}),f=[];return f.push(this.getForm(this.form.Model.Id,e)),_.find(b,function(a){return a===d})&&f.push(this.form.getAllLocaleResources()),$.when.apply($,f).then(function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return _.extend.apply(_,[{}].concat(a))})},c.prototype.update=function(a){if(this.form.SyncContext===b.FormSyncContext.LocalForm)return $.Deferred().promise();if(this.form.SyncContext!==b.FormSyncContext.DesignTimeForm)return $.Deferred().resolve().promise();var c=Nerve.getFieldSchemaInfo(b.FormMaster.Schema.SoftDeleted).Attributes.SourceFieldName;return c in a&&a[c]===b.FormDeletedState.SoftDeleted&&this.removeFromMRU(),this.dataProvider.updateForm(this.form.Model.Id,a)},c.getSourceFieldNames=function(a){return b.FormMaster.getSourceFields(a||Nerve.getSubFieldSchemas(b.FormMaster.Schema)).map(function(a){var b=Nerve.getFieldSchemaInfo(a);return b.Attributes.IsLocalField?void 0:b.Attributes.SourceFieldName||b.Name}).filter(function(a){return a})},c.prototype.removeFromMRU=function(){var a=this;return this.dataProvider.removeRecentForm(this.form.Model.Id).then(function(){var b=Forms.Mru.MruDocumentManager.getInstance();b&&b.removeDocument(a.form.Model.Id)})},c}();b.FormDataSource=c}(c=b.Model||(b.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(b){var c=function(){function c(c,d){this.image=c,this.receiver=d;var e,f=this.image.Parent;if(f instanceof b.FormMaster)e=f;else{if(!(f instanceof b.QuestionMaster||f instanceof Forms.Models.DescriptiveElementMaster))throw"Wrong parent type of ImageInfoMaster.";e=f.Form}var g=e.IsGroupForm?a.DataProvider.DataProviderType.Group:a.DataProvider.DataProviderType.Personal;this.dataProvider=b.FormDataSource.getDataProviderByFormMaster(e),this.imageProvider=a.DataProvider.ProviderManager.getInstance().createImageProvider(g,e.Model.OwnerTenantId,e.Model.OwnerId);var h=Nerve.getFieldSchemaInfo(c.Membership.FieldSchema);this.propertyName=h.Attributes.SourceFieldName||h.Name}return c.prototype.add=function(a){return $.Deferred().resolve().promise()},c.prototype["delete"]=function(a){return Nerve.Debugger.throwError("not supported")},c.prototype.query=function(a){return Nerve.Debugger.throwError("not supported")},c.prototype.update=function(a){var b=a.uploadParameters;if(!b)return this.uploadAsComplexType();var c;return b.Delete?c=this.deleteImage():b.ImageFile?c=this.uploadFromImageFile(b.ImageFile):b.Url&&(c=this.createImageFromUrl(b.Url,b.Size)),c?c.then(function(a){var b=_.clone(a);return b.uploadParameters=null,b}):void 0},c.prototype.uploadAsComplexType=function(){var a=this,c=Nerve.convertToSourceData(this.image.getSnapshot(),b.ImageInfoMaster.Schema);delete c.uploadParameters;var d={};d[this.propertyName]=c;var e,f=this.image.Parent;if(f instanceof b.FormMaster)e=this.dataProvider.updateForm(f.Model.Id,d);else{if(!(f instanceof b.QuestionMaster||f instanceof Forms.Models.DescriptiveElementMaster))return Nerve.Debugger.throwError("not supported");var g=f;e=g.createUploadSyncJob(function(){return a.dataProvider.updateFormQuestion(g.Form.Model.Id,g.Model.Id,g.Model.Type,d)})}return e.then(function(b){return b&&b[a.propertyName]})},c.prototype.createImageFromUrl=function(c,d){var e=this,f={SourceUrl:c,Title:a.Utilities.Guid.newGuid(),Size:d},g=this.image.Parent;if(g instanceof b.FormMaster)return this.dataProvider.createFormImageFromUrl(g.Model.Id,this.propertyName,f);if(g instanceof b.QuestionMaster||g instanceof Forms.Models.DescriptiveElementMaster){var h=g;return h.createUploadSyncJob(function(){return e.dataProvider.createQuestionImageFromUrl(h.Form.Model.Id,h.Model.Id,f)})}return Nerve.Debugger.throwError("not supported")},c.prototype.uploadFromImageFile=function(c){var d=this,e={ImageBlob:c,ImageName:a.Utilities.Guid.newGuid(),ImageType:c.type},f=this.image.Parent;if(f instanceof b.FormMaster)return this.imageProvider.uploadFormImage(f.Model.Id,this.propertyName,e);if(f instanceof b.QuestionMaster||f instanceof Forms.Models.DescriptiveElementMaster){var g=f;return g.createUploadSyncJob(function(){return d.imageProvider.uploadQuestionImage(g.Form.Model.Id,g.Model.Id,d.propertyName,e)})}return Nerve.Debugger.throwError("not supported")},c.prototype.deleteImage=function(){var c,d=this,e=this.image.Parent;if(e instanceof b.FormMaster)c=this.imageProvider.deleteFormImage(e.Model.Id,this.propertyName);else{if(!(e instanceof b.QuestionMaster||e instanceof Forms.Models.DescriptiveElementMaster))return Nerve.Debugger.throwError("not supported");var f=e;c=f.createUploadSyncJob(function(){return d.imageProvider.deleteQuestionImage(f.Form.Model.Id,f.Model.Id,d.propertyName)})}return c.then(null,function(b){return b&&b.innerCode===a.DataProvider.ErrorCode.InnerCode.ImageNotFound?(a.Event.ErrorEventDeprecated.logData({errorName:"DeleteImageNotFoundError",errorInfo:{imageUrl:d.image.Model.ResourceUrl}}),$.Deferred().resolve().promise()):b}).then(function(){return{altText:null,contentType:null,fileIdentifier:null,height:null,imageFile:null,originalFileName:null,resourceId:null,resourceUrl:null,size:null,width:null}})},c}();b.ImageDataSource=c}(c=b.Model||(b.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(a){var b=function(){function b(b,c){this.permission=b,this.receiver=c,this.dataProvider=a.FormDataSource.getDataProviderByFormMaster(this.permission.Form)}return Object.defineProperty(b.prototype,"FormId",{get:function(){return this.permission.FormId},enumerable:!0,configurable:!0}),b.prototype.add=function(a){return this.dataProvider.createPermissionLink(this.FormId,a)},b.prototype["delete"]=function(a){return this.dataProvider.deletePermissionLink(this.FormId,a.principalId)},b.prototype.query=function(a){return Nerve.Debugger.throwError("No scenario to call this method currently.")},b.prototype.update=function(b,c){return c.Snapshot.type===a.PermissionType[a.PermissionType.OrgLink]||c.Snapshot.type===a.PermissionType[a.PermissionType.Link]?this.dataProvider.createPermissionLink(this.FormId,{permissionSet:c.Snapshot.permissionSet,type:c.Snapshot.type}):Nerve.Debugger.throwError("No scenario to call this method currently.")},b}();a.PermissionDataSource=b}(b=a.Model||(a.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(a){var b=function(){function b(b,c){this.permissionToken=b,this.receiver=c,this.dataProvider=a.FormDataSource.getDataProviderByFormMaster(this.permissionToken.Form)}return Object.defineProperty(b.prototype,"FormId",{get:function(){return this.permissionToken.FormId},enumerable:!0,configurable:!0}),b.prototype.add=function(a){return this.dataProvider.createPermissionToken(this.FormId,a)},b.prototype["delete"]=function(a){return this.dataProvider.deletePermissionToken(this.FormId,a.principalId)},b.prototype.query=function(a){return Nerve.Debugger.throwError("No scenario to call this method currently.")},b.prototype.update=function(a,b){return Nerve.Debugger.throwError("No scenario to call this method currently.")},b}();a.PermissionTokenDataSource=b}(b=a.Model||(a.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(b){var c=function(){function c(a,c){this.question=a,this.receiver=c,this.dataProvider=b.FormDataSource.getDataProviderByFormMaster(this.question.Form)}return Object.defineProperty(c.prototype,"FormId",{get:function(){return this.question.Form.Model.Id},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"QuestionId",{get:function(){return this.question.Model.Id},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"QuestionType",{get:function(){return this.question.Model.Type},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"ExtraQosData",{get:function(){var a=this.question.Form,b=a.isFieldReady(a.Schema.DescriptiveElements)&&a.hasSection();return{WithSection:b}},enumerable:!0,configurable:!0}),c.prototype.add=function(a){var c=this;if(this.question.Form.SyncContext===b.FormSyncContext.DesignTimeForm){var d=this.question.ParentQuestionMaster;return d?d.Synchronizer.existingInDataSource().then(function(){return c.addInternally(a)}):this.addInternally(a)}Nerve.Debugger.throwError("Trying to create a question without design type.")},c.prototype["delete"]=function(c){var d=this;this.question.Form.SyncContext!==b.FormSyncContext.DesignTimeForm&&Nerve.Debugger.throwError("Trying to delete a question without design type.");var e=this.question.ParentQuestionMaster;if(e&&e.Deleted)return $.Deferred().resolve().promise();var f=this.question.SubQuestionMasters.map(function(a){return a.Synchronizer.flush()});return $.when.apply($,f).then(function(){return d.question.createSyncJob(function(){return d.dataProvider.deleteFormQuestion(d.FormId,c.id,d.QuestionType,d.ExtraQosData)})}).then(null,function(b){return b&&b.innerCode===a.DataProvider.ErrorCode.InnerCode.CDBColumnNotFound?$.Deferred().resolve().promise():b})},c.prototype.query=function(a){var b=this;return Nerve.Debugger.throwError("No scenario to call this method currently."),this.question.createSyncJob(function(){return b.dataProvider.getFormQuestion(b.FormId,b.QuestionId,a)})},c.prototype.update=function(c,d){var e=this;if(this.question.Form.SyncContext!==b.FormSyncContext.DesignTimeForm)return $.Deferred().resolve().promise();if("id"in c){var f=c.id,g=d.ValuesBefore.id;a.Event.ErrorEventDeprecated.logData({errorName:"DataSourceUpdatingQuestionId",errorInfo:{newId:f,oldId:g}})}if(null===c.allowMultipleValues)try{throw Error("allowMultipleValues null error")}catch(h){a.Event.ErrorEventDeprecated.logData({errorName:"DataSourceUpdatingQuestionNullAllowMultipleValues",errorInfo:{stack:h.stack}})}return this.question.createUploadSyncJob(function(){return e.dataProvider.updateFormQuestion(e.FormId,e.QuestionId,e.QuestionType,c,e.ExtraQosData)})},c.prototype.addInternally=function(b){var c=this,d=this.question.createSyncJob(function(){return c.dataProvider.createFormQuestion(c.FormId,b,c.ExtraQosData)});return d.done(function(b){"id"in b&&b.id!==c.QuestionId&&a.Event.ErrorEventDeprecated.logData({errorName:"ChangedIdFromServerSide",errorInfo:{newId:b.id,oldId:c.QuestionId,formId:c.FormId}})}),d},c}();b.QuestionDataSource=c}(c=b.Model||(b.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(b){var c="0001-01-01T00:00:00Z",d=function(){function d(a,c){this.response=a,this.receiver=c,this.dataProvider=b.FormDataSource.getDataProviderByFormMaster(this.response.Form)}return Object.defineProperty(d.prototype,"FormId",{get:function(){return this.response.FormId},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"ResponseId",{get:function(){return this.response.ResponseId},enumerable:!0,configurable:!0}),d.submitResponse=function(c,d){var e=_.map(d.Answers,function(a){return{questionId:a.QuestionId,answer1:a.Answer}}),f={answers:JSON.stringify(e),startDate:d.StartDate instanceof Date?d.StartDate.toISOString():"",submitDate:d.SubmitDate instanceof Date?d.SubmitDate.toISOString():""};return a.Flighting.Flight.isEnabled("EmailReceipt")&&(f.emailReceiptConsent=d.EmailReceiptConsent),f.submitLanguage=d.SubmitLanguage,d.Responder&&(f.responder=d.Responder,f.responderName=d.ResponderName),b.FormDataSource.getDataProviderByFormMaster(c).submitFormResponse(c.Model.Id,f)},d.getResponses=function(a,c,e){return b.FormDataSource.getDataProviderByFormMaster(a).getFormResponses(a.Model.Id,null,c,e).then(function(a){return a.map(d.toClientPayload)})},d.getRuntimeResponses=function(a){return b.FormDataSource.getDataProviderByFormMaster(a).getRuntimeResponses(a.Model.Id).then(function(a){return a.map(d.toClientPayload)})},d.deleteAllResponses=function(a){return b.FormDataSource.getDataProviderByFormMaster(a).deleteFormResponses(a.Model.Id)},d.getReleasedResponsesByResponder=function(a,e){return b.FormDataSource.getDataProviderByFormMaster(a).getRuntimeResponses(a.Model.Id,e).then(function(a){return a.filter(function(a){return a.releaseDate!==c}).map(d.toClientPayload)})},d.getRuntimeResponse=function(a,c){return b.FormDataSource.getDataProviderByFormMaster(a).getRuntimeResponse(a.Model.Id,c).then(d.toClientPayload)},d.deleteResponses=function(a,c){var d=b.FormDataSource.getDataProviderByFormId(a);return $.when.apply($,c.map(function(b){return d.deleteFormResponse(a,b)}))},d.toClientPayload=function(a){var d=Nerve.convertFromSourceData(a,b.ResponseMaster.Schema);void 0!==d.StartDateAsString&&(d.StartDate=new Date(d.StartDateAsString)),void 0!==d.SubmitDateAsString&&(d.SubmitDate=new Date(d.SubmitDateAsString)),void 0!==d.ReleaseDateAsString&&(null===d.ReleaseDateAsString?d.ReleaseDate=new Date(c):d.ReleaseDate=new Date(d.ReleaseDateAsString));var e=[];if(d.AnswersAsString&&(e=JSON.parse(d.AnswersAsString).map(function(a){return{QuestionId:a.questionId,Answer:a.answer1}}),d.Answers=e),d.Comments){var f={},g=[],h="___";_.forEach(d.Comments,function(a){var b=a.QuestionId||h;f[b]&&g.push(f[b]),f[b]=a}),d.Comments=_.difference(d.Comments,g)}if(d.Comments){var i={};e.forEach(function(a){return i[a.QuestionId]=a}),_.forEach(d.Comments,function(a){var b=a.QuestionId;if(b){var c=i[b];c||(c={QuestionId:b,Answer:null},e.push(c),i[b]=c),c.Feedback=a.Feedback,c.Score=a.Score}else d.Feedback=a.Feedback,d.TotalScore=a.Score})}return d},d.prototype.add=function(a){return Nerve.Debugger.throwError("No scenario to call this method currently.")},d.prototype["delete"]=function(a){return this.dataProvider.deleteFormResponse(this.FormId,a.id)},d.prototype.query=function(a){return Nerve.Debugger.throwError("No scenario to call this method currently.")},d.prototype.update=function(a,c){var d=a.releaseDate,e=this.response.Form.SyncContext;return e!==b.FormSyncContext.DesignTimeForm&&e!==b.FormSyncContext.AnalysisTimeForm?$.Deferred().promise():void 0!==d?this.dataProvider.setResponseReleaseDate(this.FormId,this.ResponseId,d):$.Deferred().resolve().promise()},d}();b.ResponseDataSource=d}(c=b.Model||(b.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(b){var c=function(){function b(a,b){void 0===a&&(a=1e3),void 0===b&&(b=5e3);var c=this;this.maxRetryTimesForUpdate=Number.MAX_VALUE,null==a&&(a=1e3),null==b&&(b=5e3),this.fast=a,this.slow=b,this.updateTrigger=function(){return c.clearUpdateSchedule().resolve()}}return b.prototype.scheduleUpdate=function(){if(this.deferred)throw Error("Calling schedule() before the previous one is resolved.");return this.deferred=$.Deferred(),this.updateFastTimer=window.setTimeout(this.updateTrigger,this.fast),this.updateSlowTimer=window.setTimeout(this.updateTrigger,this.slow),this.deferred.promise()},b.prototype.postponeUpdate=function(){window.clearTimeout(this.updateFastTimer),this.updateFastTimer=window.setTimeout(this.updateTrigger,this.fast)},b.prototype.cancelUpdate=function(){this.clearUpdateSchedule().reject()},b.prototype.setMaxRetryTimesForUpdate=function(a){this.maxRetryTimesForUpdate=a},b.prototype.clearUpdateSchedule=function(){window.clearTimeout(this.updateFastTimer),this.updateFastTimer=void 0,window.clearTimeout(this.updateSlowTimer),this.updateSlowTimer=void 0;var a=this.deferred;return this.deferred=void 0,a},b.prototype.retryForCreation=function(b){return 3>b?a.Utilities.Promise.getResolvedPromise():a.Utilities.Promise.getRejectedPromise()},b.prototype.retryForUpdate=function(b){var c=this;if(b>=this.maxRetryTimesForUpdate)return a.Utilities.Promise.getRejectedPromise();var g=e;f>b&&(g=d*Math.pow(2,b)),this.updateRetryTimer=window.setTimeout(function(){c.updateRetryTimer=void 0,h.resolve()},g);var h=$.Deferred();return h.promise()},b.prototype.cancelRetryForUpdate=function(){window.clearTimeout(this.updateRetryTimer),this.updateRetryTimer=void 0},b}();b.Scheduler=c;var d=2500,e=6e5,f=Math.log(e/d)/Math.log(2)}(c=b.Model||(b.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(a){function b(a,c,d){if(null==a)return null;if(Array.isArray(a)){if(a.length){var e=c[0];return a.map(function(a){return b(a,e,d)})}return d}var f={},g=0;return Nerve.getSubFieldSchemas(c).forEach(function(c){var e=Nerve.getFieldSchemaInfo(c),h=e.Attributes.SourceFieldName||e.Name,i=a[h];e.IsLeaf||(i=b(i,c,d)),null!=i&&(++g,f[h]=i)}),g>0?f:null}a.rateToRemoveEmptyArray=0;var c=function(){function c(a,b,c){this.master=a,this.targetField=b,this.bindedFields=c.FieldSchemas,this.bind()}return c.prototype.serialize=function(){var c=this.master.getSnapshot(this.bindedFields),d=this.master.Schema,e={};this.bindedFields.forEach(function(a){var b=Nerve.getFieldSchemaInfo(a).Name;e[b]=Nerve.convertToSourceData(c[b],a)});var f=Nerve.getFieldSchemaInfo(this.targetField).Name,g=b(e,d,[]),h=g&&JSON.stringify(g),i=this.master.Model[f]!==h;(i||Math.random()<a.rateToRemoveEmptyArray)&&(i=!0,g=b(e,d,null),h=g&&JSON.stringify(g)),i&&(this.master.Model[f]=h)},c.prototype.deserialize=function(){var a=Nerve.getFieldSchemaInfo(this.targetField).Name,b=this.master.Model[a],c=b?JSON.parse(b):{},d={};this.bindedFields.forEach(function(a){var b=Nerve.getFieldSchemaInfo(a).Name;d[b]=Nerve.convertFromSourceData(c[b],a)}),this.master.setData(d,this.bindedFields)},c.prototype.bind=function(){var a=this,b=Nerve.getFieldSchemaInfo(this.targetField).Name;this.master.addRule({Name:"Deserialize - "+b,InterestedFields:[this.targetField],onChange:function(b){b.BeingDeleted||a.deserialize()}}),this.master.addRule({Name:"Serialize - "+b,InterestedFields:this.bindedFields,onChange:function(b){b.BeingDeleted||a.serialize()}})},c}();a.FieldBinder=c}(b=a.Model||(a.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(b){var c=function(){function b(a){this.fieldSchemas=a.concat(),this.fieldNames=a.map(function(a){return Nerve.getFieldSchemaInfo(a).Name})}return Object.defineProperty(b.prototype,"FieldSchemas",{get:function(){return this.fieldSchemas.concat()},enumerable:!0,configurable:!0}),b.prototype.covers=function(b){return a.Utilities.Type.isString(b)?_.contains(this.fieldNames,b):_.contains(this.fieldSchemas,b)},b}();b.FieldSet=c}(c=b.Model||(b.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(c){function d(a){return e(a,!0)}function e(b,d){if(d&&(b.SoftDeleted=b.SoftDeleted),b.Id)return c.exportConverter(m.getDesignFormMaster(b));var e=s.FieldsForCreatingForm.map(Nerve.getFieldSchemaInfo).map(function(a){return a.Name});if(b=_.pick(b,e),d?(b.OwnerId=b.OwnerId||a.EnvironmentSettings.GroupId,b.OwnerTenantId=b.OwnerTenantId||a.EnvironmentSettings.TenantId||OfficeFormServerInfo.userInfo.TenantId):(b.OwnerId=b.OwnerId||OfficeFormServerInfo.userInfo.UserId,b.OwnerTenantId=b.OwnerTenantId||OfficeFormServerInfo.userInfo.TenantId),!b.OwnerId||!b.OwnerTenantId)throw new Error("Form OwnerId or OwnerTenantId cannot be null!");return c.exportConverter(m.createNewFormMaster(b,d?"Group":"User"))}function f(b){var d=a.Utilities.FormId.decodeFormId(b);return new c.FormMaster(o.ResponseTimeForm,{InitialData:{Id:b,OwnerId:d.OwnerId,OwnerTenantId:d.OrgId,TableId:d.TableId},ExistingInDataSource:!0},d.IsGroupOwner)}function g(b){var d=a.Utilities.FormId.decodeFormId(b);return new c.FormMaster(o.ResponseDetailTimeForm,{InitialData:{Id:b,OwnerId:d.OwnerId,OwnerTenantId:d.OrgId,TableId:d.TableId},ExistingInDataSource:!0},d.IsGroupOwner)}function h(b){var d=a.Utilities.FormId.decodeFormId(b);return new c.FormMaster(o.SharedTimeForm,{InitialData:{Id:b,OwnerId:d.OwnerId,OwnerTenantId:d.OrgId,TableId:d.TableId},ExistingInDataSource:!0},d.IsGroupOwner)}function i(b){var d=a.Utilities.FormId.decodeFormId(b);return new c.FormMaster(o.AnalysisTimeForm,{InitialData:{Id:b,OwnerId:d.OwnerId,OwnerTenantId:d.OrgId,TableId:d.TableId},ExistingInDataSource:!0},d.IsGroupOwner)}function j(a){return new c.FormMaster(o.LocalForm,{InitialData:a},!1)}var k,l=Nerve.Spec,m=Forms.Models.FormManager,n={Id:l.string({IsSourceGenerated:!0,IsKeyField:!0,SourceFieldName:"id"}),Description:l.string({SourceFieldName:"description"}),Background:l.fromMasterClass(function(){return c.ImageInfoMaster},{SourceFieldName:"background"}),Category:l.string({SourceFieldName:"category"}),Logo:l.fromMasterClass(function(){return c.ImageInfoMaster},{SourceFieldName:"logo"}),ModifiedDate:l.string({SourceFieldName:"modifiedDate"}),OtherInfo:l.string({SourceFieldName:"otherInfo"}),OwnerId:l.string({SourceFieldName:"ownerId"}),OwnerTenantId:l.string({SourceFieldName:"ownerTenantId"}),RowCount:l.number({SourceFieldName:"rowCount"}),SharedBy:l.string({SourceFieldName:"sharedBy"}),SharedFormOwnerName:l.string({SourceFieldName:"ownerDisplayName"}),SharedDate:l.string({SourceFieldName:"dateTimeShared"}),TableId:l.string({IsSourceGenerated:!0,SourceFieldName:"tableId"}),Title:l.string({SourceFieldName:"title"}),Version:l.string({SourceFieldName:"version"}),XlWorkbookId:l.string({SourceFieldName:"xlWorkbookId"}),XlExportingTag:l.string({SourceFieldName:"xlExportingTag"}),XlFileUnsynced:l["boolean"]({SourceFieldName:"xlFileUnSynced"}),Permissions:l.collectionOf(function(){return c.PermissionMaster},{SourceFieldName:"permissions"}),PermissionTokens:l.collectionOf(function(){return c.PermissionTokenMaster},{SourceFieldName:"permissionTokens"}),Questions:l.collectionOf(function(){return c.QuestionMaster},{SourceFieldName:"questions"}),DescriptiveElements:l.collectionOf(function(){return Forms.Models.DescriptiveElementMaster},{SourceFieldName:"descriptiveQuestions"}),MovingToRecycleBin:l["boolean"]({IsLocalField:!0}),SoftDeleted:l.enumeration(function(){return q},{SourceFieldName:"softDeleted",IsNumberTypeInDataSource:!0}),TrackingId:l.string({SourceFieldName:"trackingId"}),ThankYouMessage:l.string({SourceFieldName:"thankYouMessage"}),EmailReceiptEnabled:l["boolean"]({SourceFieldName:"emailReceiptEnabled"}),Flags:l.number({SourceFieldName:"flags"}),Type:l.reference({SourceFieldName:"type"}),OnlineSafetyLevel:l.number({SourceFieldName:"onlineSafetyLevel"}),BufferResponses:l.collectionOf(l.reference({},function(a){return a.Id.toString()}),{IsLocalField:!0}),CoAuthMessage:l.string({IsLocalField:!0}),DeleteCollaborationPermission:l["boolean"]({IsLocalField:!0}),HasValidBranching:l["boolean"]({IsLocalField:!0}),HasQuestionMedia:l["boolean"]({IsLocalField:!0}),Modified:l.string({IsLocalField:!0}),PredefinedResponses:l.collectionOf({Id:l.number({IsKeyField:!0}),Answers:l.collectionOf({QuestionId:l.string(),Answer:l.reference()})},{IsLocalField:!0}),PrimaryCustomizedThemeColor:l.string({IsLocalField:!0}),QuizQuestionsCount:l.number({IsLocalField:!0}),SecondaryCustomizedThemeColor:l.string({IsLocalField:!0}),Responses:l.collectionOf(l.reference({},function(a){return a.Id.toString()}),{IsLocalField:!0}),ResponsesCount:l.number({IsLocalField:!0}),XlExportingLocalTag:l.string({IsLocalField:!0}),SerializedSettings:l.string({SourceFieldName:"settings"}),Settings:l.fromMasterClass(function(){return c.FormSettingsMaster},{IsLocalField:!0}),SerializedPredefinedResponses:l.string({SourceFieldName:"predefinedResponses"}),TertiaryCustomizedThemeColor:l.string({IsLocalField:!0}),Theme:l.fromMasterClass(function(){return Forms.Models.FormThemeMaster},{IsLocalField:!0}),ResponseModels:l.collectionOf(function(){return c.ResponseMaster},{IsLocalField:!0}),IntegratedSavingState:l.reference({IsLocalField:!0}),SavingState:l.reference({IsLocalField:!0}),LogoInfo:l.fromMasterClass(function(){return c.ImageSettingsMaster},{IsLocalField:!0}),CreatedFromOneDrive:l["boolean"]({IsLocalField:!0}),TransferInProgress:l["boolean"]({IsLocalField:!0}),DataClassificationLabel:l.string(),DefaultLanguage:l.string({SourceFieldName:"defaultLanguage"}),LocaleList:l.collectionOf(function(){return Forms.Models.LocaleInfoMaster},{SourceFieldName:"localeList"}),LocalizedResources:l.collectionOf(function(){return Forms.Models.FormLocalizedItemMaster},{SourceFieldName:"localizedResources"})};!function(a){a[a.None=0]="None",a[a.MoveInProgress=1]="MoveInProgress",a[a.CvsScanAllowed=2]="CvsScanAllowed"}(k=c.FormFlags||(c.FormFlags={}));var o;!function(a){a[a.DesignTimeForm=0]="DesignTimeForm",a[a.ResponseTimeForm=1]="ResponseTimeForm",a[a.SharedTimeForm=2]="SharedTimeForm",a[a.LocalForm=3]="LocalForm",a[a.AnalysisTimeForm=4]="AnalysisTimeForm",a[a.ResponseDetailTimeForm=5]="ResponseDetailTimeForm"}(o=c.FormSyncContext||(c.FormSyncContext={}));var p;!function(a){a[a.ConnectionStateChanged=0]="ConnectionStateChanged",a[a.UserAction=1]="UserAction",a[a.UserConnect=2]="UserConnect",a[a.UserDisconnect=3]="UserDisconnect"}(p=c.FormChangeActionType||(c.FormChangeActionType={}));var q;!function(a){a[a.Normal=0]="Normal",a[a.SoftDeleted=1]="SoftDeleted"}(q=c.FormDeletedState||(c.FormDeletedState={})),c.createGroupDesignFormMaster=d,c.createDesignFormMaster=e,c.createResponseFormMaster=f,c.createResponseDetailFormMaster=g,c.createSharedFormMaster=h,c.createAnalysisFormMaster=i,c.createLocalFormMaster=j;var r=function(a,b){return a.SyncBlocker.then(function(){return new c.FormDataSource(a,b)})},s=function(d){function f(b,e,g,h){var i=this,j=$.Deferred();return e=f.normalizeInitialData(e),i=d.call(this,e,{Scheduler:new c.Scheduler,MasterReady:j.promise()})||this,i.syncBlocker=h||j,i.isGroupForm=g,i.currentQuestionListDownloadJob=$.Deferred().resolve().promise(),i.questionSyncJobs=[],i.syncContext=b,i.formElementManager=c.exportConverter(new Forms.Models.FormElementManager(c.exportConverter(i))),i.initializeElementOrderRule(),i.initializeOtherInfoBinder(e),i.initializeSavingStateIntegration(),i.initializeModifiedDate(e),i.initializeResponseCount(),c.bindImageSettings(i,f.Schema.Logo,f.Schema.LogoInfo),i.observe(function(){i.ensureFieldsReady([c.FormMaster.Schema.XlExportingTag]).done(function(){return i.Model.XlExportingLocalTag=i.Model.XlExportingTag.toLocaleLowerCase()})},[c.FormMaster.Schema.XlExportingTag]),f.Rules.forEach(function(a){return i.addRule(a)}),i.coAuthUserStateChangeCallbacks=new a.Utilities.Process.CallbackManager,j.resolve(),i}return __extends(f,d),Object.defineProperty(f,"ExportingProcessingStatusString",{get:function(){return"exporting"},enumerable:!0,configurable:!0}),Object.defineProperty(f,"ExportingFailedStatusString",{get:function(){return"failed"},enumerable:!0,configurable:!0}),Object.defineProperty(f,"ExportingTimeoutStatusString",{get:function(){return"timeout"},enumerable:!0,configurable:!0}),Object.defineProperty(f,"ReexportToExcelMaxTimeForTimeout",{get:function(){return 3e5},enumerable:!0,configurable:!0}),f.getSourceFields=function(a){var b=f.Schema,c=[];return a.forEach(function(a){switch(a){case"Settings":case b.Settings:c.push(b.SerializedSettings);break;case"Modified":case b.Modified:c.push(b.ModifiedDate);break;case"ResponsesCount":case b.ResponsesCount:c.push(b.RowCount);break;case"PredefinedResponses":case b.PredefinedResponses:c.push(b.SerializedPredefinedResponses);break;case"Theme":case b.Theme:c.push(b.Background,b.OtherInfo);break;default:if(f.OtherInfoFieldSet.covers(a)){c.push(b.OtherInfo);break}c.push(a)}}),_.uniq(c)},Object.defineProperty(f,"FieldsForCreatingForm",{get:function(){return f.FieldsToCopy.concat([f.Schema.OwnerId,f.Schema.OwnerTenantId])},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"SyncBlocker",{get:function(){return this.syncBlocker},enumerable:!0,configurable:!0}),f.prototype.createExportFile=function(){return c.FormDataSource.createExportFile(this)},f.prototype.downloadExcelFile=function(a,b){return c.FormDataSource.downloadExcelFile(this,a,b)},Object.defineProperty(f.prototype,"IsGroupForm",{get:function(){return this.isGroupForm},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"IsAssignmentForm",{get:function(){return this.isFieldReady(this.Schema.Category)?"assignments"===this.Model.Category:!1},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"SyncContext",{get:function(){return this.syncContext},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"FormElementManager",{get:function(){return this.formElementManager},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"SettingMaster",{get:function(){return Nerve.getObjectMasterFromModel(this.Model.Settings)},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"ThemeMaster",{get:function(){return Nerve.getObjectMasterFromModel(this.Model.Theme)},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"QRCodeImage",{get:function(){return this.qrCodeImage||void 0},set:function(a){this.qrCodeImage=a},enumerable:!0,configurable:!0}),f.prototype.getRelatedSourceFields=function(a){return f.getSourceFields(a)},f.prototype.existingOnServerSide=function(){return this.Synchronizer.existingInDataSource()},f.prototype.getImageMaster=function(a){return c.getImageInfoMaster(this.getModelByFieldSchema(a))},f.prototype.getImageSettingsMaster=function(a){return c.getImageSettingsMaster(this.getModelByFieldSchema(a))},f.prototype.getQuestionById=function(a){return this.formElementManager.getQuestionById(a)},f.prototype.getElementById=function(a){return this.formElementManager.getElementMasterById(a)},f.prototype.getDescriptiveElementMasterById=function(a){return this.formElementManager.getDescriptiveElementMasterById(a)},f.prototype.duplicateSection=function(a){return this.formElementManager.duplicateSectionAndSubElements(a)},f.prototype.deleteSectionAndSubElements=function(a){this.formElementManager.deleteSectionAndSubElements(a)},f.prototype.findQuestionsInSection=function(a,b){return this.formElementManager.findQuestionsInSection(a,b)},f.prototype.getQuestionSyncBlocker=function(b){return this.questionSyncJobs.push(a.Utilities.Promise.always(b)),this.currentQuestionListDownloadJob},f.prototype.getReleasedResponsesByResponder=function(a){var b=this;return a&&!this.SettingMaster.Model.IsAnonymous?c.ResponseDataSource.getReleasedResponsesByResponder(this,a).then(function(a){return b.normalizeResponses(a)}):$.Deferred().resolve().promise()},f.prototype.getRuntimeResponse=function(a){var b=this;return a?c.ResponseDataSource.getRuntimeResponse(this,a).then(function(a){return b.normalizeResponse(a)}):$.Deferred().resolve().promise()},f.prototype.duplicateForm=function(a,b){var c=this;return this.ensureFieldsReady(f.FieldsToCopy).then(function(){var d=_.clone(c.getSnapshotToCopy());return d.OwnerId=a.OwnerId,d.OwnerTenantId=a.OwnerTenantId,d.Title=b,d.Settings=_.clone(d.Settings),d.Settings.AllowCopy=!1,d.Settings.ShareToken=null,e(d,a.IsGroupForm)})},f.prototype.ensureCreationDone=function(){var a=this,b=this.getImageMaster(f.Schema.Background),c=this.getImageMaster(f.Schema.Logo);return $.when.apply($,[b.Synchronizer.flush(),c.Synchronizer.flush().then(function(){return a.Synchronizer.flush()})].concat(this.formElementManager.AllElementMasters.map(function(a){return a.ensureCreationDone()})))},f.prototype.ensureReadyToDesign=function(){return this.ensureFieldsReady(f.FieldsToDesign)},f.prototype.ensureReadyToResponse=function(){return this.ensureFieldsReady(f.FieldsToResponse)},f.prototype.ensureReadyToShare=function(){var a=f.Schema,b=[a.Title,a.ModifiedDate,a.OwnerId,a.OwnerTenantId,a.Description,a.Questions,a.DescriptiveElements,a.Settings,a.Theme,a.Logo,a.LogoInfo,a.Background,a.XlWorkbookId,a.Category,a.Type];return this.ensureFieldsReady(b)},f.prototype.ensureReadyForMruCard=function(){var a=f.Schema;return this.ensureFieldsReady([a.Title,a.ModifiedDate,a.Settings,a.XlWorkbookId,a.OwnerId,a.OwnerTenantId,a.Category,a.OtherInfo,a.Theme,a.RowCount])},f.prototype.getDefaultResponse=function(){var b={};return a.Utilities.Flight.isDarkFunctionalitiesEnabled()&&_.forEach(this.Model.Questions,function(a){return b[a.Id]=a.DefaultValue}),b},f.prototype.hasSection=function(){
return this.FormElementManager.SectionMasters.length>0},f.prototype.moveToRecycleBin=function(){var a=this;return this.bulkEdit(function(){a.Model.MovingToRecycleBin=!0,a.Model.SoftDeleted=c.FormDeletedState.SoftDeleted}),this.Synchronizer.flush().done(function(){a.Model.MovingToRecycleBin=!1})},f.prototype.isNotSoftDeleted=function(){return this.isFieldReady(this.Schema.SoftDeleted)?this.Model.SoftDeleted===c.FormDeletedState.Normal:!0},f.prototype.isSoftDeleted=function(){return this.isFieldReady(this.Schema.SoftDeleted)?this.Model.SoftDeleted===c.FormDeletedState.SoftDeleted:!1},f.prototype.reachedQuestionNumberLimitation=function(){return a.Flighting.Flight.isEnabled("Question200Limit")?this.formElementManager.QuestionMasters.filter(function(a){return a.Model.Type!=c.QuestionType.MatrixChoiceGroup}).length>=b.FormLimitation.QuestionNumber:this.FormElementManager.QuestionMasters.length>=b.FormLimitation.QuestionNumber},f.prototype.syncFormResponses=function(){var b=this;return this.responsesQueryJob&&this.responsesQueryJob.state()===a.Utilities.Promise.State.Pending?this.responsesQueryJob:(this.responsesQueryJob=this.Synchronizer.existingInDataSource().then(function(){var a=[f.Schema.Questions];a.push(f.Schema.Settings);var d=b.ensureFieldsReady(a);return $.when(c.ResponseDataSource.getResponses(b),d).then(function(a){b.updatingResponsesFromServer=!0,b.bulkEdit(function(){b.Model.Responses=b.normalizeResponses(a),b.Synchronizer.onSourceDataReceived({rowCount:a.length})}),b.updatingResponsesFromServer=!1})}),this.responsesQueryJob)},f.prototype.syncFormResponsesByPaging=function(a,b){var c=this;return this.getFormResponsesByPaging(a,b).then(function(a){c.updatingResponsesFromServer=!0,c.Model.BufferResponses=a,c.updatingResponsesFromServer=!1})},f.prototype.getFormResponsesByPaging=function(a,b){var d=this,e=[f.Schema.Questions];e.push(f.Schema.Settings);var g=this.ensureFieldsReady(e),h=this.Synchronizer.existingInDataSource().then(function(){return c.ResponseDataSource.getResponses(d,a,b)});return $.when(h,g).then(function(a){return d.normalizeResponses(a)})},f.prototype.syncAnalysisTimeResponsesByPaging=function(a,b){var c=this;return this.getAnalysisTimeResponsesByPaging(a,b).then(function(a){c.updatingResponsesFromServer=!0,c.Model.BufferResponses=a,c.updatingResponsesFromServer=!1})},f.prototype.getAnalysisTimeResponsesByPaging=function(a,c){var d=this;return b.Model.FormDataSource.getDataProviderByFormMaster(this).getAnalysisTimeResponses(this.Model.Id,a,c).then(function(a){return d.normalizeResponses(a.map(b.Model.ResponseDataSource.toClientPayload))})},f.prototype.syncRuntimeResponses=function(){var a=this;return this.Synchronizer.existingInDataSource().then(function(){return c.ResponseDataSource.getRuntimeResponses(a)}).then(function(b){a.updatingResponsesFromServer=!0,a.bulkEdit(function(){return a.Model.Responses=a.normalizeResponses(b)}),a.updatingResponsesFromServer=!1})},f.prototype.getFormResponsesCountByAPICall=function(){var a=this;return this.Synchronizer.existingInDataSource().then(function(){return c.FormDataSource.getResponseCount(a)}).then(function(b){a.Model.ResponsesCount=b})},f.prototype.refreshFormResponsesCount=function(){return this.Synchronizer.query([f.Schema.ResponsesCount])},f.prototype.submitResponse=function(b){var d=this;if("pending"===this.syncBlocker.state())return $.Deferred().resolve();var e=0,f=0,g=!1;return b=_.clone(b),b.Answers=_.map(b.Answers,function(a){var b=d.getQuestionById(a.QuestionId);return b&&b.Model&&(a=_.clone(a),a.Answer=b.serializeAnswer(a.Answer),b.Model.Type===c.QuestionType.TextField&&(e++,a.Answer&&(f+=a.Answer.length),!g&&b.Model.IsMathQuiz&&(g=!0))),a}),g&&this.logTextFieldSubmissionMathInfo(b),a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.ResponsePage.Form.TextQuestionInfoOfSubmit,extraData:{textQuestionCount:e,textQuestionAnswerTotalLength:f,isQuiz:this.SettingMaster.Model.IsQuizMode}}),this.Synchronizer.existingInDataSource().then(function(){return c.ResponseDataSource.submitResponse(d,b)})},f.prototype.deleteAllResponses=function(){var a=this;return this.Synchronizer.existingInDataSource().then(function(){return c.ResponseDataSource.deleteAllResponses(a)}).then(function(){var b={};b.Responses=[],b.ResponsesCount=0,a.updatingResponsesFromServer=!0,a.setData(b),a.updatingResponsesFromServer=!1})},f.prototype.deleteBufferResponse=function(a){var b=this;return this.Synchronizer.existingInDataSource().then(function(){return c.ResponseDataSource.deleteResponses(b.Model.Id,[a])}).then(function(){var c=Nerve.getCollectionMasterFromModel(b.Model.BufferResponses),d=c.getItemWithKeyFields({Id:a});d&&b.bulkEdit(function(){c.itemsDeletedInSource([d]),--b.Model.ResponsesCount})})},f.prototype.setResponseComment=function(a,b){var c=this.ensureResponseMasterById(a);c.Model.Feedback=b,this.postFormGradingChange(c.Model)},f.prototype.setAnswerGrading=function(a,b,c,d){var e=this.ensureResponseMasterById(a);e.setAnswerGrading(b,c,d),this.postFormGradingChange(e.Model)},f.prototype.setReleaseDate=function(a,b){var c=this.ensureResponseMasterById(a);c.Model.ReleaseDate=b,this.postFormGradingChange(c.Model)},f.prototype.resetBranchInfo=function(){this.FormElementManager.QuestionMasters.forEach(function(a){return a.resetBranchInfo()})},f.prototype.startReceivingNotifications=function(a){var b=this,c=f.Schema,d=[c.Id,c.OwnerId,c.OwnerTenantId,c.TableId];return this.ensureFieldsReady(d).done(function(){a&&b.coAuthUserStateChangeCallbacks.register(a),b.receivingNotifications||(b.receivingNotifications=!0,b.startReceivingNotificationsInternal())})},f.prototype.stopReceivingNotifications=function(b){var c=this;this.existingOnServerSide().done(function(){var d=a.DataProvider.ProviderManager.getInstance().CurrentNotificationProvider;d.close(c.Model.Id),c.receivingNotifications=!1,c.coAuthUserStateChangeCallbacks.clear(),c.responsesQueryJob=null,b()})},f.prototype.formOwnedByMe=function(){return this.Model.OwnerId&&this.Model.OwnerId===OfficeFormServerInfo.userInfo.UserId},f.prototype.appendPermission=function(a){for(var b=this.Model.Permissions,d=function(d){if(b[d].Type===c.PermissionType.OrgLink||b[d].Type===c.PermissionType.Link){var e=b[d],f=c.getPermissionMaster(e),g=f.Model.Type;return f.Model.Type=a,{value:f.Synchronizer.flush().then(function(){return e.PrincipalId}).fail(function(){return f.Model.Type=g})}}},e=0;e<b.length;e++){var f=d(e);if("object"==typeof f)return f.value}var g=Nerve.Collection.addItems(b,[c.createDefaultPermission(a)]),h=c.getPermissionMaster(g[0]);return h.Synchronizer.existingInDataSource().then(function(){return h.Model.PrincipalId})},f.prototype.removeLinkPermission=function(){var a=this.getLinkPermissions();Nerve.Collection.deleteItems(this.Model.Permissions,a);var b=a.map(c.getPermissionMaster).map(function(a){return a.Synchronizer.deletedFromDataSource()});return $.when.apply($,b)},f.prototype.getPermissionToken=function(){var a=this;return this.Synchronizer.existingInDataSource().then(function(){var b=a.getLinkPermissions().map(c.getPermissionMaster);return 0!==b.length?b[0].Synchronizer.existingInDataSource().then(function(){return b[0].Model.PrincipalId}):null})},f.prototype.getSnapshotToCopy=function(){var a=this.getSnapshot(f.FieldsToCopy),b=null;return a.XlWorkbookId&&(b=_.clone(a),b.XlWorkbookId="WaitingForExport"),this.Model.OwnerTenantId!==OfficeFormServerInfo.userInfo.TenantId&&a.DataClassificationLabel&&(b||(b=_.clone(a)),b.DataClassificationLabel=null),null===b?a:b},f.prototype.SetToExporting=function(){var a=this;this.ensureFieldsReady([c.FormMaster.Schema.XlExportingLocalTag]).done(function(){a.Model.XlExportingLocalTag=f.ExportingProcessingStatusString})},f.prototype.IsExporting=function(){var a,b=this,d=0;if(this.isFieldReady(c.FormMaster.Schema.XlExportingLocalTag)&&this.Model.XlExportingLocalTag&&this.Model.XlExportingLocalTag.indexOf(f.ExportingProcessingStatusString)>=0)try{var e=JSON.parse(this.Model.XlExportingLocalTag),g=Date.parse(e.starttime.toUpperCase()),h=new Date;d=h.getTime()-g,a=d<f.ReexportToExcelMaxTimeForTimeout}catch(i){a=!0}else a=!1;return a?this.exportingTimeout=this.exportingTimeout||window.setTimeout(function(){b.Model.XlExportingLocalTag=f.ExportingTimeoutStatusString},f.ReexportToExcelMaxTimeForTimeout-d):window.clearTimeout(this.exportingTimeout),a},f.prototype.IsExportingFailed=function(){return this.Model.XlExportingLocalTag.toLocaleLowerCase().indexOf(f.ExportingFailedStatusString)>=0?!0:!1},f.prototype.triggerShareAction=function(){if(a.Flighting.Flight.isEnabled("EnableMsaContentValidation")&&!this.cvsRequestSent&&OfficeFormServerInfo.userInfo.IsMsa&&0==(this.Model.Flags&k.CvsScanAllowed)){this.cvsRequestSent=!0;var b=a.DataProvider.ProviderManager.getInstance().createDataProvider();b.postFormShareAction(this.Model.Id)}},f.prototype.createLocale=function(a,b){if(Forms.getPageContext().Flighting.isEnabled("MultiLingualMVP1")){var d={localeId:a,localeName:b};Nerve.Collection.addItems(this.Model.LocaleList,[d]),Forms.Models.createEmptyLocalizedResource(d,c.exportConverter(this))}},f.prototype.deleteLocale=function(a){if(Forms.getPageContext().Flighting.isEnabled("MultiLingualMVP1")){var b=Nerve.Collection.getItemWithKeyFields(this.Model.LocaleList,{localeId:a});b&&(Nerve.Collection.deleteItems(this.Model.LocaleList,[b]),Forms.Models.removeLocalizedResource(a,c.exportConverter(this)))}},f.prototype.getAllLocaleResources=function(){if(!Forms.getPageContext().Flighting.isEnabled("MultiLingualMVP1"))return $.Deferred().resolve().promise();var a=c.FormDataSource.getDataProviderByFormId(this.Model.Id),b=a.getAllLocaleResources(this.Model.Id);return b.then(function(a){return Forms.Models.parseLocalizedResources(a)})},f.prototype.getLocaleResouceById=function(a){if(!Forms.getPageContext().Flighting.isEnabled("MultiLingualMVP1"))return $.Deferred().resolve().promise();var b=c.FormDataSource.getDataProviderByFormId(this.Model.Id),d=b.getLocaleResource(this.Model.Id,a);return d.then(function(a){return Forms.Models.parseLocalizedResources(a)})},Object.defineProperty(f,"FieldsToCopy",{get:function(){var a=f.Schema,b=[a.Background,a.Description,a.Logo,a.LogoInfo,a.Questions,a.DescriptiveElements,a.Settings,a.SoftDeleted,a.Title,a.PrimaryCustomizedThemeColor,a.SecondaryCustomizedThemeColor,a.TertiaryCustomizedThemeColor,a.Theme,a.TrackingId,a.XlWorkbookId,a.ThankYouMessage,a.EmailReceiptEnabled,a.DataClassificationLabel,a.Type,a.DefaultLanguage,a.LocaleList,a.LocalizedResources];return b},enumerable:!0,configurable:!0}),Object.defineProperty(f,"FieldsToDesign",{get:function(){var a=f.Schema,b=[a.Title,a.ModifiedDate,a.OwnerId,a.OwnerTenantId,a.Description,a.Questions,a.DescriptiveElements,a.Permissions,a.PermissionTokens,a.ResponsesCount,a.Settings,a.Theme,a.Logo,a.LogoInfo,a.Background,a.XlWorkbookId,a.XlExportingTag,a.XlFileUnsynced,a.Category,a.TrackingId,a.PredefinedResponses,a.ThankYouMessage,a.EmailReceiptEnabled,a.Flags,a.OnlineSafetyLevel,a.DataClassificationLabel,a.Type,a.DefaultLanguage,a.LocaleList,a.LocalizedResources];return b},enumerable:!0,configurable:!0}),Object.defineProperty(f,"FieldsToResponse",{get:function(){var a=f.Schema,b=[a.Title,a.ModifiedDate,a.Description,a.Settings,a.Theme,a.Questions,a.DescriptiveElements,a.Logo,a.LogoInfo,a.Background,a.Category,a.PredefinedResponses,a.ThankYouMessage,a.EmailReceiptEnabled,a.DataClassificationLabel,a.Type,a.DefaultLanguage,a.LocaleList];return b},enumerable:!0,configurable:!0}),Object.defineProperty(f,"OtherInfoFieldSet",{get:function(){return f.otherInfoFieldSet||(f.otherInfoFieldSet=new c.FieldSet([f.Schema.PrimaryCustomizedThemeColor,f.Schema.SecondaryCustomizedThemeColor,f.Schema.TertiaryCustomizedThemeColor,f.Schema.Theme,f.Schema.LogoInfo,f.Schema.CreatedFromOneDrive])),f.otherInfoFieldSet},enumerable:!0,configurable:!0}),Object.defineProperty(f,"Rules",{get:function(){if(!f.rules){var a=f.Schema,d=Nerve.getSubFieldSchemas(a).filter(function(a){return!Nerve.getFieldSchemaInfo(a).Attributes.IsLocalField});f.rules=[{Name:"IntegrateSavingState",InterestedFields:[a.Background.SavingState,a.Logo.SavingState,a.SavingState],onChange:function(a){return a.Master.updateIntegratedSavingState()}},{Name:"Modified",InterestedFields:_.without(d,a.SoftDeleted),onChange:function(b){if(!b.BeingDeleted&&!_.contains(b.FieldSchemas,a.Modified)){var c=b.Master;if(_.contains(b.FieldSchemas,a.ModifiedDate))return void(c.Model.Modified=c.Model.ModifiedDate);if(c.isFieldReady(a.Modified)){var e=_.intersection(b.FieldSchemas,d).map(Nerve.getFieldSchemaInfo).map(function(a){return a.Name}).some(function(a){return a in b.OldValues});e&&(c.Model.Modified=(new Date).toISOString())}}}},{Name:"RowCount",InterestedFields:[a.RowCount],onChange:function(a){if(!a.BeingDeleted){var b=a.Master.Model;b.ResponsesCount=b.RowCount}}},{Name:"CollaboratedQuestionProperties",InterestedFields:[a.Questions,a.DescriptiveElements],onChange:function(a){var c=b.convertToArray(a.Master.getSnapshot().Questions),d=b.convertToArray(a.Master.getSnapshot().DescriptiveElements),e=a.Master.Model;e.HasValidBranching=c.some(function(a){return a.HasValidBranching}),e.HasQuestionMedia=c.some(function(a){return!(!a.ImageInfo.ResourceUrl&&!a.VideoInfo.Url)})||d.some(function(a){return!(!a.ImageInfo.ResourceUrl&&!a.VideoInfo.Url)}),e.QuizQuestionsCount=c.filter(function(a){return a.IsQuiz}).length}},{Name:"DeserializeSettings",InterestedFields:[a.SerializedSettings],onChange:function(a){if(!a.BeingDeleted){var b=a.Master.Model.SerializedSettings||"{}",c=JSON.parse(b);a.Master.setData({Settings:c})}}},{Name:"SerializeSettings",InterestedFields:[f.Schema.Settings],onChange:function(a){if(!a.BeingDeleted){var b=a.Master.Model;b.SerializedSettings=c.FormSettingsMaster.serialize(b.Settings)}}},{Name:"DeserializePredefinedResponses",InterestedFields:[a.SerializedPredefinedResponses],onChange:function(a){if(!a.BeingDeleted){var b=a.Master.Model.SerializedPredefinedResponses||"[]",c=JSON.parse(b);a.Master.setData({PredefinedResponses:c})}}},{Name:"SerializePredefinedResponses",InterestedFields:[f.Schema.PredefinedResponses],onChange:function(a){if(!a.BeingDeleted){var b=a.Master.Model;b.SerializedPredefinedResponses=f.serializePredefinedReponses(b.PredefinedResponses)}}},{Name:"DeleteResponseModels",InterestedFields:[a.Responses],onChange:function(a){var b=a.Master,d=b.Model.Responses,e=[],f=[];a.SubChanges.filter(function(a){return a.Master.Model===d}).forEach(function(a){return a.RemovedModels.forEach(function(a){var c=b.getResponseModelById(a.Id);c?e.push(c):f.push(a.Id)})});var g=Nerve.getCollectionMasterFromModel(b.Model.ResponseModels);b.updatingResponsesFromServer?g.itemsDeletedInSource(e):(g.deleteItems(e),c.deleteResponses(b,f))}},{Name:"ResponsesCount",InterestedFields:[a.ResponsesCount],onChange:function(b){var c=b.Master;c.isFieldReady(a.ResponsesCount)&&-1===c.Model.ResponsesCount&&(c.Model.ResponsesCount=null)}},{Name:"ResponseModel Change",InterestedFields:[a.ResponseModels],onChange:function(a){var b=a.Master,c=Nerve.getCollectionMasterFromModel(b.Model.ResponseModels),d=Nerve.getCollectionMasterFromModel(b.Model.Responses);a.SubChanges.filter(function(a){return a.Master===c}).forEach(function(a){a.SubChanges.forEach(function(a){var b=_.indexOf(d.Model,a.Master.Model);b>=0&&d.markAsChanged(b)})})}}]}return f.rules},enumerable:!0,configurable:!0}),f.normalizeInitialData=function(a){var b;return a.InitialData&&((a.InitialData.SerializedSettings||a.InitialData.Settings)&&(b=b||{},a.InitialData.SerializedSettings?b.Settings=JSON.parse(a.InitialData.SerializedSettings):b.SerializedSettings=c.FormSettingsMaster.serialize(a.InitialData.Settings)),(a.InitialData.SerializedPredefinedResponses||a.InitialData.PredefinedResponses)&&(b=b||{},a.InitialData.SerializedPredefinedResponses?b.PredefinedResponses=JSON.parse(a.InitialData.SerializedPredefinedResponses):b.SerializedPredefinedResponses=f.serializePredefinedReponses(a.InitialData.PredefinedResponses))),b&&(a=_.clone(a),a.InitialData=_.extend({},a.InitialData,b)),a},f.serializePredefinedReponses=function(a){return a&&a.length>0?JSON.stringify(a):null},f.prototype.initializeElementOrderRule=function(){var a=this;this.formElementManager.adjustElementOrders();var b=[f.Schema.Questions,f.Schema.DescriptiveElements];this.addRule({Name:"ElementOrder",InterestedFields:b,onChange:function(){return a.formElementManager.adjustElementOrders()}})},f.prototype.initializeSavingStateIntegration=function(){var a=this;c.keepSavingStateUpdated(this),this.questionsSavingState=c.SavingStateValues.Idle,this.responsesSavingState=c.SavingStateValues.Idle,this.descriptiveElementSavingState=c.SavingStateValues.Idle,this.fieldsReady([f.Schema.Questions]).done(function(){var b=Nerve.getCollectionMasterFromModel(a.Model.Questions);c.observeIntegratedSavingState(b,b.Schema[0].IntegratedSavingState,function(b){a.questionsSavingState=b,a.updateIntegratedSavingState()})}),this.fieldsReady([f.Schema.DescriptiveElements]).done(function(){var b=Nerve.getCollectionMasterFromModel(a.Model.DescriptiveElements);c.observeIntegratedSavingState(b,b.Schema[0].IntegratedSavingState,function(b){a.descriptiveElementSavingState=b,a.updateIntegratedSavingState()})});var b=Nerve.getCollectionMasterFromModel(this.Model.ResponseModels);c.observeIntegratedSavingState(b,b.Schema[0].IntegratedSavingState,function(b){a.responsesSavingState=b,a.updateIntegratedSavingState()}),this.updateIntegratedSavingState()},f.prototype.initializeModifiedDate=function(a){a.ExistingInDataSource?this.isFieldReady(f.Schema.ModifiedDate)&&(this.Model.Modified=this.Model.ModifiedDate):this.Model.Modified=(new Date).toISOString()},f.prototype.initializeResponseCount=function(){this.isFieldReady(f.Schema.RowCount)&&(this.Model.ResponsesCount=this.Model.RowCount)},f.prototype.updateIntegratedSavingState=function(){var a=this;if("pending"===this.syncBlocker.state())return this.Model.IntegratedSavingState=c.SavingStateValues.NotStarted,void this.syncBlocker.done(function(){return a.updateIntegratedSavingState()});var b=[this.Model.SavingState,this.questionsSavingState,this.responsesSavingState],d=f.Schema;this.isFieldReady(d.DescriptiveElements)&&b.push(this.descriptiveElementSavingState),this.isFieldReady(d.Logo)&&b.push(this.Model.Logo.SavingState),this.isFieldReady(d.Background)&&b.push(this.Model.Background.SavingState),this.Model.IntegratedSavingState=c.integrateSavingState(b)},f.prototype.initializeOtherInfoBinder=function(a){this.otherInfoBinder=new c.FieldBinder(this,f.Schema.OtherInfo,f.OtherInfoFieldSet),a.InitialData&&this.isFieldReady(f.Schema.OtherInfo)&&(a.ExistingInDataSource||a.InitialData.OtherInfo?this.otherInfoBinder.deserialize():this.otherInfoBinder.serialize())},f.prototype.updateCoAuthors=function(b,c){if(a.UserRepository.isValidUser(c)){var d=this.getElementById(b);d&&d.updateCoAuthors(c)}},f.prototype.startReceivingNotificationsInternal=function(){var b,d=this,e=function(a,b){return d.coAuthUserStateChangeCallbacks.trigger(a,b)},g=a.DataProvider.ProviderManager.getInstance().CurrentNotificationProvider,h=this.Model,i=$.Deferred().resolve().promise(),j=0,k=function(a){i.done(function(){a===j&&(i=d.refreshFormResponsesCount())})},l=function(){d.Synchronizer.query(f.FieldsToDesign)};b=a.EnvironmentConfig.isProduction()?function(a){}:function(a){h.CoAuthMessage=a};var m={onConnectionStarted:function(a){k(++j),e(a||[],p.ConnectionStateChanged),b("Connection established")},onConnectionFailed:function(a){b("Connection failed to be established")},onConnectionSlow:function(){b("Connection is slow")},onConnectionError:function(a){b("Connection has error")},onConnectionReconnecting:function(){b("Connection reestablishing")},onConnectionReconnected:function(a){k(++j),e(a||[],p.ConnectionStateChanged),l(),b("Connection reestablished")},onConnectionDisconnected:function(){b("Connection disconnected")},onFormElementAdded:function(f,g){var h=d.getElementById(f.id);if(h instanceof c.QuestionMaster){var i=f;i.choices||(i.choices=[]),h.Synchronizer.onSourceDataReceived(f)}else h instanceof Forms.Models.DescriptiveElementMaster?h.Synchronizer.onSourceDataReceived(f):d.currentQuestionListDownloadJob=a.Utilities.Promise.always(d.currentQuestionListDownloadJob.then(function(){Forms.Models.FormElementManager.isDescriptiveElement(f.type)?Nerve.Collection.itemsAddedInSource(d.Model.DescriptiveElements,[Nerve.convertFromSourceData(f,Forms.Models.DescriptiveElementMaster.Schema)]):Nerve.Collection.itemsAddedInSource(d.Model.Questions,[Nerve.convertFromSourceData(f,c.QuestionMaster.Schema)])}));d.updateCoAuthors(f.id,g),e([g],p.UserAction),b("Question added")},onFormElementDeleted:function(f,g){d.currentQuestionListDownloadJob=a.Utilities.Promise.always(d.currentQuestionListDownloadJob.then(function(){var a=d.getElementById(f);if(a instanceof c.QuestionMaster){var b=a.SubQuestionMasters.concat(a);Nerve.Collection.itemsDeletedInSource(d.Model.Questions,b.map(function(a){return a.Model}))}else a instanceof Forms.Models.DescriptiveElementMaster&&Nerve.Collection.itemsDeletedInSource(d.Model.DescriptiveElements,[a.Model])})),e([g],p.UserAction),b("Question deleted")},onFormElementUpdated:function(a,f,g){var h=d.getElementById(a);h&&(h instanceof c.QuestionMaster?h.Synchronizer.onSourceDataReceived(f):h instanceof Forms.Models.DescriptiveElementMaster&&h.Synchronizer.onSourceDataReceived(f),d.updateCoAuthors(a,g),e([g],p.UserAction),b("Question updated"))},onChoiceAdded:function(a,f,g){var h=d.getQuestionById(a);if(h){var i;if(f.key){var j=h.getChoiceByKey(f.key);if(!j){var k=Nerve.convertFromSourceData(f,c.ChoiceV2Master.Schema);Nerve.Collection.itemsAddedInSource(h.Model.ChoiceGroup,[k])}i=$.Deferred().resolve().promise()}else{var l=_.map(h.Model.ChoiceGroup,function(a){var b=Nerve.getObjectMasterFromModel(a);return b.Synchronizer.existingInDataSource()});i=$.when.apply($,l).then(function(){if(-1===Nerve.Collection.getIndexWithKeyFields(h.Model.ChoiceGroup,{Id:f.id})){var a=Nerve.convertFromSourceData(f,c.ChoiceV2Master.Schema);Nerve.Collection.itemsAddedInSource(h.Model.ChoiceGroup,[a])}})}i.done(function(){d.updateCoAuthors(a,g),e([g],p.UserAction),b("Choice added")})}},onChoiceDeleted:function(a,c,f){var g=d.getQuestionById(a);if(g){var h=g.getChoiceById(c);h&&(h.Synchronizer.onDeletedInDataSource(),e([f],p.UserAction),b("Question deleted"))}},onChoiceUpdated:function(a,c,f,g){var h=d.getQuestionById(a);if(h){var i=h.getChoiceById(c);i&&(i.Synchronizer.onSourceDataReceived(f),d.updateCoAuthors(a,g),e([g],p.UserAction),b("Choice updated"))}},onUserConnected:function(a){e([a],p.UserConnect),b("New user connected")},onUserDisconnected:function(a){e([a],p.UserDisconnect),b("Existing user disconnected")},onFormUpdated:function(a,c){var f=_.map(d.Model.PermissionTokens,function(a){var b=Nerve.getObjectMasterFromModel(a);return b.Synchronizer.existingInDataSource()});$.when.apply($,f).then(function(){d.Synchronizer.onSourceDataReceived(a),e([c],p.UserAction),b("Form updated")})},onResponseAdded:function(a){d.bulkEdit(function(){k(++j),b("Response added")})},onResponseDeleted:function(a){d.bulkEdit(function(){k(++j),b("Response deleted")})},onResponsesAllDeleted:function(){d.bulkEdit(function(){k(++j),b("All responses deleted")})},onLocaleResourceAdded:function(a,f){d.bulkEdit(function(){_.forEach(a,function(a){if("localename"===a.elementKey){var b={localeId:a.locale,localeName:a.elementValue},e=Nerve.Collection.getIndexWithKeyFields(d.Model.LocaleList,{localeId:b.localeId});-1===e&&(Nerve.Collection.itemsAddedInSource(d.Model.LocaleList,[b]),Forms.Models.createEmptyLocalizedResource(b,c.exportConverter(d)))}else d.handleNewLocaleResourceExceptLocaleName(a)}),f&&e([f],p.UserAction),b("Locale resource added")})},onLocaleResourceUpdated:function(a,c){var f=Nerve.Collection.getItemWithKeyFields(d.Model.LocaleList,{localeId:a.locale});if(f){if("localename"===a.elementKey){var g={localeName:a.elementValue},h=Nerve.getObjectMasterFromModel(f);h.Synchronizer.onSourceDataReceived(g);var i=Nerve.Collection.getItemWithKeyFields(d.Model.LocalizedResources,{localeId:a.locale});if(i){var j=Nerve.getObjectMasterFromModel(i);j.Synchronizer.onSourceDataReceived(g)}}else d.handleNewLocaleResourceExceptLocaleName(a);c&&e([c],p.UserAction),b("Locale resource updated")}},onLocaleResourceDeleted:function(a,c){if(a.hasOwnProperty("locale")){var f=a.locale,g=Nerve.Collection.getItemWithKeyFields(d.Model.LocaleList,{localeId:f});g&&Nerve.Collection.itemsDeletedInSource(d.Model.LocaleList,[g])}else if(a.hasOwnProperty("propertyName")){var h=a.propertyName;_.forEach(d.Model.LocalizedResources,function(a){var b=Nerve.Collection.getItemWithKeyFields(a.questionResources,{questionId:h});if(b){var c=Nerve.getObjectMasterFromModel(b);c.Synchronizer.onDeletedInDataSource()}})}else Nerve.Debugger.throwError("Not supposed to happen.");c&&e([c],p.UserAction),b("Locale resource deleted")}},n=a.Utilities.FormId.decodeFormId(h.Id),o={OwnerTenantId:h.OwnerTenantId,OwnerId:h.OwnerId,TableId:h.TableId,IsGroupTable:n.IsGroupOwner};g.open(h.Id,m,o).done(function(){return l()})},f.prototype.handleNewLocaleResourceExceptLocaleName=function(a){if(a.elementKey.startsWith("choiceid_")){var b=_.find(this.Model.LocalizedResources,function(b){return b.localeId==a.locale});if(b){var c=_.find(b.questionResources,function(b){return b.questionId==a.propertyName});if(c){var d=Nerve.getObjectMasterFromModel(c),e=a.elementKey.substring("choiceid_".length),f=d.getChoiceLocalizedMaster(e),g={choiceId:e,description:a.elementValue,key:f.Model.key};f.Synchronizer.onSourceDataReceived(g)}}}else switch(a.elementKey){case"title":case"subtitle":"_id"===a.propertyName?this.updateFormLevelLocaleResource(a.locale,a.elementKey,a.elementValue):this.updateQuationLevelLocaleResource(a.locale,a.propertyName,a.elementKey,a.elementValue);break;case"thankYouMessage":case"formCloseMessage":"_id"===a.propertyName?this.updateFormLevelLocaleResource(a.locale,a.elementKey,a.elementValue):Nerve.Debugger.throwError("Not supposed to happen. Should be form level property.");break;case"leftDescription":case"rightDescription":"_id"===a.propertyName?Nerve.Debugger.throwError("Not supposed to happen. Should be question level property."):this.updateQuationLevelLocaleResource(a.locale,a.propertyName,a.elementKey,a.elementValue);break;case"option":"_id"===a.propertyName?Nerve.Debugger.throwError("Not supposed to happen. Should be question level property."):this.updateQuationLevelLocaleResource(a.locale,a.propertyName,a.elementKey,a.elementValue);break;default:Nerve.Debugger.throwError("Not supposed to happen. Unknown element key")}},f.prototype.updateFormLevelLocaleResource=function(a,b,c){var d=_.find(this.Model.LocalizedResources,function(b){return b.localeId==a});if(d){var e=Nerve.getObjectMasterFromModel(d),f={localeId:a};f[b]=c,e.Synchronizer.onSourceDataReceived(f)}},f.prototype.updateQuationLevelLocaleResource=function(a,b,c,d){var e=_.find(this.Model.LocalizedResources,function(b){return b.localeId==a});if(e){var f=_.find(e.questionResources,function(a){return a.questionId==b});if(f){var g=Nerve.getObjectMasterFromModel(f),h={localeId:a};h[c]=d,g.Synchronizer.onSourceDataReceived(h)}}},f.prototype.ensureResponseMasterById=function(a){var b=this,d=this.getResponseModelById(a);if(!d){var e=this.Model.Responses,f=_.findIndex(e,function(b){return b.Id===a});0>f&&Nerve.Debugger.throwError("no such response"),this.bulkEdit(function(){d=Nerve.Collection.itemsAddedInSource(b.Model.ResponseModels,[e[f]])[0],e[f]=d})}return c.getResponseMaster(d)},f.prototype.getLinkPermissions=function(){return _.filter(this.Model.Permissions,function(a){return a.Type===c.PermissionType.Link||a.Type===c.PermissionType.OrgLink})},f.prototype.getResponseModelById=function(a){return Nerve.Collection.getItemWithKeyFields(this.Model.ResponseModels,{Id:a})},f.prototype.normalizeResponses=function(a){var b=this;return this.bulkEdit(function(){a=a.map(function(a){return b.normalizeResponse(a)})}),a},f.prototype.normalizeResponse=function(a){var b=this.Model.Settings.IsQuizMode&&this.SyncContext!==o.ResponseTimeForm,d={};this.FormElementManager.QuestionMasters.forEach(function(a){return d[a.Model.Id]=a}),a=_.clone(a),a.Answers=_.map(a.Answers,function(a){var c=d[a.QuestionId];return c&&(a=_.clone(a),a.Answer=c.deserializeAnswer(a.Answer),a.IsMathAnswer=!c.Model.IsAnswerPlainText,null==a.Score&&b&&c.autoGradeAnswer(a)),a});var e=this.getResponseModelById(a.Id);return e&&(c.getResponseMaster(e).updateWithNormalizedResponse(a),a=e),a},f.prototype.postFormGradingChange=function(b){if(a.EnvironmentSettings.IsAssignmentsIntegration&&a.EnvironmentSettings.IsAssignmentsPage&&this.IsAssignmentForm&&Forms.getPageContext().Flighting.isEnabled("AssignmentsIFrameLimitParentHeaders")){var c=_.reduce(b.Answers,function(a,b){return a+(b.Score||0)},0);window.parent.postMessage({eventName:"FormGradingChangePerformed",responseId:b.Id,responder:b.Responder,responseScore:c,feedback:b.Feedback,isReturned:"0001-01-01T00:00:00Z"!==b.ReleaseDateAsString},"*")}},f.prototype.logTextFieldSubmissionMathInfo=function(b){var d=this,e={QuestionCount:0,GradableQuestionCount:0,MathResponses:0,MathGradableResponses:0,TextResponses:0,TextGradableResponses:0,EmptyResponses:0,TotalLength:0};_.forEach(b.Answers,function(b){var f=d.getQuestionById(b.QuestionId);if(f&&f.Model&&f.Model.Type===c.QuestionType.TextField&&f.Model.IsMathQuiz){f.hasCorrectAnswers()?e.GradableQuestionCount++:e.QuestionCount++;var g=a.Utilities.tryParseJson(b.Answer);null==g||""==g.Answer?e.EmptyResponses++:(e.TotalLength+=g.Answer.length,f.hasCorrectAnswers()?g.IsMath?e.MathGradableResponses++:e.TextGradableResponses++:g.IsMath?e.MathResponses++:e.TextResponses++)}}),a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.ResponsePage.Form.TextFieldSubmissionMathInfo,extraData:e})},f}(Nerve.createObjectMasterClass("FormMaster",n,r));c.FormMaster=s}(c=b.Model||(b.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(b){var c=Nerve.Spec,d={QuestionRuntimeMasters:c.collectionOf(c.reference()),RuntimeSectionId:c.string(),UploadingFileCount:c.number()},e=function(c){function d(d,e){var f=c.call(this)||this;return f.questionRuntimeMasters={},f.answerChangeNotifier=new a.Utilities.Process.CallbackManager,f.questionAnswerChangeCallback=function(){return f.answerChangeNotifier.trigger()},f.onQuestionListChangeCallback=function(a){return f.updateQuestionList(a)},f.updateQuestionListCallback=function(){return f.updateQuestionList()},f.branchingChangeCallback=function(){return f.calculation.callOnceLater()},f.calculation=new a.Utilities.Process.CallLater(function(){return f.calculateQuestionRuntimeList()}),f.formMaster=d,e=e||{},f.disableShuffle=e.disableShuffle,f.disableBranching=e.disableBranching,f.updateQuestionList(),f.calculation.callImmediately(),f.Model.UploadingFileCount=0,Nerve.getCollectionMasterFromModel(d.Model.Questions).observe(f.onQuestionListChangeCallback),d.observe(f.updateQuestionListCallback,[b.FormMaster.Schema.HasValidBranching,b.FormMaster.Schema.Settings.ShuffleQuestionOrder]),f}return __extends(d,c),Object.defineProperty(d.prototype,"Form",{get:function(){return this.formMaster},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"IsDisableBranching",{get:function(){return this.disableBranching||this.formMaster.hasSection()},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"Answers",{get:function(){return Nerve.convertToArray(this.Model.QuestionRuntimeMasters).filter(function(a){return a.Question.hasAnswer()}).map(function(a){return a.getAnswerEntity()})},set:function(a){var b=this,c={};_.forEach(a,function(a){return c[a.QuestionId]=a.Answer}),this.bulkEdit(function(){b.formMaster.FormElementManager.QuestionMasters.map(function(a){return b.getOrCreateQuestionRuntime(a)}).forEach(function(a){a.Model.Answer=c[a.Question.Model.Id];
})}),this.calculation.flush()},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"SectionTopQuestionRuntimeMasters",{get:function(){return this.getRuntimeQuestionsWithSectionId(this.Model.RuntimeSectionId)},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"TopQuestionRuntimeMasters",{get:function(){return Nerve.convertToArray(this.Model.QuestionRuntimeMasters).filter(function(a){return!a.Question.Model.GroupId})},enumerable:!0,configurable:!0}),d.prototype.isDefaultAnswer=function(){var a=this.formMaster.getDefaultResponse();return Nerve.convertToArray(this.Model.QuestionRuntimeMasters).every(function(b){var c=b.Question.Model.Id;return a[c]===b.Model.Answer})},d.prototype.updateWithResponse=function(a){var b=this,c={};a&&a.Answers&&_.forEach(a.Answers,function(a){return c[a.QuestionId]=a}),this.bulkEdit(function(){b.formMaster.FormElementManager.QuestionMasters.map(function(a){return b.getOrCreateQuestionRuntime(a)}).forEach(function(a){var b=a.Question.Model.Id,d=c[b];a.bulkEdit(function(){a.Model.Answer=d&&d.Answer,a.Model.AnswerEntity=d})})}),this.updateQuestionList()},d.prototype.setQuizResults=function(a){var b=this;a.forEach(function(a){var c=b.questionRuntimeMasters[a.id];c&&(c.Model.QuizResult={IsAnswerCorrect:a.isAnswerCorrect,AnswerHints:a.answerHints,IsAnswerKeys:a.answerKeys,Choices:_.map(c.Question.Model.Choices,function(a){return a.Description}),GradingBasis:a.gradingBasis})})},d.prototype.clearQuizResult=function(){for(var a in this.questionRuntimeMasters)this.questionRuntimeMasters[a].Model.QuizResult=void 0},d.prototype.calculateQuizResultFromModel=function(){Nerve.convertToArray(this.Model.QuestionRuntimeMasters).forEach(function(a){return a.calculateQuizResultFromModel()})},d.prototype.getQuestionsWithWrongAnswer=function(a){if(a.length<=0)return[];var b=_.findIndex(this.TopQuestionRuntimeMasters,function(b){return b.Question.Model.Id===a[0].Question.Model.Id})+1;return a.map(function(a,c){return a.verifyAnswer()?-1:c+b}).filter(function(a){return a>0})},d.prototype.getOrCreateQuestionRuntimeById=function(a){var b=this.formMaster.getQuestionById(a);return b&&this.getOrCreateQuestionRuntime(b)},d.prototype.observeAnswerChange=function(a){this.answerChangeNotifier.register(a)},d.prototype.unobserveAnswerChange=function(a){this.answerChangeNotifier.unregister(a)},d.prototype.release=function(){for(var a in this.questionRuntimeMasters){var b=this.questionRuntimeMasters[a];b.unobserve(this.branchingChangeCallback),b.unobserve(this.questionAnswerChangeCallback),b.release()}Nerve.getCollectionMasterFromModel(this.formMaster.Model.Questions).unobserve(this.onQuestionListChangeCallback),this.formMaster.unobserve(this.updateQuestionListCallback),this.clearOD4BTempFolder()},d.prototype.createOD4BTempFolder=function(){return this.od4bTempFolder||(this.od4bTempFolder=a.DataProvider.createDataProvider().createOD4BSessionTempFolder(this.formMaster.Model.Id)),this.od4bTempFolder},d.prototype.clearOD4BTempFolder=function(){this.od4bTempFolder=null},d.prototype.getOrCreateQuestionRuntime=function(a){var b=a.Model.Id;this.questionRuntimeMasters[b];return this.questionRuntimeMasters[b]||(this.questionRuntimeMasters[b]=this.createQuestionRuntimeMaster(a)),this.questionRuntimeMasters[b]},d.prototype.createQuestionRuntimeMaster=function(a){var c=new b.QuestionRuntimeMaster(a,this);return c.observe(this.branchingChangeCallback,[b.QuestionRuntimeMaster.Schema.BranchedQuestion]),c.observe(this.questionAnswerChangeCallback,[b.QuestionRuntimeMaster.Schema.Answer]),c},d.prototype.updateQuestionList=function(b){var c,d=this,e=this.formMaster.Model.Settings;if(this.questionMasters=this.formMaster.FormElementManager.TopQuestionMasters,!this.Form.hasSection()&&!this.disableShuffle&&!this.formMaster.Model.HasValidBranching&&e.ShuffleQuestionOrder)if(e.ShuffleAllQuestions||null==e.ShuffleAllQuestions)this.questionMasters=_.shuffle(this.questionMasters);else if(a.Utilities.NumberValidation.isInteger(e.LockGivenQuestionsStartDisplayOrder)&&a.Utilities.NumberValidation.isInteger(e.LockGivenQuestionsEndDisplayOrder)){var f=e.LockGivenQuestionsStartDisplayOrder-1,g=e.LockGivenQuestionsEndDisplayOrder-1,h=this.questionMasters.splice(f,g-f+1);this.questionMasters=_.shuffle(this.questionMasters),(c=this.questionMasters).splice.apply(c,[f,0].concat(h))}this.questionMasters.forEach(function(a,b){var c=d.getOrCreateQuestionRuntime(a).Model;c.NextQuestionInOrder=d.questionMasters[b+1],a.SubQuestionMasters.forEach(function(a){return d.getOrCreateQuestionRuntime(a)})}),b&&(b.AddedModels.length||b.RemovedModels.length)&&this.calculation.callOnceLater()},d.prototype.calculateQuestionRuntimeList=function(){for(var a,b=this,c=[],d=this.questionMasters[0];d&&(a=this.getOrCreateQuestionRuntime(d),!_.include(c,a));)c.push(a),d.SubQuestionMasters.forEach(function(a){var d=b.getOrCreateQuestionRuntime(a);c.push(d)}),d=this.IsDisableBranching?a.Model.NextQuestionInOrder:a.Model.BranchedQuestion;this.Model.QuestionRuntimeMasters=c},d.prototype.getRuntimeQuestionsWithSectionId=function(a){var b,c=Nerve.convertToArray(this.Model.QuestionRuntimeMasters).filter(function(a){return!a.Question.Model.GroupId});if(a){var d=this.Form.getDescriptiveElementMasterById(a);b=c.filter(function(a){return a.Question.Model.Order>d.Model.Order});var e=_.find(this.Form.FormElementManager.SectionMasters,function(a){return a.Model.Order>d.Model.Order});e&&(b=_.filter(b,function(a){return e.Model.Order>a.Question.Model.Order}))}else{var f=this.Form.FormElementManager.SectionMasters,g=f.length&&f[0].Model.Order;b=c,g>0&&(b=_.filter(b,function(a){return a.Question.Model.Order<g}))}return b},d}(Nerve.createObjectMasterClass("FormRuntime",d));b.FormRuntimeMaster=e}(c=b.Model||(b.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(b){var c,d=Nerve.Spec,e={LockGivenQuestionsEndDisplayOrder:d.number(),LockGivenQuestionsStartDisplayOrder:d.number(),FormClosed:d["boolean"](),FormClosedMessage:d.string(),FormClosedMessageChanged:d["boolean"](),TimerEnabled:d["boolean"](),TimerEnabledStart:d["boolean"](),TimerEnabledEnd:d["boolean"](),StartTime:d.string(),EndTime:d.string(),RequiresUniqueResponse:d["boolean"](),IsAnonymous:d["boolean"](),NotRecordIdentity:d["boolean"](),ShuffleAllQuestions:d["boolean"](),ShuffleQuestionOrder:d["boolean"](),ShowGradedResults:d["boolean"](),ShowGradedScores:d["boolean"](),RespondInAppOnly:d["boolean"](),AllowCopy:d["boolean"](),ShareToken:d.string(),ManualGradingEnabled:d["boolean"](),IsQuizMode:d["boolean"](),EmailNotification:d["boolean"](),AllowResponderGetAllResponses:d["boolean"]()};!function(a){a[a.NotStarted=0]="NotStarted",a[a.Opened=1]="Opened",a[a.Expired=2]="Expired",a[a.Closed=3]="Closed"}(c=b.FormStatusType||(b.FormStatusType={}));var f=function(d){function e(a){var b=d.call(this,a)||this;return b.addRule({Name:"updateClosedMessage",InterestedFields:[b.Schema.FormClosed],onChange:e.updateClosedMessage}),b.addRule({Name:"updateAllowCopy",InterestedFields:[b.Schema.ShareToken],onChange:e.updateAllowCopy}),b}return __extends(e,d),e.serialize=function(a){var b=Nerve.convertToSourceData(a,this.Schema),c=0;return Object.keys(b).forEach(function(a){null==b[a]?delete b[a]:++c}),c>0?JSON.stringify(b):null},e.prototype.isAcceptingResponse=function(){return null==this.getFormClosedMessage()},e.prototype.getFormStatus=function(){var a=this.Model;if(a.FormClosed)return c.Closed;if(a.TimerEnabled){var b=Date.now();if(null!=a.StartTime&&Date.parse(a.StartTime)>b)return c.NotStarted;if(null!=a.EndTime&&Date.parse(a.EndTime)<b)return c.Expired}return c.Opened},e.prototype.getFormClosedMessage=function(){var b=this.Model,d=this.getFormStatus();switch(d){case c.Closed:return b.FormClosedMessage;case c.NotStarted:return a.Resources.LocalizedStrings.FormSetting_NotStartForm_DefaultMessage.format(new Date(b.StartTime).toLocaleString());case c.Expired:return a.Resources.LocalizedStrings.FormSetting_ExpiredForm_DefaultMessage;default:return void 0}},e.prototype.setSharingStatus=function(a,c){var d=this,e=this.Parent,f=b.FormDataSource.getDataProviderByFormMaster(e);return e.existingOnServerSide().then(function(){return f.changeSharingStatus(e.Model.Id,c)}).then(function(a){d.Model.ShareToken=a})},e.updateClosedMessage=function(b){if(-1===b.FieldSchemas.indexOf(e.Schema.FormClosedMessage)){var c=b.Master.Model;c.FormClosed?null!=c.FormClosedMessage&&a.Resources.loadLocalizedStrings().done(function(a){return c.FormClosedMessage=a.FormSetting_ClosedForm_DefaultMessage}):c.FormClosedMessage=null}},e.updateAllowCopy=function(a){var b=a.Master.Model;b.AllowCopy=!!b.ShareToken},e.prototype.serialize=function(){return e.serialize(this.Model)},e.prototype.deserialize=function(a){this.setData(a?JSON.parse(a):{},Nerve.getSubFieldSchemas(this.Schema))},e}(Nerve.createObjectMasterClass("FormSettingsMaster",e));b.FormSettingsMaster=f}(b=a.Model||(a.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(c){function d(a){if(!a)return!1;if(a.ResourceUrl)return!0;var b=a.UploadParameters;return!!b&&!!b.ImageFile}function e(a){return Nerve.getObjectMasterFromModel(a)}var f,g=Nerve.Spec,h={AltText:g.string({SourceFieldName:"altText"}),ContentType:g.string({SourceFieldName:"contentType"}),FileIdentifier:g.string({SourceFieldName:"fileIdentifier"}),OriginalFileName:g.string({SourceFieldName:"originalFileName"}),ResourceId:g.string({SourceFieldName:"resourceId"}),ResourceUrl:g.string({SourceFieldName:"resourceUrl"}),Width:g.number({SourceFieldName:"width"}),Height:g.number({SourceFieldName:"height"}),UploadParameters:g.reference({SourceFieldName:"uploadParameters"}),ErrorType:g.enumeration(function(){return i},{IsLocalField:!0}),ResponseError:g.reference({IsLocalField:!0}),ImageProcessingStatus:g.enumeration(function(){return f},{IsLocalField:!0}),IsPredefined:g["boolean"]({IsLocalField:!0}),SavingState:g.reference({IsLocalField:!0})};!function(a){a[a.Idle=0]="Idle",a[a.Picking=1]="Picking",a[a.Uploading=2]="Uploading",a[a.Deleting=3]="Deleting"}(f=c.ImageProcessingStatus||(c.ImageProcessingStatus={}));var i;!function(a){a[a.NoError=0]="NoError",a[a.SizeTooLarge=1]="SizeTooLarge",a[a.InvalidType=2]="InvalidType",a[a.BrokenImage=3]="BrokenImage",a[a.ServerError=4]="ServerError",a[a.DeleteFailError=5]="DeleteFailError"}(i=c.ImageErrorType||(c.ImageErrorType={})),c.hasImage=d,c.getImageInfoMaster=e;var j=function(a,b){return new c.ImageDataSource(a,b)},k=function(d){function e(a){var b=this,g=$.Deferred(),h=!a.ExistingInDataSource&&a.InitialData&&!!a.InitialData.ResourceUrl,j=_.clone(a.InitialData);a=_.clone(a),h?a.InitialData.ImageProcessingStatus=f.Uploading:a.InitialData=_.extend({},j,e.getDefaultClientFieldValues());var k=new c.Scheduler;k.setMaxRetryTimesForUpdate(0),b=d.call(this,a,{Scheduler:k,MasterReady:g.promise()})||this,c.keepSavingStateUpdated(b);var l=b.Synchronizer;return l.observe(function(a){var c;_.contains(a.FieldSchemas,l.Schema.CreationError)?c=l.Model.CreationError:_.contains(a.FieldSchemas,l.Schema.UpdateError)&&(c=l.Model.UpdateError),c&&b.bulkEdit(function(){b.Model.ResponseError=c;var a=b.Model.UploadParameters;a&&a.Delete?b.Model.ErrorType=i.DeleteFailError:b.Model.ErrorType=i.ServerError})},[l.Schema.CreationError,l.Schema.UpdateError]),b.addRule({InterestedFields:[b.Schema.ResourceId],Name:"ResetErrorStatus",onChange:function(a){!a.BeingDeleted&&b.Model.ResourceId&&b.resetStatus(f.Idle)}}),g.resolve(),h&&b.Synchronizer.existingInDataSource().done(function(){return b.duplicateFrom(j)}),b}return __extends(e,d),Object.defineProperty(e.prototype,"SettingsMaster",{get:function(){return this.settingsMaster},set:function(a){this.settingsMaster=a},enumerable:!0,configurable:!0}),e.prototype.addImage=function(a){var c,d=this;if(a.File)c=function(){return d.addImageFromFile(a.File,b.FormLimitation.ImageMaxWidth,b.FormLimitation.ImageMaxHeight)};else{if(!a.FromUrl)throw Error("Invalid picked image result.");c=function(){return d.addImageFromUrl(a.FromUrl.Url,a.FromUrl.Size,a.FromUrl.Width,a.FromUrl.Height)}}this.Model.ImageProcessingStatus=f.Picking;var e=this.Synchronizer.existingInDataSource().then(c).done(function(){d.Model.AltText=null});return e},e.prototype.getImageErrorMessage=function(){switch(this.Model.ErrorType){case i.NoError:return null;case i.SizeTooLarge:return b.Resources.LocalizedStrings.Error_Message_5208;case i.InvalidType:return b.Resources.LocalizedStrings.Error_Message_5209;case i.BrokenImage:return b.Resources.LocalizedStrings.ImagePicker_Broken_Image;case i.ServerError:return this.getReponseErrorMessage();case i.DeleteFailError:return b.Resources.LocalizedStrings.Image_Delete_Fail}},e.prototype.clear=function(){var a=this,b=this.Model;return b.ResourceUrl?b.IsPredefined?(this.setData({AltText:null,ContentType:null,FileIdentifier:null,OriginalFileName:null,ResourceId:null,ResourceUrl:null,IsPredefined:!1,UploadParameters:null,ErrorType:i.NoError,ResponseError:null,ImageProcessingStatus:f.Idle,Width:null,Height:null}),$.Deferred().resolve().promise()):(this.bulkEdit(function(){b.ImageProcessingStatus=f.Deleting,b.UploadParameters={Delete:!0}}),this.flushUpload(function(){return a.setData(e.getDefaultClientFieldValues())})):$.Deferred().resolve().promise()},e.prototype.updateSettings=function(a,b){this.SettingsMaster&&this.SettingsMaster.updateWith(this.Model,a,b)},e.prototype.duplicateFrom=function(a){var c=this;if(this.Model.ResourceUrl){var d=a.AltText,e=this.SettingsMaster,f={};e&&(f=_.clone(e.getSnapshot())),this.Synchronizer.existingInDataSource().then(function(){return c.addImageFromUrl(a.ResourceUrl,0,f?f.NaturalWidth:b.FormLimitation.ImageMaxWidth,f?f.NaturalHeight:b.FormLimitation.ImageMaxHeight)}).done(function(){c.Model.AltText=d,e&&(delete f.TargetResourceId,delete f.NaturalHeight,delete f.NaturalWidth,e.setData(f))})}},e.prototype.addImageFromUrl=function(b,c,d,g){var h=this;a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.DesignPage.ImageLayout.ImageSize,extraData:{width:d,height:g}});var j=this.Model;return this.bulkEdit(function(){var a=e.getLimitedSize(d,g,800,600);return j.ErrorType=h.validateImage(c),j.ErrorType!==i.NoError?$.Deferred().reject(j.ErrorType).promise():(h.resetStatus(f.Picking),j.UploadParameters={Url:b,Size:c},h.flushUpload(void 0,a.width,a.height))})},e.prototype.addImageFromFile=function(a,b,c){var d=this,e=this.Model;return this.bulkEdit(function(){var b=d.validateImage(a.size,a.type);return b===i.NoError?(d.resetStatus(f.Uploading),e.UploadParameters={ImageFile:a},d.flushUpload()):(e.ErrorType=b,e.ImageProcessingStatus=f.Idle,$.Deferred().reject(e.ErrorType))})},e.prototype.flushUpload=function(a,b,c){var d=this;return this.Synchronizer.flush().always(function(){return d.Model.ImageProcessingStatus=f.Idle}).then(a).then(function(){return d.updateSettings(b,c)}).fail(function(a){d.resetToDefault()})},e.getLimitedSize=function(a,b,c,d){if(a>c||b>d){var e=Math.min(d/b,c/a);a*=e,b*=e}return{width:a,height:b}},e.prototype.validateImage=function(a,c,d,e){var f=i.NoError;return a>b.FormLimitation.ImageMaxSize&&(f=i.SizeTooLarge),c&&$.inArray(c,b.FormLimitation.ImageSupportMimeType)<0&&(f=i.InvalidType),f},e.prototype.resetToDefault=function(){this.setData(e.getDefaultClientFieldValues(),Nerve.getSubFieldSchemas(e.Schema)),this.updateSettings()},e.getDefaultClientFieldValues=function(){return{UploadParameters:null,ErrorType:i.NoError,ResponseError:null,ImageProcessingStatus:f.Idle,Width:null,Height:null}},e.prototype.resetStatus=function(a){var b=this.Model;this.bulkEdit(function(){b.ErrorType=i.NoError,b.ResponseError=void 0,b.ImageProcessingStatus=a})},e.prototype.getReponseErrorMessage=function(){var a=this.Model,c=a.ResponseError&&a.ResponseError.innerCode;return b.Resources.LocalizedStrings["Error_Message_"+c]||b.Resources.LocalizedStrings.Image_Upload_Fail},e}(Nerve.createObjectMasterClass("ImageInfoMaster",h,j));c.ImageInfoMaster=k}(c=b.Model||(b.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(c){function d(a){return Nerve.getObjectMasterFromModel(a)}function e(a,b,e){a.fieldsReady([b]).done(function(){var f=a.getModelByFieldSchema(b),g=c.getImageInfoMaster(f);a.ensureFieldsReady([e]).done(function(){var b=a.getModelByFieldSchema(e),c=d(b);g.SettingsMaster=c})})}var f,g=Nerve.Spec,h={TargetResourceId:g.string(),Layout:g.enumeration(function(){return f}),Size:g.enumeration(function(){return i}),NaturalWidth:g.number(),NaturalHeight:g.number(),ContainerWidth:g.number(),ContainerHeight:g.number(),ActualWidth:g.number(),ActualHeight:g.number(),Left:g.number(),Top:g.number()};!function(a){a[a.Horizontal=0]="Horizontal",a[a.Vertical=1]="Vertical",a[a.Square=2]="Square"}(f=c.ImageLayout||(c.ImageLayout={}));var i;!function(a){a[a.Small=0]="Small",a[a.Large=1]="Large"}(i=c.ImageSize||(c.ImageSize={})),c.getImageSettingsMaster=d,c.bindImageSettings=e;var j=function(d){function e(a){var b=d.call(this,a)||this;return a.MasterTreeReady&&a.MasterTreeReady.done(function(){var a=b.Parent;a instanceof c.FormMaster&&a.fieldsReady([c.FormMaster.Schema.LogoInfo]).done(function(){a.Model.LogoInfo===b.Model&&(b.isFormLogo=!0)})}),b}return __extends(e,d),Object.defineProperty(e.prototype,"IsFormLogo",{get:function(){return this.isFormLogo},enumerable:!0,configurable:!0}),e.prototype.initImageSetting=function(a,b,d){var e=this,f=this.Model;this.bulkEdit(function(){f.TargetResourceId=a.ResourceId,null==f.Layout&&(a.ResourceUrl||a.ImageProcessingStatus!==c.ImageProcessingStatus.Idle?(f.NaturalWidth=a.Width||b,f.NaturalHeight=a.Height||d,e.initLayout(),e.applyDefaultImageSettings()):e.clear())})},e.prototype.updateWith=function(a,b,c){var d=this;this.bulkEdit(function(){d.clear(),d.initImageSetting(a,b,c)})},e.prototype.onImageStyleChange=function(a){var b=this,c=this.Model;c.Size!==a&&this.bulkEdit(function(){c.Size=a,b.applyDefaultImageSettings()})},e.prototype.clear=function(){return this.setData({},Nerve.getSubFieldSchemas(this.Schema))},e.prototype.validateImageSettings=function(a){var c=_.clone(this.getSnapshot());if(744===c.ContainerWidth&&(c.ContainerHeight=c.ContainerHeight*b.FormLimitation.QuestionCarMaxWidth/c.ContainerWidth,c.ContainerWidth=b.FormLimitation.QuestionCarMaxWidth,!a)){var d=this.Model;d.ContainerWidth=c.ContainerWidth,d.ContainerHeight=c.ContainerHeight}if(null==c.ContainerHeight||null==c.ContainerWidth||null==c.ActualHeight||null==c.ActualWidth||null==c.Top||this.IsFormLogo&&(120!==c.ContainerHeight||120!==c.ContainerWidth)||c.Left>0||c.ContainerWidth>c.Left+c.ActualWidth||c.Top>0||c.ContainerHeight>c.Top+c.ActualHeight){var e=this.getDefaultImageSettings();for(var f in e)c[f]=Math.round(e[f]),a||(this.Model[f]=c[f])}return c},e.prototype.calcLogoLayout=function(a){var c,d,e,g=this.Model.NaturalWidth||b.FormLimitation.ImageMaxWidth,h=this.Model.NaturalHeight||b.FormLimitation.ImageMaxHeight,i=g/h;a=a||{};var j=a.isSmallSize,k=a.isMobile,l=a.isSlimSize;if(k)c=l?30:j?70:80,d=c*i,d>c?(c=l?40:c,d=c*i,e=f.Vertical):e=f.Horizontal;else{var m=void 0;j?(c=70,m=125):l?(c=40,m=95):(c=120,m=215),d=c*i,d>m?(c=l?30:j?40:70,d=c*i,e=f.Vertical):e=f.Horizontal}return d=Math.min(d,750),{ActualWidth:d,ActualHeight:c,Layout:e}},e.prototype.initLayout=function(){var a=this.Model;if(this.IsFormLogo)a.Size=i.Small;else{var b=a.NaturalHeight/a.NaturalWidth;b>1?a.Layout=f.Vertical:1>b?a.Layout=f.Horizontal:a.Layout=f.Square,a.Size=.5>b?i.Large:i.Small}},e.prototype.applyDefaultImageSettings=function(){var a=this.Model,b=this.getDefaultImageSettings();for(var c in b)a[c]=Math.round(b[c])},e.prototype.getDefaultImageSettings=function(){var c,d=this.Model;if(d.NaturalHeight&&d.NaturalWidth)c={NaturalHeight:d.NaturalHeight,NaturalWidth:d.NaturalWidth};else{var e=d.NaturalHeight||b.FormLimitation.ImageMaxHeight,f=d.NaturalWidth||b.FormLimitation.ImageMaxWidth;c={NaturalHeight:e,NaturalWidth:f}}if((!a.Flighting.Flight.isEnabled("DisableBrandingForMSA")||!OfficeFormServerInfo.userInfo.IsMsa)&&this.IsFormLogo)return c;var g=this.getImageLayoutPatten();if(null==g.Height?(c.ContainerWidth=g.Width,c.ContainerHeight=g.Width*c.NaturalHeight/c.NaturalWidth):null==g.Width?(c.ContainerWidth=g.Height*c.NaturalWidth/c.NaturalHeight,c.ContainerHeight=g.Height):(c.ContainerWidth=g.Width,c.ContainerHeight=g.Height),null==g.Height||null==g.Width)c.Left=0,c.Top=0,c.ActualWidth=c.ContainerWidth,c.ActualHeight=c.ContainerHeight;else{var h=Math.max(c.ContainerWidth/c.NaturalWidth,c.ContainerHeight/c.NaturalHeight);c.ActualWidth=h*c.NaturalWidth,c.ActualHeight=h*c.NaturalHeight,c.Left=(c.ContainerWidth-c.ActualWidth)/2,c.Top=(c.ContainerHeight-c.ActualHeight)/2}return c},e.prototype.getImageLayoutPatten=function(){var a=this.Model;if(this.IsFormLogo)return{Height:120,Width:120};if(null==a.Size||a.Size===i.Small)switch(a.Layout){case f.Square:return{Width:314,Height:314};case f.Vertical:return{Height:314};case f.Horizontal:default:return{Width:314}}else switch(a.Layout){case f.Square:return{Width:414,Height:414};case f.Vertical:return{Height:414};case f.Horizontal:default:return{Width:b.FormLimitation.QuestionCarMaxWidth}}},e}(Nerve.createObjectMasterClass("ImageSettingsMaster",h));c.ImageSettingsMaster=j}(c=b.Model||(b.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(b){function c(a){return a}a.Exports.Models=a.Form.Model,b.exportConverter=c}(c=b.Model||(b.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(a){function b(a){return{PermissionSet:"Read, Write, Share",Type:a}}function c(a){return Nerve.getObjectMasterFromModel(a)}var d,e=Nerve.Spec,f={PrincipalId:e.string({SourceFieldName:"principalId"}),PermissionSet:e.string({SourceFieldName:"permissionSet"}),Type:e.enumeration(function(){return d},{SourceFieldName:"type"}),FormId:e.string({IsSourceGenerated:!0,SourceFieldName:"formId"}),IsOwner:e["boolean"]({IsSourceGenerated:!0,SourceFieldName:"isOwner"}),PrincipalEmailAddress:e.string({IsSourceGenerated:!0,SourceFieldName:"principalEmailAddress"}),PrincipalName:e.string({IsSourceGenerated:!0,SourceFieldName:"principalName"}),SavingState:e.reference({IsLocalField:!0})};!function(a){a[a.User=0]="User",a[a.Group=1]="Group",a[a.Tenant=2]="Tenant",a[a.Link=3]="Link",a[a.OrgLink=4]="OrgLink"}(d=a.PermissionType||(a.PermissionType={})),a.createDefaultPermission=b,a.getPermissionMaster=c;var g=function(b,c){return new a.PermissionDataSource(b,c)},h=function(b){function c(c){var d=b.call(this,c)||this;return a.keepSavingStateUpdated(d),d}return __extends(c,b),Object.defineProperty(c.prototype,"Form",{get:function(){return this.Parent.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!0,configurable:!0}),c}(Nerve.createObjectMasterClass("Permission",f,g));a.PermissionMaster=h}(b=a.Model||(a.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(b){function c(a,b){return{Type:a,Name:b}}function d(a){return Nerve.getObjectMasterFromModel(a)}var e,f=Nerve.Spec,g={PrincipalId:f.string({IsSourceGenerated:!0,SourceFieldName:"principalId"}),Type:f.enumeration(function(){return e},{SourceFieldName:"type"}),Name:f.string({SourceFieldName:"name"})};!function(a){a[a.Default=0]="Default",a[a.AnalyzerToken=1]="AnalyzerToken",a[a.OrgAnalyzerToken=2]="OrgAnalyzerToken"}(e=b.PermissionTokenType||(b.PermissionTokenType={})),b.createDefaultPermissionToken=c,b.getPermissionTokenMaster=d;var h=function(a,c){return new b.PermissionTokenDataSource(a,c)},i=function(e){function f(a){return e.call(this,a)||this}return __extends(f,e),Object.defineProperty(f.prototype,"Form",{get:function(){return this.Parent.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!0,configurable:!0}),f.appendPermissionToken=function(a,b,e){var f=Nerve.Collection.addItems(a.Model.PermissionTokens,[c(b,e)]),g=d(f[0]);return g.Synchronizer.existingInDataSource().then(function(){return g.Model.PrincipalId})},f.removePermissionToken=function(a,b){return b?(Nerve.Collection.deleteItems(a.Model.PermissionTokens,[b]),d(b).Synchronizer.deletedFromDataSource().done()):void 0},f.getShareResultPermissionToken=function(a){return a.Synchronizer.existingInDataSource().then(function(){var b=f.getShareResultPermissions(a);if(!b)return null;var c=d(b);return c?c.Synchronizer.existingInDataSource().then(function(){return c.Model.PrincipalId}):void 0})},f.getShareResultPermissions=function(c){return _.filter(c.Model.PermissionTokens,function(c){return c.Type===b.PermissionTokenType.AnalyzerToken&&c.Name===a.FormLimitation.AnalysisTokenName})[0]},f}(Nerve.createObjectMasterClass("PermissionToken",g,h));b.PermissionTokenMaster=i}(b=a.Model||(a.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(b){function c(a){return Nerve.getObjectMasterFromModel(a)}var d=Nerve.Spec,e={Id:d.number({IsSourceGenerated:!0,IsKeyField:!0,SourceFieldName:"id"}),AnswerHint:d.string({SourceFieldName:"description"}),CustomProperties:d.string({SourceFieldName:"customProperties"}),Description:d.string({SourceFieldName:"displayText"}),Order:d.number({SourceFieldName:"order"}),Key:d.string({SourceFieldName:"key"}),IsGenerated:d["boolean"]({IsLocalField:!0}),IsMathOption:d["boolean"]({IsLocalField:!0}),BranchInfo:d.fromMasterClass(function(){return b.BranchInfoMaster},{IsLocalField:!0}),SavingState:d.reference({IsLocalField:!0})};b.getChoiceV2Master=c;var f=function(a,c){return new b.ChoiceDataSource(a,c)},g=function(c){function d(d){var e=this,f=$.Deferred();return e=c.call(this,d,{Scheduler:new b.Scheduler,MasterReady:f.promise()})||this,b.keepSavingStateUpdated(e),e.fieldsReady([e.Schema.Id,e.Schema.Key]).done(function(){e.Model.Key||(e.Model.Key=a.Utilities.Guid.newGuid())}),e.initializeCustomPropertiesBinder(d),f.resolve(),e}return __extends(d,c),Object.defineProperty(d.prototype,"Question",{get:function(){return this.Parent.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"QuestionId",{get:function(){return this.Question.Model.Id},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"Form",{get:function(){return this.Question.Form},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!0,configurable:!0}),d.prototype.initializeCustomPropertiesBinder=function(a){this.customPropertiesBinder=new b.FieldBinder(this,d.Schema.CustomProperties,d.CustomPropertiesFieldSet),a.InitialData&&this.isFieldReady(d.Schema.CustomProperties)&&(a.ExistingInDataSource||a.InitialData.CustomProperties?this.customPropertiesBinder.deserialize():this.customPropertiesBinder.serialize())},Object.defineProperty(d,"CustomPropertiesFieldSet",{get:function(){return d.customPropertiesFieldSet||(d.customPropertiesFieldSet=new b.FieldSet([d.Schema.BranchInfo,d.Schema.IsGenerated,d.Schema.IsMathOption])),d.customPropertiesFieldSet},enumerable:!0,configurable:!0}),d}(Nerve.createObjectMasterClass("ChoiceV2Master",e,f));b.ChoiceV2Master=g}(c=b.Model||(b.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(c){function d(a){return Nerve.getObjectMasterFromModel(a)}var e,f=Nerve.Spec,g={Id:f.string({IsKeyField:!0,SourceFieldName:"id"}),DefaultValue:f.reference({SourceFieldName:"defaultValue"}),ImageInfo:f.fromMasterClass(function(){return c.ImageInfoMaster},{SourceFieldName:"image"}),ImageSettings:f.fromMasterClass(function(){return c.ImageSettingsMaster},{IsLocalField:!0}),Order:f.number({SourceFieldName:"order"}),QuestionInfo:f.string({SourceFieldName:"questionInfo"}),Required:f["boolean"]({SourceFieldName:"required"}),Subtitle:f.string({SourceFieldName:"subtitle"}),CombinedTitle:f.string({SourceFieldName:"title"}),Type:f.reference({SourceFieldName:"type"}),GroupId:f.string({SourceFieldName:"groupId"}),ShowSubtitle:f["boolean"]({IsLocalField:!0}),Hidden:f["boolean"]({IsLocalField:!0}),Title:f.string({IsLocalField:!0}),HasValidBranching:f["boolean"]({IsLocalField:!0}),BranchInfo:f.fromMasterClass(function(){return c.BranchInfoMaster},{IsLocalField:!0}),IntegratedSavingState:f.reference({IsLocalField:!0}),SavingState:f.reference({IsLocalField:!0}),IsQuiz:f["boolean"]({SourceFieldName:"isQuiz"}),GradingBasis:f.string({IsLocalField:!0}),Point:f.number({IsLocalField:!0}),ChoiceType:f.reference({IsLocalField:!0}),Choices:f.collectionOf({Description:f.string(),BranchInfo:f.fromMasterClass(function(){return c.BranchInfoMaster}),IsAnswerKey:f["boolean"](),AnswerHint:f.string(),IsGenerated:f["boolean"](),IsMathOption:f["boolean"]()},{IsLocalField:!0}),Hint:f.string({IsLocalField:!0}),AllowMultipleValues:f["boolean"]({SourceFieldName:"allowMultipleValues"}),AllowOtherAnswer:f["boolean"]({IsLocalField:!0}),OptionDisplayStyle:f.enumeration(function(){return k},{IsLocalField:!0}),ShuffleOptions:f["boolean"]({IsLocalField:!0}),BranchInfoForOtherChoice:f.fromMasterClass(function(){return c.BranchInfoMaster},{IsLocalField:!0}),ChoiceGroup:f.collectionOf(function(){return c.ChoiceV2Master},{SourceFieldName:"choices"}),Length:f.number({IsLocalField:!0}),RatingShape:f.enumeration(function(){return h},{IsLocalField:!0}),LeftDescription:f.string({IsLocalField:!0}),RightDescription:f.string({IsLocalField:!0}),ShowRatingLabel:f["boolean"]({IsLocalField:!0}),MinRating:f.number({IsLocalField:!0}),Multiline:f["boolean"]({IsLocalField:!0}),IsNumber:f["boolean"]({IsLocalField:!0}),Placeholder:f.string({IsLocalField:!0}),NumberValidationRule:f.enumeration(function(){return i},{IsLocalField:!0}),NumberMinBoundary:f.string({IsLocalField:!0}),NumberMaxBoundary:f.string({IsLocalField:!0}),Date:f["boolean"]({IsLocalField:!0}),Time:f["boolean"]({IsLocalField:!0}),FileUploadFolderId:f.string({SourceFieldName:"fileUploadFolderId"}),FileTypes:f.create({Word:f["boolean"](),Excel:f["boolean"](),PowerPoint:f["boolean"](),PDF:f["boolean"](),Image:f["boolean"](),Text:f["boolean"](),Video:f["boolean"](),Audio:f["boolean"]()},{IsLocalField:!0}),HasSpecificFileType:f["boolean"]({IsLocalField:!0}),CoAuthors:f.collectionOf(f.reference(),{IsLocalField:!0}),IsMathQuiz:f["boolean"]({IsLocalField:!0}),IsPlainTextInMathField:f["boolean"]({IsLocalField:!0}),IsAnswerPlainText:f["boolean"]({IsLocalField:!0}),IsMathInputDefault:f["boolean"]({IsLocalField:!0}),InputSwitcherDisabled:f["boolean"]({IsLocalField:!0}),MathPatterns:f.collectionOf(f.string(),{IsLocalField:!0}),MathAriaLabels:f.collectionOf(f.string(),{IsLocalField:!0}),LastMathMLFormula:f.string({IsLocalField:!0}),VideoInfo:f.create({Url:f.string(),Title:f.string(),Author:f.string(),Thumbnail_url:f.string(),OriginalWidth:f.number(),OriginalHeight:f.number()},{IsLocalField:!0}),TrackingId:f.string({SourceFieldName:"trackingId"}),QuestionTagForIntelligence:f.string({SourceFieldName:"questionTagForIntelligence"}),IsFromSuggestion:f["boolean"]({SourceFieldName:"isFromSuggestion"}),TitleAndSubTitleHasPhishingKeywords:f["boolean"]({IsLocalField:!0})};g.Choices[0],g.ChoiceGroup[0];!function(a){a[a.SingleChoice=1]="SingleChoice",a[a.MultiChoice=2]="MultiChoice"}(e=c.ChoiceType||(c.ChoiceType={}));var h;!function(a){a[a.Number=0]="Number",a[a.Star=1]="Star"}(h=c.RatingShape||(c.RatingShape={}));var i;!function(a){a[a.None=0]="None",a[a.Greater=1]="Greater",a[a.GreaterOrEqual=2]="GreaterOrEqual",a[a.Less=3]="Less",a[a.LessOrEqual=4]="LessOrEqual",a[a.Equal=5]="Equal",a[a.NotEqual=6]="NotEqual",a[a.Between=7]="Between",a[a.NotBetween=8]="NotBetween",a[a.Max=9]="Max"}(i=c.NumberValidationRule||(c.NumberValidationRule={}));var j;!function(a){
a[a.Success=0]="Success",a[a.RequiredError=1]="RequiredError",a[a.NumberValidationError=2]="NumberValidationError",a[a.QuizWrongChoiceError=3]="QuizWrongChoiceError",a[a.MathLengthError=4]="MathLengthError"}(j=c.QuestionValidationResult||(c.QuestionValidationResult={}));var k;!function(a){a[a.Dropdown=0]="Dropdown",a[a.ListAll=1]="ListAll"}(k=c.OptionDisplayStyle||(c.OptionDisplayStyle={}));var l;!function(a){a.Choice="Question.Choice",a.DateTime="Question.DateTime",a.Rating="Question.Rating",a.TextField="Question.TextField",a.Ranking="Question.Ranking",a.MatrixChoiceGroup="Question.MatrixChoiceGroup",a.MatrixChoice="Question.MatrixChoice",a.FileUpload="Question.FileUpload",a.NPS="Question.NPS",a.Section="Question.ColumnGroup"}(l=c.QuestionType||(c.QuestionType={})),c.getQuestionMaster=d;var m=function(a,b){return new c.QuestionDataSource(a,b)},n=function(d){function e(a){var b=this,f=$.Deferred();return a.InitialData?(e.resolveQuestionNullTypeIssue(a.InitialData),a=_.clone(a),a.InitialData=_.clone(a.InitialData),void 0!==a.InitialData.CombinedTitle?e.updateTitleWithCombinedTitle(a.InitialData):e.updateCombinedTitle(a.InitialData)):Nerve.Debugger.throwError("Question model should created with initial data."),b=d.call(this,a,{MasterReady:f.promise(),Scheduler:new c.Scheduler})||this,b.fieldsReady([e.Schema.ChoiceGroup]).done(function(){Nerve.Collection.setComparer(b.Model.ChoiceGroup,function(a,b){return a.Order-b.Order})}),c.keepSavingStateUpdated(b),b.updateIntegratedSavingState(),b.updateBranchInfoValidness(),b.initializeQuestionInfoBinder(a),c.bindImageSettings(b,e.Schema.ImageInfo,e.Schema.ImageSettings),e.Rules.forEach(function(a){return b.addRule(a)}),b.redressGradingBasis(),b.coAuthorTimers={},f.resolve(),b}return __extends(e,d),Object.defineProperty(e,"SubQuestionOrderDefaultStep",{get:function(){return 100},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Form",{get:function(){return this.Parent.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ImageInfoMaster",{get:function(){return c.getImageInfoMaster(this.Model.ImageInfo)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ImageSettingsMaster",{get:function(){return c.getImageSettingsMaster(this.Model.ImageSettings)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ParentQuestionMaster",{get:function(){if(!this.isFieldReady(this.Schema.GroupId))return null;var a=this.Model.GroupId;return a&&this.Form.getQuestionById(a)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SubQuestionMasters",{get:function(){var a=this;return this.Form.FormElementManager.QuestionMasters.filter(function(b){return b.Model.GroupId===a.Model.Id})},enumerable:!0,configurable:!0}),e.prototype.isFieldReady=function(a){return a=e.getSourceFields([a])[0],d.prototype.isFieldReady.call(this,a)},e.prototype.ensureFieldsReady=function(a){return d.prototype.ensureFieldsReady.call(this,e.getSourceFields(a))},e.prototype.fieldsReady=function(a){return d.prototype.fieldsReady.call(this,e.getSourceFields(a))},e.prototype.ensureCreationDone=function(){var a=this;return this.ImageInfoMaster.Synchronizer.flush().then(function(){return a.Synchronizer.flush()})},e.prototype.setVideoUrl=function(a){var b=this,c=this.Model.VideoInfo,d=Nerve.getObjectMasterFromModel(c);d.bulkEdit(function(){c.Url=b.generateEmbedURLLocally(a),c.Title="",c.Author="",c.Thumbnail_url="",c.OriginalWidth=459,c.OriginalHeight=256})},e.prototype.clearVideoInfo=function(){this.Model.VideoInfo={}},e.prototype.isSubQuestion=function(){return!!this.Model.GroupId},e.prototype.addSubQuestion=function(a){a.GroupId=this.Model.Id,a.Required=this.Model.Required,this.Form.FormElementManager.insertElementAfter(a,this)},e.prototype.deleteSubQuestion=function(a){var b=this.Form.getQuestionById(a);b.Deleted=!0},e.prototype.createSyncJob=function(a){var b=this,c=$.Deferred(),d=c.promise().then(function(){return b.Form.getQuestionSyncBlocker(d)}).then(a);return c.resolve(),d},e.prototype.createUploadSyncJob=function(b){var c=this,d=$.Deferred(),e=$.when(d,this.uploadJob).then(function(){return c.createSyncJob(b)});return d.resolve(),this.uploadJob=a.Utilities.Promise.always(e),e},e.prototype.getMethodDelegator=function(){var a=this.Model.Type;this.delegators=this.delegators||(this.delegators={});var b=this.delegators[a];if(!b){var d=c.Question.getQuestionDelegatorClass(a);b=new d(this),this.delegators[a]=b}return b},e.prototype.getChoiceById=function(a){var b=Nerve.Collection.getItemWithKeyFields(this.Model.ChoiceGroup,{Id:a});return b&&Nerve.getObjectMasterFromModel(b)},e.prototype.getChoiceByKey=function(a){var b=_.find(this.Model.ChoiceGroup,function(b){return b.Key===a});return b&&c.getChoiceV2Master(b)},e.prototype.updateCoAuthors=function(a){var b=this,c=_.filter(this.Model.CoAuthors,function(b){return a.userId===b.userId})[0],d=function(){c&&e.deleteItems([c]),a.userId in b.coAuthorTimers&&(clearTimeout(b.coAuthorTimers[a.userId]),delete b.coAuthorTimers[a.userId])},e=Nerve.getCollectionMasterFromModel(this.Model.CoAuthors);e.bulkEdit(function(){d(),c=Nerve.Collection.addItems(b.Model.CoAuthors,[a])[0]}),this.coAuthorTimers[a.userId]=setTimeout(d,1e4)},e.prototype.updateTitlePhishingInfo=function(){var b=this;a.Exports.DataProvider.createDataProvider().checkPhishingKeyword(this.Model.Title+" "+(this.Model.ShowSubtitle?this.Model.Subtitle:"")).done(function(a){b.Model.TitleAndSubTitleHasPhishingKeywords=a})},e.prototype.initializeQuestionInfoBinder=function(a){this.questionInfoBinder=new c.FieldBinder(this,e.Schema.QuestionInfo,e.QuestionInfoFieldSet),a.InitialData&&this.isFieldReady(e.Schema.QuestionInfo)&&(a.ExistingInDataSource||a.InitialData.QuestionInfo?this.questionInfoBinder.deserialize():this.questionInfoBinder.serialize()),this.justifyQuestionInfo()},e.prototype.updateIntegratedSavingState=function(){[this.Model.SavingState];this.isFieldReady(e.Schema.ImageInfo)?this.Model.IntegratedSavingState=c.integrateSavingState([this.Model.ImageInfo.SavingState,this.Model.SavingState]):this.Model.IntegratedSavingState=this.Model.SavingState},e.prototype.updateBranchInfoValidness=function(){var a=this.Model,b=_.map(a.Choices,function(a){return a.BranchInfo}).concat([a.BranchInfo,a.BranchInfoForOtherChoice]);a.HasValidBranching=b.some(function(a){return a.IsQuestionBranchingValid})},e.prototype.generateEmbedURLLocally=function(b){var c=document.createElement("a");c.href=b;var d=c.pathname.split("/"),e=b.substring(b.indexOf("?")+1),f=a.Utilities.Html.getQueries(e),g=f.v||d[0]||d[1];return"https://www.youtube.com/embed/"+g+"?feature=oembed&modestbranding=1&rel=0"},Object.defineProperty(e,"QuestionInfoFieldSet",{get:function(){return e.questionInfoFieldSet||(e.questionInfoFieldSet=new c.FieldSet([e.Schema.VideoInfo,e.Schema.ShowSubtitle,e.Schema.Hidden,e.Schema.BranchInfo,e.Schema.ShowRatingLabel,e.Schema.Point,e.Schema.ImageSettings,e.Schema.GradingBasis,e.Schema.ChoiceType,e.Schema.Choices,e.Schema.Hint,e.Schema.AllowOtherAnswer,e.Schema.OptionDisplayStyle,e.Schema.ShuffleOptions,e.Schema.BranchInfoForOtherChoice,e.Schema.Length,e.Schema.RatingShape,e.Schema.LeftDescription,e.Schema.RightDescription,e.Schema.Multiline,e.Schema.IsNumber,e.Schema.Placeholder,e.Schema.NumberValidationRule,e.Schema.NumberMinBoundary,e.Schema.NumberMaxBoundary,e.Schema.Date,e.Schema.Time,e.Schema.IsMathQuiz,e.Schema.IsPlainTextInMathField,e.Schema.IsAnswerPlainText,e.Schema.InputSwitcherDisabled,e.Schema.IsMathInputDefault,e.Schema.MathPatterns,e.Schema.MathAriaLabels,e.Schema.HasSpecificFileType,e.Schema.FileTypes,e.Schema.MinRating])),e.questionInfoFieldSet},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Rules",{get:function(){if(!e.rules){var c=e.Schema;e.rules=[{Name:"block id changes",InterestedFields:[c.Id],onChange:function(b){var c=b.Master.Model,d=c.Id,e=b.OldValues.Id;c.Id=e;var f;try{throw Error("Changing question id")}catch(g){f=g}a.Event.ErrorEventDeprecated.logData({errorName:"UpdatingQuestionId",errorInfo:{newId:d,oldId:e,stack:f.stack}})}},{Name:"null type resolver",InterestedFields:[c.Type],onChange:function(a){return e.resolveQuestionNullTypeIssue(a.Master.Model)}},{Name:"update CombinedTitle",InterestedFields:[c.Title,c.IsMathQuiz,c.Subtitle],onChange:function(a){return e.updateCombinedTitle(a.Master.Model)}},{Name:"update Title",InterestedFields:[c.CombinedTitle],onChange:function(a){return e.updateTitleWithCombinedTitle(a.Master.Model)}},{Name:"IntegrateSavingState",InterestedFields:[c.ImageInfo.SavingState,c.SavingState],onChange:function(a){return a.Master.updateIntegratedSavingState()}},{Name:"HasValidBranching",InterestedFields:[c.BranchInfo,c.BranchInfoForOtherChoice,c.Choices],onChange:function(a){return a.Master.updateBranchInfoValidness()}},{Name:"IsQuiz",InterestedFields:[c.IsQuiz],onChange:function(a){var c=a.Master.Model;c.IsQuiz||(c.IsMathQuiz=null,b.convertToArray(c.Choices).forEach(function(a){a.IsAnswerKey=null}))}},{Name:"IsMathQuiz",InterestedFields:[c.IsMathQuiz],onChange:function(a){var b=a.Master.Model;b.IsMathQuiz||(b.IsMathQuiz=null,b.MathPatterns=null,b.MathAriaLabels=null,b.IsPlainTextInMathField=null,b.IsMathInputDefault=null,b.InputSwitcherDisabled=null,b.LastMathMLFormula=null)}},{Name:"NumberValidationRule",InterestedFields:[c.IsNumber],onChange:function(a){var b=a.Master.Model;b.IsNumber?null==b.NumberValidationRule&&(b.NumberValidationRule=i.None):b.NumberValidationRule=null}},{Name:"JustifyNumberBoundaries",InterestedFields:[c.NumberValidationRule],onChange:function(a){return a.Master.justifyNumberBoundaries()}}]}return e.rules},enumerable:!0,configurable:!0}),e.resolveQuestionNullTypeIssue=function(b){if(!b.Type){var d={choiceType:b.ChoiceType,date:b.Date,time:b.Time,ratingShape:b.RatingShape,multiline:b.Multiline};null!=d.choiceType?b.Type=c.Question.Choice.getElementTypeName():null!=d.date||null!=d.time?b.Type=c.Question.DateTime.getElementTypeName():d.ratingShape?b.Type=c.Question.Rating.getElementTypeName():b.Type=c.Question.TextField.getElementTypeName(),a.Event.ErrorEventDeprecated.logData({errorName:"QuestionNullTypeError",errorInfo:{message:"question type resolved",conditions:d,resolvedType:b.Type}})}},e.updateCombinedTitle=function(b){if(b.IsMathQuiz&&b.Subtitle){var c=b.Title||"";b.CombinedTitle=c+a.Utilities.MathHelper.mathSeparator+b.Subtitle}else b.CombinedTitle=b.Title},e.updateTitleWithCombinedTitle=function(b){var c=b.CombinedTitle;c&&(c=c.split(a.Utilities.MathHelper.mathSeparator)[0]),b.Title=c},e.getSourceFields=function(a){return _.uniq(a.map(function(a){return e.QuestionInfoFieldSet.covers(a)?e.Schema.QuestionInfo:a}))},e}(Nerve.createObjectMasterClass("QuestionMaster",g,m));c.QuestionMaster=n;var o={verify:null,isEmpty:null,getTypeDisplayName:null,getBranchedQuestion:null,isNumberType:null,resetBranchInfo:null,getNormalizedAnswer:null,hasAnswer:null,justifyNumberBoundaries:null,getNumberValidationErrorMessage:null,supportsQuestionLevelBranching:null,supportsChoiceLevelBranching:null,getSnapshotWithoutBranchInfo:null,insertChoice:null,setAnswerKey:null,createQuizResult:null,autoGradeAnswer:null,autoGradeWithQuizResult:null,serializeAnswer:null,deserializeAnswer:null,justifyQuestionInfo:null,showAsDropdown:null,hasCorrectAnswers:null,isCorrectAnswer:null,redressGradingBasis:null};Object.keys(o).forEach(function(a){n.prototype[a]=function(){var b=this.getMethodDelegator();return b[a].apply(b,arguments)}}),a.Exports.Models.getQuestionMaster=d}(c=b.Model||(b.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(a){var b;!function(b){function c(a){f[a.getElementTypeName()]=a}function d(a){return f[a]}var e=function(){function b(a){this.questionMaster=a}return Object.defineProperty(b.prototype,"Master",{get:function(){return this.questionMaster},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Model",{get:function(){return this.questionMaster.Model},enumerable:!0,configurable:!0}),b.prototype.isEmpty=function(a){return!a},b.prototype.justifyNumberBoundaries=function(){throw Error("to be overridden")},b.prototype.supportsQuestionLevelBranching=function(){return!0},b.prototype.supportsChoiceLevelBranching=function(){return!1},b.prototype.getBranchedQuestion=function(b,c){var d=this.getBranchingResult(b);switch(d.Type){case a.BranchingType.Next:return c;case a.BranchingType.Specified:return d.TargetQuestion;case a.BranchingType.Pending:case a.BranchingType.End:default:return null}},b.prototype.isNumberType=function(){return!1},b.prototype.getNumberValidationErrorMessage=function(){throw Error("to be overridden")},b.prototype.getSnapshotWithoutBranchInfo=function(){var a=_.clone(this.Master.getSnapshot());return delete a.BranchInfo,delete a.BranchInfoForOtherChoice,a},b.prototype.resetBranchInfo=function(){this.getBranchInfoMaster(this.Model.BranchInfo).resetToDefault()},b.prototype.insertChoice=function(a,b){},b.prototype.getNormalizedAnswer=function(a){return a},b.prototype.hasAnswer=function(){return!0},b.prototype.hasCorrectAnswers=function(){return!1},b.prototype.isCorrectAnswer=function(a){return!1},b.prototype.setAnswerKey=function(a,b){},b.prototype.createQuizResult=function(a){return null},b.prototype.autoGradeAnswer=function(a){var b=!this.Model.Point,c=null==a.Answer||""===a.Answer;(b||c)&&(a.Score=0,a.IsAutoGraded=!0)},b.prototype.autoGradeWithQuizResult=function(a,b){var c=this.Master.Parent,d=c&&c.Model||this.Model,e=d.Point,f=null==a||""===a;return e||f?0:null},b.prototype.serializeAnswer=function(a){return a},b.prototype.deserializeAnswer=function(a){return a},b.prototype.justifyQuestionInfo=function(){},b.prototype.showAsDropdown=function(){},b.prototype.redressGradingBasis=function(){},b.prototype.getBranchInfoMaster=function(a){return Nerve.getObjectMasterFromModel(a)},b.prototype.getBranchingResult=function(a){return this.getBranchInfoMaster(this.Model.BranchInfo).getBranchingResult()},b}();b.MethodDelegatorBase=e;var f={};b.registerQuestionDelegatorClass=c,b.getQuestionDelegatorClass=d}(b=a.Question||(a.Question={}))}(b=a.Model||(a.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(c){var d;!function(d){var e=function(e){function f(){return null!==e&&e.apply(this,arguments)||this}return __extends(f,e),Object.defineProperty(f,"MinimumOptionsForDropDown",{get:function(){return 7},enumerable:!0,configurable:!0}),f.getElementTypeName=function(){return c.QuestionType.Choice},f.createDefaultDefinition=function(){var a=[{Description:b.Resources.LocalizedStrings.Designer_Choices_DefaultDescription.format(1),IsGenerated:!0},{Description:b.Resources.LocalizedStrings.Designer_Choices_DefaultDescription.format(2),IsGenerated:!0}];return{Type:f.getElementTypeName(),Title:b.Resources.LocalizedStrings.Question_DefaultTitle,Choices:a,ChoiceType:c.ChoiceType.SingleChoice,OptionDisplayStyle:c.OptionDisplayStyle.ListAll,QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1}},f.prototype.verify=function(b){a.Utilities.tryParseJson(b);return!this.Model.Required||b&&"[]"!==b?c.QuestionValidationResult.Success:c.QuestionValidationResult.RequiredError},f.prototype.isEmpty=function(a){return this.Model.ChoiceType===c.ChoiceType.SingleChoice?!a:!a||"[]"===a},f.prototype.getTypeDisplayName=function(){switch(this.Model.ChoiceType){case c.ChoiceType.SingleChoice:return b.Resources.LocalizedStrings.QuestionType_SingleChoice;case c.ChoiceType.MultiChoice:return b.Resources.LocalizedStrings.QuestionType_MultiChoice;default:throw Error("Choice Question Type Not Supported")}},f.prototype.supportsQuestionLevelBranching=function(){return this.Model.ChoiceType!==c.ChoiceType.SingleChoice},f.prototype.supportsChoiceLevelBranching=function(){return this.Model.ChoiceType===c.ChoiceType.SingleChoice},f.prototype.getSnapshotWithoutBranchInfo=function(){var a=e.prototype.getSnapshotWithoutBranchInfo.call(this);return a.Choices=b.convertToArray(a.Choices).map(function(a){return a=_.clone(a),delete a.BranchInfo,a}),a},f.prototype.resetBranchInfo=function(){var a=this;e.prototype.resetBranchInfo.call(this),b.convertToArray(this.Model.Choices).filter(function(b){return a.getBranchInfoMaster(b.BranchInfo).resetToDefault()}),this.getBranchInfoMaster(this.Model.BranchInfoForOtherChoice).resetToDefault()},f.prototype.insertChoice=function(a,b){var c=this.Model.Choices,d=_.find(c,function(a){return a.IsGenerated});if(!d||b&&""!==d.Description){var e=Nerve.Collection.addItems(c,[{Description:a,IsMathOption:b}]);d=e[0]}else{var f=Nerve.getObjectMasterFromModel(d);f.bulkEdit(function(){d.Description=a,d.IsGenerated=null,d.IsMathOption=b})}return d},f.prototype.hasCorrectAnswers=function(){return _.some(this.Model.Choices,function(a){return a.IsAnswerKey})},f.prototype.isCorrectAnswer=function(a){var c=d.getChoiceAnswer(a,this.Model),e=b.convertToArray(this.Model.Choices).filter(function(a){return a.IsAnswerKey}).map(function(a){return a.Description}).sort();return _.isEqual(e,c.SelectedOptions.sort())},f.prototype.justifyQuestionInfo=function(){if(a.Flighting.Flight.isEnabled("DropDown")){var b=this.Master.Model;if(null==b.OptionDisplayStyle){var d=b.ChoiceType===c.ChoiceType.SingleChoice&&!b.IsMathQuiz&&!b.AllowOtherAnswer&&b.Choices.length>=f.MinimumOptionsForDropDown;b.OptionDisplayStyle=d?c.OptionDisplayStyle.Dropdown:c.OptionDisplayStyle.ListAll}}},f.prototype.showAsDropdown=function(){var b=this.Master.Model;return a.Flighting.Flight.isEnabled("DropDown")?b.OptionDisplayStyle===c.OptionDisplayStyle.Dropdown:b.ChoiceType===c.ChoiceType.SingleChoice&&!b.IsMathQuiz&&!b.AllowOtherAnswer&&b.Choices.length>=f.MinimumOptionsForDropDown},f.prototype.setAnswerKey=function(a,d){var e=this;this.Master.bulkEdit(function(){a.IsAnswerKey=d,e.Model.ChoiceType===c.ChoiceType.SingleChoice&&a.IsAnswerKey&&b.convertToArray(e.Model.Choices).forEach(function(b){b.IsAnswerKey&&b!==a&&(b.IsAnswerKey=!1)})})},f.prototype.createQuizResult=function(a){if(this.Model.IsQuiz){var c=b.convertToArray(this.Model.Choices),d=c.some(function(a){return a.IsAnswerKey});return d?{IsAnswerCorrect:this.isCorrectAnswer(a),AnswerHints:c.map(function(a){return a.AnswerHint}),IsAnswerKeys:c.map(function(a){return a.IsAnswerKey}),Choices:c.map(function(a){return a.Description}),GradingBasis:this.Model.GradingBasis}:void 0}},f.prototype.autoGradeAnswer=function(a){var b=_.some(this.Model.Choices,function(a){return a.IsAnswerKey});if(b){var c=this.Model.Point?this.Model.Point:0;a.Score=this.isCorrectAnswer(a.Answer)?c:0,a.IsAutoGraded=!0}else e.prototype.autoGradeAnswer.call(this,a)},f.prototype.autoGradeWithQuizResult=function(a,b){return b?b.IsAnswerCorrect?this.Model.Point:0:null},f.prototype.getBranchingResult=function(a){var d=this;if(!this.Model.HasValidBranching||this.Model.ChoiceType!==c.ChoiceType.SingleChoice)return e.prototype.getBranchingResult.call(this,a);var f=b.convertToArray(this.Model.Choices),g=f.filter(function(a){return a.BranchInfo&&a.BranchInfo.IsQuestionBranchingValid});if(0===g.length)return e.prototype.getBranchingResult.call(this,a);var h,i=f.filter(function(b){return d.selected(a,b)}),j=_.intersection(i,g);if(j.length>0||i.length>0){var k=j[0]||i[0];h=k.BranchInfo}else this.isEmpty(a)||(h=this.Model.BranchInfoForOtherChoice);return h?this.getBranchInfoMaster(h).getBranchingResult():{Type:c.BranchingType.Pending}},f.prototype.selected=function(a,b){return b.Description===a},f}(d.MethodDelegatorBase);d.Choice=e,d.registerQuestionDelegatorClass(e)}(d=c.Question||(c.Question={}))}(c=b.Model||(b.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={})),function(a){var b;!function(a){var b;!function(b){var c;!function(c){function d(c,d){var e=d.ChoiceType===b.ChoiceType.SingleChoice;if(null!=c){var f=a.convertToArray(d.Choices).map(function(a){return a.Description});if(!e||!d.AllowOtherAnswer&&!_.contains(f,c))try{var g=JSON.parse(c);if(Array.isArray(g)){if(!g.some(function(a){return!_.isString(a)}))return{IsSingleChoiceAnswer:!1,IsLegacyChoiceAnswer:!1,SelectedOptions:g}}else if(_.isObject(g)){var h=_.values(g);if(!h.some(function(a){return!_.isString(a)}))return{IsSingleChoiceAnswer:e&&h.length<=1,IsLegacyChoiceAnswer:!0,SelectedOptions:h}}}catch(i){}}return{IsSingleChoiceAnswer:e,IsLegacyChoiceAnswer:!1,SelectedOptions:null==c?[]:[c]}}c.getChoiceAnswer=d}(c=b.Question||(b.Question={}))}(b=a.Model||(a.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(b){var c;!function(c){var d=function(c){function d(){return null!==c&&c.apply(this,arguments)||this}return __extends(d,c),d.getElementTypeName=function(){return b.QuestionType.DateTime},d.createDefaultDefinition=function(){return{Type:d.getElementTypeName(),Title:a.Resources.LocalizedStrings.Question_DefaultTitle,Date:!0,Time:!1,QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1}},d.prototype.verify=function(a){return this.Model.Required&&!a?b.QuestionValidationResult.RequiredError:b.QuestionValidationResult.Success},d.prototype.getTypeDisplayName=function(){return a.Resources.LocalizedStrings.QuestionType_DateTime},d}(c.MethodDelegatorBase);c.DateTime=d,c.registerQuestionDelegatorClass(d)}(c=b.Question||(b.Question={}))}(b=a.Model||(a.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(b){var c;!function(c){var d=function(c){function d(){return null!==c&&c.apply(this,arguments)||this}return __extends(d,c),d.getElementTypeName=function(){return b.QuestionType.FileUpload},d.createDefaultDefinition=function(){return{Type:d.getElementTypeName(),Title:a.Resources.LocalizedStrings.Question_DefaultTitle,HasSpecificFileType:!1,FileTypes:{Word:!0,Excel:!0,PowerPoint:!0,PDF:!0,Image:!0,Text:!0,Video:!0,Audio:!0},QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1}},d.prototype.verify=function(a){return this.Model.Required&&!a?b.QuestionValidationResult.RequiredError:b.QuestionValidationResult.Success},d.prototype.getTypeDisplayName=function(){return a.Resources.LocalizedStrings.QuestionType_UploadFile},d}(c.MethodDelegatorBase);c.FileUpload=d,c.registerQuestionDelegatorClass(d)}(c=b.Question||(b.Question={}))}(b=a.Model||(a.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(a){var b;!function(b){var c=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.getElementTypeName=function(){return a.QuestionType.MatrixChoice},c.prototype.verify=function(b){return!this.Model.Required||b&&0!==b.length?a.QuestionValidationResult.Success:a.QuestionValidationResult.RequiredError},c.prototype.getTypeDisplayName=function(){return"MatrixChoice"},c.prototype.getNormalizedAnswer=function(a){return a},c}(b.MethodDelegatorBase);b.MatrixChoice=c,b.registerQuestionDelegatorClass(c)}(b=a.Question||(a.Question={}))}(b=a.Model||(a.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(b){var c;!function(c){var d=function(c){function d(){return null!==c&&c.apply(this,arguments)||this}return __extends(d,c),d.getElementTypeName=function(){return b.QuestionType.MatrixChoiceGroup},d.createDefaultDefinition=function(){var b=[{Description:a.Resources.LocalizedStrings.Designer_Choices_DefaultDescription.format(1),IsGenerated:!0,Id:1,Order:1},{Description:a.Resources.LocalizedStrings.Designer_Choices_DefaultDescription.format(2),IsGenerated:!0,Id:2,Order:2},{Description:a.Resources.LocalizedStrings.Designer_Choices_DefaultDescription.format(3),IsGenerated:!0,Id:3,Order:3},{Description:a.Resources.LocalizedStrings.Designer_Choices_DefaultDescription.format(4),IsGenerated:!0,Id:4,Order:4},{Description:a.Resources.LocalizedStrings.Designer_Choices_DefaultDescription.format(5),IsGenerated:!0,Id:5,Order:5}];return{Type:d.getElementTypeName(),Title:a.Resources.LocalizedStrings.Question_DefaultTitle,ChoiceGroup:b,QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1}},d.createSubQuestionsDefinition=function(){var b={Title:a.Resources.LocalizedStrings.Desinger_Likert_DefaultDescription.format(1),Type:"Question.MatrixChoice"},c={Title:a.Resources.LocalizedStrings.Desinger_Likert_DefaultDescription.format(2),Type:"Question.MatrixChoice"};return[b,c]},d.prototype.verify=function(a){return b.QuestionValidationResult.Success},d.prototype.getTypeDisplayName=function(){return a.Resources.LocalizedStrings.QuestionType_Likert},d.prototype.hasAnswer=function(){return!1},d}(c.MethodDelegatorBase);c.MatrixChoiceGroup=d,c.registerQuestionDelegatorClass(d)}(c=b.Question||(b.Question={}))}(b=a.Model||(a.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(b){var c;!function(c){var d=function(c){function d(){return null!==c&&c.apply(this,arguments)||this}return __extends(d,c),d.getElementTypeName=function(){return b.QuestionType.NPS},d.createDefaultDefinition=function(){return{Type:d.getElementTypeName(),Title:a.Resources.LocalizedStrings.NPS_DefaultTitle,LeftDescription:a.Resources.LocalizedStrings.NPS_LeftDescription,RightDescription:a.Resources.LocalizedStrings.NPS_RightDescription,QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1}},d.prototype.verify=function(a){return this.Model.Required&&!a&&0!==a?b.QuestionValidationResult.RequiredError:b.QuestionValidationResult.Success},d.prototype.getTypeDisplayName=function(){return a.Resources.LocalizedStrings.QuestionType_NPS},d.prototype.isNumberType=function(){return!0},d}(c.MethodDelegatorBase);c.NPSDelegator=d,c.registerQuestionDelegatorClass(d)}(c=b.Question||(b.Question={}))}(b=a.Model||(a.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(c){var d;!function(d){var e=function(d){function e(){return null!==d&&d.apply(this,arguments)||this}return __extends(e,d),e.getElementTypeName=function(){return c.QuestionType.Ranking},e.createDefaultDefinition=function(){var c=[{Description:b.Resources.LocalizedStrings.Designer_Choices_DefaultDescription.format(1),Order:1,Key:a.Utilities.Guid.newGuid()},{Description:b.Resources.LocalizedStrings.Designer_Choices_DefaultDescription.format(2),Order:2,Key:a.Utilities.Guid.newGuid()},{Description:b.Resources.LocalizedStrings.Designer_Choices_DefaultDescription.format(3),Order:3,Key:a.Utilities.Guid.newGuid()}];return{Type:e.getElementTypeName(),Title:b.Resources.LocalizedStrings.Question_DefaultTitle,AllowMultipleValues:!0,ChoiceGroup:c,QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1}},e.prototype.verify=function(a){return!this.Model.Required||a&&0!==a.length?c.QuestionValidationResult.Success:c.QuestionValidationResult.RequiredError},e.prototype.getTypeDisplayName=function(){return b.Resources.LocalizedStrings.QuestionType_Ranking},e.prototype.isCorrectAnswer=function(a){var b=this;if(!a)return!1;var c,d=JSON.parse(this.Model.GradingBasis);c=_.isString(a)?JSON.parse(a):_.map(_.sortBy(a,function(a){return a.answerOrder}),function(a){return a.id});var e=_.map(d,function(a){return _.findWhere(b.Model.ChoiceGroup,{Key:a}).Id});return c.length<e.length?!1:(c=_.filter(c,function(a){return _.contains(e,a)}),_.isEqual(e,c))},e.prototype.createQuizResult=function(a){return this.Model.IsQuiz?{IsAnswerCorrect:this.isCorrectAnswer(a),GradingBasis:this.Model.GradingBasis}:void 0},e.prototype.autoGradeAnswer=function(a){var b=this.Model.Point||0;a.Score=this.isCorrectAnswer(a.Answer)?b:0,a.IsAutoGraded=!0},e.prototype.autoGradeWithQuizResult=function(a,b){return b?b.IsAnswerCorrect?this.Model.Point:0:null},e.prototype.getNormalizedAnswer=function(a){return a||[]},e.prototype.hasCorrectAnswers=function(){return!0},e.prototype.redressGradingBasis=function(){var a=this;this.Master.fieldsReady([c.QuestionMaster.Schema.ChoiceGroup,c.QuestionMaster.Schema.GradingBasis]).done(function(){var b=Nerve.convertToArray(a.Master.Model.ChoiceGroup).sort(function(a,b){return a.Order-b.Order}).map(function(a){return a.Key});a.Master.Model.GradingBasis=JSON.stringify(b)})},e}(d.MethodDelegatorBase);d.Ranking=e,d.registerQuestionDelegatorClass(e)}(d=c.Question||(c.Question={}))}(c=b.Model||(b.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(b){var c;!function(c){var d=function(c){function d(){return null!==c&&c.apply(this,arguments)||this}return __extends(d,c),d.getElementTypeName=function(){return b.QuestionType.Rating},d.createDefaultDefinition=function(){return{Type:d.getElementTypeName(),Title:a.Resources.LocalizedStrings.Question_DefaultTitle,Length:5,RatingShape:b.RatingShape.Star,LeftDescription:"",RightDescription:"",MinRating:1,QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1}},d.prototype.verify=function(a){return this.Model.Required&&!a?b.QuestionValidationResult.RequiredError:b.QuestionValidationResult.Success},d.prototype.getTypeDisplayName=function(){return a.Resources.LocalizedStrings.QuestionType_Rating},d.prototype.isNumberType=function(){return!0},d}(c.MethodDelegatorBase);c.Rating=d,c.registerQuestionDelegatorClass(d)}(c=b.Question||(b.Question={}))}(b=a.Model||(a.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(){function b(b,c,d){this.answer=b,this.id=c||a.Utilities.Guid.newGuid(),this.isMath=d}return b}();b.ShortTextAnswer=c,a.Exports.Models.ShortTextAnswer=c;var d=function(){function b(c){if(this.possibleCorrectAnswers=[],null!=c.GradingBasis)try{this.possibleCorrectAnswers=JSON.parse(c.GradingBasis)}catch(d){this.possibleCorrectAnswers=[],a.Event.ErrorEventDeprecated.logData({errorName:"ShortTextGradingBasisJsonParseFailure",errorInfo:{gradingBasisLength:c.GradingBasis.length,nonAsciiDetected:b.doesContainNonAsciiCharacters(c.GradingBasis)}})}else this.possibleCorrectAnswers=[]}return b.prototype.serialize=function(){return JSON.stringify(this.possibleCorrectAnswers)},b.prototype.getAnswers=function(){return _.clone(this.possibleCorrectAnswers)},b.prototype.areAnyAnswersDefined=function(){return 0!==this.possibleCorrectAnswers.length},b.prototype.addAnswer=function(a,b){return this.isInvalidAnswerCandidate(a)?!1:this.hasAnswerBeenPreviouslyAdded(a)?!1:(this.possibleCorrectAnswers.push(new c(a,void 0,b)),!0)},b.prototype.updateAnswer=function(a,b,d){if(this.isInvalidAnswerCandidate(b))return!1;if(this.hasAnswerBeenPreviouslyAdded(b,a))return!1;var e=this.getPossibleAnswerIndex(a);if(0>e)return!1;var f=this.possibleCorrectAnswers[e];return this.possibleCorrectAnswers[e]=new c(b,f.id,d),!0},b.prototype.deleteAnswer=function(a){var b=this.getPossibleAnswerIndex(a);b>=0&&this.possibleCorrectAnswers.splice(b,1)},b.prototype.isCorrect=function(a){return this.isInvalidAnswerCandidate(a)?!1:(a+="",a=a.trim().toUpperCase(),null!=_.find(this.possibleCorrectAnswers,function(b){return b.answer.trim().toUpperCase()===a}))},b.prototype.hasAnswerBeenPreviouslyAdded=function(a,b){a+="";var c=a.toUpperCase();return null!=_.find(this.possibleCorrectAnswers,function(a){return a.answer.toUpperCase()===c&&a.id!==b})},b.prototype.isInvalidAnswerCandidate=function(a){return null==a||""===a},b.prototype.getPossibleAnswerIndex=function(a){return _.findIndex(this.possibleCorrectAnswers,function(b){return b.id===a})},b.doesContainNonAsciiCharacters=function(a){for(var b=0;b<a.length;b++)if(a.charCodeAt(b)>127)return!0;return!1},b}();b.ShortTextAutograder=d,a.Exports.Models.ShortTextAutograder=d}(c=b.Question||(b.Question={}))}(c=b.Model||(b.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(c){var d;!function(d){function e(a){var d=c.NumberValidationRule[a];return b.Resources.LocalizedStrings["NumberValidation"+d];
}d.getLocalizedNumberValidationRuleName=e;var f=function(e){function f(){return null!==e&&e.apply(this,arguments)||this}return __extends(f,e),f.getElementTypeName=function(){return c.QuestionType.TextField},f.createDefaultDefinition=function(){return f.createDefaultSingleLineDefinition()},f.createDefaultSingleLineDefinition=function(){return{Type:f.getElementTypeName(),Title:b.Resources.LocalizedStrings.Question_DefaultTitle,Multiline:!1,QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1}},f.createDefaultMultiLineDefinition=function(){return{Type:f.getElementTypeName(),Title:b.Resources.LocalizedStrings.Question_DefaultTitle,Multiline:!0,QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1}},f.prototype.verify=function(b){var d=b;if(this.Model.IsMathQuiz&&d){var e=a.Utilities.tryParseJson(b);if(d=null==e.Answer?b:e.Answer,d.length>a.Form.FormLimitation.MathInputLength)return c.QuestionValidationResult.MathLengthError}return this.Model.Required&&!d?c.QuestionValidationResult.RequiredError:d&&this.Model.IsNumber&&!this.verifyNumber(d)?c.QuestionValidationResult.NumberValidationError:c.QuestionValidationResult.Success},f.prototype.getTypeDisplayName=function(){return this.Model.Multiline?b.Resources.LocalizedStrings.QuestionType_MultiLineText:this.Model.IsNumber?b.Resources.LocalizedStrings.QuestionType_Number:b.Resources.LocalizedStrings.QuestionType_SingleLineText},f.prototype.isNumberType=function(){return!!this.Model.IsNumber},f.prototype.justifyNumberBoundaries=function(){var b=this;this.Master.bulkEdit(function(){var d=b.Master.Model,e=a.Utilities.NumberValidation.formatAsFloat(d.NumberMinBoundary)||"1",f=a.Utilities.NumberValidation.formatAsFloat(d.NumberMaxBoundary)||"10";switch(d.NumberValidationRule){case c.NumberValidationRule.Greater:case c.NumberValidationRule.GreaterOrEqual:case c.NumberValidationRule.Equal:case c.NumberValidationRule.NotEqual:f=null;break;case c.NumberValidationRule.Less:case c.NumberValidationRule.LessOrEqual:e=null;break;case c.NumberValidationRule.Between:case c.NumberValidationRule.NotBetween:if(parseFloat(e)>parseFloat(f)){var g=e;e=f,f=g}}d.NumberMinBoundary=e,d.NumberMaxBoundary=f})},f.prototype.getNumberValidationErrorMessage=function(){var a=this.Model.NumberValidationRule;if(null!=a){var d=b.Resources.LocalizedStrings["NumberValidation_ErrorMessage_"+c.NumberValidationRule[a]];return d.format(this.Model.NumberMinBoundary,this.Model.NumberMaxBoundary)}},f.prototype.hasCorrectAnswers=function(){if(this.Model.IsQuiz&&!this.Model.Multiline){var a=new d.ShortTextAutograder(this.Model);return a.areAnyAnswersDefined()}return!1},f.prototype.isCorrectAnswer=function(a){if(this.Model.IsQuiz&&!this.Model.Multiline){var b=new d.ShortTextAutograder(this.Model);return b.isCorrect(a)}return e.prototype.isCorrectAnswer.call(this,a)},f.prototype.createQuizResult=function(a){var b=new d.ShortTextAutograder(this.Model);return b.areAnyAnswersDefined()&&this.Model.IsQuiz?{IsAnswerCorrect:this.isCorrectAnswer(a),GradingBasis:this.Model.GradingBasis}:void 0},f.prototype.autoGradeAnswer=function(a){if(this.Model.IsQuiz&&!this.Model.Multiline){var b=new d.ShortTextAutograder(this.Model);if(b.areAnyAnswersDefined()){var c=this.Model.Point?this.Model.Point:0;a.Score=b.isCorrect(a.Answer)?c:0,a.IsAutoGraded=!0}else e.prototype.autoGradeAnswer.call(this,a)}else e.prototype.autoGradeAnswer.call(this,a)},f.prototype.autoGradeWithQuizResult=function(a,b){return b?this.Model.IsQuiz&&!this.Model.Multiline?b.IsAnswerCorrect?this.Model.Point:0:e.prototype.autoGradeWithQuizResult.call(this,a,b):null},f.prototype.verifyNumber=function(b){if(void 0===b||""===b)return!0;if(!a.Utilities.NumberValidation.isFormatedAsFloat(b))return!1;var d=parseFloat(a.Utilities.NumberValidation.formatAsFloat(b)),e=parseFloat(this.Model.NumberMinBoundary),f=parseFloat(this.Model.NumberMaxBoundary);switch(this.Model.NumberValidationRule){case c.NumberValidationRule.None:return!0;case c.NumberValidationRule.Between:return d>=e&&f>=d;case c.NumberValidationRule.NotBetween:return!(d>=e&&f>=d);case c.NumberValidationRule.Greater:return d>e;case c.NumberValidationRule.GreaterOrEqual:return d>=e;case c.NumberValidationRule.Less:return f>d;case c.NumberValidationRule.LessOrEqual:return f>=d;case c.NumberValidationRule.Equal:return d===e;case c.NumberValidationRule.NotEqual:return d!==e;default:return!0}},f.prototype.deserializeAnswer=function(b){if(this.Model.IsMathQuiz&&b&&""!=b){var c=a.Utilities.tryParseJson(b);return this.Model.IsAnswerPlainText=!c.IsMath,null==c.Answer?b:c.Answer}return b},f}(d.MethodDelegatorBase);d.TextField=f,d.registerQuestionDelegatorClass(f)}(d=c.Question||(c.Question={}))}(c=b.Model||(b.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(b){var c=Nerve.Spec,d={Answer:c.reference(),AnswerEntity:c.reference(),BranchedQuestion:c.reference(),NextQuestionInOrder:c.reference(),QuizResult:c.reference(),ShowPhishingFormWarning:c["boolean"]()},e=function(c){function d(a,b){var d=c.call(this)||this;return d.calculateNextQuestionCallback=function(){return d.updateBranchedQuestion()},d.question=a,d.question.observe(d.calculateNextQuestionCallback),d.formRuntimeMaster=b,d.addRule({Name:"UpdateBranchedQuestion",onChange:function(a){return d.updateBranchedQuestion()}}),d}return __extends(d,c),Object.defineProperty(d.prototype,"Question",{get:function(){return this.question},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"SubQuestions",{get:function(){return this.Question.SubQuestionMasters},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"SubQuestionRuntimeMasters",{get:function(){var a=this;return this.SubQuestions.map(function(b){return a.getSubQuestionRuntimeById(b.Model.Id)})},enumerable:!0,configurable:!0}),d.prototype.getSubQuestionRuntimeById=function(a){return this.formRuntimeMaster?this.formRuntimeMaster.getOrCreateQuestionRuntimeById(a):null},d.prototype.verifyAnswer=function(){if(0===this.SubQuestionRuntimeMasters.length){if(this.Question.Model.IsMathQuiz){var c=a.Utilities.tryParseJson(this.Model.Answer||"{}"),d=null==c.Answer?this.Model.Answer:c.Answer;return this.Question.verify(d)===b.QuestionValidationResult.Success}return this.Question.verify(this.Model.Answer)===b.QuestionValidationResult.Success}return this.SubQuestionRuntimeMasters.every(function(a){return a.Question.verify(a.Model.Answer)===b.QuestionValidationResult.Success})},d.prototype.release=function(){this.question.unobserve(this.calculateNextQuestionCallback)},d.prototype.getAnswerEntity=function(){return{Answer:this.Question.getNormalizedAnswer(this.Model.Answer),QuestionId:this.Question.Model.Id}},d.prototype.calculateQuizResultFromModel=function(){0===this.SubQuestionRuntimeMasters.length?this.Model.QuizResult=this.Question.createQuizResult(this.Model.Answer):this.Model.QuizResult={IsAnswerCorrect:!1}},d.prototype.getScore=function(){var a=this.Model.AnswerEntity,b=a&&a.Score;return null!=b?b:this.Question.autoGradeWithQuizResult(this.Model.Answer,this.Model.QuizResult)},d.prototype.createOD4BTempFolder=function(){if(this.formRuntimeMaster)return this.formRuntimeMaster.createOD4BTempFolder();throw Error("No FormRuntimeMaster specified.")},d.prototype.updateBranchedQuestion=function(){var a=this.Model;a.BranchedQuestion=this.Question.getBranchedQuestion(a.Answer,a.NextQuestionInOrder)},d}(Nerve.createObjectMasterClass("QuestionRuntime",d));b.QuestionRuntimeMaster=e}(c=b.Model||(b.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(a){function b(a){return Nerve.getObjectMasterFromModel(a)}function c(b,c){return a.ResponseDataSource.deleteResponses(b.Model.Id,c)}var d=Nerve.Spec,e={Id:d.number({IsKeyField:!0,SourceFieldName:"id"}),Comments:d.collectionOf(function(){return a.CommentMaster},{SourceFieldName:"comments"}),AnswersAsString:d.string({SourceFieldName:"answers"}),StartDateAsString:d.string({SourceFieldName:"startDate"}),SubmitDateAsString:d.string({SourceFieldName:"submitDate"}),Responder:d.string({SourceFieldName:"responder"}),ResponderName:d.string({SourceFieldName:"responderName"}),QuizResult:d.string({SourceFieldName:"quizResult"}),ReleaseDateAsString:d.string({SourceFieldName:"releaseDate"}),Answers:d.collectionOf({QuestionId:d.string({IsKeyField:!0,SourceFieldName:"questionId"}),Answer:d.reference({SourceFieldName:"answer1"}),Feedback:d.string({IsLocalField:!0}),Score:d.number({IsLocalField:!0}),IsAutoGraded:d["boolean"]({IsLocalField:!0}),IsMathAnswer:d["boolean"]({IsLocalField:!0})},{IsLocalField:!0}),StartDate:d.reference({IsLocalField:!0}),SubmitDate:d.reference({IsLocalField:!0}),ReleaseDate:d.reference({IsLocalField:!0}),Feedback:d.string({IsLocalField:!0}),TotalScore:d.number({IsLocalField:!0}),IntegratedSavingState:d.reference({IsLocalField:!0}),SavingState:d.reference({IsLocalField:!0}),EmailReceiptConsent:d["boolean"]({SourceFieldName:"emailReceiptConsent"}),SubmitLanguage:d.string({SourceFieldName:"submitLanguage"})};e.Answers[0];a.getResponseMaster=b,a.deleteResponses=c;var f=function(b,c){return new a.ResponseDataSource(b,c)},g=function(b){function c(d){var e=this,f=$.Deferred();return e=b.call(this,d,{Scheduler:new a.Scheduler,MasterReady:f.promise()})||this,e.initializeSavingStateIntegration(),c.Rules.forEach(function(a){return e.addRule(a)}),f.resolve(),e}return __extends(c,b),Object.defineProperty(c.prototype,"Form",{get:function(){return this.Parent.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"ResponseId",{get:function(){return this.Model.Id},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"Comment",{get:function(){return this.getCommentByQuestionId(null)},enumerable:!0,configurable:!0}),c.prototype.updateWithNormalizedResponse=function(a){var b=this;this.bulkEdit(function(){b.Synchronizer.onSourceDataReceived(Nerve.convertToSourceData(a,c.Schema)),b.setData(a)})},c.prototype.getAnswerByQuestionId=function(a){var b=Nerve.Collection.getItemWithKeyFields(this.Model.Answers,{QuestionId:a});return b&&Nerve.getObjectMasterFromModel(b)},c.prototype.getCommentByQuestionId=function(b){var c=Nerve.Collection.getItemWithKeyFields(this.Model.Comments,{QuestionId:b});return c&&a.getCommentMaster(c)},c.prototype.setAnswerGrading=function(a,b,c){var d=this.Form.getQuestionById(a),e=d.SubQuestionMasters;e.length>0&&(a=e[e.length-1].Model.Id);var f=this.getCommentByQuestionId(a);if(f)f.bulkEdit(function(){f.Model.Score=b,f.Model.Feedback=c});else{var g={QuestionId:a,Feedback:c,Score:b};Nerve.Collection.addItems(this.Model.Comments,[g])}},c.prototype.initializeSavingStateIntegration=function(){var b=this;this.commentsSavingState=a.SavingStateValues.Idle;var c=Nerve.getCollectionMasterFromModel(this.Model.Comments);a.observeIntegratedSavingState(c,c.Schema[0].SavingState,function(a){b.commentsSavingState=a,b.updateIntegratedSavingState()}),a.keepSavingStateUpdated(this),this.updateIntegratedSavingState()},c.prototype.ensureAnswerByQuestionId=function(a){var b=this.getAnswerByQuestionId(a);if(b)return b;var c=Nerve.Collection.addItems(this.Model.Answers,[{QuestionId:a}])[0];return Nerve.getObjectMasterFromModel(c)},c.prototype.updateIntegratedSavingState=function(){this.Model.IntegratedSavingState=a.integrateSavingState([this.Model.SavingState,this.commentsSavingState])},Object.defineProperty(c,"Rules",{get:function(){if(!c.rules){var a=c.Schema;c.rules=[{Name:"ResponseComment",InterestedFields:[a.Feedback,a.TotalScore],onChange:function(a){var b=a.Master,c=b.getCommentByQuestionId(null);c?c.bulkEdit(function(){c.Model.Feedback=b.Model.Feedback,c.Model.Score=b.Model.TotalScore}):Nerve.Collection.addItems(b.Model.Comments,[{QuestionId:null,Feedback:b.Model.Feedback,Score:b.Model.TotalScore}])}},{Name:"AnswerComment",InterestedFields:[a.Answers[0].Feedback,a.Answers[0].Score,a.Answers[0].IsAutoGraded],onChange:function(a){var b=a.Master,c=b.Model.Answers,d=function(a){a.IsAutoGraded||b.setAnswerGrading(a.QuestionId,a.Score,a.Feedback)};a.SubChanges.filter(function(a){return a.Master.Model===c}).forEach(function(a){a.AddedModels.forEach(d),a.SubChanges.forEach(function(a){return d(a.Master.Model)})})}},{Name:"ApplyCommentChange",InterestedFields:[a.Comments],onChange:function(a){var b=a.Master,c=b.Model.Comments,d=function(a){var c=a.QuestionId;if(c){var d=b.ensureAnswerByQuestionId(c);d.bulkEdit(function(){d.Model.Feedback=a.Feedback,d.Model.Score=a.Score,d.Model.IsAutoGraded=!1})}else b.bulkEdit(function(){b.Model.Feedback=a.Feedback,b.Model.TotalScore=a.Score})};a.SubChanges.filter(function(a){return a.Master.Model===c}).forEach(function(a){a.AddedModels.forEach(d),a.SubChanges.forEach(function(a){return d(a.Master.Model)})})}}],c.rules=c.rules.concat(c.getRulesForSyncBetweenDateFields(a.StartDate,a.StartDateAsString),c.getRulesForSyncBetweenDateFields(a.SubmitDate,a.SubmitDateAsString),c.getRulesForSyncBetweenDateFields(a.ReleaseDate,a.ReleaseDateAsString))}return c.rules},enumerable:!0,configurable:!0}),c.getRulesForSyncBetweenDateFields=function(a,b){var c=Nerve.getFieldSchemaInfo(a).Name,d=Nerve.getFieldSchemaInfo(b).Name;return[{Name:"update "+c,InterestedFields:[b],onChange:function(a){var b=a.Master.Model;b[c]=new Date(b[d])}},{Name:"update "+d,InterestedFields:[a],onChange:function(a){var b=a.Master.Model;b[d]=b[c].toISOString()}}]},c}(Nerve.createObjectMasterClass("Response",e,f));a.ResponseMaster=g}(b=a.Model||(a.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(b){function c(a){var b=a.Synchronizer;b.observe(function(){return f(a)},[b.Schema.CreationFailed,b.Schema.CreationInProcess,b.Schema.CreationScheduled,b.Schema.UpdateFailed,b.Schema.UpdateInProcess,b.Schema.UpdateScheduled]),f(a)}function d(b,c,d){function f(){var a=g.map(function(a){return a.getModelByFieldSchema(c)});d(e(a))}var g=a.convertToArray(b.Model).map(Nerve.getObjectMasterFromModel);f(),b.observe(function(a){a.AddedModels.length&&(g=g.concat(a.AddedModels.map(Nerve.getObjectMasterFromModel))),a.RemovedModels.length&&a.RemovedModels.map(Nerve.getObjectMasterFromModel).forEach(function(a){a.Synchronizer.deletedFromDataSource().done(function(){g=_.without(g,a),f()})}),f()},[c])}function e(a){return _.contains(a,g.Saving)?g.Saving:_.contains(a,g.Scheduled)?g.Scheduled:_.contains(a,g.Failed)?g.Failed:g.Idle}function f(a){var b=a.Synchronizer.Model;b.CreationInProcess||b.UpdateInProcess?a.Model.SavingState=g.Saving:b.CreationScheduled||b.UpdateScheduled?a.Model.SavingState=g.Scheduled:b.CreationFailed||b.UpdateFailed?a.Model.SavingState=g.Failed:a.Model.SavingState=g.Idle}var g;!function(a){a.NotStarted="NotStarted",a.Idle="Idle",a.Scheduled="Scheduled",a.Saving="Saving",a.Failed="Failed"}(g=b.SavingStateValues||(b.SavingStateValues={})),b.keepSavingStateUpdated=c,b.observeIntegratedSavingState=d,b.integrateSavingState=e}(b=a.Model||(a.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(b){function c(){return g||(g=new h)}function d(a){var c=parseInt(a);return isNaN(c)||c<b.MAXRUNVERSION}var e=Nerve.Spec,f={ExportToExcelCalloutVersion:e.string(),NewFormTeachingCalloutVersion:e.string(),SendTeachingCalloutVersion:e.string(),ThemeSuggestCalloutVersion:e.string(),WhatsNewVersion:e.string(),PortalFormIntroduction:e.string(),PreviewLabelForSurvey:e.string(),OutlookQuickPollTeachingUI:e.string()};b.MAXRUNVERSION=2;var g;b.getUserProfileMaster=c,b.isVersionOk=d;var h=function(b){function c(){var a=b.call(this,{InitialData:c.getInitialData()})||this;return a.observe(function(b){return a.saveValues(b.FieldSchemas)}),a}return __extends(c,b),c.getInitialData=function(){var b=a.SafeStorage.DefaultStorage,d={};return Object.keys(c.Schema).forEach(function(a){return d[a]=b.getItem(a)}),d},c.prototype.saveValues=function(b){var c=a.SafeStorage.DefaultStorage,d=this.getSnapshot();b.map(Nerve.getFieldSchemaInfo).map(function(a){return a.Name}).forEach(function(a){return c.setItem(a,d[a])})},c}(Nerve.createObjectMasterClass("UserProfileMaster",f));b.UserProfileMaster=h}(c=b.Model||(b.Model={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(b){function c(a){return a&&a[e]}b.getMasterFromModel=c;var d=function(){function b(b){var c=this;this.instanceId=a.Utilities.Guid.newGuid(),this.values=[],this.allFields=[],this.changedFieldNames={},this.observers=[],this.bulkChangingModeStackedCount=0;var d=this.FieldOptions||{};this.arrayFields=[],this.fieldsEnumType=b,this.allFields=a.Utilities.getAllEnumValues(b),d.ArrayFields&&d.ArrayFields.forEach(function(a){return c.arrayFields[a.Field]=a}),this.enumFields=[],d.EnumFields&&d.EnumFields.forEach(function(a){var b=a.EnumField,d=a.StringField;c.enumFields[b]=c.enumFields[d]=_.clone(a),a.EnumType[a.DefaultValue]&&(c.values[b]=a.DefaultValue,c.values[d]=a.EnumType[a.DefaultValue])});var f=this.values.map(function(a,b){return b});this.snapshotBeforeChange=this.getSnapshot(f),this.changeNotifier=new a.Utilities.Process.CallLater(function(){return c.notifyChange()}),this.model={},Object.defineProperty(this.model,e,{get:function(){return c},enumerable:!1,configurable:!1});var g=this.toJSON.bind(this);Object.defineProperty(this.model,"toJSON",{get:function(){return g},enumerable:!1,configurable:!1}),this.allFields.forEach(function(a){var d=b[a];Object.defineProperty(c.model,d,{get:function(){return c.getFieldValue(a)},set:function(b){return c.setFieldValue(a,b)},enumerable:!0,configurable:!0})})}return b.prototype.getInstanceId=function(){return this.instanceId},Object.defineProperty(b.prototype,"Model",{get:function(){return this.model},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"FieldsEnumType",{get:function(){return this.fieldsEnumType},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"AllFields",{get:function(){return _.clone(this.allFields)},enumerable:!0,configurable:!0}),b.prototype.toJSON=function(){return this.getSnapshot()},b.prototype.getSnapshot=function(b){var c=this;b=b||a.Utilities.getAllEnumValues(this.fieldsEnumType);var d={};return b.forEach(function(a){d[c.fieldsEnumType[a]]=c.getFieldValue(a)}),d},b.prototype.setData=function(b,c){var d=this;if(b){var e;e=c?c.map(function(a){return d.FieldsEnumType[a]}):_.intersection(_.keys(b),a.Utilities.getAllEnumValueNames(this.FieldsEnumType)),this.startBulkEditMode(),e.forEach(function(a){d.Model[a]=b[a]}),this.endBulkEditMode()}},b.prototype.getFieldValue=function(a){var b=this.values[a];return this.isArrayField(a)&&(b=_.clone(b)||[]),b},b.prototype.setFieldValue=function(a,b){var c=a,d=this.values[c]===b,e=this.isArrayField(a);if(e){if(b=b||[],!_.isArray(b))throw Error('Type of field named "'+this.fieldsEnumType[c]+'" should be an array.');var f=this.values[c]||[];d=f.length===b.length,d=d&&!f.some(function(a,c){return a!==b[c]})}if(!d){var g=this.enumFields[a];if(g){var h=a===g.EnumField?b:g.EnumType[b];this.values[g.EnumField]=h,this.values[g.StringField]=g.EnumType[h],this.markFieldAsChanged([g.EnumField,g.StringField])}else e?this.onArrayFieldChange(c,b):this.values[c]=b,this.markFieldAsChanged([a])}},b.prototype.onArrayFieldChange=function(a,b){var c=this.arrayFields[a],d=this.values[a]||[];b=c.onAdd?b.map(function(a){return _.contains(d,a)?a:c.onAdd(a,b,d)}):_.clone(b),c.onDelete&&_.difference(d,b).forEach(function(a){c.onDelete(a,b,d)||b.push(a)}),c.comparer&&b.sort(c.comparer);var e=b.length===d.length&&!b.some(function(a,b){return a!==d[b]});e||(c.adjust&&(b=c.adjust(b)),this.values[a]=b)},b.prototype.observe=function(a,b){b&&b.length||(b=this.AllFields);var c=this.findObserver(a);c?c.Fields=_.union(c.Fields,b):(c={Callback:a,Fields:b},this.observers.push(c))},b.prototype.unobserve=function(a,b){var c=this.findObserver(a);if(c){if(b&&b.length&&(c.Fields=_.difference(c.Fields,b),c.Fields.length))return;this.observers=_.without(this.observers,c)}},b.prototype.triggerChangeNotificationImmediately=function(){this.changeNotifier.callImmediately()},b.prototype.startBulkEditMode=function(){++this.bulkChangingModeStackedCount},b.prototype.endBulkEditMode=function(){--this.bulkChangingModeStackedCount<=0&&(this.bulkChangingModeStackedCount=0,this.changeNotifier.flush())},Object.defineProperty(b.prototype,"FieldOptions",{get:function(){return{ArrayFields:[],EnumFields:[]}},enumerable:!0,configurable:!0}),b.prototype.isArrayField=function(a){return!!this.arrayFields[a]},b.prototype.markFieldAsChanged=function(a){var b=this;a.forEach(function(a){return b.changedFieldNames[b.fieldsEnumType[a]]=!0}),this.bulkChangingModeStackedCount>0?this.triggerChangeNotificationLater():this.triggerChangeNotificationImmediately()},b.prototype.triggerChangeNotificationLater=function(){this.changeNotifier.callOnceLater()},b.prototype.asInterface=function(){return this},b.prototype.notifyChange=function(){var a=this,b=this.snapshotBeforeChange,c=this.getSnapshot(),d=_.keys(this.changedFieldNames).map(function(b){return a.fieldsEnumType[b]});this.snapshotBeforeChange=c,this.changedFieldNames={},this.bulkChangingModeStackedCount=0,this.observers.forEach(function(e){var f=_.intersection(e.Fields,d);f.length&&e.Callback({Master:a.asInterface(),FieldSchemas:d,NewValues:c,OldValues:b})})},b.prototype.findObserver=function(a){return this.observers.filter(function(b){return b.Callback===a})[0]},b}();b.MasterBase=d;var e="__master__"}(c=b.Model_v2||(b.Model_v2={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(a){return React.createElement(g,a)}var d,e=a.DataProvider.ErrorCode.InnerCode;!function(a){a[a.Desktop=0]="Desktop",a[a.Mobile=1]="Mobile",a[a.Auto=2]="Auto"}(d=b.ViewMode||(b.ViewMode={}));var f;!function(a){a[a.NotSubmitted=0]="NotSubmitted",a[a.Submitting=1]="Submitting",a[a.Failed=2]="Failed",a[a.Succeed=3]="Succeed",a[a.SucceedWithQuizResult=4]="SucceedWithQuizResult"}(f=b.SubmitState||(b.SubmitState={})),b.createFormRenderer=c;var g=function(c){function g(a){var b=c.call(this,a)||this;b.defaultLanguageId=b.props.Master.Model.DefaultLanguage;var d=Forms.UX.MultiLingual.getLocaleList(),e=_.find(d,{Value:b.defaultLanguageId});return b.defaultLanguageName=e&&e.DisplayName,b.state={IsSmallScreen:$(window).width()<768,SubmitState:f.NotSubmitted,ShowDuplicateSpinner:!1,ShowErrorPage:!1,IsStudentViewMode:null!=b.props.Response,IsReportingView:!1,HideQuestions:!1,EmailReceiptConsent:!1,LocalizedResource:b.props.Master.Model.LocaleList.length&&{localeId:b.defaultLanguageId,localeName:b.defaultLanguageName},ShowSpinnerWhenChangeLanguage:!1,ShowSpinnerForFirstTimeLoadMultilingual:!1},b.updateFocus=b.updateFocus.bind(b),b.updateScreenSizeClass=b.updateScreenSizeClass.bind(b),b.update=b.update.bind(b),b.onAnswersChanged=b.onAnswersChanged.bind(b),b.onSectionIdChanged=b.onSectionIdChanged.bind(b),b.increaseUploadingFileCount=b.increaseUploadingFileCount.bind(b),b.decreaseUploadingFileCount=b.decreaseUploadingFileCount.bind(b),b.showAbuseReport=b.showAbuseReport.bind(b),b.onThankYouViewResult=b.onThankYouViewResult.bind(b),b.onBackButtonClick=b.onBackButtonClick.bind(b),b.onPreviousButton=b.onPreviousButton.bind(b),b.onNextButton=b.onNextButton.bind(b),b.onLanguageChange=b.onLanguageChange.bind(b),b}return __extends(g,c),g.prototype.componentWillMount=function(){this.formRuntimeMaster=new b.Model.FormRuntimeMaster(this.props.Master,{disableBranching:this.props.PrintView}),this.state.IsStudentViewMode?(this.resetAnswers(this.props.Response.Answers),this.formRuntimeMaster.updateWithResponse(this.props.Response),this.setServerQuizResult(this.props.Response.QuizResult),this.setState({ShowQuizResult:!0})):this.resetAnswers(this.props.PersistedAnswers),this.resetSectionId(this.props.PersistedSectionId),this.formRuntimeMaster.observeAnswerChange(this.onAnswersChanged),this.formRuntimeMaster.observe(this.onSectionIdChanged,[b.Model.FormRuntimeMaster.Schema.RuntimeSectionId]),this.formRuntimeMaster.observe(this.update,[b.Model.FormRuntimeMaster.Schema.QuestionRuntimeMasters,b.Model.FormRuntimeMaster.Schema.UploadingFileCount]),window.addEventListener("resize",this.updateScreenSizeClass)},g.prototype.componentDidMount=function(){this.props.Master;if(a.Utilities.OEmbed.notifyResponsePageHeightToParentWindow(),this.state.IsStudentViewMode){var b=this.props.Response.SubmitLanguage;if(b){var c=JSON.parse(b).localeId;this.showBestMatchLanguage(c)}}else if(this.props.Master.Model.LocaleList.length>0){var c=OfficeFormServerInfo.cultureInfo.Name.toLowerCase(),d=Nerve.Collection.getItemWithKeyFields(this.props.Master.Model.LocaleList,{localeId:c});d&&this.showBestMatchLanguage(c)}},g.prototype.componentDidUpdate=function(){a.Utilities.OEmbed.notifyResponsePageHeightToParentWindow(),$(".office-form-answerhint").linkify();var b=ReactDOM.findDOMNode(this.refs["office-form-quiz-result-container"]);b&&b.focus();var c=ReactDOM.findDOMNode(this.refs["auto-release-grade-quiz-result-container"]);c&&c.focus()},g.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.updateScreenSizeClass),this.formRuntimeMaster.observe(this.onSectionIdChanged),this.formRuntimeMaster.unobserveAnswerChange(this.onAnswersChanged),this.formRuntimeMaster.unobserve(this.update),this.formRuntimeMaster.release()},g.prototype.render=function(){var c=this;if(this.state.ShowSpinnerForFirstTimeLoadMultilingual)return this.createMultiLingualSpinnerForEmailReceipt();var e=this.props.Master.SyncContext===b.Model.FormSyncContext.SharedTimeForm;if(this.state.ShowErrorPage)return React.createElement(Forms.UX.Renderer.ErrorPage,{Error:this.error,ErrorType:"Information",FormId:this.props.Master.Model.Id,ShowCreateFormLink:!1});var g,h={className:"office-form-content office-form-page-padding"};if(e&&(h.className=a.Utilities.Html.combineAttributes(h.className,"share-page")),(this.props.ViewMode===d.Mobile||this.state.IsSmallScreen)&&(h.className=a.Utilities.Html.combineAttributes(h.className,"small-screen")),this.isMobile()&&(h.className=a.Utilities.Html.combineAttributes(h.className,"mobile-view")),this.state.SubmitState===f.Succeed||this.state.SubmitState===f.SucceedWithQuizResult&&!this.state.ShowQuizResult){var i=void 0;this.props.Master.Model.Settings.RequiresUniqueResponse||(i=function(){return c.submitAnotherResponse()});var j=void 0;this.state.SubmitState===f.SucceedWithQuizResult&&(j=this.onThankYouViewResult);var k=this.state.LocalizedResource.localeId;g=React.createElement(Forms.UX.Renderer.ThankYouPage,{FormMaster:b.Model.exportConverter(this.props.Master),LocaleId:k!==this.defaultLanguageId&&k,ShowPromotionMessage:!a.Utilities.Flight.isPPTIntegration(),submitAnother:i,viewResultsHandler:j}),a.Flighting.Flight.isEnabled("MSAIntroductionForResponder")&&Forms.Common.isOwnerMsaUser()&&!this.isMobile()&&(g=React.DOM.div(null,g,React.createElement(Forms.UX.Renderer.IntroductionForResponder)))}else if(this.state.IsReportingView)g=React.createElement(Forms.UX.Renderer.ReportPage);else{var l="ShowStatementWithNotice";this.props.Master.SyncContext===b.Model.FormSyncContext.ResponseTimeForm&&this.props.Master.Model.Settings.IsAnonymous&&(l="ShowStatement"),g=React.DOM.div(null,React.DOM.div({"aria-label":this.props.Master.Model.Title,className:"office-form office-form-theme-shadow",role:"form"},this.createDataClassificationLabel(),!this.isMobile()&&this.createMultiLingualSelect(),this.createTitleContainer(),this.createResultContainer(),React.DOM.div({className:"office-form-body"},this.createNoticeContainer(),this.createRuntimeFormContent(),this.createEmailReceiptCheckbox(),React.DOM.div({className:"office-form-button-container"},this.createPreviousSection(),this.createSubmitButton(),this.createNextSection()),this.showDuplicateMessage(),this.createValidationErrorLabel(),this.createErrorMessage(),this.createPhishingNotice(),this.createBackToThankYouLink())),React.createElement(Forms.UX.Renderer.FooterControl,{FooterType:l}))}return React.DOM.div({className:"form-content-container"},this.createDuplicateNavBar(),React.DOM.div(h,this.props.HeaderMessage&&this.createHeader(),React.createElement(Forms.UX.Renderer.ThemeRender,{ThemeMaster:this.props.Master.ThemeMaster}),this.isMobile()&&this.createMultiLingualSelect(),g),this.createMultiLingualSpinner())},g.prototype.createMultiLingualSpinner=function(){return this.state.ShowSpinnerWhenChangeLanguage?React.DOM.div({className:"multi-lingual-spinner-container"},React.DOM.div({className:"multi-lingual-blank-page"}),React.DOM.div({className:"multi-lingual-spinner"},React.DOM.div({className:"spinner-tile-animation"}))):void 0},g.prototype.createMultiLingualSpinnerForEmailReceipt=function(){return React.DOM.div({className:"multi-lingual-page-loading-background"},React.DOM.div({className:"page-loading-messagebox",tabIndex:0,"aria-label":b.Resources.LocalizedStrings.Page_LoadingMessage,"aria-live":"polite"},React.DOM.div({className:"page-loading-animation"},React.DOM.div({className:"spinner-tile-animation"})),React.DOM.div({className:"page-loading-message"},b.Resources.LocalizedStrings.Page_LoadingMessage)))},g.prototype.showBestMatchLanguage=function(a){var c=this;a!==this.defaultLanguageId&&this.props.Master.isFieldReady(b.Model.FormMaster.Schema.LocalizedResources)&&(this.setState({ShowSpinnerForFirstTimeLoadMultilingual:!0}),this.props.Master.getLocaleResouceById(a).done(function(a){var b=c.props.Master.Model.LocalizedResources,d=a.localizedResources;Nerve.Collection.getItemWithKeyFields(b,{localeId:d[0].localeId})||Nerve.Collection.itemsAddedInSource(b,d),c.setState({LocalizedResource:a&&d[0],ShowSpinnerForFirstTimeLoadMultilingual:!1})}))},g.prototype.createRuntimeFormContent=function(){return this.state.HideQuestions?null:this.props.Master.hasSection()?React.DOM.div(null,this.createSectionRenderers()):React.DOM.div(null,this.createElementRenderers(this.formRuntimeMaster.TopQuestionRuntimeMasters))},g.prototype.onThankYouViewResult=function(){this.setState({ShowQuizResult:!0})},g.prototype.createBackToThankYouLink=function(){return this.state.ShowQuizResult&&this.state.SubmitState===f.SucceedWithQuizResult?React.DOM.div({className:"office-form-quiz-back-to-result-link"},React.DOM.a({href:"javascript:void(0)",onClick:this.onBackButtonClick},b.Resources.LocalizedStrings.Response_Page_Quiz_Result_Back_To_Thank_You_Message)):void 0},g.prototype.onBackButtonClick=function(){this.setState({ShowQuizResult:!1})},g.prototype.createHeader=function(){return React.DOM.div({className:"form-header-text-message"},this.props.HeaderMessage)},g.prototype.createDuplicateSpinner=function(){return this.state.ShowDuplicateSpinner?React.DOM.div({className:"duplicate-form-spinner"},React.DOM.div({className:"spinner-tile-animation"})):void 0},g.prototype.createDuplicateNavBar=function(){var c=this,d=this.props.Master.SyncContext===b.Model.FormSyncContext.SharedTimeForm;if(d){var e=a.Control.createFontIconControl({HTMLAttributes:{className:"duplicate-form-nav-bar-icon"},IconName:"OfficeFormsLogo"}),f=React.DOM.span({className:"duplicate-form-nav-bar-title"},b.Resources.LocalizedStrings.DuplicateForm_Page_Nav_Bar_Title),g=Forms.UX.Controls.createTextButton({HTMLAttributes:{className:"office-form-copy-form-button",titel:b.Resources.LocalizedStrings.DuplicateForm_Page_Duplicate_Button_Text,onClick:function(){return c.duplicateForm()},disabled:this.state.ShowDuplicateSpinner},ButtonStyle:"LightBackground",Text:b.Resources.LocalizedStrings.DuplicateForm_Page_Duplicate_Button_Text});return React.DOM.div({className:"office-form-duplicate-form-container"},React.DOM.div({className:"office-form-duplicate-form-content"},e,f,React.DOM.div({className:"office-form-duplicate-form-button-container"},g,this.createDuplicateSpinner())))}},g.prototype.showDuplicateMessage=function(){
var a=this;return this.props.Master.SyncContext===b.Model.FormSyncContext.SharedTimeForm?React.DOM.div({className:"office-form-duplicate-message-container"},React.DOM.span(null,b.Resources.LocalizedStrings.DuplicateForm_Page_Nav_Bar_Title),React.DOM.div({className:"office-form-duplicate-form-duplicate-link office-form-theme-primary-foreground",onClick:function(){return a.duplicateForm()},disabled:this.state.ShowDuplicateSpinner},b.Resources.LocalizedStrings.DuplicateForm_Page_Duplicate_Button_Text)):void 0},g.prototype.ensureLocalizedResourceReadyToDuplicate=function(){var a=this.props.Master,c=a.Model.LocaleList;if(c.length>0){var d=a.Model.LocalizedResources;if(void 0===d||c.length>d.length){for(var e=[],f=0;f<c.length;f++){var g=c[f].localeId;if(this.props.Master.isFieldReady(b.Model.FormMaster.Schema.LocalizedResources)){var h=Nerve.Collection.getItemWithKeyFields(a.Model.LocalizedResources,{localeId:g});h||e.push(this.props.Master.getLocaleResouceById(g))}}return $.when.apply($,e).then(function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];return b.forEach(function(b){Nerve.Collection.itemsAddedInSource(a.Model.LocalizedResources,b.localizedResources)}),$.Deferred().resolve().promise()})}}return $.Deferred().resolve().promise()},g.prototype.duplicateForm=function(){var c=this,d=a.Utilities.Guid.newGuid();window.sessionStorage.setItem("FormCopy.GUID",d),a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.ShareFormPage.Copy.DuplicateButton,extraData:{CopyCorelationID:d,Time:(new Date).toUTCString()}});var e=this.props.Master;this.setState({ShowDuplicateSpinner:!0}),b.Model.FormDataSource.getDataProviderByFormId(e.Model.Id).getSharedForm(e.Model.Id).done(function(){c.ensureLocalizedResourceReadyToDuplicate().done(function(){var b=e.getSnapshotToCopy();window.sessionStorage.setItem("FormCopy.FormModelToJSON",JSON.stringify(b));var c=window.location.origin+"/Pages/DesignPage.aspx";if(Forms.AuthTokenHelper.isUserLoggedIn()||!Forms.getPageContext().Flighting.isEnabled("CookieAuth"))return void Forms.Common.redirectTo(c);var d=window.sessionStorage.getItem("FormCopy.GUID");a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.ShareFormPage.Copy.LoginToAutoCopy,extraData:{CopyCorelationID:d,Time:(new Date).toUTCString()}}),window.sessionStorage.setItem("FormCopy.LoginToAutoCopy",JSON.stringify("LoginToAutoCopy")),Forms.AuthTokenHelper.redirectToSignIn(c)})}).fail(function(a){c.error=a,c.setState({ShowErrorPage:!0,ShowDuplicateSpinner:!1})})},g.prototype.createNoticeContainer=function(){return this.state.SubmitState===f.SucceedWithQuizResult||this.state.IsStudentViewMode?void 0:React.DOM.div({className:"office-form-notice-container"},this.createRecordIdentityNotice(),this.createRequiredNotice())},g.prototype.createRecordIdentityNotice=function(){var c=this.props.Master.Model.Settings,d=this.props.Master.SyncContext===b.Model.FormSyncContext.SharedTimeForm,e=this.props.Master.hasSection()&&!!this.formRuntimeMaster.Model.RuntimeSectionId;if(d||e)return void 0;var g=void 0;if(c.IsAnonymous||c.NotRecordIdentity)g="";else{var h=OfficeFormServerInfo.userInfo.GivenName||OfficeFormServerInfo.userInfo.DisplayName;h?g=b.Resources.LocalizedStrings.Response_NonAnonymous_Notice.format(h):(a.Event.ErrorEventDeprecated.logData({errorName:"MissingUserName",errorInfo:{givenName:!!OfficeFormServerInfo.userInfo.GivenName,displayName:!!OfficeFormServerInfo.userInfo.DisplayName,userId:!!OfficeFormServerInfo.userInfo.UserId}}),g=b.Resources.LocalizedStrings.Response_NonName_Notice)}return this.state.SubmitState!==f.SucceedWithQuizResult?React.DOM.div({},React.DOM.span({className:"office-form-notice-long-text"},g)):void 0},g.prototype.createRequiredNotice=function(){var a=this.props.Master,c=[];if(a.hasSection()&&!this.showAllSectionsAtOnce()){var d=this.formRuntimeMaster.Model.RuntimeSectionId,e=a.FormElementManager.getDescriptiveElementMasterById(d);c=a.FormElementManager.findQuestionsInSection(e,!0).map(function(a){return a.Model})}else c=b.convertToArray(a.Model.Questions);return _.some(c,function(a){return a.Required})?React.DOM.div(null,React.DOM.span({className:"office-form-required-notice-star"}),React.DOM.span(null,b.Resources.LocalizedStrings.Answer_Required_Notice)):void 0},g.prototype.createResultContainer=function(){if(this.state.IsStudentViewMode||this.state.SubmitState===f.SucceedWithQuizResult){var a=this.createFormCommentContainer(),b=this.createTotalScoreBar();if(a||b)return React.DOM.div({className:"office-form-result-container"},a,b)}},g.prototype.createFormCommentContainer=function(){if(this.state.IsStudentViewMode){var c=this.props.Response.Feedback;if(c){var d=b.Resources.LocalizedStrings.RuntimeView_FormComment.format(c),e=a.Control.createRenderNewlines({content:d});return React.DOM.div({className:"office-form-formcomment-container"},React.DOM.div({className:"office-form-formcomment office-form-theme-primary-foreground"},e))}return void 0}},g.prototype.createTotalScoreBar=function(){var a=this,c=0,d=0,e=0,g=0;if((this.state.SubmitState===f.SucceedWithQuizResult||this.state.IsStudentViewMode)&&this.formRuntimeMaster.TopQuestionRuntimeMasters.forEach(function(b){var h=b.Question.Model,i=b.Question;if(h.IsQuiz)if(i.hasCorrectAnswers()&&++e,d+=h.Point||0,g+=b.Model.QuizResult&&b.Model.QuizResult.IsAnswerCorrect?1:0,a.state.SubmitState===f.SucceedWithQuizResult)c+=b.Model.QuizResult&&b.Model.QuizResult.IsAnswerCorrect?h.Point||0:0;else{var j=b.SubQuestionRuntimeMasters,k=j[j.length-1];b=k||b;var l=b.getScore();null!=l&&(c+=l)}}),e||d){var h={className:"office-form-totalscore-bar",tabIndex:-1,ref:"auto-release-grade-quiz-result-container"};if(0===d&&0===c){var i=Math.round(100*g/e)+"%";return h["aria-label"]=b.Resources.LocalizedStrings.Response_Preview_SubmitNotificationUnderAutoReleaseGrade.format(b.Resources.LocalizedStrings.Response_QuizResult_Title,i),React.DOM.div(h,React.DOM.div({className:"office-form-point-label"},b.Resources.LocalizedStrings.Quiz_Points_Text+":"),React.DOM.div({className:"office-form-score-label office-form-theme-primary-foreground"},i))}h["aria-label"]=b.Resources.LocalizedStrings.Response_Preview_SubmitNotificationUnderAutoReleaseGrade.format(b.Resources.LocalizedStrings.Response_QuizResult_Title,b.Resources.LocalizedStrings.Response_ScoreResult_Transcript.format(c,d));var j=d?d:"-";return React.DOM.div(h,React.DOM.div({className:"office-form-point-label"},b.Resources.LocalizedStrings.Quiz_Points_Text+":"),React.DOM.div({className:"office-form-score-label office-form-theme-primary-foreground"},b.Resources.LocalizedStrings.RuntimeView_TotalPoints_Content.format(c,j)))}return null},g.prototype.createValidationErrorLabel=function(){var c;c=this.formRuntimeMaster.Form.hasSection()?this.formRuntimeMaster.getQuestionsWithWrongAnswer(this.formRuntimeMaster.SectionTopQuestionRuntimeMasters):this.formRuntimeMaster.getQuestionsWithWrongAnswer(this.formRuntimeMaster.TopQuestionRuntimeMasters);var d,e=c.map(function(a){return b.Resources.LocalizedStrings.Form_QuestionWithOrdinal.format(a)}).join(b.Resources.LocalizedStrings.Common_ItemSeperator);d=this.formRuntimeMaster.Form.hasSection()&&null!=this.nextSection()?b.Resources.LocalizedStrings.Section_Question_Error_Message.format(c.length,e):b.Resources.LocalizedStrings.Form_Question_Error_Message.format(c.length,e);var f=a.Control.createFontIconControl({HTMLAttributes:{className:"office-form-alert-icon forms-icon-size24x24"},IconName:"IncidentTriangle"}),g=!!this.state.ShowValidationStyle&&!!c.length;return React.DOM.div({className:a.Utilities.Html.combineAttributes("office-form-submit-error",g?"":"NotVisible"),role:"alert"},f,React.DOM.span({className:"error-message"},g?d:""))},g.prototype.showMultiLingualSelect=function(){var a=this.props.Master.Model.LocaleList;return!Forms.getPageContext().Flighting.isEnabled("MultiLingualMVP1")||!a.length||this.state.IsStudentViewMode||!this.showAllSectionsAtOnce()&&this.formRuntimeMaster.Model.RuntimeSectionId?!1:!0},g.prototype.createMultiLingualSelect=function(){if(this.showMultiLingualSelect()){var b=(this.props.Master,this.props.Master.Model.LocaleList),c=[];c.push({DisplayName:this.defaultLanguageName,Key:"default-language",Value:this.defaultLanguageId});var d=(_.forEach(b,function(a,b){c.push({DisplayName:a.localeName||"",Key:a.localeId,Value:a.localeId||""})}),"multi-lingual-select-control office-form-theme-secondary-background");return this.isMobile()&&(d=a.Utilities.Html.combineAttributes(d,"isMobile")),a.Control.createSelect({HTMLAttributes:{className:d},onValueChange:this.onLanguageChange,Placeholder:c[0]&&c[0].DisplayName,PlaceholderIcon:"World",SelectOptions:c,Value:this.state.LocalizedResource.localeId})}},g.prototype.createDataClassificationLabel=function(){var c=this.props.Master,d=c.SyncContext===b.Model.FormSyncContext.SharedTimeForm;if(!(this.isMobile()||!this.showAllSectionsAtOnce()&&this.formRuntimeMaster.Model.RuntimeSectionId)&&(this.props.PrintView||Forms.getPageContext().Flighting.isEnabled("DataClassificationRuntime")&&!OfficeFormServerInfo.userInfo.IsMsa&&d&&c.isFieldReady(b.Model.FormMaster.Schema.DataClassificationLabel)&&c.Model.DataClassificationLabel)){var e=a.Utilities.Html.combineAttributes(this.showMultiLingualSelect()?"office-form-duplicate-classification-label-with-multilingual":"office-form-duplicate-classification-label-without-multilingual","office-form-duplicate-classification-label","office-form-theme-secondary-background");return React.createElement(Forms.UX.Designer.DataClassificationLabel,{FormMaster:b.Model.exportConverter(this.props.Master),HTMLAttributes:{className:e},DesignTimeView:!1})}},g.prototype.onLanguageChange=function(c){var d=this;a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.ResponsePage.MultiLingual.ChangeLanguage,extraData:{LocaleId:c}}),b.Resources.loadLanguageStrings(c).done(function(){if(c===d.defaultLanguageId)return void d.setState({LocalizedResource:{localeId:d.defaultLanguageId,localeName:d.defaultLanguageName}});if(d.props.Master.isFieldReady(b.Model.FormMaster.Schema.LocalizedResources)){var a=Nerve.Collection.getItemWithKeyFields(d.props.Master.Model.LocalizedResources,{localeId:c});a?d.setState({LocalizedResource:a}):d.getLocaleResourceByLocaleId(c)}})},g.prototype.getLocaleResourceByLocaleId=function(a){var b=this;this.setState({ShowSpinnerWhenChangeLanguage:!0}),this.props.Master.getLocaleResouceById(a).done(function(a){Nerve.Collection.itemsAddedInSource(b.props.Master.Model.LocalizedResources,a.localizedResources),b.setState({LocalizedResource:a&&a.localizedResources[0],ShowSpinnerWhenChangeLanguage:!1})})},g.prototype.createTitleContainer=function(){var c=(this.props.Master,this.state.LocalizedResource.localeId);return Forms.UX.Renderer.createTitleContainer({Form:b.Model.exportConverter(this.props.Master),LocaleId:c!==this.defaultLanguageId&&c,IsMobile:this.props.ViewMode===d.Mobile||a.Utilities.isMobile(),IsSlimTitle:!this.showAllSectionsAtOnce()&&!!this.formRuntimeMaster.Model.RuntimeSectionId})},g.prototype.createSectionRenderer=function(b,c){var e=this.formRuntimeMaster.Form.getDescriptiveElementMasterById(b),f=this.state.LocalizedResource.localeId,g=[];this.showAllSectionsAtOnce()&&g.push(React.createElement(Forms.UX.Renderer.SectionBreaker,{HasTheme:!this.isMobile(),key:"form-section-breaker-"+b}));var h=this.createElementRenderers(this.formRuntimeMaster.getRuntimeQuestionsWithSectionId(b));return g.push(React.createElement(Forms.UX.Renderer.SectionRender,{children:h,Disabled:!0,DisableShuffle:!0,Expaned:!0,IsMobile:this.props.ViewMode===d.Mobile||a.Utilities.isMobile(),LocaleId:f!==this.defaultLanguageId&&f,Ordinal:c+1,key:"form-section-container-"+b,SectionMaster:e})),g},g.prototype.createSectionRenderers=function(){var a=this;if(this.showAllSectionsAtOnce())return[this.createElementRenderers(this.formRuntimeMaster.getRuntimeQuestionsWithSectionId()),this.formRuntimeMaster.Form.FormElementManager.SectionMasters.map(function(b,c){return a.createSectionRenderer(b.Model.Id,c)})];var b=this.formRuntimeMaster.Model.RuntimeSectionId;if(b){var c=_.findIndex(this.formRuntimeMaster.Form.FormElementManager.SectionMasters,function(a){return a.Model.Id===b});return this.createSectionRenderer(b,c)}return this.createElementRenderers(this.formRuntimeMaster.getRuntimeQuestionsWithSectionId())},g.prototype.createElementRenderers=function(a){var c=this;if(a.length<=0)return null;var d,e=this.state.ShowValidationStyle,g=this.state.ShowQuizResult;this.props.Master;return d=_.indexOf(this.formRuntimeMaster.TopQuestionRuntimeMasters,a[0])+1,a.map(function(a,h){var i=a.Question.Model.Id,j=(_.indexOf(c.formRuntimeMaster.TopQuestionRuntimeMasters,a),c.state.LocalizedResource.localeId),k={Master:b.Model.exportConverter(a),LocaleId:j!==c.defaultLanguageId&&j,Ordinal:d+h,Disabled:c.state.SubmitState===f.SucceedWithQuizResult||c.state.IsStudentViewMode,key:i,IsMobile:c.isMobile(),ShowValidationStyle:e,ShowQuizResult:g,ShowPhishingWarning:c.showPhishingInfo(),HideMedia:!1,IsStudentViewMode:c.state.IsStudentViewMode,HideDeleteButton:c.state.SubmitState===f.Submitting||c.state.SubmitState===f.SucceedWithQuizResult||c.state.IsStudentViewMode,increaseUploadingFileCountCallBack:c.increaseUploadingFileCount,decreaseUploadingFileCountCallBack:c.decreaseUploadingFileCount,setAbuseReportStateCallBack:c.showAbuseReport};return Forms.UX.Renderer.createRendererElement(k)})},g.prototype.createNextSection=function(){return this.isSectionInProgress()?React.DOM.div({className:"office-form-bottom-button-div"},Forms.UX.Controls.createTextButton({HTMLAttributes:{"aria-label":b.Resources.LocalizedStrings.Renderer_NextButtonText,className:"office-form-bottom-button office-form-theme-button",disabled:!!this.formRuntimeMaster.Model.UploadingFileCount,onClick:this.onNextButton},ButtonStyle:"LightBackground",Text:b.Resources.LocalizedStrings.Renderer_NextButtonText})):null},g.prototype.createPreviousSection=function(){if(!this.props.Master.hasSection()||this.showAllSectionsAtOnce()||null==this.formRuntimeMaster.Model.RuntimeSectionId)return null;var a=this.state.SubmitState===f.Submitting||!!this.formRuntimeMaster.Model.UploadingFileCount;return React.DOM.div({className:"office-form-bottom-button-div"},Forms.UX.Controls.createTextButton({HTMLAttributes:{"aria-label":b.Resources.LocalizedStrings.Renderer_PrevButtonText,className:"office-form-bottom-button office-form-dark-theme-button gray-background",disabled:a,onClick:this.onPreviousButton},ButtonStyle:"LightBackground",Text:b.Resources.LocalizedStrings.Renderer_PrevButtonText}))},g.prototype.createErrorMessage=function(){var b=a.Control.createFontIconControl({HTMLAttributes:{className:"office-form-alert-icon forms-icon-size24x24"},IconName:"IncidentTriangle"}),c=this.state.SubmitState===f.Failed;return React.DOM.div({className:a.Utilities.Html.combineAttributes("office-form-submit-error",c?"":"NotVisible"),role:"alert"},b,React.DOM.span({className:"error-message"},c?this.state.ErrorMessage:""))},g.prototype.calculateTranscript=function(){if(this.state.SubmitState===f.SucceedWithQuizResult){var a=this.formRuntimeMaster.TopQuestionRuntimeMasters,c=this.formRuntimeMaster.TopQuestionRuntimeMasters.filter(function(a){return a.Question.Model.IsQuiz}).length;if(c){var d=a.filter(function(a){return a.Model.QuizResult&&a.Model.QuizResult.IsAnswerCorrect}).length;return b.Resources.LocalizedStrings.Response_QuizResult_Transcript.format(d,c)}}},g.prototype.isSectionInProgress=function(){return!this.showAllSectionsAtOnce()&&this.formRuntimeMaster.Form.hasSection()&&null!=this.nextSection()},g.prototype.createSubmitButton=function(){var c=this;if(!this.isSectionInProgress()&&this.state.SubmitState!==f.SucceedWithQuizResult&&!this.state.IsStudentViewMode){var d=this.state.SubmitState===f.Submitting,e=d||this.props.Master.SyncContext===b.Model.FormSyncContext.SharedTimeForm||this.props.DisableSubmitButton||a.Utilities.isOEmbedSPOPreview()||this.formRuntimeMaster.Model.UploadingFileCount;return React.DOM.div({className:"__submit-button-div__ office-form-bottom-button-div"},Forms.UX.Controls.createTextButton({HTMLAttributes:{className:a.Utilities.Html.combineAttributes("__submit-button__ office-form-bottom-button office-form-theme-button",d?"office-form-hide-text":""),disabled:e,title:a.Utilities.isOEmbedSPOPreview()?b.Resources.LocalizedStrings.Renderer_SubmitButtonSPODisabledTitle:void 0,onClick:function(){c.submitResponse();var d={},e=c.props.Master.Model;c.formRuntimeMaster.TopQuestionRuntimeMasters.forEach(function(a){var b=a.Question.Model;if(d[b.Type]=d[b.Type]||0,++d[b.Type],b.IsMathQuiz){var c=b.Type+".Math";d[c]=d[c]||0,++d[c]}});var f=c.formRuntimeMaster.TopQuestionRuntimeMasters.some(function(a){var b=a.Question.Model;return!!(b.Title&&b.Title.match(/passw(o|0)rd/i)||b.Subtitle&&b.Subtitle.match(/passw(o|0)rd/i))}),g=function(a,b){return a+(b&&b.Answer?JSON.stringify(b.Answer).length:0)},h=c.formRuntimeMaster.Answers?b.convertToArray(c.formRuntimeMaster.Answers):[],i={withBranching:e.HasValidBranching,allQuestionCount:e.Questions.length,branchedQuestionCounts:d,hasPhishingKeywords:f,allAnswersLength:_.reduce(h,g,0)};if(a.Flighting.Flight.isEnabled("EmailReceipt")){var j=c.props.Master.Model;!j.EmailReceiptEnabled||j.Settings.IsAnonymous||j.Settings.NotRecordIdentity||(i.emailReceiptConsent=c.state.EmailReceiptConsent)}a.Flighting.Flight.isEnabled("SectionMVP1")&&(i.withSection=c.props.Master.hasSection()),a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.ResponsePage.Form.Submit,extraData:i})}},ButtonStyle:"LightBackground",Text:d?b.Resources.LocalizedStrings.Response_Page_Submitting_Message:b.Resources.LocalizedStrings.Renderer_SubmitButtonText}),this.createSpinner())}},g.prototype.createSpinner=function(){return this.state.SubmitState===f.Submitting?React.DOM.div({className:"submit-spinner"},React.DOM.div({className:"spinner-tile-animation"},React.createElement(Forms.UX.Controls.LiveRegion,{HTMLAttributes:{className:"screenReaderVisible"},LazyRendering:!0,Role:"Log",children:b.Resources.LocalizedStrings.Response_Page_Submitting_Message}))):void 0},g.prototype.submitResponse=function(){var c=this;if(this.formRuntimeMaster.getQuestionsWithWrongAnswer(this.formRuntimeMaster.TopQuestionRuntimeMasters).length>0)return void this.setState({ShowValidationStyle:!0},g.scrollToShowSubmitError);this.setState({SubmitState:f.Submitting});var d,h;Forms.getPageContext().Flighting.isEnabled("MultiLingualMVP1")&&(h=this.state.LocalizedResource.localeId,h&&(d=h!=this.defaultLanguageId?_.find(this.props.Master.Model.LocaleList,function(a){return a.localeId===h}):{localeId:h,localeName:this.defaultLanguageName}));var i={StartDate:this.startTime,SubmitDate:new Date,Answers:this.formRuntimeMaster.Answers,SubmitLanguage:d&&JSON.stringify(d)};if(a.Flighting.Flight.isEnabled("EmailReceipt")){var j=this.props.Master.Model;!j.EmailReceiptEnabled||j.Settings.IsAnonymous||j.Settings.NotRecordIdentity||(i.EmailReceiptConsent=this.state.EmailReceiptConsent)}var k=this.props.Master;k.submitResponse(i).done(function(b){var d=c.formRuntimeMaster.Model.QuestionRuntimeMasters;k.Model.Settings.ShowGradedResults!==!1&&Nerve.convertToArray(d).filter(function(a){return a.Question.Model.IsQuiz}).length?(c.setServerQuizResult(b&&b.quizResult),c.setState({ShowQuizResult:!1,SubmitState:f.SucceedWithQuizResult,ErrorMessage:void 0},g.scrollToTop)):c.setState({SubmitState:f.Succeed,ErrorMessage:void 0},g.scrollToTop);var e=c.props.persistSectionId;e&&e();var h=c.props.persistAnswer;h&&h(void 0),a.EnvironmentSettings.IsAssignmentsIntegration&&k.IsAssignmentForm&&window.parent.postMessage("FormResponseSubmitted","*"),c.formRuntimeMaster.clearOD4BTempFolder()}).fail(function(d){if(d.innerCode&&d.innerCode===e.AntiForgeryTokenValidationError)Forms.Common.reloadPage();else{var g=b.Resources.LocalizedStrings.Error_Inline_DefaultMessage;if(d.innerCode){if(g=b.Resources.LocalizedStrings["Error_Message_"+d.innerCode]||b.Resources.LocalizedStrings.Error_Inline_DefaultMessage,d.innerCode===e.FormClosed){var i=void 0,j=void 0;if(h&&h!==c.defaultLanguageId&&(i=Forms.Models.FormLocalizedItemMaster.getFormResourceMaster(h,b.Model.exportConverter(k)),j=i.Model.formCloseMessage),j)g=b.Resources.LocalizedStrings["Error_Message_"+d.innerCode+"_title"]+". "+j;else{var l="Inner Message:",m=d.innerMessage.indexOf("Inner Message:")+l.length,n=d.innerMessage.length;g=b.Resources.LocalizedStrings["Error_Message_"+d.innerCode+"_title"]+". "+d.innerMessage.substring(m,n).trim()}}d.innerCode===e.EmbedFormNeedAuth&&(g=b.Resources.LocalizedStrings.Error_Inline_RefreshMessage),(d.innerCode===e.CDBTopLevelError||d.innerCode===e.CdbServiceUnavailable)&&(g=b.Resources.LocalizedStrings.Error_Inline_DelayTryMessage)}a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.Error.InlineError.ShowAtSubmitResponse,extraData:{Error:d,ErrorMessage:g||void 0}}),c.setState({SubmitState:f.Failed,ErrorMessage:g})}})},g.prototype.submitAnotherResponse=function(){var b=this;a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.ResponsePage.ThanksView.SubmitAnother}),this.resetAnswers(),this.resetSectionId(),this.formRuntimeMaster.updateWithResponse(null),this.setState({ErrorMessage:void 0,ShowValidationStyle:!1,ShowQuizResult:!1,SubmitState:f.NotSubmitted,IsStudentViewMode:!1,HideQuestions:!0,EmailReceiptConsent:!1},function(){b.setState({HideQuestions:!1},g.scrollToTop)})},g.prototype.resetAnswers=function(a){this.startTime=new Date,this.formRuntimeMaster.clearQuizResult(),this.formRuntimeMaster.Answers=a||[]},g.prototype.resetSectionId=function(a){this.formRuntimeMaster.Model.RuntimeSectionId=a||null},g.prototype.setServerQuizResult=function(b){if(b){var c=a.Utilities.tryParseJson(b);Array.isArray(c)&&this.formRuntimeMaster.setQuizResults(c)}else this.formRuntimeMaster.calculateQuizResultFromModel()},g.prototype.isMobile=function(){switch(this.props.ViewMode){case d.Desktop:return!1;case d.Mobile:return!0;case d.Auto:return a.Utilities.isMobile();default:throw Error("unknown view mode")}},g.prototype.onAnswersChanged=function(){var a=this.props.persistAnswer;a&&a(this.formRuntimeMaster.isDefaultAnswer()?void 0:b.convertToArray(this.formRuntimeMaster.Answers))},g.prototype.onSectionIdChanged=function(){var a=this.props.persistSectionId;a&&(null==this.formRuntimeMaster.Model.RuntimeSectionId?a():a(this.formRuntimeMaster.Model.RuntimeSectionId))},g.prototype.increaseUploadingFileCount=function(){this.formRuntimeMaster.Model.UploadingFileCount++},g.prototype.decreaseUploadingFileCount=function(){this.formRuntimeMaster.Model.UploadingFileCount>0&&this.formRuntimeMaster.Model.UploadingFileCount--},g.prototype.showAbuseReport=function(){this.setState({IsReportingView:!0})},g.prototype.updateScreenSizeClass=function(){a.Utilities.isSmallScreen()!==this.state.IsSmallScreen?this.setState({IsSmallScreen:!this.state.IsSmallScreen}):a.Utilities.OEmbed.notifyResponsePageHeightToParentWindow()},g.prototype.createPhishingNotice=function(){var c=this;if(this.showPhishingInfo())return React.DOM.div({className:"office-form-notice-password"},b.Resources.LocalizedStrings.Response_Page_Footer_Notice,React.DOM.a({className:a.Utilities.isOEmbedSPO()?"office-form-notice-report office-form-theme-spo-link":"office-form-notice-report",href:"javascript:void(0)",onClick:function(){return c.setState({IsReportingView:!0})}},b.Resources.LocalizedStrings.Response_Page_Footer_Report))},g.prototype.showPhishingInfo=function(){var c=this.props.Master.Model.Settings,d=this.props.Master.SyncContext===b.Model.FormSyncContext.ResponseTimeForm;return!c.IsAnonymous||!d||this.state.ShowQuizResult||a.EnvironmentConfig.isSovereignProd()?!1:!0},g.scrollToTop=function(){a.Utilities.Html.scrollToShowSubelement($(".office-form-title-container"),$(".office-form-content"),void 0,void 0,!0)},g.scrollToShowTranscript=function(){a.Utilities.Html.scrollToShowSubelement($(".office-form-bottom-bar"),$(".office-form-content"),void 0,10,!0)},g.scrollToShowSubmitError=function(){a.Utilities.Html.scrollToShowSubelement($(".office-form-submit-error"),$(".office-form-content"),void 0,20,!0)},g.prototype.createEmailReceiptCheckbox=function(){var c=this,d=this.props.Master.Model,e=a.Flighting.Flight.isEnabled("EmailReceipt")&&d.EmailReceiptEnabled&&!d.Settings.IsAnonymous&&!d.Settings.NotRecordIdentity&&!this.state.ShowQuizResult&&!this.isSectionInProgress();return e&&a.Control.createCheckBox({HTMLAttributes:{className:"office-form-email-receipt-checkbox"},Value:this.state.EmailReceiptConsent,Description:b.Resources.LocalizedStrings.Response_Page_EmailReceipt_Checkbox_Description,SpanClassName:"office-form-email-receipt-checkbox-description",onValueChange:function(a){c.setState({EmailReceiptConsent:a})}})},g.prototype.finishedAllRequiredOnThisPage=function(){return this.formRuntimeMaster.getQuestionsWithWrongAnswer(this.formRuntimeMaster.SectionTopQuestionRuntimeMasters).length>0?(this.setState({ShowValidationStyle:!0},g.scrollToShowSubmitError),!1):!0},g.prototype.nextSection=function(){var a,b=this.formRuntimeMaster;if(null==b.Model.RuntimeSectionId)a=b.Form.hasSection()?_.min(b.Form.FormElementManager.SectionMasters,function(a){return a.Model.Order}):null;else{var c=b.Form.getDescriptiveElementMasterById(b.Model.RuntimeSectionId);a=_.find(b.Form.FormElementManager.SectionMasters,function(a){return a.Model.Order>c.Model.Order})}return a},g.prototype.previousSection=function(){var a=this.formRuntimeMaster,b=a.Form.getDescriptiveElementMasterById(a.Model.RuntimeSectionId),c=a.Form.FormElementManager.SectionMasters,d=_.findLastIndex(c,function(a){return a.Model.Order<b.Model.Order});return null==a.Model.RuntimeSectionId||0>d?null:c[d]},g.prototype.onPreviousButton=function(){var a=this.previousSection();null==a?this.formRuntimeMaster.Model.RuntimeSectionId=null:this.formRuntimeMaster.Model.RuntimeSectionId=a.Model.Id,this.updateFocus()},g.prototype.onNextButton=function(){(this.props.Master.SyncContext===b.Model.FormSyncContext.SharedTimeForm||this.finishedAllRequiredOnThisPage())&&(this.formRuntimeMaster.Model.RuntimeSectionId=this.nextSection().Model.Id,this.updateFocus())},g.prototype.showAllSectionsAtOnce=function(){return this.state.ShowQuizResult||this.props.PrintView},g.prototype.updateFocus=function(){var a=this;this.setState({ShowValidationStyle:!1},g.scrollToTop),this.forceUpdate(function(){Forms.UX.Utilities.focusOnFirstFocusableElement(ReactDOM.findDOMNode(a))})},g.prototype.update=function(){this.forceUpdate()},g}(a.ReactComponent)}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(a){return React.createElement(f,{Image:b.Model.exportConverter(a.Image),ImageSettings:b.Model.exportConverter(a.ImageSettings),ImageType:a.ImageType})}function d(a){return React.DOM.div({className:"image-spinner",id:a&&e(a)},React.DOM.div({className:"spinner-tile-animation"}))}function e(a){return"imageSpinner-"+a.ResourceId}b.createImageRenderer=c,b.createImageSpinner=d,a.Exports.createImageSpinner=d;var f=function(c){function d(){var a=null!==c&&c.apply(this,arguments)||this;return a.mounted=!0,a.update=function(){return a.forceUpdate()},a.drawCanvasCallback=function(){return a.drawImageCanvas()},a}return __extends(d,c),d.prototype.componentDidMount=function(){var a=b.Model.ImageInfoMaster.Schema,c=b.Model.ImageSettingsMaster.Schema;this.props.ImageSettings.observe(this.update),this.props.Image.observe(this.update,[a.ResourceUrl,a.ContentType,a.OriginalFileName]),this.props.ImageSettings.observe(this.drawCanvasCallback,[c.ContainerHeight,c.ContainerWidth,c.Left,c.Top]),this.props.Image.observe(this.drawCanvasCallback,[a.AltText]),this.applyImageEdit()},d.prototype.componentDidUpdate=function(){this.applyImageEdit()},d.prototype.componentWillUnmount=function(){this.mounted=!1,this.props.ImageSettings.unobserve(this.update),this.props.Image.unobserve(this.update),this.props.ImageSettings.unobserve(this.drawCanvasCallback),this.props.Image.unobserve(this.drawCanvasCallback)},d.prototype.render=function(){var b=this,c=this.props.Image.Model,d=this.props.ImageSettings.validateImageSettings(!0),e=0;return React.DOM.img({src:c.ResourceUrl,title:c.AltText,alt:c.AltText,height:d.ContainerHeight+"px",width:d.ContainerWidth+"px",style:{visibility:"hidden"},onLoad:function(){a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.Image.ImageOnLoad.Success,extraData:{imageType:b.props.ImageType,location:"1"}})},onError:function(d){if(3>e&&"Response"===a.EnvironmentConfig.getPageType()){var f=ReactDOM.findDOMNode(b);e++;var g=c.ResourceUrl+"?"+e;window.setTimeout(function(){$(f).attr("src",g)},1e3)}else a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.Image.ImageOnLoad.Failure,extraData:{imageSrc:c.ResourceUrl,imageType:b.props.ImageType,location:"1"}})}})},d.prototype.applyImageEdit=function(){var b=this,c=this.props.Image&&this.props.Image.Model;if(c&&c.ResourceUrl&&!this.underSyncing()){var d=ReactDOM.findDOMNode(this),f=0;d&&this.props.ImageSettings&&(d.onload=function(){return b.drawImageCanvas()},d.onerror=function(g){if(3>f&&"Response"===a.EnvironmentConfig.getPageType()){f++;var h=c.ResourceUrl+"?"+f;window.setTimeout(function(){$(d).attr("src",h)},1e3)}else{a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.Image.CanvasOnLoad.Failure,extraData:{imageSrc:d.src,imageType:b.props.ImageType,location:"1"}});var i=document.getElementById(e(c));i&&$(i).css("display","none"),$(d).css("visibility","visible")}})}},d.prototype.drawImageCanvas=function(){if(this.mounted){var b=this.props.Image&&this.props.Image.Model;if(b&&b.ResourceUrl&&!this.underSyncing()){var c=ReactDOM.findDOMNode(this);if($(c).siblings("canvas").remove(),c&&this.props.ImageSettings)try{var d=document.createElement("canvas"),f=this.props.ImageSettings.validateImageSettings(!0);null!=b.AltText&&(d.title=b.AltText),d.tabIndex=-1;var g=1*f.NaturalWidth/f.ActualWidth,h=Math.abs(f.Left*g);h=Math.floor(Math.min(h,f.NaturalWidth));var i=Math.abs(f.Top*g);i=Math.floor(Math.min(i,f.NaturalHeight));var j=f.ContainerWidth*g||f.NaturalWidth;j=Math.floor(Math.min(j,f.NaturalWidth));var k=f.ContainerHeight*g||f.NaturalHeight;k=Math.floor(Math.min(k,f.NaturalHeight));try{var l=isNaN(window.devicePixelRatio)?1:window.devicePixelRatio;l=Math.ceil(Math.max(l,g)),d.width=Math.floor(f.ContainerWidth*l),d.height=Math.floor(f.ContainerHeight*l);var m=d.getContext("2d");m.drawImage(c,h,i,j,k,0,0,d.width,d.height)}catch(n){$(c).css("visibility","visible");var o=n.message||void 0,p=n.stack||void 0;return void a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.Image.CanvasRender.Failure,extraData:{imageSrc:c.src,imageType:this.props.ImageType,location:"1",error:o+" "+p,Exception:"DrawImageCanvas"}})}var q=document.getElementById(e(b));q&&$(q).css("display","none"),$(c).css("display","none"),$(c).parent().append(d),a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.Image.CanvasRender.Success,extraData:{imageType:this.props.ImageType,location:"1"}}),a.Utilities.OEmbed.notifyResponsePageHeightToParentWindow()}catch(n){var o=n.message||void 0,p=n.stack||void 0;throw a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.Image.CanvasRender.Failure,extraData:{imageSrc:c.src,imageType:this.props.ImageType,location:"1",error:o+" "+p,Exception:"CreateImageCanvas"}}),n}}}},d.prototype.underSyncing=function(){var a=this.props.Image.Model,c=this.props.ImageSettings.Model;return a.ResourceId!==c.TargetResourceId||a.ImageProcessingStatus!==b.Model.ImageProcessingStatus.Idle},d}(a.ReactComponent);a.Exports.ImageRenderer=f}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(a){return React.createElement(e,a)}var d=a.DataProvider.ErrorCode.InnerCode;
b.createPollRenderer=c;var e=function(c){function e(a){var d=c.call(this,a)||this;return d.updateScreenSizeClassCallback=function(){return d.updateScreenSizeClass()},d.state={IsSmallScreen:$(window).width()<768,SubmitState:b.PollUtil.isDetailResultView()?b.SubmitState.Succeed:b.SubmitState.NotSubmitted,ShowErrorPage:!1,ResponderEmail:OfficeFormServerInfo.userInfo.Email},d}return __extends(e,c),e.prototype.componentWillMount=function(){this.formRuntimeMaster=new b.Model.FormRuntimeMaster(this.props.Master),this.resetAnswers(),window.addEventListener("resize",this.updateScreenSizeClassCallback)},e.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.updateScreenSizeClassCallback)},e.prototype.render=function(){var c=this;if(this.state.ShowErrorPage)return React.createElement(Forms.UX.Renderer.ErrorPage,{Error:this.error,ErrorType:"Information",FormId:this.props.Master.Model.Id,ShowCreateFormLink:!1});var d,e={className:"office-poll office-form-content office-form-page-padding"};if((this.props.ViewMode===b.ViewMode.Mobile||this.state.IsSmallScreen)&&(e.className=a.Utilities.Html.combineAttributes(e.className,"small-screen")),this.isMobile()&&(e.className=a.Utilities.Html.combineAttributes(e.className,"mobile-view")),this.state.SubmitState===b.SubmitState.Succeed){var f=void 0;this.props.Master.Model.Settings.RequiresUniqueResponse||(f=function(){return c.submitAnotherResponse()}),d=b.createPollResultView({ShowPromotionMessage:!0,submitAnother:f,beforePromotion:function(){a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.ResponsePage.PollResultView.NavigateToPortal})},Form:this.props.Master})}else d=React.DOM.div(null,React.DOM.div({"aria-label":this.props.Master.Model.Title,className:"office-form office-form-theme-shadow",role:"form"},this.createTitleContainer(),React.DOM.div({className:"office-form-body"},this.createNoticeContainer(),React.DOM.div(null,this.createElementRenderers()),this.showCollectEmailTextbox(),this.createSubmitButton(),this.showViewResultLink(),this.createValidationErrorLabel(),this.createErrorMessage())),React.createElement(Forms.UX.Renderer.FooterControl,{FooterType:"ShowStatementWithNotice"}));return React.DOM.div({className:"form-content-container"},React.DOM.div(e,React.createElement(Forms.UX.Renderer.ThemeRender,{ThemeMaster:this.props.Master.ThemeMaster}),d))},e.prototype.createNoticeContainer=function(){return React.DOM.div({className:"office-form-notice-container"},this.createRecordIdentityNotice(),this.createRequiredNotice())},e.prototype.createRecordIdentityNotice=function(){var a=this.props.Master.Model.Settings;if(a.IsAnonymous||a.NotRecordIdentity)return void 0;var c=OfficeFormServerInfo.userInfo.GivenName;return React.DOM.div({},React.DOM.span({className:"office-form-notice-long-text"},b.Resources.LocalizedStrings.Response_NonAnonymous_Notice.format(c)))},e.prototype.createRequiredNotice=function(){return _.some(this.props.Master.Model.Questions,function(a){return a.Required})?React.DOM.div(null,React.DOM.span({className:"office-form-required-notice-star"}),React.DOM.span(null,b.Resources.LocalizedStrings.Answer_Required_Notice)):void 0},e.prototype.createValidationErrorLabel=function(){var c=this.formRuntimeMaster.getQuestionsWithWrongAnswer(this.formRuntimeMaster.TopQuestionRuntimeMasters),d=c.map(function(a){return b.Resources.LocalizedStrings.Form_QuestionWithOrdinal.format(a)}).join(b.Resources.LocalizedStrings.Common_ItemSeperator),e=b.Resources.LocalizedStrings.Form_Question_Error_Message.format(c.length,d),f=a.Control.createFontIconControl({HTMLAttributes:{className:"office-form-alert-icon forms-icon-size24x24"},IconName:"IncidentTriangle"}),g=!!this.state.ShowValidationStyle&&!!c.length;return React.DOM.div({className:a.Utilities.Html.combineAttributes("office-form-submit-error",g?"":"NotVisible"),role:"alert"},f,React.DOM.span({className:"error-message"},g?e:""))},e.prototype.createTitleContainer=function(){return React.DOM.div({className:"office-poll-title-container office-form-theme-primary-background"})},e.prototype.createElementRenderers=function(){var a=this,c=this.state.ShowValidationStyle;return Nerve.convertToArray(this.formRuntimeMaster.Model.QuestionRuntimeMasters).map(function(d,e){var f=d.Question.Model.Id,g={Master:b.Model.exportConverter(d),Ordinal:e+1,Disabled:!1,ExpandAll:!0,key:f,IsMobile:a.isMobile(),ShowValidationStyle:c,ShowQuizResult:!1,HideMedia:!1,IsStudentViewMode:!1};return Forms.UX.Renderer.createRendererElement(g)})},e.prototype.createErrorMessage=function(){var c=a.Control.createFontIconControl({HTMLAttributes:{className:"office-form-alert-icon forms-icon-size24x24"},IconName:"IncidentTriangle"}),d=this.state.SubmitState===b.SubmitState.Failed;return React.DOM.div({className:a.Utilities.Html.combineAttributes("office-form-submit-error",d?"":"NotVisible"),role:"alert"},c,React.DOM.span({className:"error-message"},d?this.state.ErrorMessage:""))},e.prototype.createReloadLink=function(){var a=this;return this.props.Master.Model.Settings.RequiresUniqueResponse?void 0:React.DOM.a({href:"javascript:void(0)",onClick:function(){return a.submitAnotherResponse()}},b.Resources.LocalizedStrings.Response_Submit_Again_Link)},e.prototype.showCollectEmailTextbox=function(){var c=this;return React.DOM.div({className:"design-question-choice-label"},React.DOM.div({className:"poll-email-label"},b.Resources.LocalizedStrings.Response_Poll_Email_Label,React.createElement(a.Control.RequiredStar)),a.Control.createTextField({Value:this.state.ResponderEmail,AutoSelection:!0,Placeholder:b.Resources.LocalizedStrings.Response_Poll_Email_Placeholder,HTMLAttributes:{className:"inline-display poll-email-textbox"},onValueChange:function(a){var b=!a||!a.trim();c.setState({ResponderEmail:a,ShowValidationStyle:b})}}),this.state.ShowValidationStyle?React.DOM.div({className:"poll-email-validation-error"},a.Control.createLabel({HTMLAttributes:{className:"validation-error-message-label",role:"alert"},Label:b.Resources.LocalizedStrings.Response_Poll_Email_ValidationError,Alert:!0})):void 0)},e.prototype.showViewResultLink=function(){var a=this;return React.DOM.span({className:"poll-view-result-link"},React.DOM.a({className:"office-form-info-premotion office-form-info-children",href:"javascript:void(0)",onClick:function(){a.setState({SubmitState:b.SubmitState.Submitting});var c=a.props.Master;$.when(c.ensureFieldsReady([b.Model.FormMaster.Schema.Questions,b.Model.FormMaster.Schema.DescriptiveElements,b.Model.FormMaster.Schema.Responses]),c.syncRuntimeResponses()).then(function(){a.setState({SubmitState:b.SubmitState.Succeed})})}},b.Resources.LocalizedStrings.Response_Poll_ViewResult),this.createSpinner())},e.prototype.createSubmitButton=function(){var c=this,d=this.state.SubmitState===b.SubmitState.Submitting;return React.DOM.div({className:"office-form-bottom-button-div"},Forms.UX.Controls.createTextButton({HTMLAttributes:{className:"office-poll-submit-button office-form-theme-primary-background",disabled:d,onClick:function(){c.submitResponse();var d=c.props.Master.Model,e=function(a,b){return a+(b&&b.Answer?JSON.stringify(b.Answer).length:0)},f=c.formRuntimeMaster.Answers?b.convertToArray(c.formRuntimeMaster.Answers):[];a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.ResponsePage.Form.Submit,extraData:{isPoll:!0,allQuestionCount:d.Questions.length,allAnswersLength:_.reduce(f,e,0)}})}},ButtonStyle:"LightBackground",Text:b.Resources.LocalizedStrings.Response_Poll_VoteButtonText}))},e.prototype.createSpinner=function(){return this.state.SubmitState===b.SubmitState.Submitting?React.DOM.div({className:"poll-submit-spinner"},React.DOM.div({className:"spinner-tile-animation"})):void 0},e.prototype.validateEmail=function(a){var b=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return b.test(a)},e.prototype.submitResponse=function(){var c=this;if(this.formRuntimeMaster.getQuestionsWithWrongAnswer(this.formRuntimeMaster.TopQuestionRuntimeMasters).length>0)return void this.setState({ShowValidationStyle:!0},e.scrollToShowSubmitError);if(!this.state.ResponderEmail||!this.state.ResponderEmail.trim()||!this.validateEmail(this.state.ResponderEmail.trim()))return void this.setState({ShowValidationStyle:!0},e.scrollToShowSubmitError);this.setState({SubmitState:b.SubmitState.Submitting});var f={StartDate:this.startTime,SubmitDate:new Date,Answers:this.formRuntimeMaster.Answers,Responder:this.state.ResponderEmail,ResponderName:this.state.ResponderEmail},g=this.props.Master;g.submitResponse(f).done(function(a){$.when(g.ensureFieldsReady([b.Model.FormMaster.Schema.Questions,b.Model.FormMaster.Schema.DescriptiveElements,b.Model.FormMaster.Schema.Responses]),g.syncRuntimeResponses()).then(function(){c.formRuntimeMaster.Model.QuestionRuntimeMasters;c.setState({SubmitState:b.SubmitState.Succeed,ErrorMessage:void 0})})}).fail(function(e){var f="";if(e.innerCode){if(f=b.Resources.LocalizedStrings["Error_Message_"+e.innerCode]||b.Resources.LocalizedStrings.Error_Inline_DefaultMessage,e.innerCode===d.FormClosed){var g="Inner Message:",h=e.innerMessage.indexOf("Inner Message:")+g.length,i=e.innerMessage.length;f=b.Resources.LocalizedStrings["Error_Message_"+e.innerCode+"_title"]+". "+e.innerMessage.substring(h,i).trim()}e.innerCode===d.EmbedFormNeedAuth&&(f=b.Resources.LocalizedStrings.Error_Inline_RefreshMessage),(e.innerCode===d.CDBTopLevelError||e.innerCode===d.CdbServiceUnavailable)&&(f=b.Resources.LocalizedStrings.Error_Inline_DelayTryMessage)}a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.Error.InlineError.ShowAtSubmitResponse,extraData:{Error:e,ErrorMessage:f||void 0}}),c.setState({SubmitState:b.SubmitState.Failed,ErrorMessage:f})})},e.prototype.submitAnotherResponse=function(){a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.ResponsePage.PollResultView.SubmitAnother}),this.resetAnswers(),this.formRuntimeMaster.updateWithResponse(null),this.setState({ErrorMessage:void 0,ShowValidationStyle:!1,SubmitState:b.SubmitState.NotSubmitted},e.scrollToTop)},e.prototype.resetAnswers=function(a){this.startTime=new Date,this.formRuntimeMaster.Answers=a||[]},e.prototype.isMobile=function(){switch(this.props.ViewMode){case b.ViewMode.Desktop:return!1;case b.ViewMode.Mobile:return!0;case b.ViewMode.Auto:return a.Utilities.isMobile();default:throw Error("unknown view mode")}},e.prototype.updateScreenSizeClass=function(){$(window).width()<=768!==this.state.IsSmallScreen&&this.setState({IsSmallScreen:!this.state.IsSmallScreen})},e.scrollToTop=function(){a.Utilities.Html.scrollToShowSubelement($(".office-form-form-title"),$(".office-form-content"),void 0,void 0,!0)},e.scrollToShowSubmitError=function(){a.Utilities.Html.scrollToShowSubelement($(".office-form-submit-error"),$(".office-form-content"),void 0,20,!0)},e}(a.ReactComponent)}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(a){return React.createElement(e,a)}b.createPollResultView=c;var d,e=function(c){function d(a){var b=c.call(this,a)||this;return b.backgroundColor="#008272",b.watermarkColor="#f4f4f4",b.state={IsRefreshing:!1},b}return __extends(d,c),d.prototype.componentDidMount=function(){a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.ResponsePage.PollResultView.Navigate})},d.prototype.componentDidUpdate=function(){var a=ReactDOM.findDOMNode(this.refs["vote-detail"]);a&&a.focus()},d.prototype.render=function(){var c=this,d=a.Control.createGlyphButton({HTMLAttributes:{onClick:function(){return c.props.submitAnother()}},Icon:"Back",IconClassName:"poll-top-view-back-icon forms-icon-size16x16",GlyphButtonStyle:a.Control.GlyphButtonStyle.Vertical,Text:b.Resources.LocalizedStrings.Response_Poll_Result_Back,TextClassName:"poll-top-view-back-text"});return React.DOM.div({className:"office-poll-result-container"},React.DOM.div({className:"office-poll office-form office-form-theme-shadow office-poll-info-container",role:"main"},React.DOM.div({className:"office-poll-title-container office-form-theme-primary-background"},d),React.DOM.div({className:"poll-result-container office-form-padding-align"},this.createQuestionTitle(),this.createViewResult(),React.DOM.div({className:"office-form-info-other"},this.createRefreshLink()))),React.createElement(Forms.UX.Renderer.FooterControl,{TopExtraContent:this.createPremotionLink()}))},d.prototype.createQuestionTitle=function(){var a=this.props.Form;return React.DOM.div({className:"office-form-question-title"},a.Model.Questions[0]&&a.Model.Questions[0].Title)},d.prototype.createViewResult=function(){var c=this,d=this.props.Form,e=d.Model.Questions[0].ChoiceType===b.Model.ChoiceType.MultiChoice,f=d.Model.Questions[0].AllowOtherAnswer,g=_.map(d.Model.Questions[0].Choices,function(a){return{option:a.Description,voteCount:0,names:[],voted:!1}});f&&g.push({option:"Other",voteCount:0,names:[],otherOptions:[],voted:!1}),_.each(d.Model.Responses,function(c){var d=c.Answers,h=[];e?_.each(a.Utilities.tryParseJson(d[0].Answer),function(a){return h.push(a)}):h.push(d[0].Answer);var i=c.ResponderName||c.Responder||b.Resources.LocalizedStrings.Response_Poll_Result_Anonymous;i&&_.each(h,function(a){var b=_.findIndex(g,function(b){return b.option===a});f&&-1===b&&(b=g.length-1),-1!==b&&(g[b].voteCount+=1,g[b].names.push(i),"otherOptions"in g[b]&&g[b].otherOptions.push(a),i===OfficeFormServerInfo.userInfo.Email&&(g[b].voted=!0))})}),g.sort(function(a,b){return b.voteCount-a.voteCount});var h=_.last(_.filter(g,function(a){return 0!==a.voteCount})),i=(h?h.voteCount:0,_.first(g).voteCount),j=g.map(function(a,d){var e=a.voteCount||0,f=0===i?0:80*e/i,g=String(f)+"%",h=String(100-f)+"%",j=React.DOM.span({className:"office-poll-vote-count-container"},React.DOM.span({className:"poll-result-vote-count"},b.Resources.LocalizedStrings.Response_Poll_Result_VoteCount.format(e))),k=React.DOM.div({className:"poll-result-progressbar-container"},React.DOM.div({className:"poll-result-progressbar-cell",style:{width:g}},React.DOM.a({className:"poll-result-progressbar",style:{backgroundColor:c.backgroundColor}})),React.DOM.div({className:"poll-result-progressbar-cell",style:{width:h}},React.DOM.a({className:"poll-result-progressbar"})));return React.DOM.div({className:"poll-result-option-container",title:a.names.join(b.Resources.LocalizedStrings.Response_Poll_Result_ResponderNameSep),key:a.option},React.DOM.div(null,a.option,a.voted?React.DOM.span({className:"poll-result-voted"},b.Resources.LocalizedStrings.Response_Poll_Voted):void 0,j),k)});return React.DOM.div({className:"poll-result-options-container"},j)},d.prototype.createRefreshLink=function(){var a=this;return React.DOM.div({className:"poll-result-refresh-link"},React.DOM.a({className:"office-form-info-reload office-form-info-children",href:"javascript:void(0)",onClick:function(){var c=a.props.Form;a.setState({IsRefreshing:!0}),$.when(c.ensureFieldsReady([b.Model.FormMaster.Schema.Questions,b.Model.FormMaster.Schema.DescriptiveElements,b.Model.FormMaster.Schema.Responses]),c.syncRuntimeResponses()).then(function(){a.setState({IsRefreshing:!1})})}},b.Resources.LocalizedStrings.Response_Poll_Result_Refresh),this.createSpinner())},d.prototype.createPremotionLink=function(){var c=this;if(!a.Utilities.Flight.isPPTIntegration()){var d={className:"office-form-info-premotion office-form-info-children",href:"DesignPage.aspx",onClick:function(){return c.props.beforePromotion&&c.props.beforePromotion(),!0}};return(a.Utilities.isOEmbed()||a.Utilities.isOEmbedSPO()||a.EnvironmentSettings.IsExternalIntegration)&&(d.href="javascript:void(0)",d.onClick=function(){c.props.beforePromotion&&c.props.beforePromotion();var b=a.Utilities.getNonEmbedQuery(),d=a.EnvironmentSettings.IsExternalIntegration?"../Pages/DesignPage.aspx":"../Pages/DesignPage.aspx?"+jQuery.param(b);return a.Utilities.Html.safeOpen(a.Utilities.Html.getAbsoluteUrl(d)),!0}),React.DOM.div(null,React.DOM.a(d,b.Resources.LocalizedStrings.Renderer_PromotionMessage))}},d.prototype.createSpinner=function(){return this.state.IsRefreshing?React.DOM.div({className:"poll-submit-spinner"},React.DOM.div({className:"spinner-tile-animation"})):void 0},d}(a.ReactComponent);!function(b){function c(){return"DetailResult"===a.Utilities.Html.getQueries().view}b.isDetailResultView=c}(d=b.PollUtil||(b.PollUtil={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c=function(){function c(){}return c.createQuizPointLabel=function(a){var c=a.Master.Question.Model,d=a.Master.SubQuestionRuntimeMasters,e=d[d.length-1];if(a.IsStudentViewMode){var f=(e||a.Master).getScore();if(!f&&!c.Point)return void 0;var g=c.Point?c.Point:"-",h=null!=f?f:"-",i=b.Resources.LocalizedStrings.RuntimeView_TotalPoints_Content.format(h,g);return React.DOM.span({className:"office-form-theme-quiz-point"},b.Resources.LocalizedStrings.Quiz_Points_BracketsText.format(i))}if(c.IsQuiz&&!a.HiddenPoint){if(!c.Point)return void 0;if(!a.ShowDesignInfo&&a.ShowQuizResult){var f=(e||a.Master).getScore(),h=null!=f?f:"-",i=b.Resources.LocalizedStrings.RuntimeView_TotalPoints_Content.format(h,c.Point);return React.DOM.span({className:"office-form-theme-quiz-point"},b.Resources.LocalizedStrings.Quiz_Points_BracketsText.format(i))}return React.DOM.span({className:"office-form-theme-quiz-point"},b.RendererHelper.getBracketPointText(c.Point))}},c.createWrongResultLabel=function(d){var e;if(!d.IsMobile){var f=[];if(c.isWrongQuestion(d)){var g=a.Control.createFontIconControl({Accessible:!0,HTMLAttributes:{"aria-label":b.Resources.LocalizedStrings.Response_Preview_WrongReponseIcon.format(d.Ordinal),className:"validation-error-message-wrong-Icon office-form-answerkey"},IconName:"Cancel"});f=[React.DOM.div({className:"validation-error-circle-big"}),React.DOM.div({className:"validation-error-circle-small"}),g]}return(e=React.DOM).div.apply(e,[{"aria-live":"assertive",role:"alert"}].concat(f))}},c.isWrongQuestion=function(a){var c=a.Master.Model,d=a.Master.Question.Model,e=d.Type===b.Model.Question.Choice.getElementTypeName(),f=d.Type===b.Model.QuestionType.TextField&&!d.Multiline,g=d.Type===b.Model.QuestionType.Ranking,h=e||f||g,i=d.IsQuiz&&a.ShowQuizResult&&h;return i&&c.QuizResult?!c.QuizResult.IsAnswerCorrect:!1},c}();b.QuizRenderer=c,a.Exports.QuizRenderer=c}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b=function(){function b(){}return b.getBracketPointText=function(b){var c=a.Resources.LocalizedStrings.Quiz_Points_BracketsText_Singular,d=a.Resources.LocalizedStrings.Quiz_Points_BracketsText_Plural,e=1===b?c:d;return e.format(b)},b}();a.RendererHelper=b}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c=window.onerror;window.onerror=function(b,d,e,f,g){a.Utilities.OEmbed.notifyFormErrorToParentWindow(g),a.Event.ErrorEventDeprecated.logData({errorName:"UnhandleException",errorInfo:{message:b,fileName:d,lineNo:e,columnNo:f,stack:g&&g.stack}}),c&&c.apply(this,arguments)}}(b=a.Telemetry||(a.Telemetry={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b=function(){function a(){}return a.logData=function(a){Forms.Telemetry.log({eventName:a.name,eventType:"nav_perf_event",extraData:a.extraData})},a}();a.NavPerfEventDeprecated=b}(b=a.Event||(a.Event={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a.DefaultPage="Endpoint.DefaultPage",a.DesignPagePortalView="Endpoint.DesignPagePortalView",a.ResponsePage="Endpoint.ResponsePage",a.SurveyAnalyzePage="Endpoint.SurveyAnalyzePage",a.ShareAnalysisPage="Endpoint.ShareAnalysisPage",a.OutlookCreatePollPage="Endpoint.OutlookCreatePollPage",a}();a.Endpoints=b}(b=a.Scenario||(a.Scenario={}))}(b=a.NavPerfEventNames||(a.NavPerfEventNames={}))}(b=a.Event||(a.Event={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(a){a.SettingsAllowResponderGetAllResponses="Settings.AllowResponderGetAllResponses",a.DisableEditForm="DisableEditForm",a.ResponsePagePollView="ResponsePage.PollView"}(c=b.ExtensionPoints||(b.ExtensionPoints={})),a.Exports.ExtensionPoints=c;var d,e={Poll:[c.SettingsAllowResponderGetAllResponses,c.DisableEditForm,c.ResponsePagePollView],"Teams Poll":[c.DisableEditForm]};!function(c){function d(c,d){var f;if(a.Utilities.Type.isString(c))f=c;else if(c){var g=c;if(g.isFieldReady(b.Model.FormMaster.Schema.OwnerId)&&!g.IsGroupForm&&g.Model.OwnerId!==OfficeFormServerInfo.userInfo.UserId)return!1;f=g.Model.Category}return f?_.contains(e[f],d):!1}c.supportsExtensionPoint=d}(d=b.CategoryExtensionPoints||(b.CategoryExtensionPoints={})),a.Exports.CategoryExtensionPoints=d}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(a){a[a.Win32OneNote=0]="Win32OneNote",a[a.UWPOneNote=1]="UWPOneNote",a[a.OneNoteClient=2]="OneNoteClient"}(b=a.OEmbedClients||(a.OEmbedClients={}))}(b=a.OEmbed||(a.OEmbed={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(c){function d(c,d,f){var i=c.Model.Id;Forms.Common.setFormIdGetter(function(){return i}),Forms.Common.setFormGetter(function(){return b.Model.exportConverter(c)});var j,k=Forms.PerformanceAnalysis,o=k.requestWithPromise("loadForm",d()),q=k.requestWithPromise("responseStrings",b.Resources.loadLocalizedStrings());j=OfficeFormServerInfo.combineScripts?["combined-response"]:["BootStrap","JQuery_RateIt","Linkify","Linkify_JQuery","JQuery_Picker","JQuery_Picker_Date","JQuery_Picker_Time"];var r=k.requestWithPromise("scripts",a.JavaScriptLoader.loadJavaScripts(j));q.fail(function(b){a.Utilities.OEmbed.notifyFormErrorToParentWindow({message:"LoadLocalizedStrings failure, error: "+(b&&b.message)})}),r.fail(function(b){a.Utilities.OEmbed.notifyFormErrorToParentWindow({message:"LoadDependencies failure, error: "+(b&&b.message)})}),o.fail(p).then(function(){return Forms.FormsProRelated.ensureEnvironment("survey"===c.Model.Type)}).then(function(){return g(c)}).then(function(){return!f&&h(c)}).then(function(){return l(c).fail(p)}).done(function(d){$.when(q,r).done(function(){k.onPageReadyToRender(),Forms.getPageContext().Flighting.isEnabled("MultiLingualMVP1")&&c.Model.LocaleList.length&&c.Synchronizer.setFieldsQueryJob([b.Model.FormMaster.Schema.LocalizedResources],$.Deferred().resolve({localizedResources:[]}).promise()),d&&d.length?m(d,c):n(c),a.Utilities.Flight.isRuntimePageAutoRefreshEnabled()&&e(c)})})}function e(a){var c=a.Synchronizer.query(b.Model.FormMaster.FieldsToResponse);c.done(function(){setTimeout(function(){return e(a)},1e4)}).fail(function(){setTimeout(function(){return e(a)},1e4)})}function f(c){var d,e=Forms.PerformanceAnalysis,f=e.requestWithPromise("responseStrings",b.Resources.loadLocalizedStrings());d=OfficeFormServerInfo.combineScripts?["combined-response"]:["BootStrap","JQuery_RateIt","Linkify","Linkify_JQuery","JQuery_Picker","JQuery_Picker_Date","JQuery_Picker_Time"];var g=e.requestWithPromise("scripts",a.JavaScriptLoader.loadJavaScripts(d));if(f.fail(function(b){a.Utilities.OEmbed.notifyFormErrorToParentWindow({message:"LoadLocalizedStrings failure, error: "+(b&&b.message)})}),g.fail(function(b){a.Utilities.OEmbed.notifyFormErrorToParentWindow({message:"LoadDependencies failure, error: "+(b&&b.message)})}),Forms.getPageContext().Flighting.isEnabled("DataClassification")&&c.isFieldReady(c.Schema.DataClassificationLabel)){var h=a.DataProvider.FeaturePlanProvider.getDataClassificationLabelDetail(c.Model.OwnerTenantId,c.Model.DataClassificationLabel);$.when(f,g,h).done(function(){e.onPageReadyToRender(),n(c,!0)})}else $.when(f,g).done(function(){e.onPageReadyToRender(),n(c,!0)})}function g(c){a.Utilities.OEmbed.notifyFormInfoToParentWindow(c);var d=c.SyncContext===b.Model.FormSyncContext.SharedTimeForm;if(k(c))return $.Deferred().reject();var e=a.Utilities.Flight.isPPTIntegration()||a.EnvironmentSettings.IsAssignmentsIntegration;return window.parent!==window&&!e&&(window.innerWidth<320||window.innerHeight<320||a.Utilities.isAndroid())?(a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.ResponsePage.EmbedView.BlockEmbed,extraData:{iFrameWidth:window.innerWidth,iFrameHeight:window.innerHeight,isAndroid:a.Utilities.isAndroid()}}),j(),$.Deferred().reject()):(document.title=c.Model.Title,void(d?a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.ShareFormPage.Copy.Navigate}):a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.ResponsePage.Form.Navigate})))}function h(b){var c=$.Deferred();return!a.Flighting.Flight.isEnabled("VerifyUserInResponsePage")||b.SettingMaster.Model.IsAnonymous||OfficeFormServerInfo.userInfo.UserId?c.resolve():(a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.Auth.Auth.NoUserInfoForNonanonymousForm}),Forms.Common.reloadPage()),c.promise()}function i(c,d,e){void 0===d&&(d=!0);var f;e&&(f=e instanceof Error?e.message:e.innerMessage);var g;switch(c){case"Information":g=a.Event.EngagementEventNames.ResponsePage.ErrorPage.Information;break;case"Error":default:g=a.Event.EngagementEventNames.ResponsePage.ErrorPage.Error}a.Event.EngagementEventDeprecated.logData({name:g,extraData:{errorType:c,message:f}}),b.Resources.loadLocalizedStrings().done(function(){var b=React.createElement(Forms.UX.Renderer.ErrorPage,{Error:e,ErrorType:c,FormId:a.Utilities.Html.getQueries().id,IsResponsePage:!0,ShowCreateFormLink:d});a.Utilities.isOEmbedSPO()&&d?ReactDOM.render(React.DOM.div({className:"embed-view-spo"},React.createElement(Forms.UX.Renderer.ThemeRender),b),document.getElementById("content-root")):ReactDOM.render(b,document.getElementById("content-root"))})}function j(){b.Resources.loadLocalizedStrings().done(function(){a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.ResponsePage.EmbedView.Navigate});var c=a.Utilities.isOEmbedSPO()?"embed-view office-form-theme-primary-background":"embed-view",d=React.DOM.div({className:c},React.DOM.div({className:"embed-view-container"},a.Control.createFontIconControl({HTMLAttributes:{className:"embed-view-icon"},IconName:"OfficeFormsLogo"}),React.DOM.span({className:"embed-view-content"},b.Resources.LocalizedStrings.Page_Title),React.DOM.a({className:"embed-view-content",onClick:function(){a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.ResponsePage.EmbedView.OpenInBrowser});var b=a.Utilities.getNonEmbedQuery(),c=window.location.pathname+"?";c+=jQuery.param(b),a.Utilities.Html.safeOpen(a.Utilities.Html.getAbsoluteUrl(c),"_blank","toolbar=yes, menubar=yes")}},b.Resources.LocalizedStrings.EmbedPage_Link)));a.Utilities.isOEmbedSPO()&&(d=React.DOM.div({className:"embed-view-spo"},React.createElement(Forms.UX.Renderer.ThemeRender),d)),ReactDOM.render(d,document.getElementById("content-root"))})}function k(c){if(!Forms.getPageContext().Flighting.isEnabled("ResponseInApp")||!c.Model.Settings.RespondInAppOnly)return!1;var d=!1,e=void 0!==window.browser;if(e)a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.ResponsePage.Form.OpenInTakeATest});else{if(a.Utilities.isWin10()){var f="ms-edu-secureassessment:",g="_self",h="directories=no,titlebar=no,toolbar=no,location=no,status=no,menubar=no,scrollbars=no,resizable=no",j="!enforceLockdown";a.Utilities.Html.safeOpen(f.concat(window.location.href).concat(j),g,h),i("Information",!1,Error(b.Resources.LocalizedStrings.TakeATest_Win10))}else i("Information",!1,Error(b.Resources.LocalizedStrings.TakeATest_NotWin10));d=!0}return d}function l(c){var d=a.Utilities.Html.getQueries().rid;return a.Flighting.Flight.isEnabled("EmailReceipt")&&null!=d?c.getRuntimeResponse(d).then(function(a){return[a]}):c.Model.Settings.IsQuizMode&&c.SyncContext===b.Model.FormSyncContext.ResponseTimeForm?Forms.PerformanceAnalysis.requestWithPromise("releasedResponses",c.getReleasedResponsesByResponder(OfficeFormServerInfo.userInfo.Email)):$.Deferred().resolve().promise()}function m(c,d){null!=a.Utilities.Html.getQueries().rid?a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.ResponsePage.ViewResultView.Navigate}):a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.ResponsePage.StudentView.Navigate});var e=c[c.length-1],f={Master:d,ViewMode:b.ViewMode.Auto,Response:e};o(b.createFormRenderer(f))}function n(a,c){var d=!a.Model.Settings.IsAnonymous,e=new r(a.Model.Id,d),f={PersistedAnswers:e.Answers,PrintView:c,PersistedSectionId:e.SectionId,Master:a,DisableSubmitButton:!1,ViewMode:b.ViewMode.Auto,persistAnswer:function(c){e.Answers=c,a.SyncContext===b.Model.FormSyncContext.ResponseTimeForm&&(c?window.onbeforeunload=function(){return""}:window.onbeforeunload=null)},persistSectionId:function(a){return e.SectionId=a}};b.CategoryExtensionPoints.supportsExtensionPoint(a.Model.Category,b.ExtensionPoints.ResponsePagePollView)?b.PollUtil.isDetailResultView()?$.when(a.ensureFieldsReady([b.Model.FormMaster.Schema.Questions,b.Model.FormMaster.Schema.DescriptiveElements,b.Model.FormMaster.Schema.Responses]),a.syncRuntimeResponses()).then(function(){o(b.createPollRenderer(f))},p):o(b.createPollRenderer(f)):o(b.createFormRenderer(f))}function o(b){var c;c=a.Utilities.isOEmbedSPO()?"office-form-theme-page-background office-form-spo-embed":"office-form-theme-page-background",ReactDOM.render(React.DOM.div({id:"form-container",className:c},React.DOM.div({className:"form-content"},b)),document.getElementById("content-root")),window.performance&&a.Event.NavPerfEventDeprecated.logData({name:a.Event.NavPerfEventNames.Scenario.Endpoints.ResponsePage,extraData:{timeToSpin:window.performance.timing.domInteractive-window.performance.timing.navigationStart,timeToContentReady:a.Utilities.DateTime.getTimeStamp()-window.performance.timing.navigationStart}})}function p(b){if(b)switch(a.Utilities.OEmbed.notifyFormErrorToParentWindow(b),b.innerCode){case q.CDBTableMoved:var c=a.Utilities.Html.updateUrlParam(window.location.href,"id",b.innerMessage);c!==window.location.href&&Forms.Common.redirectTo(c);break;case q.FormClosed:i("Information",!0,b);break;case q.EmbedFormNeedAuth:a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.ResponsePage.EmbedView.NeedAuth});var d=function(){setTimeout(function(){Forms.Authenticator.signInThenRefresh()})};Forms.Authenticator.detectUserLoggedInAAD(d,j);break;case q.NetworkIssue:i("Information",!1,b);break;case q.NoPermission:case q.DisabledByTenantAdmin:case q.InvalidFormId:case q.MultiResponseNotAllowed:case q.FormNotStarted:case q.FormEnded:case q.FormSettingJSONParseError:case q.CopyNotAllowed:case q.IncorrectShareToken:case q.CDBTableNotFound:case q.CDBUnauthorizedAccess:case q.LicenseNotValid:case q.LicenseNotFound:case q.AbusedForm:i("Information",!0,b);break;case q.GetFormFailed:default:i("Error",!0,b)}else i("Error",!0)}a.Exports.RuntimeFormPage={showPrintForm:function(a){return f(b.Model.exportConverter(a))},showForm:function(a,c,e){return d(b.Model.exportConverter(a),c,e)},showErrorPage:i};var q=a.DataProvider.ErrorCode.InnerCode,r=function(){function b(b,c){void 0===c&&(c=!0),this.storage=c?a.SafeStorage.LocalStorage:a.SafeStorage.SessionStorage,this.formId=b}return b.prototype.getAnswerMapId=function(){return b.KeyPrefix_AnswerMap+this.formId+"."+OfficeFormServerInfo.userInfo.UserId},Object.defineProperty(b.prototype,"Answers",{get:function(){var a=this.storage.getItem(this.getAnswerMapId());if(a){var b=JSON.parse(a);return Array.isArray(b)?b:void(this.Answers=void 0)}},set:function(a){a?this.storage.setItem(this.getAnswerMapId(),JSON.stringify(a)):this.storage.removeItem(this.getAnswerMapId())},enumerable:!0,configurable:!0}),
b.prototype.getActiveSectionKey=function(){return b.KeyPrefix_ActiveSection+this.formId+"."+OfficeFormServerInfo.userInfo.UserId},Object.defineProperty(b.prototype,"SectionId",{get:function(){var a=this.getActiveSectionKey();return this.storage.getItem(a)||null},set:function(a){var b=this.getActiveSectionKey();a?this.storage.setItem(b,a):this.storage.removeItem(b)},enumerable:!0,configurable:!0}),b.KeyPrefix_AnswerMap="officeforms.answermap.",b.KeyPrefix_ActiveSection="officeforms.activesection",b}();c.showForm=d,c.showPrintForm=f,c.showErrorPage=i}(c=b.RuntimeFormPage||(b.RuntimeFormPage={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={})),function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})},b.n=function(a){var c=a&&a.__esModule?function(){return a["default"]}:function(){return a};return b.d(c,"a",c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p="",b(b.s=313)}([function(a,b){a.exports=React},function(a,b,c){"use strict";function d(a){var b=a;j.forEach(function(c){var d=b[c];d&&(b[c]=function(){for(var b=[],f=0;f<arguments.length;f++)b[f]=arguments[f];try{return d.apply(a,b)}catch(g){return e(a,c,g),null}})})}function e(a,b,c){try{if(c&&c.stack&&console.log(c.stack),window.onerror){var d=h.findDOMNode(a),e=d&&d.getAttribute("data-reactId")||"",f="Exception in "+a.constructor.name+"["+e+"]:"+b;c&&c.message&&(f+=" Message: "+c.message),window.onerror(f,"",0,0,c)}}catch(c){}}var f=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var g=c(0),h=c(8);c(35),c(36);var i=function(a){function b(b){var c=a.call(this,b)||this;return c.state={},d(c),c}return f(b,a),b}(g.Component);b.ReactComponent=i;var j=["componentWillMount","componentDidMount","componentWillReceiveProps","shouldComponentUpdate","componentWillUpdate","componentDidUpdate","componentWillUnmount","render"]},function(a,b,c){"use strict";function d(a){var b=l[a.eventType];if(b)j.Telemetry.logData(b(a));else{var c={eventName:"no_ErrorName",eventType:"error_event",extraData:{initData:a,message:"Unsupported event"}};j.Telemetry.logData(e(c))}}function e(a){var b={duration:0,eventCorrelationId:k.Guid.newGuid(),eventName:(a.eventName||m[a.eventType]).replace(" ",""),eventType:a.eventType,properties:"",timeStamp:k.DateTime.getTimeStamp()};return a.extraData&&(b.properties=JSON.stringify(a.extraData)),b}function f(a){return a.extraData={DbId:"",DeviceId:""},e(a)}function g(a){var b={duration:a.duration,eventCorrelationId:a.correlationId,eventName:(a.eventName||m[a.eventType]).replace(" ",""),eventType:a.eventType,properties:"",timeStamp:k.DateTime.getTimeStamp()};return a.extraData&&(b.properties=JSON.stringify(a.extraData)),b}function h(a){var b=e(a);return a.extraData&&(a.ignoreRawTiming&&i(a),b.properties=JSON.stringify(a.extraData)),b}function i(a){if(window.performance){var b=window.performance.timing,c={navigationType:window.performance.navigation.type};c.navigationStart=b.navigationStart,c.unloadEventStart=b.unloadEventStart-b.navigationStart,c.unloadEventEnd=b.unloadEventEnd-b.navigationStart,c.redirectStart=0===b.redirectStart?0:b.redirectStart-b.navigationStart,c.redirectEnd=0===b.redirectEnd?0:b.redirectEnd-b.navigationStart,c.fetchStart=b.fetchStart-b.navigationStart,c.domainLookupStart=b.domainLookupStart-b.navigationStart,c.domainLookupEnd=b.domainLookupEnd-b.navigationStart,c.connectStart=b.connectStart-b.navigationStart,c.connectEnd=b.connectEnd-b.navigationStart,c.requestStart=b.requestStart-b.navigationStart,c.responseStart=b.responseStart-b.navigationStart,c.responseEnd=b.responseEnd-b.navigationStart,c.domLoading=b.domLoading-b.navigationStart,c.domInteractive=b.domInteractive-b.navigationStart,c.domContentLoadedEventStart=b.domContentLoadedEventStart-b.navigationStart,c.domContentLoadedEventEnd=b.domContentLoadedEventEnd-b.navigationStart,c.domComplete=b.domComplete-b.navigationStart,c.loadEventStart=b.loadEventStart-b.navigationStart,c.loadEventEnd=b.loadEventEnd-b.navigationStart,a.extraData=a.extraData||{};var d="rawTiming";a.extraData[d]=c}}Object.defineProperty(b,"__esModule",{value:!0});var j=c(14),k=OfficeForm.Exports.Utilities,l={engagement_event:e,error_event:e,nav_perf_event:h,qos_event:g,session_start:f},m={engagement_event:"no_EngagementName",error_event:"no_ErrorName",nav_perf_event:"no_NavPerfName",qos_event:"no_QosName",session_start:"session_start"};b.log=d,Forms.Telemetry.log=d},function(a,b){a.exports=_},function(a,b,c){"use strict";function d(a){if(f)throw Error("PageContext has already been initialized.");f=new k(a)}function e(){return void 0===f&&(d({authenticators:[]}),j.log({eventName:"PageContextNotIntialized",eventType:"error_event"})),f}Object.defineProperty(b,"__esModule",{value:!0});var f,g=c(33),h=c(32),i=c(18),j=c(2);b.initializePageContext=d,b.getPageContext=e;var k=function(){function a(a){this.flightsDeferred=$.Deferred(),this.authAdapter=new g.AuthAdapter(a.authenticators),this.flighting=new h.Flight(this.flightsDeferred.promise())}return Object.defineProperty(a.prototype,"AuthContext",{get:function(){return this.authAdapter},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Flighting",{get:function(){return this.flighting},enumerable:!0,configurable:!0}),a.prototype.getPrivacyUrl=function(){var a=i.getCurrentFormIdObj();return OfficeForm.Exports.DataProvider.createDataProvider().getPrivacySettings(a&&a.OrgId,OfficeFormServerInfo.userInfo.TenantId).then(function(a){return a&&a.privacyUrl})},a.prototype.setFlightsBasingOnAuth_Deprecated=function(a){this.flightsDeferred.resolve(a)},a}();Forms.getPageContext=e},function(a,b,c){"use strict";function d(a){var b;b=g.clone(a)||{},b.children=a.Text;var c=b.HTMLAttributes&&b.HTMLAttributes.title;return!c&&a.Text&&(b.HTMLAttributes=g.clone(b.HTMLAttributes)||{},b.HTMLAttributes.title=a.Text),f.createElement(h.Button,e({},b))}var e=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};Object.defineProperty(b,"__esModule",{value:!0});var f=c(0),g=c(3),h=c(9);b.TextButton=d,Forms.UX.Controls.TextButton=d,Forms.UX.Controls.createTextButton=d},function(a,b,c){"use strict";function d(a){return i().then(function(){window.location.assign(a)})}function e(a){return i().then(function(){window.location.reload(a)})}function f(a){return i().then(function(){window.location.replace(a)})}function g(a){return i().then(function(){var b=window.location,c=b.origin+a+b.search+b.hash;window.location.replace(c)})}function h(a){j.push(a)}function i(){var a=j;j=[];var b=OfficeForm.Exports.Utilities.Promise.always,c=$.when.apply($,a.map(function(a){return b(a())}));return j.push(function(){return c}),c}Object.defineProperty(b,"__esModule",{value:!0}),b.redirectTo=d,b.reloadPage=e,b.replaceUrl=f,b.replacePathName=g,b.beforeLeavingPage=h;var j=[];Forms.Common.redirectTo=d,Forms.Common.reloadPage=e,Forms.Common.replaceUrl=f,Forms.Common.replacePathName=g,Forms.Common.beforeLeavingPage=h},function(a,b,c){"use strict";a.exports=Nerve},function(a,b){a.exports=ReactDOM},function(a,b,c){"use strict";function d(a){return g.createElement(l,f({},a))}var e=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),f=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};Object.defineProperty(b,"__esModule",{value:!0});var g=c(0),h=c(8),i=c(3),j=c(1),k=OfficeForm.Exports.Utilities,l=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return e(b,a),b.prototype.render=function(){var a=i.extend({},this.props.HTMLAttributes);switch(a.className=k.Html.combineAttributes(a.className,"button-control"),a["aria-pressed"]=this.props.ToggleActive,this.props.ToggleActive&&(a.className=k.Html.combineAttributes(a.className,"active")),this.props.ButtonStyle){case"LightBackground":a.className=k.Html.combineAttributes(a.className,"light-background-button");break;case"DarkBackGround":a.className=k.Html.combineAttributes(a.className,"dark-background-button");break;case"None":}return g.createElement("button",f({},a),g.createElement("div",{className:"button-content"},this.props.children))},b.prototype.focus=function(){var a=h.findDOMNode(this);a.focus()},b.prototype.setTabIndex=function(a){var b=h.findDOMNode(this);b.setAttribute("tabIndex",a.toString())},b}(j.ReactComponent);b.Button=l,Forms.UX.Controls.Button=l,Forms.UX.Controls.createButton=d},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var e=c(3),f=c(7),g=c(68),h=c(17),i=c(85),j=OfficeForm.Exports.Models,k=f.Spec,l={choices:k.collectionOf(function(){return g.ChoiceLocalizedItemMaster}),choicesV1:k.collectionOf({choiceId:k.string({IsLocalField:!0}),description:k.string({SourceFieldName:"Description"})},{IsLocalField:!0}),leftDescription:k.string(),localeId:k.string({IsKeyField:!0}),localeName:k.string(),option:k.string(),questionId:k.string({IsKeyField:!0}),rightDescription:k.string(),subtitle:k.string(),title:k.string()},m=function(a){return new i.QuestionLocalizedItemDataSource(a)},n=function(a){function b(b){var c=this,d=$.Deferred();return c=a.call(this,b,{MasterReady:d.promise(),Scheduler:new j.Scheduler})||this,c.initializeOptionBinder(b),d.resolve(),c}return d(b,a),b.handleChoicesV1Deleted=function(a,b,c){0>a||e.forEach(c.Model.LocalizedResources,function(c){var d=e.filter(c.questionResources,function(a){return a.questionId===b});d.forEach(function(b){b.choicesV1.length>a&&f.Collection.itemsDeletedInSource(b.choicesV1,[b.choicesV1[a]])})})},Object.defineProperty(b.prototype,"Form",{get:function(){return this.FormLocalizedMaster.Form},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"FormLocalizedMaster",{get:function(){return this.Parent.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"QuestionId",{get:function(){return this.Model.questionId},enumerable:!0,configurable:!0}),b.prototype.getChoiceLocalizedMaster=function(a){var b=this,c=e.find(this.Form.Model.Questions,function(a){return a.Id===b.QuestionId});if(c){var d=e.find(c.ChoiceGroup,function(b){return b.Id.toString()===a});if(d){var g=f.Collection.getItemWithKeyFields(this.Model.choices,{choiceId:a});return g?f.getObjectMasterFromModel(g):h.createEmptyChoiceLocalizedResource(a,d.Key,this.Model)}}throw Error("Question or Chocie don't exist for localization.")},b.prototype.getChoiceV1LocalizedMaster=function(a){var b=this,c=e.find(this.Form.Model.Questions,function(a){return a.Id===b.QuestionId});if(c&&c.Choices.length>a){for(;this.Model.choicesV1.length<c.Choices.length;)h.createEmptyChoiceV1LocalizedResource(this.Model);return f.getObjectMasterFromModel(this.Model.choicesV1[a])}return null},b.prototype.initializeOptionBinder=function(a){b.Schema.option&&(this.optionBinder=new j.FieldBinder(this,b.Schema.option,b.ChoicesV1FieldSet),a.InitialData&&this.isFieldReady(b.Schema.option)&&(a.ExistingInDataSource||a.InitialData.option?this.optionBinder.deserialize():this.optionBinder.serialize()))},Object.defineProperty(b,"ChoicesV1FieldSet",{get:function(){return b.choicesV1FieldSet||(b.choicesV1FieldSet=new j.FieldSet([b.Schema.choicesV1])),b.choicesV1FieldSet},enumerable:!0,configurable:!0}),b}(f.createObjectMasterClass("QuestionLocalizedItemMaster",l,m));b.QuestionLocalizedItemMaster=n,Forms.Models.QuestionLocalizedItemMaster=n},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d;!function(a){a[a.BackSpace=8]="BackSpace",a[a.Tab=9]="Tab",a[a.Enter=13]="Enter",a[a.Shift=16]="Shift",a[a.Esc=27]="Esc",a[a.Space=32]="Space",a[a.End=35]="End",a[a.Home=36]="Home",a[a.ArrowLeft=37]="ArrowLeft",a[a.ArrowUp=38]="ArrowUp",a[a.ArrowRight=39]="ArrowRight",a[a.ArrowDown=40]="ArrowDown",a[a.Delete=46]="Delete",a[a.Eight=56]="Eight",a[a.PlaceHolder=229]="PlaceHolder"}(d=b.KeyCode||(b.KeyCode={}))},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var e=c(3),f=c(7),g=c(84),h=c(17),i=c(10),j=f.Spec,k={formCloseMessage:j.string(),localeId:j.string({IsKeyField:!0}),localeName:j.string(),questionResources:j.collectionOf(function(){return i.QuestionLocalizedItemMaster}),subtitle:j.string(),thankYouMessage:j.string(),title:j.string()},l=function(a){return new g.FormLocalizedItemDataSource(a)},m=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return d(b,a),Object.defineProperty(b.prototype,"Form",{get:function(){return this.Parent.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"LocaleId",{get:function(){return this.Model.localeId},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"LocaleName",{get:function(){return this.Model.localeName},enumerable:!0,configurable:!0}),b.getFormResourceMaster=function(a,b){var c=e.find(b.Model.LocalizedResources,function(b){return b.localeId===a});if(c)return f.getObjectMasterFromModel(c);throw Error("This locale does not exist in form.")},b.getQuestionResourceMaster=function(a,b,c){var d=c.Model.LocalizedResources,e=f.Collection.getItemWithKeyFields(d,{localeId:a});if(e){if(e.questionResources||(e.questionResources=[]),e.questionResources.length>0){var g=f.Collection.getItemWithKeyFields(e.questionResources,{localeId:a,questionId:b});if(g)return f.getObjectMasterFromModel(g)}return h.createEmptyQuestionLocalizedResource({localeId:a,localeName:e.localeName},b,e,c)}throw Error("This locale does not exist in form.")},b}(f.createObjectMasterClass("FormLocalizedItemMaster",k,l));b.FormLocalizedItemMaster=m,Forms.Models.FormLocalizedItemMaster=m},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c(3),e=c(2),f=OfficeForm.Exports.Utilities,g=function(){function a(a){this.eventData={correlationId:f.Guid.newGuid(),duration:0,eventName:a,eventType:"qos_event",extraData:void 0},this.startTime=null}return Object.defineProperty(a.prototype,"EventName",{get:function(){return this.eventData.eventName},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Duration",{get:function(){return this.eventData.duration},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"CorrelationId",{get:function(){return this.eventData.correlationId},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"ExtraData",{get:function(){return this.eventData.extraData},set:function(a){this.eventData.extraData=a},enumerable:!0,configurable:!0}),a.prototype.start=function(){this.startTime=f.DateTime.getTimeStamp();var a=this.prepareEvent(this.eventData,"Start");e.log(a)},a.prototype.end=function(a){var b=this.prepareEvent(a,"End");e.log(b)},a.prototype.log=function(a){var b=this.prepareEvent(a,"Log");e.log(b)},a.prototype.prepareEvent=function(a,b){var c=d.clone(this.eventData);switch(null!==this.startTime&&"Start"!==b&&(c.duration=f.DateTime.getTimeStamp()-this.startTime),a.logLevel&&(c.logLevel=a.logLevel),a.extraData&&(c.extraData=a.extraData),b){case"Start":c.eventName+="."+b;break;case"Log":c.eventName+="."+b,a.resultCode&&(c.eventName+="."+a.resultCode);break;case"End":a.resultType&&(c.eventName+="."+a.resultType)}return c},a}();b.QosEvent=g,Forms.Telemetry.QosEvent=g},function(a,b,c){"use strict";function d(){X.initialize(),o.beforeLeavingPage(f)}function e(){return X&&X.SessionId}function f(){var a=$.Deferred();return X?X.flush(function(){return a.resolve()}):a.resolve(),a.promise()}function g(){var a=q.GetHostString();if(a)return a;var b="origin",c=s.Html.getQueries()[b];if(c)return c;b="oembedsso";var d=s.Html.getQueries()[b];return d?"Forms WebPart":s.Flight.isPPTIntegration()?"PowerPoint":null}function h(){var a=r.getEnvironmentType();switch(a){case"Int":case"MSInt":return"Int";case"EDog":case"MSEDog":return"PreProd";case"WWProd":case"USGovProd":case"MSProd":return"Prod";default:return"DevEnv"}}function i(a){return isNaN(a)?"0":a.toString()}function j(){var a=r.getPageType();switch(a){case"Design":return V.Designer;case"Response":return V.Responder;case"Analyze":return V.AnalyzeViewer;case"TeamsConfig":return V.TeamsConfigUser;default:return V.Unknown}}function k(){var a=r.getEnvironmentType();switch(a){case"Int":case"MSInt":return M;case"EDog":case"MSEDog":return N;case"WWProd":case"MSProd":return u.FeaturePlanProvider.isMsaUser()||Forms.Common.isOwnerMsaUser()?P:O;case"USGovGccProd":return Q;case"USGovProd":return R;case"USDoDProd":return S;default:return L}}function l(){var a=g();return"OneNoteUwp"===a||"PowerPointTaskpane"===a}Object.defineProperty(b,"__esModule",{value:!0});var m,n=c(31),o=c(6),p=c(4),q=OfficeForm.Exports.EnvironmentSettings,r=OfficeForm.Exports.EnvironmentConfig,s=OfficeForm.Exports.Utilities,t=OfficeForm.Exports.Muid,u=OfficeForm.Exports.DataProvider,v="Office Forms BrowserApp",w="source_application",x="session_id",y="user_id",z="user_tenant_id",A="user_role",B="user_type",C="form_id",D="event_name",E="event_correlation_id",F="timestamp",G="duration",H="properties",I="UserInfo.Id",J="UserInfo.IdType",K="UserInfo.OMSTenantId",L="e132e188c609439ab47cd7b06511fc0a-433f81b3-fab9-415a-882a-ba9e2f91abea-6917",M="79beea9c4fdb49a5adab4843729e1fa0-19b42cd4-5bd4-4bf8-8e49-05dc0f7f97f8-7484",N="725da52713e94a7f8c04e11418b8378d-67b7892c-33c8-439c-a03e-bd0305e0bc8e-6732",O="2ddc7e5f54754fc68f3ae1c5b7f3eb20-1883aa8c-4c7b-42d1-b3d6-c9cdb5956783-7092",P="5f4ebf0f9a11474199e89f94bc7e2f50-61b8420a-22b1-4220-b531-4a4b96e4edb9-7406",Q="aa96061debfd4ec7b9704f62060b4ca6-a498d428-fdba-43da-bc8b-4fe51865cb7f-7984",R="577e32a3275e48c5a639a92c9a8af033-4028cb75-b5f4-4ad0-835e-0e26d79ff209-6823",S="291cebec6b9a4cbf9489bc8cf3a0cc50-06f4c682-bd49-4f88-a8c2-ac582180b7f9-7725",T="MUID",U="IntelligenceStatistic";!function(a){a[a.Unknown=0]="Unknown",a[a.Edu=1]="Edu",a[a.Biz=2]="Biz",a[a.MsaFree=4]="MsaFree",a[a.MSIT=8]="MSIT",a[a.MsaPaid=16]="MsaPaid",a[a.FastFood=32]="FastFood"}(m||(m={}));var V;!function(a){a[a.Designer=0]="Designer",a[a.Responder=1]="Responder",a[a.Unknown=2]="Unknown",a[a.AnalyzeViewer=3]="AnalyzeViewer",a[a.TeamsConfigUser=4]="TeamsConfigUser"}(V||(V={})),b.initializeTelemetry=d,b.getCurrentSessionId=e,b.flushLogs=f,b.getOrigin=g;var W=function(){function a(){this.sessionId=s.Guid.newGuid(),this.sessionDbId="",this.sessionDeviceId="",this.initialized=!1}return a.logData=function(b){a.BUFFER.queue(b)},Object.defineProperty(a.prototype,"SessionId",{get:function(){return this.sessionId},enumerable:!0,configurable:!0}),a.prototype.flush=function(a){this.initialized?AWTLogManager.flush(a):a()},a.prototype.initialize=function(){var b=this;p.getPageContext().Flighting.isEnabled("EnableMuidForAnonymousUsers")&&t.Instance.ensureMuid(),this.msaTenantIdInUpperCase=r.getMsaTenantId().toUpperCase(),this.userRole=j(),this.userType=m.Unknown,r.isOsi()&&"OneNoteUwp"!==g()&&u.FeaturePlanProvider.getUserType().done(function(a){return b.userType=a}).always(function(){var c={disableCookiesUsage:!0};switch(r.getEnvironmentType()){case"USGovProd":c.collectorUri="https://tb.pipe.aria.microsoft.com/Collector/3.0";break;case"USDoDProd":c.collectorUri="https://pf.pipe.aria.microsoft.com/Collector/3.0"}var d=k();AWTLogManager.initialize(d,c),b.initialized=!0,b.logger=AWTLogManager.getLogger(d),a.BUFFER.setFunctionToCall(b.logEvent.bind(b))})},a.prototype.logEvent=function(a){"session_start"===a.eventType&&this.enrichSessionInfo(a),this.logEventWorker(a)},a.prototype.enrichSessionInfo=function(a){if(a.properties){var b=JSON.parse(a.properties);b&&(this.sessionDbId=b.DbId,this.sessionDeviceId=b.DeviceId)}var c={BuildVersion:OfficeFormServerInfo.version,DbId:this.sessionDbId,DeviceId:this.sessionDeviceId,IsMobile:s.isMobile(),JQueryLoaded:!!window.$,SessionRing:h(),SessionUrlPath:window.location.origin+window.location.pathname,UserAgent:navigator.userAgent},d=g();d&&(c.Origin=d),a.eventName=a.eventType,a.duration=0,a.properties=JSON.stringify(c),a.timeStamp=s.DateTime.getTimeStamp()},a.prototype.logEventWorker=function(a){var b=new AWTEventProperties;b.setName(a.eventType),b.setProperty(D,a.eventName),b.setProperty(E,a.eventCorrelationId),b.setProperty(G,i(a.duration)),b.setProperty(F,i(a.timeStamp)),b.setProperty(H,a.properties),a.eventName&&a.eventName.indexOf(U)>=0?this.sendSingleTelemetryEventWithoutUserInfo(b):this.sendSingleTelemetryEvent(b)},a.prototype.sendSingleTelemetryEventWithoutUserInfo=function(a){l()||(a.setProperty(w,v),a.setProperty(A,this.userRole),a.setProperty(B,this.userType),this.logger.logEvent(a))},a.prototype.sendSingleTelemetryEvent=function(a){if(!l()){var b=OfficeFormServerInfo.userInfo.UserId,c=OfficeFormServerInfo.userInfo.TenantId,d=Forms.Common.getCurrentFormId();if(d&&a.setProperty(C,d),a.setProperty(w,v),a.setProperty(y,b),a.setProperty(z,c),a.setProperty(A,this.userRole),a.setProperty(B,this.userType),a.setProperty(x,this.sessionId),c)if(c.toUpperCase()===this.msaTenantIdInUpperCase){var e=OfficeFormServerInfo.userInfo.PUID;a.setProperty(I,e),a.setProperty(J,"MSAPUID")}else a.setProperty(I,b),a.setProperty(J,"UserObjectId"),a.setProperty(K,c);else!b&&p.getPageContext().Flighting.isEnabled("EnableMuidForAnonymousUsers")&&a.setProperty(T,t.Instance.Muid);this.logger.logEvent(a)}},a.BUFFER=new n.BufferForCall,a}();b.Telemetry=W;var X=new W;Forms.Telemetry.flushLogs=f,Forms.Telemetry.getOrigin=g},function(a,b,c){"use strict";function d(a,b){g[a]=b}function e(a){var b=a.Master.Question.Model.Type,c=g[b];if(c)return f.createElement(c,a);throw Error('Type "'+b+'" has not been registered.')}Object.defineProperty(b,"__esModule",{value:!0});var f=c(0);b.registerRendererComponentClass=d,b.createRendererElement=e;var g={};Forms.UX.Renderer.createRendererElement=e},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),e=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};Object.defineProperty(b,"__esModule",{value:!0});var f=c(0),g=c(3),h=c(12),i=c(10),j=c(41),k=c(39),l=c(1),m=OfficeForm.Exports.Control,n=OfficeForm.Exports.CategoryExtensionPoints,o=OfficeForm.Exports.ExtensionPoints,p=OfficeForm.Exports.FormLimitation,q=OfficeForm.Exports.Models,r=OfficeForm.Exports.QuizRenderer,s=OfficeForm.Exports.Resources,t=OfficeForm.Exports.Utilities,u=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.questionElementRef=f.createRef(),b.videoRatioHeight=9,b.videoRatioWidth=16,b.idPrefix=g.uniqueId("question"),b}return d(b,a),b.prototype.componentWillMount=function(){var a=this;this.update=function(){return a.forceUpdate(function(){var b=a.props.onHeightChange;b&&b()})};var b=this.props.Master;b.Question.Form.observe(this.update,[q.FormMaster.Schema.HasQuestionMedia]),b.observe(this.update),b.Question.observe(this.update);var c=q.ImageInfoMaster.Schema;b.Question.ImageInfoMaster.observe(this.update,[c.ResourceUrl,c.ContentType,c.OriginalFileName]),b.Question.ImageSettingsMaster.observe(this.update),this.getQuestionLocalizedItemMaster(this.props)},b.prototype.componentWillReceiveProps=function(a){this.getQuestionLocalizedItemMaster(a)},b.prototype.componentWillUnmount=function(){var a=this.props.Master;a.Question.ImageSettingsMaster.unobserve(this.update),a.Question.ImageInfoMaster.unobserve(this.update),a.Question.unobserve(this.update),a.unobserve(this.update),a.Question.Form.unobserve(this.update),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.update)},b.prototype.componentDidMount=function(){var a=$(this.questionElementRef.current),b=a.find(".office-form-question-formula span"),c=a.find(".office-form-question-choice-formula span");a.find("span").not(b).not(c).linkify()},b.prototype.render=function(){var a={className:"__question__ office-form-question",ref:this.questionElementRef};if(this.getValidationStyle()===m.ValidationStyles.Error||r.isWrongQuestion(this.props)){var b=this.props.IsMobile?"office-form-error-question-mobile":"office-form-error-question";a.className=t.Html.combineAttributes(a.className,b)}var c=null;this.isRequiredQuestionError()&&(c=m.createLabel({HTMLAttributes:{className:"validation-error-message-label",role:"alert"},Label:s.LocalizedStrings.Required_Question_Error_Message}));var d={className:"office-form-question-content office-form-theme-focus-border"},g=this.props.HTMLAttributes;g&&(d=t.Html.mergeReactProps(g,d));var h=t.Html.combineAttributes("office-form-question-element",this.isImageLayout()?"with-image":""),i=f.createElement("div",e({},d),this.createWrongResultLabel(),this.createTitleContainer(),f.createElement("div",{className:h},this.createReactNodes()),c),j=this.createFeedbackBox(),k=null;return void 0!==j&&(a.className=t.Html.combineAttributes(a.className,"office-form-studentview-question"),k=f.createElement("div",{className:"office-form-feedback-marginbottom-box"})),f.createElement("div",e({},a),this.createCoAuthorFacePile(),i,j,k)},b.prototype.createWrongResultLabel=function(){return r.createWrongResultLabel(this.props)},b.prototype.createReactNodes=function(){throw Error("to be overridden.")},b.prototype.isRequiredQuestionError=function(){if(!this.props.ShowValidationStyle)return!1;var a=this.props.Master,b=a.Question.verify(a.Model.Answer);return a.SubQuestionRuntimeMasters.forEach(function(a){a.Question.verify(a.Model.Answer)===q.QuestionValidationResult.RequiredError&&(b=q.QuestionValidationResult.RequiredError)}),b===q.QuestionValidationResult.RequiredError},b.prototype.getValidationStyle=function(){if(!this.props.ShowValidationStyle)return m.ValidationStyles.None;var a=this.props.Master,b=a.Question.verify(a.Model.Answer);return a.SubQuestionRuntimeMasters.forEach(function(a){a.Question.verify(a.Model.Answer)===q.QuestionValidationResult.RequiredError&&(b=q.QuestionValidationResult.RequiredError)}),b===q.QuestionValidationResult.Success?m.ValidationStyles.Success:m.ValidationStyles.Error},b.prototype.getQuestionId=function(){return this.idPrefix},b.prototype.getRequiredId=function(){return this.props.Master.Question.Model.Required?this.idPrefix+"-required":void 0},b.prototype.getQuestionTypeId=function(){return this.idPrefix+"-questiontype"},b.prototype.getElementProps=function(a){var b={"aria-describedby":this.getSubtitleId(),"aria-labelledby":t.Html.combineAttributes(this.getOrdinalId(),this.getTitleId(),this.getRequiredId(),this.getQuestionTypeId())};return a?t.Html.mergeReactProps(a,b):b},b.prototype.getQuestionLocalizedItemMaster=function(a){var b=a.Master,c=a.LocaleId;this.questionLocalizedItemMaster&&(this.questionLocalizedItemMaster.unobserve(this.update),this.questionLocalizedItemMaster=void 0),c&&(this.questionLocalizedItemMaster=h.FormLocalizedItemMaster.getQuestionResourceMaster(c,b.Question.Model.Id,b.Question.Form),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.update,[i.QuestionLocalizedItemMaster.Schema.title,i.QuestionLocalizedItemMaster.Schema.subtitle]))},b.prototype.createFeedbackBox=function(){var a=this.props.Master.SubQuestionRuntimeMasters,b=a[a.length-1],c=b&&b.Model,d=(c||this.props.Master.Model).AnswerEntity,e=d&&d.Feedback;if(!this.props.IsStudentViewMode||!e)return void 0;var g={HTMLAttributes:{className:t.Html.combineAttributes("feedback-icon forms-icon-size16x16",t.isEdge()?"edge":void 0,t.isIE()?"ie":void 0),role:"presentation"},IconName:"Chat"};return f.createElement("div",{className:"office-form-feedback-box"},m.createFontIconControl(g),f.createElement("div",{className:"office-form-feedback-content"},m.createRenderNewlines({content:e})))},b.prototype.createTitleLabel=function(){var a=this.props.Master.Question.Model,b=this.questionLocalizedItemMaster,c=b&&b.Model,d=this.props.Master.Question.Form.Model.HasQuestionMedia,e=c&&c.title||a.Title,g=!this.props.HideMedia&&(a.ImageInfo&&a.ImageInfo.ResourceUrl||d)?"office-form-question-title with-image":"office-form-question-title",h=this.props.Master.Question.Form,i=n.supportsExtensionPoint(h,o.ResponsePagePollView),j=!(this.isImageLayout()||i),k={"aria-level":2,className:g,id:this.getTitleId(),role:"heading"},l=a.Required?s.LocalizedStrings.Accessibility_RequiredAnswer:void 0,p=null;l&&(p=f.createElement("div",null,f.createElement("span",{className:"accessibility-reader-no-display",id:this.getRequiredId()},l)));var q=this.createQuestionTypeHint(),t=null;q&&(t=f.createElement("div",null,f.createElement("span",{className:"accessibility-reader-no-display",id:this.getQuestionTypeId()},q)));var u={children:[p,t,r.createQuizPointLabel(this.props)],HTMLAttributes:k,Label:e,Ordinal:this.props.Ordinal,ShowOrdinal:j,ShowRequiredStar:a.Required,Theme:this.props.Theme};return m.createLabel(u)},b.prototype.createQuestionTypeHint=function(){var a=this.props.Master.Question.Model,b=a.Type,c="";switch(b){case q.QuestionType.Choice:c=a.ChoiceType===q.ChoiceType.MultiChoice?s.LocalizedStrings.QuestionType_MultiChoice:s.LocalizedStrings.QuestionType_SingleChoice;break;case q.QuestionType.DateTime:c=s.LocalizedStrings.QuestionType_DateTime;break;case q.QuestionType.Rating:c=s.LocalizedStrings.QuestionType_Rating;break;case q.QuestionType.TextField:c=a.Multiline?s.LocalizedStrings.QuestionType_MultiLineText:s.LocalizedStrings.QuestionType_SingleLineText;break;case q.QuestionType.Ranking:c=s.LocalizedStrings.QuestionType_Ranking;break;case q.QuestionType.MatrixChoiceGroup:c=s.LocalizedStrings.QuestionType_MatrixChoiceGroup}return c},b.prototype.createTitleOrdinal=function(){return f.createElement("div",{className:"office-form-question-ordinal office-form-theme-primary-background"},f.createElement("span",{id:this.getOrdinalId()},this.props.Ordinal))},b.prototype.createTitleContainer=function(){var a,b,c,d=this.props.Master.Question,g=d.Model,h=d.Form.Model.HasQuestionMedia,i={},j="office-form-question-subtitle",k=this.props.IsMobile||t.isSmallScreen()||g.ImageSettings.Layout===q.ImageLayout.Horizontal&&g.ImageSettings.Size===q.ImageSize.Large,l=k||g.VideoInfo&&g.VideoInfo.Url;if(this.props.HideMedia||g.VideoInfo&&g.VideoInfo.Url||!(g.ImageInfo&&g.ImageInfo.ResourceUrl||h||g.ImageInfo.ImageProcessingStatus===q.ImageProcessingStatus.Uploading||g.ImageInfo.ImageProcessingStatus===q.ImageProcessingStatus.Picking)){
if(!this.props.HideMedia&&g.VideoInfo&&g.VideoInfo.Url){i.className=t.Html.combineAttributes(i.className,"question-title-container office-form-theme-video-question-background");var n={allowFullScreen:!0,frameBorder:"0",height:this.calcVideoDisplayHeight(),sandbox:"allow-scripts allow-same-origin allow-popups",src:g.VideoInfo.Url,width:"100%"};a=f.createElement("div",{className:"office-form-question-video-container"},f.createElement("iframe",e({},n))),j="office-form-question-subtitle with-video"}}else{i.className="question-title-container office-form-theme-image-question-background",j="office-form-question-subtitle with-image";var o=k?"office-form-question-horizontal-large-image-container office-form-theme-image-container-border":"office-form-question-image-container office-form-theme-image-container-border";if(g.ImageInfo&&g.ImageInfo.ResourceUrl){var r=d.ImageSettingsMaster.validateImageSettings(),s={className:o,style:k?void 0:{width:"{0}px".format(r.ContainerWidth)}},u=OfficeForm.Exports.createImageSpinner(g.ImageInfo);a=f.createElement("div",e({},s),f.createElement(OfficeForm.Exports.ImageRenderer,{Image:d.ImageInfoMaster,ImageSettings:d.ImageSettingsMaster,ImageType:"Question"}),u)}else if(g.ImageInfo.ImageProcessingStatus===q.ImageProcessingStatus.Uploading||g.ImageInfo.ImageProcessingStatus===q.ImageProcessingStatus.Picking){var s={className:o,style:{height:"{0}px".format(p.ImagePlaceHolderHeight),width:"{0}px".format(p.ImagePlaceHolderWidth)}};a=f.createElement("div",e({},s),OfficeForm.Exports.createImageSpinner())}}if(this.isSubtitleLayout())if(g.IsMathQuiz&&!g.IsPlainTextInMathField){var v=m.createFormulaRenderer({DisableLinebreaks:this.props.DisableFormulaLinebreak,Formula:g.Subtitle,onRenderComplete:this.props.onHeightChange});b=f.createElement("div",{className:"office-form-question-formula"},v)}else{var w=this.questionLocalizedItemMaster,x=w&&w.Model,y=x&&x.subtitle||g.Subtitle;c=m.createLabel({HTMLAttributes:{className:j,id:this.getSubtitleId()},Label:y})}return f.createElement("div",{className:"question-title-box"},f.createElement("div",e({},i),l?void 0:a,this.isImageLayout()?this.createTitleOrdinal():void 0,this.createTitleLabel(),c,l?a:void 0,b))},b.prototype.createCoAuthorFacePile=function(){var a,b=this,c=this.props.Master.Question.Model,d=c.CoAuthors&&c.CoAuthors.length>0;return d?c.CoAuthors[c.CoAuthors.length-1].userId!==OfficeFormServerInfo.userInfo.UserId&&(a=g.map(c.CoAuthors,function(a){if(a.userId!==OfficeFormServerInfo.userInfo.UserId){var c={ariaLabel:s.LocalizedStrings.DesignPage_NavBar_CoAuthor_Screen_Reader.format(a.displayName||a.userId,b.props.Ordinal||0),displayText:k.getDisplayText(a.firstName||"",a.lastName||""),email:a.email,isCoAuthUser:!0,key:a.userId,name:a.displayName,tooltip:a.displayName||a.userId};return f.createElement(j.AuthorFacePile,e({},c))}})):a=void 0,f.createElement("div",{className:"question-coAuthor-notification-container-render-mode","aria-live":"polite"},a)},b.prototype.calcVideoDisplayHeight=function(){if(t.isMobile()){var a=$(window).width();return 0===a&&(a=document.body.scrollWidth),a/(this.videoRatioWidth/this.videoRatioHeight)}return p.DefaultVideoHeight},b.prototype.getOrdinalId=function(){return this.isImageLayout()?this.idPrefix+"-ordinal":void 0},b.prototype.getTitleId=function(){return this.idPrefix+"-title"},b.prototype.getSubtitleId=function(){return this.isSubtitleLayout()?this.idPrefix+"-subtitle":void 0},b.prototype.isImageLayout=function(){var a=this.props.Master.Question.Form.Model.HasQuestionMedia;return a&&!this.props.HideMedia},b.prototype.isSubtitleLayout=function(){var a=this.props.Master.Question.Model;return a.ShowSubtitle&&!!a.Subtitle},b}(l.ReactComponent);b.QuestionRendererBase=u},function(a,b,c){"use strict";function d(a,b){var c=f(a);Nerve.Collection.itemsAddedInSource(b.Model.LocalizedResources,c)}function e(a){var b=f(a);return{localizedResources:b}}function f(a){var b=g(a),c=h(a);return b.forEach(function(a){if(a.localeId){var b=c[a.localeId];b&&(a.questionResources=b)}}),b}function g(a){var b=a.filter(function(a){return!a.questionId}),c=v.groupBy(b,function(a){return a.locale}),d=v.map(c,function(a){var b={formCloseMessage:null,localeId:null,localeName:null,questionResources:[],subtitle:null,thankYouMessage:null,title:null};return a.forEach(function(a){r(a,b)}),b});return d}function h(a){var b=a.filter(function(a){return a.questionId}),c=v.groupBy(b,function(a){return a.locale}),d={},e=v.map(c,function(a,b){var c=v.groupBy(a,function(a){return a.questionId}),d=v.map(c,function(a,c){var d={choices:[],choicesV1:[],leftDescription:null,localeId:b,localeName:null,option:null,questionId:c,rightDescription:null,subtitle:null,title:null},e=a.filter(function(a){return a.elementKey&&a.elementKey.startsWith("choiceid_")});if(e&&e.length>0){var f=v.map(e,function(a){var b={choiceId:null,description:null,key:null};return t(a,b),b});d.choices=f}var g=a.filter(function(a){return a.elementKey&&!a.elementKey.startsWith("choiceid_")});return g&&g.forEach(function(a){s(a,d)}),d});return d});return e.forEach(function(a){var b=a.length>0&&a[0].localeId;b&&(d[b]=a)}),d}function i(a){var b=q(a);return null!=a.formCloseMessage?(b.elementKey="formclosemessage",b.elementValue=a.formCloseMessage):null!=a.thankYouMessage&&(b.elementKey="thankyoumessage",b.elementValue=a.thankYouMessage),b}function j(a){var b=q(a);return null!=a.leftDescription?(b.elementKey="leftdescription",b.elementValue=a.leftDescription):null!=a.rightDescription?(b.elementKey="rightdescription",b.elementValue=a.rightDescription):null!=a.option&&'{"choicesV1":[]}'!==a.option&&(b.elementKey="option",b.elementValue=a.option),b}function k(a,b){var c=b.Model,d=Nerve.Collection.getItemWithKeyFields(c.LocalizedResources,{localeId:a.localeId});if(!d){var e={formCloseMessage:null,localeId:a.localeId,localeName:a.localeName,questionResources:[],subtitle:null,thankYouMessage:null,title:null};Nerve.Collection.itemsAddedInSource(c.LocalizedResources,[e])}}function l(a,b){var c=b.Model,d=Nerve.Collection.getItemWithKeyFields(c.LocalizedResources,{localeId:a});d&&Nerve.Collection.itemsDeletedInSource(c.LocalizedResources,[d])}function m(a,b,c,d){var e={choices:[],choicesV1:[],leftDescription:null,localeId:a.localeId,localeName:a.localeName,option:null,questionId:b,rightDescription:null,subtitle:null,title:null},f=Nerve.Collection.getItemWithKeyFields(d.Model.Questions,{Id:b});if(f&&f.ChoiceGroup&&f.ChoiceGroup.length>0){var g=v.map(f.ChoiceGroup,function(a){var b={choiceId:a.Id.toString(),description:null,key:a.Key};return b});e.choices=g}var h=Nerve.Collection.itemsAddedInSource(c.questionResources,[e]);return Nerve.getObjectMasterFromModel(h[0])}function n(a,b,c){var d={choiceId:a,description:null,key:b},e=Nerve.Collection.itemsAddedInSource(c.choices,[d]);return Nerve.getObjectMasterFromModel(e[0])}function o(a){var b={choiceId:null,description:""},c=Nerve.Collection.itemsAddedInSource(a.choicesV1,[b]);return Nerve.getObjectMasterFromModel(c[0])}function p(a,b){switch(b.localeId=a.locale,a.elementKey){case"title":b.title=a.elementValue;break;case"subtitle":b.subtitle=a.elementValue;break;case"localename":b.localeName=a.elementValue;break;default:throw Error("element key is not valid.")}}function q(a){var b={elementKey:null,elementValue:null,locale:null,questionId:null};return null!=a.title?(b.elementKey="title",b.elementValue=a.title):null!=a.subtitle?(b.elementKey="subtitle",b.elementValue=a.subtitle):null!=a.localeName&&(b.elementKey="localename",b.elementValue=a.localeName),b}function r(a,b){switch(a.elementKey){case"thankyoumessage":b.thankYouMessage=a.elementValue;break;case"formclosemessage":b.formCloseMessage=a.elementValue;break;default:p(a,b)}}function s(a,b){switch(b.questionId=a.questionId,a.elementKey){case"leftdescription":b.leftDescription=a.elementValue;break;case"rightdescription":b.rightDescription=a.elementValue;break;case"option":b.option=a.elementValue;break;default:p(a,b)}}function t(a,b){var c=a.elementKey;c&&c.startsWith("choiceid_")&&(b.choiceId=c.split("_")[1]),b.description=a.elementValue}function u(a,b){a&&a.length>0&&v.forEach(a,function(a){var c=[];v.forEach(b,function(b){var d=v.filter(a.questionResources,function(a){return a.questionId===b.oldId});v.forEach(d,function(a){a=v.clone(Nerve.getObjectMasterFromModel(a).getSnapshot()),a.questionId=b.newId,c.push(a)})}),Nerve.Collection.addItems(a.questionResources,c)})}Object.defineProperty(b,"__esModule",{value:!0});var v=c(3);b.appendLocalizedResources=d,b.parseLocalizedResources=e,b.parseFormLocalizedItem=i,b.parseQuestionLocalizedItem=j,b.createEmptyLocalizedResource=k,b.removeLocalizedResource=l,b.createEmptyQuestionLocalizedResource=m,b.createEmptyChoiceLocalizedResource=n,b.createEmptyChoiceV1LocalizedResource=o,b.duplicateQuestionLocaleResources=u,Forms.Models.appendLocalizedResources=d,Forms.Models.parseLocalizedResources=e,Forms.Models.createEmptyLocalizedResource=k,Forms.Models.removeLocalizedResource=l},function(a,b,c){"use strict";function d(){return Forms.Common.getCurrentFormId()}function e(){var a=Forms.Common.getCurrentFormId();return a&&g.decodeFormId(a)}Object.defineProperty(b,"__esModule",{value:!0});var f=OfficeForm.Exports.EnvironmentConfig,g=OfficeForm.Exports.Utilities.FormId,h=null,i=null;Forms.Common.setFormIdGetter=function(a){return h=a},Forms.Common.getCurrentFormId=function(){return h&&h()},Forms.Common.setFormGetter=function(a){return i=a},Forms.Common.getCurrentForm=function(){return i&&i()},Forms.Common.isOwnerMsftUser=function(){var a=g.decodeFormId(Forms.Common.getCurrentFormId()||"");return!!a.OrgId&&a.OrgId.toLowerCase()===f.getMsftTenantId()},Forms.Common.isOwnerMsaUser=function(){var a=g.decodeFormId(Forms.Common.getCurrentFormId()||"");return!!a.OrgId&&a.OrgId.toLowerCase()===f.getMsaTenantId()},Forms.Common.isOwnerOnFastFoodTenant=function(){var a=g.decodeFormId(Forms.Common.getCurrentFormId()||"");return!!a.OrgId&&-1!==f.getFastFoodTenantsId().indexOf(a.OrgId.toLowerCase())},b.getCurrentFormId=d,b.getCurrentFormIdObj=e},function(a,b,c){"use strict";function d(a){return h.LocalStorage.getItem(a)}function e(a,b){b?h.LocalStorage.setItem(a,b):h.LocalStorage.removeItem(i)}function f(a){var b=h.LocalStorage,c=a+n,d=b.getItem(c),e=d&&JSON.parse(d);if(!e||Date.now()>e)return b.removeItem(c),b.removeItem(a),null;var f=b.getItem(a);return f&&JSON.parse(f)}function g(a,b,c){var d=a+n,e=h.LocalStorage;b?(e.setItem(d,JSON.stringify(Date.now()+c)),e.setItem(a,JSON.stringify(b))):(e.removeItem(d),e.removeItem(a))}Object.defineProperty(b,"__esModule",{value:!0});var h=OfficeForm.Exports.SafeStorage,i="officeforms.uselegacylogindomain",j="officeforms.userAccountNameKey",k="officeforms.auth.detectAADInProgress",l="officeforms.auth.detectAADResult",m=function(){function a(){}return a.isSupported=function(){return h.supportsLocalStorage()},Object.defineProperty(a,"DetectAADInProgress",{get:function(){return f(k)},set:function(a){var b=5e3;g(k,a,b)},enumerable:!0,configurable:!0}),Object.defineProperty(a,"DetectAADResult",{get:function(){return"true"===d(l)},set:function(a){e(l,a?"true":null)},enumerable:!0,configurable:!0}),Object.defineProperty(a,"UseLegacyLoginDomain",{get:function(){return!!d(i)},set:function(a){e(i,a?"1":null)},enumerable:!0,configurable:!0}),Object.defineProperty(a,"UserAccountName",{get:function(){var a=d(j);return a&&JSON.parse(a)},set:function(a){e(j,a?JSON.stringify(a):null)},enumerable:!0,configurable:!0}),a}();b.AuthRelatedLocalStorage=m;var n=".timestamp";Forms.AuthRelatedLocalStorage=m},function(a,b,c){"use strict";function d(a){return a.map(f)}function e(a,b,c){var d=p.FieldsForCreatingForm.map(o.getFieldSchemaInfo).map(function(a){return a.Name});a=n.pick(a,d);var e=new p(q.DesignTimeForm,{ExistingInDataSource:!1,InitialData:a},"Group"===b,c);return s[e.getInstanceId()]=e,e.fieldsReady([p.Schema.Id]).done(function(){r[e.Model.Id]=e}),t.trigger(e),e}function f(a){var b=r[a.Id];if(b){var c=o.convertToSourceData(a,p.Schema);return b.Synchronizer.onSourceDataReceived(c),b}var d=OfficeForm.Exports.Utilities.FormId.decodeFormId(a.Id);return a=n.clone(a),a.OwnerId=d.OwnerId,a.OwnerTenantId=d.OrgId,a.TableId=d.TableId,b=new p(q.DesignTimeForm,{ExistingInDataSource:!0,InitialData:a},d.IsGroupOwner),s[b.getInstanceId()]=b,r[a.Id]=b,t.trigger(b),b}function g(a){return s[a]}function h(a){return r[a]}function i(a){var b=OfficeForm.Exports.Utilities.FormId.decodeFormId(a);return new p(q.ResponseTimeForm,{ExistingInDataSource:!0,InitialData:{Id:a,OwnerId:b.OwnerId,OwnerTenantId:b.OrgId,TableId:b.TableId}},b.IsGroupOwner)}function j(a){var b=OfficeForm.Exports.Utilities.FormId.decodeFormId(a);return new p(q.SharedTimeForm,{ExistingInDataSource:!0,InitialData:{Id:a,OwnerId:b.OwnerId,OwnerTenantId:b.OrgId,TableId:b.TableId}},b.IsGroupOwner)}function k(a){var b=OfficeForm.Exports.Utilities.FormId.decodeFormId(a);return new p(q.AnalysisTimeForm,{ExistingInDataSource:!0,InitialData:{Id:a,OwnerId:b.OwnerId,OwnerTenantId:b.OrgId,TableId:b.TableId}},b.IsGroupOwner)}function l(a){return new p(q.LocalForm,{InitialData:a},!1)}function m(a){t.register(a)}Object.defineProperty(b,"__esModule",{value:!0});var n=c(3),o=c(7);c(61);var p=OfficeForm.Exports.Models.FormMaster,q=OfficeForm.Exports.Models.FormSyncContext,r={},s={},t=new OfficeForm.Exports.Utilities.Process.CallbackManager;b.getDesignFormMasters=d,b.createNewFormMaster=e,b.getDesignFormMaster=f,b.getFormMasterByInstanceId=g,b.getFormMasterById=h,b.createResponseFormMaster=i,b.createSharedFormMaster=j,b.createAnalysisFormMaster=k,b.createLocalFormMaster=l;var u=Forms.Models.FormManager;u.createNewFormMaster=e,u.getDesignFormMaster=f,u.onFormMasterCreated=m},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var e=c(4),f=c(2),g=c(13),h=c(6),i=c(19),j=c(23),k=c(34),l=function(){function a(){this.tokenGetter=new k.TokenGetter}return a.prototype.getFormApiToken=function(){var a=s.AuthContext;return this.tokenGetter.getToken(a)},a.prototype.signIn=function(){return $.Deferred().resolve().promise()},a.prototype.signOut=function(){throw new Error("Method not implemented.")},a}();b.DeprecatedAuthenticator=l;var m=OfficeForm.Exports.ClientErrorNames,n=OfficeForm.Exports.EnvironmentConfig,o=OfficeForm.Exports.SafeStorage,p=OfficeForm.Exports.Utilities,q=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return d(b,a),b}(Error);b.AuthError=q;var r=function(a){function b(b){var c=a.call(this,b)||this;return c.name=m.AuthNoStorageError,c}return d(b,a),b}(q);b.AuthErrorNoStorage=r;var s=function(){function a(){}return Object.defineProperty(a,"AuthContext",{get:function(){return a.authContext},enumerable:!0,configurable:!0}),a.hasUserLoggedIn=function(){return e.getPageContext().Flighting.isEnabled("CookieAuth")?j.AuthTokenHelper.isUserLoggedIn():!!a.AuthContext.getCachedUser()},a.setUserAccountNameToStorage=function(b){o.DefaultStorage.setItem(a.userAccountNameKey,JSON.stringify(b))},a.getUserAccountNameFromStorage=function(){var b=o.DefaultStorage.getItem(a.userAccountNameKey);return b&&JSON.parse(b)},a.detectUserLoggedInAAD=function(b,c){if(i.AuthRelatedLocalStorage.isSupported()){var d=!i.AuthRelatedLocalStorage.DetectAADInProgress;d&&a.initDetectUserLoggedInAAD();var e=setInterval(function(){i.AuthRelatedLocalStorage.DetectAADInProgress||(clearInterval(e),i.AuthRelatedLocalStorage.DetectAADResult?d?b():setTimeout(function(){return h.reloadPage()},2e3):c())},100)}else c()},a.initDetectUserLoggedInAAD=function(){i.AuthRelatedLocalStorage.DetectAADInProgress=!0,i.AuthRelatedLocalStorage.DetectAADResult=!1;var b;b=e.getPageContext().Flighting.isEnabled("CookieAuth")?a.stateCookieAuthPrefix+p.Guid.newGuid():a.statePrefix+p.Guid.newGuid();var c={client_id:n.getAadClientId(),msafed:0,prompt:"none",redirect_uri:window.location.origin,resource:n.getFormsResourceId(),response_mode:"form_post",response_type:"token",state:b};o.DefaultStorage.setItem(a.stateKey,b);var d=new g.QosEvent("Auth.DetectUserLoggedInAAD");d.start(),window.formDetectUserLoggedInAADCallback=function(a){d.end({resultType:a?"ExpectedFailure":"Success"}),i.AuthRelatedLocalStorage.DetectAADInProgress=!1,i.AuthRelatedLocalStorage.DetectAADResult=!a};var f=n.getAadInstance()+"common/oauth2/authorize?"+jQuery.param(c);$("body").append('<iframe id="detectAADAuthFrame" style="display:none;" src='+f+"><iframe>")},a.handleAuthForContentPage=function(b){return a.deferredHandleAuth||(a.deferredHandleAuth=$.Deferred(),e.getPageContext().Flighting.isEnabled("CookieAuth")?a.deferredHandleAuth.resolve():a.handleAuth().done(function(c){if(c.HasUserSignedIn||!b)a.populateUserInfo(),a.deferredHandleAuth.resolve();else{if(a.AuthContext.login(),!a.loginWithRedirectPromise)throw Error("Authenticator.redirectForAuthContextLogin not called.");a.loginWithRedirectPromise.done(function(){return a.deferredHandleAuth.resolve()}).fail(function(){return a.deferredHandleAuth.reject()})}}).fail(function(b){a.deferredHandleAuth.reject(b)})),a.deferredHandleAuth.promise()},a.handleAuthForAddinPage=function(){return a.deferredHandleAuth||(a.deferredHandleAuth=$.Deferred(),e.getPageContext().Flighting.isEnabled("CookieAuth")?a.deferredHandleAuth.resolve():a.handleAuth().done(function(b){b.HasUserSignedIn?(a.populateUserInfo(),a.deferredHandleAuth.resolve()):a.deferredHandleAuth.reject()})),a.deferredHandleAuth.promise()},a.registerSignInHandler=function(b){a.loginHandler=b},a.signIn=function(){return a.loginHandler?a.loginHandler():(a.redirectToLogin(),$.Deferred().promise())},a.signInThenRefresh=function(){a.signIn().then(function(){return h.reloadPage(!0)})},a.redirectToLogin=function(){e.getPageContext().Flighting.isEnabled("CookieAuth")?j.AuthTokenHelper.redirectToSignIn():a.AuthContext.login()},a.signOut=function(){e.getPageContext().Flighting.isEnabled("CookieAuth")?h.redirectTo(OfficeFormServerInfo.signOutLink):(a.AuthContext.config.postLogoutRedirectUri=window.location.href,a.AuthContext.logOut())},a.handleAuth=function(){var b=o.supportsLocalStorage(),c=o.supportsSessionStorage();if(b||f.log({eventType:"engagement_event",eventName:"Auth.LocalStorageNotSupported",extraData:{supportsSessionStorage:c}}),!b&&!c)return $.Deferred().reject(new r("local storage or session storage can't be used")).promise();var d=o.DefaultStorage.getItem(a.userAccountNameKey),e="response_mode=form_post&msafed=0";e=d?e+"&username="+d:e;var g=window.location.origin,h={cacheLocation:b?"localStorage":"sessionStorage",clientId:n.getAadClientId(),displayCall:a.redirectForAuthContextLogin,extraQueryParameter:e,instance:n.getAadInstance(),postLogoutRedirectUri:g,redirectUri:g,tenant:""},i=new AuthenticationContext(h),j=i.isCallback(window.location.hash);if(i.handleWindowCallback(),j)return $.Deferred().promise();if(a.authContext=i,!a.hasUserLoggedIn())return $.Deferred().resolve({HasUserSignedIn:!1,UserSignedInBefore:!1}).promise();var k=$.Deferred();return i.acquireToken(n.getAadClientId(),function(b,c){var d=!b&&!!c;if(d){var e=i.getCachedUser();"live.com"===e.profile.idp&&(i.clearCache(),d=!1,f.log({eventType:"error_event",eventName:"UnexpectedLiveId"}))}else a.AuthContext.clearCache();k.resolve({HasUserSignedIn:d,UserSignedInBefore:!0})}),k.promise()},a.handleDetectUserLoggedInAADCallback=function(){return a.isDetectUserLoggedInAADCallback(window.location.hash)?(window.parent&&window.parent.formDetectUserLoggedInAADCallback&&window.parent.formDetectUserLoggedInAADCallback(a.isDetectUserLoggedInAADCallbackError(window.location.hash)),!0):!1},a.isDetectUserLoggedInAADCallback=function(b){return-1!==b.indexOf("state="+a.statePrefix)},a.isDetectUserLoggedInAADCallbackError=function(b){var c=!1,d=p.Html.getQueries(b.substring(1).trim());return d.state&&o.DefaultStorage.getItem(a.stateKey)===d.state&&(c=!0),!c||-1!==b.indexOf("error_description=")},a.populateUserInfo=function(){var b=a.AuthContext.getCachedUser();if(b){var c=b.profile.oid;OfficeFormServerInfo.userInfo={DisplayName:b.profile.name,GivenName:b.profile.given_name||b.profile.name&&b.profile.name.split(" ")[0],Email:b.profile.unique_name,UserId:c,TenantId:b.profile.tid,PUID:c.replace(/-/g,"").substring(16),IsMsa:!1}}},a.redirectForAuthContextLogin=function(b){if(a.loginWithRedirectPromise)throw Error("login in progress.");h.replaceUrl(b);var c=$.Deferred();a.loginWithRedirectPromise=c.promise(),setTimeout(function(){return c.reject()},3e3)},a.stateKey="officeforms.auth.state",a.statePrefix="form.detectUserLoggedInAAD.",a.stateCookieAuthPrefix=a.statePrefix+"cookieAuth.",a.userAccountNameKey="officeforms.userAccountNameKey",a}();b.Authenticator=s,Forms.Authenticator=s,Forms.AuthError=q},function(a,b,c){"use strict";function d(a){var b=$.Deferred();if(f.Flight.isEnabled("EnableFormsProRoute")){var c=window.location.pathname,d=c.toLowerCase().startsWith(h.toLowerCase());if(!a!=!d)return c=a?h+c:c.substring(h.length),g.replacePathName(c),b.promise()}return b.resolve().promise()}function e(){return f.Flight.isEnabled("FilterSurveyWhenIsIntegration")&&OfficeForm.Exports.EnvironmentSettings.IsIntegration?{name:"type",operator:"ne",value:"survey"}:void 0}Object.defineProperty(b,"__esModule",{value:!0});var f=OfficeForm.Exports.Flighting,g=c(6),h="/FormsPro";b.ensureEnvironment=d,b.generateGetFormsFilterOfIntegration=e,Forms.FormsProRelated.ensureEnvironment=d,Forms.FormsProRelated.generateGetFormsFilterOfIntegration=e},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c(24),e=c(13),f=c(2),g=OfficeForm.Exports.Utilities,h=OfficeForm.Exports.EnvironmentSettings,i=OfficeForm.Exports.EnvironmentConfig,j=function(){function a(){}return a.redirectToSignIn=function(a){var b=encodeURIComponent(a||window.location.href),c=OfficeFormServerInfo.userInfo.IsMsa,d="Response"===i.getPageType(),e=OfficeFormServerInfo.signInLink;!c||d?e=g.Html.updateUrlParam(e,"state",b):(e=OfficeFormServerInfo.signInLinkMsa,e=g.Html.updateUrlParam(e,"redirecturl",b)),Forms.Common.replaceUrl(e)},a.redirectWithPatchedRedirectUrl=function(){var a=window.location.hash,b=g.Html.getQueries().redirecturl;if(b&&-1===b.indexOf("#")&&a){window.location.hash="";var c=window.location.href;return c=g.Html.updateUrlParam(c,"redirecturl",encodeURIComponent(b+a)),Forms.Common.redirectTo(c),!0}return!1},a.isUserLoggedIn=function(){return!!OfficeFormServerInfo.userInfo.UserId},a.isAuthTokenExpiredFailure=function(b){var c=b&&b.response&&b.response.statusCode;if(Forms.getPageContext().Flighting.isEnabled("CookieAuth")&&c===d.HttpStatusCode.Unauthorized){if(b&&b.response&&"Expired"===b.response.headers["X-FailureReason"])return!0;var e=a.parseInnerCodeFromError(b);if(e===d.InnerCode.TokenExpired)return!0}return!1},a.isAntiForgeryTokenValidationFailure=function(b){var c=b&&b.response&&b.response.statusCode;if(Forms.getPageContext().Flighting.isEnabled("CookieAuth")&&c===d.HttpStatusCode.Forbidden){var e=a.parseInnerCodeFromError(b);if(e===d.InnerCode.AntiForgeryTokenValidationError)return!0}return!1},a.refreshAuthToken=function(b,c){window.formsRefreshAuthTokenCallbacks||(window.formsRefreshAuthTokenCallbacks=[]);var d=function(a,d){!d&&a?b():c()};if(window.formsRefreshAuthTokenCallbacks.push(d),!window.formsRefreshAuthTokenCallback){var h=new e.QosEvent("Auth.RefreshToken");h.start();var i=function(a,b){try{h.end({resultType:b?"ExpectedFailure":"Success",extraData:{loggedIn:a}}),$("#refreshAuthTokenFrame").remove();var c=window.formsRefreshAuthTokenCallbacks;if(c)if(b)c&&c.length>0&&c[0](a,b);else for(var d=0;d<c.length;++d)c[d](a,b)}finally{window.formsRefreshAuthTokenCallback=void 0,window.formsRefreshAuthTokenCallbacks=void 0}},j=!!g.getCookie("AADState.forms");if(a.isUserLoggedIn()||j){var k=null;a.isUserLoggedIn()?k=OfficeFormServerInfo.userInfo.IsMsa?a.signInLinkSilentMsa:a.signInLinkSilent:j&&(f.log({eventType:"engagement_event",eventName:"Auth.SilentSigninUsingAadState"}),k=a.signInLinkSilent);var l=$("<iframe id='refreshAuthTokenFrame' style='display: none' src='"+k+"' />");l.on("load",function(a){window.setTimeout(function(){window.formsRefreshAuthTokenCallback&&window.formsRefreshAuthTokenCallback(!1,!0)},5e3)}),window.formsRefreshAuthTokenCallback=i,$(document.body).append(l)}else i(!1,!0)}},a.detectUserLoggedIn=function(){return i.isOsi()?a.detectUserLoggedInWithProvider("Aad").then(function(b){return b?"Aad":a.detectUserLoggedInWithProvider("Msa").then(function(a){return a?"Msa":$.Deferred().reject().promise()})}):$.Deferred().reject().promise()},a.detectUserLoggedInWithProvider=function(b,c){var d="detect-user-loggedIn-frame",f=$.Deferred();if(window.formsDetectUserLoggedInCallback)f.reject();else{var h="Msa"===b,i=h?"Auth.DetectUserLoggedInMSA":"Auth.DetectUserLoggedInAAD",j=new e.QosEvent(i);j.start();var k=function(a,b){window.formsDetectUserLoggedInCallback=void 0,j.end({resultType:b?"ExpectedFailure":"Success"}),$("#"+d).remove(),f.resolve(a)},l=h?a.signInLinkSilentMsa:a.signInLinkSilent;c&&(l=g.Html.updateUrlParam(l,h?"username":"login_hint",encodeURIComponent(c)));var m=$("<iframe id='"+d+"' style='display: none' src='"+l+"' />");m.on("load",function(a){window.setTimeout(function(){window.formsDetectUserLoggedInCallback&&window.formsDetectUserLoggedInCallback(!1,!0)},5e3)}),window.formsDetectUserLoggedInCallback=k,$(document.body).append(m)}return f.promise()},a.parseInnerCodeFromError=function(a){var b=a&&a.response&&g.tryParseJson(a.response.body);return b.error&&parseInt(b.error.code)},a.signOutInIframe=function(){if(i.isOsi()){var a=new e.QosEvent("Auth.SignOutInIframe");a.start();var b=$('<iframe style="display: none" src="'+OfficeFormServerInfo.signOutLink+'" />');b.on("load",function(b){a.end({resultType:"Success"})}),$(document.body).append(b)}},a.signInWithOtherAccount=function(){f.log({eventType:"engagement_event",eventName:"Error.ErrorPage.SignInWithOtherAccount"}),i.isOsi()&&a.detectUserLoggedInWithProvider("Msa").then(function(a){if(a)f.log({eventType:"engagement_event",eventName:"Error.ErrorPage.SignOutInIframeInProgress"}),Forms.Common.redirectTo(OfficeFormServerInfo.signOutLink);else{var b=window.location.origin+"#Login=True";Forms.Common.replaceUrl(b)}})},a.forceAadSignIn=function(){var a=window.location.href,b="OrgId";a=g.Html.updateUrlParam(a,h.AuthProviderParam,b),Forms.Common.replaceUrl(a)},a.signInLinkSilent=OfficeFormServerInfo.signInLinkSilent,a.signInLinkSilentMsa=OfficeFormServerInfo.signInLinkSilentMsa,a}();b.AuthTokenHelper=j,Forms.AuthTokenHelper=j},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d;!function(a){a[a.Unauthorized=401]="Unauthorized",a[a.Forbidden=403]="Forbidden",a[a.NotFound=404]="NotFound"}(d=b.HttpStatusCode||(b.HttpStatusCode={}));var e;!function(a){a[a.UpdateFormFailed=609]="UpdateFormFailed",a[a.GetFormFailed=612]="GetFormFailed",a[a.CDBColumnNotFound=621]="CDBColumnNotFound",a[a.CDBTopLevelError=631]="CDBTopLevelError",a[a.ExceedMaximumFormLimition=650]="ExceedMaximumFormLimition",a[a.CDBTableNotFound=674]="CDBTableNotFound",a[a.TableReadOnly=636]="TableReadOnly",a[a.CDBTableMoved=639]="CDBTableMoved",a[a.NoPermission=700]="NoPermission",a[a.RequireLogin=701]="RequireLogin",a[a.UserNotAllowed=702]="UserNotAllowed",a[a.DisabledByTenantAdmin=703]="DisabledByTenantAdmin",a[a.AntiForgeryTokenValidationError=704]="AntiForgeryTokenValidationError",a[a.UserNeedMultiFactorAuth=705]="UserNeedMultiFactorAuth",a[a.CDBUnauthorizedAccess=707]="CDBUnauthorizedAccess",a[a.NotAllowedBySetting=708]="NotAllowedBySetting",a[a.TokenExpired=711]="TokenExpired",a[a.NotRolloutMsaUser=712]="NotRolloutMsaUser",a[a.CoAuthNotAllowedForMsa=715]="CoAuthNotAllowedForMsa",a[a.NotAllowedByResponseOwnership=716]="NotAllowedByResponseOwnership",a[a.FailedToCheckUserLicense=750]="FailedToCheckUserLicense",a[a.LicenseNotFound=751]="LicenseNotFound",a[a.LicenseNotValid=752]="LicenseNotValid",a[a.AbusedForm=6100]="AbusedForm",a[a.ImageNotFound=805]="ImageNotFound",a[a.InvalidFormId=1001]="InvalidFormId",a[a.NotSupportComposeFormId=1002]="NotSupportComposeFormId",a[a.ResponseNotFound=1007]="ResponseNotFound",a[a.FormClosed=5e3]="FormClosed",a[a.MultiResponseNotAllowed=5001]="MultiResponseNotAllowed",a[a.FormNotStarted=5002]="FormNotStarted",a[a.FormEnded=5003]="FormEnded",a[a.FormSettingJSONParseError=5004]="FormSettingJSONParseError",a[a.NoODPermissionForOpenInExcel=5117]="NoODPermissionForOpenInExcel",a[a.FailedToCreatePermission=5501]="FailedToCreatePermission",a[a.FailedToDeletePermission=5503]="FailedToDeletePermission",a[a.CreateInfoNotCompletePermission=5504]="CreateInfoNotCompletePermission",a[a.DeleteNotExistPermission=5506]="DeleteNotExistPermission",a[a.CopyNotAllowed=5550]="CopyNotAllowed",a[a.FailedToTurnOnAllowCopy=5551]="FailedToTurnOnAllowCopy",a[a.FailedToTurnOffAllowCopy=5552]="FailedToTurnOffAllowCopy",a[a.IncorrectShareToken=5553]="IncorrectShareToken",a[a.ImageUploadFailed=5200]="ImageUploadFailed",a[a.ImageTypeConvertFailed=5201]="ImageTypeConvertFailed",a[a.ImageProviderGetCDBTokenFailed=5202]="ImageProviderGetCDBTokenFailed",a[a.CdbServiceUnavailable=6503]="CdbServiceUnavailable",a[a.OriginalOwnerIsEmpty=6700]="OriginalOwnerIsEmpty",a[a.OriginalOwnerNotFound=6701]="OriginalOwnerNotFound",a[a.CurrentSignedUserIsNotDelegator=6702]="CurrentSignedUserIsNotDelegator",a[a.CurrentOwnerIsActiveUser=6705]="CurrentOwnerIsActiveUser",a[a.EmbedFormNeedAuth=10001]="EmbedFormNeedAuth",a[a.WorkBookLostFocus=10100]="WorkBookLostFocus",a[a.GetTableDataFailed=10101]="GetTableDataFailed",a[a.InvalidWorkBookSchema=10102]="InvalidWorkBookSchema",a[a.DeleteFormFailed=10201]="DeleteFormFailed",a[a.DeleteFormSuccessed=10202]="DeleteFormSuccessed",a[a.DownloadExcelFileFailed=10203]="DownloadExcelFileFailed",a[a.DownloadExcelFileFailedOnIos=10204]="DownloadExcelFileFailedOnIos",a[a.ReexportToExcelFailed=10205]="ReexportToExcelFailed",a[a.DownloadExcelFileTimeout=10206]="DownloadExcelFileTimeout",a[a.NetworkIssue=15001]="NetworkIssue",a[a.GetGraphAPITokenFailed=15002]="GetGraphAPITokenFailed",a[a.LoginNotSupportInCurrentBrowser=15003]="LoginNotSupportInCurrentBrowser"}(e=b.InnerCode||(b.InnerCode={}))},function(a,b,c){"use strict";function d(a){switch(a){case"ShowStatement":return i.createElement("div",{className:"office-form-footer-block"},l.LocalizedStrings.Response_Page_Footer_Statement_2);case"ShowStatementWithNotice":return i.createElement("div",{className:"office-form-footer-block"},l.LocalizedStrings.Response_Page_Footer_Statement);default:return null}}function e(){var a={className:m.isOEmbedSPO()?"office-form-theme-spo-link":void 0,href:window.location.origin,target:"_blank"};return i.createElement("div",{className:"office-form-footer-inline"},i.createElement("a",h({},a),l.LocalizedStrings.Form_Footer_Powered))}function f(){return i.createElement("div",{className:"office-form-footer-inline"},l.LocalizedStrings.Form_Footer_Powered)}var g=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),h=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};Object.defineProperty(b,"__esModule",{value:!0});var i=c(0),j=c(1),k=c(55),l=OfficeForm.Exports.Resources,m=OfficeForm.Exports.Utilities,n=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return g(b,a),b.prototype.componentDidMount=function(){},b.prototype.componentWillUnmount=function(){},
b.prototype.render=function(){var a=this.props.TopExtraContent&&i.createElement("div",{className:"office-form-footer-block"},this.props.TopExtraContent),b=m.isOEmbedSPO()?e():f(),c=m.Html.combineAttributes("office-form-footer-container office-form-padding-align",this.props.HTMLAttributes&&this.props.HTMLAttributes.className);return i.createElement("div",{className:"office-form-footer office-form-theme-footer",role:"contentinfo"},i.createElement("div",{className:c},a,d(this.props.FooterType),i.createElement("div",{className:"office-form-footer-block"},b,i.createElement(k.FooterLinks,null))))},b}(j.ReactComponent);b.FooterControl=n,Forms.UX.Renderer.FooterControl=n,Forms.UX.Renderer.FooterLinks=k.FooterLinks},function(a,b,c){"use strict";function d(a){return a.SubMenu||!a.Active?a.children:f.createElement("div",e({},a.HTMLAttributes),a.children)}var e=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};Object.defineProperty(b,"__esModule",{value:!0});var f=c(0);b.MenuItem=d,Forms.UX.Controls.MenuItem=d},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(a,b){this.items=[],this.targetApi=a,b=b||{},this.deferredTimeInMs=b.deferredTimeInMs||100,this.maxCount=b.maxCount||10}return a.prototype.insert=function(a){var b=this,c=$.Deferred();return this.items.push({Arguments:a,Deferred:c}),this.items.length>=this.maxCount?this.triggerApi():void 0===this.timerID&&(this.timerID=window.setTimeout(function(){return b.triggerApi()},this.deferredTimeInMs)),c.promise()},a.prototype.triggerApi=function(){var a=this.items;this.items=[],void 0!==this.timerID&&(window.clearTimeout(this.timerID),this.timerID=void 0),0!==a.length&&this.targetApi(a.map(function(a){return a.Arguments})).done(function(b){if(a.length!==b.length)throw Error("All the elements needs to be listed in result array.");b.forEach(function(b,c){b.Succeeded?a[c].Deferred.resolve(b.Value):a[c].Deferred.reject(b.Error)})}).fail(function(b){a.forEach(function(a){a.Deferred.reject(b)})})},a}();b.BatchHelper=d},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c(2),e=c(29),f=c(4),g=OfficeForm.Exports.Utilities,h=OfficeForm.Exports.EnvironmentSettings,i=OfficeForm.Exports.PageMethods,j=function(){function a(){}return Object.defineProperty(a,"DeferredHandler",{get:function(){return a.deferredHandler||(a.deferredHandler=$.Deferred())},enumerable:!0,configurable:!0}),a.getPopupUrl=function(a,b,c){void 0===b&&(b="Default"),void 0===c&&(c=null);var d=g.Html.getAbsoluteUrl("/Pages/PopupLoginPage.aspx?"+h.PopupNotifyTypeParam+"="+a);return null!=b&&"Default"!==b&&(d+="&"+h.AuthProviderParam+"="+b),c&&(d+="&"+h.AuthUpnParam+"="+encodeURIComponent(c)),d},a.officeDialogSignIn=function(b,c){return Office.context.ui.displayDialogAsync(a.getPopupUrl("OfficeAPI",c?"WindowsLiveId":"OrgId",b),{width:50,height:70,hideTitle:!0,promptBeforeOpen:!1},function(b){var c=b.value;null!=c&&c.addEventHandler(Office.EventType.DialogMessageReceived,function(b){if(c.close(),b&&b.message){var d=JSON.parse(b.message);OfficeFormServerInfo=d||OfficeFormServerInfo}Forms.getPageContext().setFlightsBasingOnAuth_Deprecated(OfficeFormServerInfo.flights),a.DeferredHandler.resolve()})}),a.DeferredHandler.promise()},a.getAddinAccessToken=function(){if(h.IsAssignmentsIntegration)return this.assignmentsSsoHandler();if(g.applyTeamSSO())return this.teamSsoHandler();if(h.IsPPTIntegration){var a=e.getAddinType();if("Taskpane"===a&&f.getPageContext().Flighting.isEnabled("PPTTaskpaneAddinSSO"))return this.pptFirstPartySsoHandler();if("Content"===a){if(Office.context.platform===Office.PlatformType.PC&&f.getPageContext().Flighting.isEnabled("PPTWin32ContentAddinSSO"))return this.pptFirstPartySsoHandler();if(Office.context.platform===Office.PlatformType.OfficeOnline&&f.getPageContext().Flighting.isEnabled("PPTContentAddinSSO"))return this.pptThirdPartySsoHandler()}}else if("OneNoteUwp"===h.Host)return this.oneNoteUWPSsoHandler();return $.Deferred().reject("GetAddinAccessTokenFailed").promise()},a.teamSsoHandler=function(){var a=this,b=$.Deferred();return microsoftTeams.authentication.getAuthToken({successCallback:function(c){d.log({eventType:"engagement_event",eventName:"TeamsTab.Auth.SsoSuccess"}),a.refreshInfo(c).always(function(){return b.resolve(c)})},failureCallback:function(a){d.log({eventType:"error_event",eventName:"TeamsTabSsoLoginFailure",extraData:a}),b.reject(a)},resources:["https://forms.office.com"]}),b.promise()},a.assignmentsSsoHandler=function(){var a=this,b=$.Deferred(),c=function(d){if(d.data&&d.data.startsWith("GetAccessTokenFromAssignments:"))try{var e="GetAccessTokenFromAssignments:Bearer ",f=d.data.indexOf(e);if(-1!==f){var g=d.data.substring(f+e.length);a.refreshInfo(g).always(function(){return b.resolve(g)})}}finally{window.removeEventListener("message",c,!1)}};return window.addEventListener("message",c,!1),window.parent.postMessage("GetAccessTokenFromAssignments","*"),b.promise()},a.oneNoteUWPSsoHandler=function(){var a=this,b=$.Deferred();return OneNote.run(function(c){var e=c.application,f=e._GetServiceTokens("Form");return c.sync().then(function(){if(null!=f&&f.value.length>0){var c=f.value[0].headerValue;a.refreshInfo(c).always(function(){return b.resolve(c)})}else d.log({eventType:"error_event",eventName:"OneNoteAddinGetTokenFromUWPHostFailure",extraData:"Fail to Get Access Token from UWP OneNote host"}),b.reject()})})["catch"](function(a){d.log({eventType:"error_event",eventName:"OneNoteAddinGetTokenFromUWPHostFailure",extraData:a}),b.reject()}),b.promise()},a.pptFirstPartySsoHandler=function(){var a=this,b=$.Deferred(),c="Taskpane"===e.getAddinType();d.log({eventType:"engagement_event",eventName:c?"PowerPointTaskpaneAddinPage.Initialize.GetToken":"PowerPointContentAddinPage.Initialize.GetToken",extraData:{hostPlatform:Office.context.platform,isFirstParty:!0}});var f=function(e){d.log({eventType:"engagement_event",eventName:c?"PowerPointTaskpaneAddinPage.Initialize.GetTokenCompleted":"PowerPointContentAddinPage.Initialize.GetTokenCompleted",extraData:{hostPlatform:Office.context.platform,isFirstParty:!0,isGetAccessTokenSucceeded:!0}}),a.refreshInfo(e).always(function(){return b.resolve(e)})},g=function(a){d.log({eventType:"error_event",eventName:c?"PowerPointTaskpaneAddinGetTokenFailure":"PowerPointContentAddinGetTokenFailure",extraData:a}),b.reject(a)};if(Forms.getPageContext().Flighting.isEnabled("PPTWin32FirstPartySSOLegacyAPI")){var h=new OfficeCore.RequestContext,i=h.firstParty.authentication.getAccessToken({resource:"https://forms.office.com"});h.sync().then(function(){var a=i.value.accessToken;f(a)})["catch"](function(a){g(a)})}else{var j=OfficeFirstPartyAuth.getAccessToken({resource:"https://forms.office.com"});j.then(function(a){var b=a.accessToken;f(b)})["catch"](function(a){g(a)})}return b.promise()},a.pptThirdPartySsoHandler=function(){var a=this,b=$.Deferred();return d.log({eventType:"engagement_event",eventName:"PowerPointContentAddinPage.Initialize.GetToken",extraData:{isFirstParty:!1}}),Office.context.auth.getAccessTokenAsync?Office.context.auth.getAccessTokenAsync({forceConsent:!1,forceAddAccount:!1},function(c){if(c.status===Office.AsyncResultStatus.Succeeded){d.log({eventType:"engagement_event",eventName:"PowerPointContentAddinPage.Initialize.GetTokenCompleted",extraData:{isFirstParty:!1}});var e=c.value;a.refreshInfo(e).always(function(){return b.resolve(e)})}else d.log({eventType:"error_event",eventName:"PowerPointContentAddinGetTokenFailure",extraData:c.error}),b.reject(c.error)}):(d.log({eventType:"engagement_event",eventName:"PowerPointContentAddinPage.Initialize.GetTokenThirdPartySSONotSupported",extraData:{hostEnvironment:Office.context.host,hostPlatform:Office.context.platform}}),b.reject("Third party SSO API is not supported.")),b.promise()},a.teamsPopupSignIn=function(){return d.log({eventType:"engagement_event",eventName:"TeamsTab.Auth.Navigate"}),microsoftTeams.authentication.authenticate({url:a.getPopupUrl("TeamsAPI","OrgId"),width:770,height:485,successCallback:function(b){if(b){var c=JSON.parse(b);OfficeFormServerInfo=c||OfficeFormServerInfo}Forms.getPageContext().setFlightsBasingOnAuth_Deprecated(OfficeFormServerInfo.flights),d.log({eventType:"engagement_event",eventName:"TeamsTab.Auth.Success"}),a.DeferredHandler.resolve()},failureCallback:function(b){d.log({eventType:"error_event",eventName:"TeamsTabLoginFailure",extraData:b}),a.DeferredHandler.reject(b)}}),a.DeferredHandler.promise()},a.refreshInfo=function(a){try{return $.when(this.refreshUserInfo(a),this.refreshFlights(a))}catch(b){return d.log({eventType:"engagement_event",eventName:"TeamsTab.Auth.RefreshInfoFailed"}),$.Deferred().resolve().promise()}},a.refreshUserInfo=function(b){return a.userInfoPromise&&a.userInfoPromise.state()!==g.Promise.State.Rejected||(a.userInfoPromise=i.refreshUserInfoWithToken(b).then(function(){d.log({eventType:"engagement_event",eventName:"AddinPage.PageMethod.GetAddinUserInfoSuccess"})},function(a){d.log({eventType:"engagement_event",eventName:"AddinPage.PageMethod.GetAddinUserInfoFailed",extraData:{error:a}})})),a.userInfoPromise},a.refreshFlights=function(b){return a.flightPromise&&a.flightPromise.state()!==g.Promise.State.Rejected||(a.flightPromise=i.refreshFlightsWithToken(b).done(function(){d.log({eventType:"engagement_event",eventName:"AddinPage.PageMethod.GetFlightsSuccess"})}).fail(function(a){d.log({eventType:"engagement_event",eventName:"AddinPage.PageMethod.GetFlightsFailed",extraData:{error:a}})}).always(function(){return Forms.getPageContext().setFlightsBasingOnAuth_Deprecated(OfficeFormServerInfo.flights)})),a.flightPromise},a}();b.AddinAuth=j,Forms.AddinAuth=j},function(a,b,c){"use strict";function d(a){if(f)throw Error("initializing twice!");f=a}function e(){if(!f)throw Error("Not initialized.");return f}Object.defineProperty(b,"__esModule",{value:!0});var f;b.initializeAddinType=d,b.getAddinType=e},function(a,b,c){"use strict";function d(a,b,c){l.hasOwnProperty(b)||(l[b]=new k.BatchHelper(function(a){return e(a,b)}));var d={element:a,extraQosData:c};return l[b].insert(d)}function e(a,b){return OfficeForm.Exports.DataProvider.createDataProvider().createFormElements(a,b).then(function(a){return a.map(function(a){return"Created"===a.status.toString()?{Succeeded:!0,Value:a.entity}:{Error:new Error(a.errorMessage.message),Succeeded:!1}})})}function f(a,b,c){m.hasOwnProperty(a)||(m[a]=new k.BatchHelper(function(b){return g(b,a)}));var d={extraQosData:c,questionId:b};return m[a].insert(d)}function g(a,b){return OfficeForm.Exports.DataProvider.createDataProvider().deleteFormElements(a,b).then(j)}function h(a,b,c,d){var e={element:a,extraQosData:d,questionId:c};return n.hasOwnProperty(b)||(n[b]=new k.BatchHelper(function(a){return i(a,b)})),n[b].insert(e)}function i(a,b){return OfficeForm.Exports.DataProvider.createDataProvider().updateFormElements(a,b).then(j)}function j(a){return a.map(function(a){return"NoContent"===a.status.toString()?{Succeeded:!0,Value:void 0}:{Error:new Error(a.errorMessage.message),Succeeded:!1}})}Object.defineProperty(b,"__esModule",{value:!0});var k=c(27),l={},m={},n={};b.createElementBatch=d,b.deleteElementBatch=f,b.updateElementBatch=h,Forms.FormElementBatchRelated.createElementBatch=d,Forms.FormElementBatchRelated.deleteElementBatch=f,Forms.FormElementBatchRelated.updateElementBatch=h},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(){this.buffer=[]}return a.prototype.setFunctionToCall=function(a){var b=this;if(this.functionToCall!==a)if(this.functionToCall=a,a){var c=this.buffer;delete this.buffer,c&&c.length&&c.forEach(function(a){return b.functionToCall.apply(void 0,a)})}else this.buffer=this.buffer||[]},Object.defineProperty(a.prototype,"queue",{get:function(){return this.functionToCall?this.functionToCall:this.defaultQueue},enumerable:!0,configurable:!0}),a.prototype.defaultQueue=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.buffer.push(a)},a}();b.BufferForCall=d},function(a,b,c){"use strict";function d(a){var b={};return a&&a.split(";").forEach(function(a){"!"!==a[0]?b[a]=!0:(a=a.substr(1),b[a]=!1)}),b}function e(){var a={};if(!k.isProduction()||k.isProdAlternative()){var b="fo",c=l.Html.getQueries()[b];Array.isArray(c)&&(c=c[c.length-1]),c&&c.split(";").forEach(function(b){"!"!==b[0]?a[b.toUpperCase()]=!0:(b=b.substr(1).toUpperCase(),a[b]=!1)})}return a}function f(){switch(k.getEnvironmentType()){case"DevHost":return n.OnDevBox;case"Daily":case"Drill":case"Pilot":case"Trial":return n.OnDevBoxAndDaily;case"Weekly":case"Hotfix":return n.AllOnNonOSI;case"Int":case"MSInt":return n.AllOnButEDogProd;case"EDog":case"MSEDog":return n.AllOnButProd;case"WWProd":case"MSProd":case"USGovProd":case"USDoDProd":case"USGovGccProd":return n.AllOn;default:return n.AllOn}}function g(a,b){p[a]=b>=o,q[a]="environment"}function h(a,b){p[a]=b>=o,q[a]="tenant"}function i(a,b){p[a]=b>=o,q[a]="deprecated"}Object.defineProperty(b,"__esModule",{value:!0});var j=c(2),k=OfficeForm.Exports.EnvironmentConfig,l=OfficeForm.Exports.Utilities,m=function(){function a(a){var b=this;this.frozenValues={},this.tenantValuesReadiness=a.then(function(a){b.tenantValues=d(a)}),"pending"===this.tenantValuesReadiness.state()&&(this.valuesFromServer=d(OfficeFormServerInfo.flights))}return a.prototype.isEnabled=function(a){return this.isEnabledInternal(a)},a.prototype.isEnabledAsync=function(a){var b=this;if(!(a&&a in p))throw Error("Checking uninitialized flight "+a+".");return this.tenantValuesReadiness.then(function(){return b.isEnabledInternal(a)})},a.prototype.isEnabled_Deprecated=function(a){return this.isEnabledInternal(a)},a.prototype.isEnabledInternal=function(a){var b=q[a];switch(b){case"environment":if(a in this.frozenValues)return this.frozenValues[a];break;case"tenant":if(!this.tenantValues)throw Error('Checking flight "'+a+'" before ready.');break;case"deprecated":if(!this.tenantValues){var c=new Error('Checking flight "'+a+'" before ready.');j.log({eventName:"UnstableFlightChecking",eventType:"error_event",extraData:{flightName:a,stack:c.stack}})}break;default:throw Error("Checking uninitialized flight "+a+".")}var d=this.getFlightValue(a);return"environment"===b&&(this.frozenValues[a]=d),d},a.prototype.getFlightValue=function(a){var b=this;if(r[a]&&!r[a].every(function(a){return b.isEnabledInternal(a)}))return!1;var c=a.toUpperCase();if(c in s)return s[c];var d=this.tenantValues||this.valuesFromServer;return a in d?d[a]:p[a]},a}();b.Flight=m;var n;!function(a){a[a.AllOff=0]="AllOff",a[a.OnDevBox=1]="OnDevBox",a[a.OnDevBoxAndDaily=2]="OnDevBoxAndDaily",a[a.AllOnNonOSI=3]="AllOnNonOSI",a[a.AllOnButEDogProd=4]="AllOnButEDogProd",a[a.AllOnButProd=5]="AllOnButProd",a[a.AllOn=6]="AllOn"}(n||(n={}));var o=f(),p={},q={},r={},s=e(),t=function(a,b){r[a]=b};g("CookieAuth",n.AllOff),g("UpgradeUxStateModel",n.AllOff),i("CheckScriptLoading",n.AllOff),i("SubmitTimeDistributionInsight",n.AllOff),i("EnableNPSKeywordsInsight",n.AllOff),i("EnablePartialOrderInsight",n.AllOff),i("EnableResponseSentimentInsight",n.AllOff),i("EnableMsaContentValidation",n.AllOff),i("StraightLineVizForCorrelationInsight",n.AllOff),h("ResponseInApp",n.AllOnButEDogProd),h("MathIncorrectAnswerSuggestions",n.OnDevBoxAndDaily),h("MathQuestionGeneration",n.OnDevBoxAndDaily),h("TextFieldMathAnswers",n.OnDevBoxAndDaily),i("ReExportToExcelButton",n.AllOnButEDogProd),i("O365ConsumerWaffle",n.OnDevBox),i("EnableOnlineExcelForMSA",n.AllOff),h("QRCodePlus",n.AllOnButEDogProd),g("ShareQuickSubmitPage",n.AllOnButEDogProd),h("FileUpload",n.AllOnButEDogProd),i("FormInsight",n.AllOnButEDogProd),i("PartialPut",n.OnDevBox),h("FileUploadOnlyLargeFileAPI",n.AllOnButEDogProd),i("DropDown",n.AllOnButEDogProd),i("CopyPasteForChoice",n.AllOnButEDogProd),i("DisableOpenRedirection",n.AllOnButEDogProd),g("PPTContentAddinSSO",n.AllOnButEDogProd),g("PPTWin32ContentAddinSSO",n.AllOnButEDogProd),g("PPTTaskpaneAddinSSO",n.AllOnButEDogProd),g("PreviewInfoBar",n.AllOnButEDogProd),i("RefreshServerInfoInFrame",n.AllOnButEDogProd),i("MsaPreviewLabel",n.AllOn),i("EnableOptionSuggestsOption",n.AllOnButEDogProd),i("PrintForm",n.OnDevBox),i("IsStartTimeEndTimeManaged",n.AllOnButEDogProd),h("AssignmentsIFrameLimitParentHeaders",n.AllOnButEDogProd),i("FormsBranding",n.OnDevBoxAndDaily),i("EnableExperimentationClient",n.AllOnButEDogProd),i("FormInsightFeedbackV2",n.AllOnButEDogProd),i("EmailHrdFallback",n.AllOnButEDogProd),i("UseIdeas",n.AllOnButEDogProd),i("AddCustomizeTheme",n.AllOnButEDogProd),h("NetPromoteScore",n.AllOnButEDogProd),i("WordCloudMultipleRatio",n.AllOnButEDogProd),i("LogDownloadExcelErrorMessage",n.AllOnButEDogProd),i("DisableBrandingForMSA",n.AllOff),i("RecordIdentityAdminSetting",n.AllOnButEDogProd),g("EnableMuidForAnonymousUsers",n.AllOnButEDogProd),i("IntelligenceTitleLogMetric",n.AllOnButEDogProd),i("EnableFFUserGating",n.AllOnButEDogProd),h("EnableNonAnonymousForMSA",n.AllOnButEDogProd),i("OptionSuggestionFetchTimeout",n.AllOnButEDogProd),i("EmailReceipt",n.AllOnButEDogProd),h("NpsForMSA",n.AllOnButEDogProd),i("MoveIntelligence",n.AllOnButEDogProd),h("PPTSlideShowNavigateButton",n.AllOnButEDogProd),i("SocialSharing",n.AllOnButEDogProd),i("MSAIntroductionForResponder",n.AllOnButEDogProd),i("QuestionTagForIntelligence",n.AllOff),h("MSASampleForm",n.AllOnButEDogProd),i("UserSettings",n.AllOnButEDogProd),i("Question200Limit",n.AllOnButEDogProd),i("VerifyUserInResponsePage",n.AllOnButEDogProd),i("SectionMVP1",n.AllOnButEDogProd),g("DataClassification",n.AllOnButEDogProd),h("MultiLingualMVP1",n.AllOnButEDogProd),i("EnableFormsProRoute",n.AllOnButEDogProd),h("MSATemplate",n.AllOff),g("PPTWin32FirstPartySSOLegacyAPI",n.AllOnButEDogProd),i("QuestionBatchOperation",n.AllOff),i("FilterSurveyWhenIsIntegration",n.AllOnButEDogProd),i("CheckPhishingForm",n.AllOnButEDogProd),i("EnableLikertOptionSuggestsOption",n.AllOnButEDogProd),h("ThemeSuggestion",n.AllOnButEDogProd),g("LikertSubQuestions20Limit",n.AllOnButEDogProd),g("DataClassificationRuntime",n.AllOnButEDogProd),h("ThemeSuggestionPreview",n.AllOnButEDogProd),h("TestTenantFlight",n.AllOn),g("TestEnvironmentFlight",n.AllOn),i("TestDeprecatedFlight",n.AllOff),h("PromptToUseMicrosoftDomain",n.AllOnButEDogProd),t("TestTenantFlight",["TestEnvironmentFlight"])},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c(3),e=c(21),f=function(){function a(a){this.validAuthenticator=null,this.userInfo=null,OfficeFormServerInfo.isAuthV2Enabled?this.authenticators=a.concat():this.authenticators=[new e.DeprecatedAuthenticator]}return a.prototype.ensureSignIn=function(){var a=this;return this.signInPromise||(this.signInPromise=$.when(this.signOutPromise).then(function(){var b=function(c){var e=a.authenticators[c];return e?e.signIn().then(function(b){return a.userInfo=d.clone(b||null),a.validAuthenticator=e,b},function(){return b(c+1)}):$.Deferred().reject(new Error("Sign in failed.")).promise()};return b(0)})),this.signInPromise},a.prototype.getCurrentUser=function(){return this.userInfo},a.prototype.getFormApiToken=function(){var a=this;return this.ensureSignIn().then(function(){return a.validAuthenticator&&a.validAuthenticator.getFormApiToken()})},a.prototype.getSignInState=function(){return this.signInPromise?this.signInPromise.state():"not started"},a.prototype.signOut=function(){if(this.signOutPromise)return this.signOutPromise;if(!this.signInPromise)return $.Deferred().resolve().promise();var a=this.signInPromise,b=this.validAuthenticator;return this.signInPromise=void 0,this.validAuthenticator=null,this.userInfo=null,this.signOutPromise=a.then(function(){return b.signOut()}),this.signOutPromise},a}();b.AuthAdapter=f},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c(2),e=c(6),f=c(19),g=c(28),h=OfficeForm.Exports.Utilities,i=OfficeForm.Exports.EnvironmentConfig,j=function(){function a(){this.waitHostAccessTokenRetryCount=0}return a.prototype.getToken=function(b){var c=this;return h.Flight.isOembedTrialSSOEnabled()||h.Flight.isPPTContentAddinSSOEnabled()||h.Flight.isStreamSSOEnabled()?(a.getAccessTokenFromHostHandler||(a.getAccessTokenFromHostHandler=$.Deferred()),!a.shouldMemoryCachedTokenCheckBeSkipped()&&a.AccessTokenFromHost&&a.AccessTokenFromHost.isAccessTokenFromHostValid()?(a.getAccessTokenFromHostHandler.resolve(a.AccessTokenFromHost.AccessToken),a.getAccessTokenFromHostHandler.promise()):(("resolved"===a.getAccessTokenFromHostHandler.state()||"rejected"===a.getAccessTokenFromHostHandler.state())&&(a.getAccessTokenFromHostHandler=$.Deferred()),a.getAccessTokenFromHost(),this.waitHostAccessTokenRetryCount=0,this.waitForAccessToken(),a.getAccessTokenFromHostHandler.promise())):h.enterSSO()?g.AddinAuth.getAddinAccessToken().then(null,function(){return c.getTokenInternal(b)}):this.getTokenInternal(b)},a.shouldMemoryCachedTokenCheckBeSkipped=function(){return h.Flight.isPPTContentAddinSSOEnabled()||h.Flight.isStreamSSOEnabled()},a.getAccessTokenFromHost=function(){a.AccessTokenFromHost=null,window.addEventListener("message",a.receiveAccessToken,!1),window.parent.postMessage("GetAccessTokenFromHost","*")},a.receiveAccessToken=function(b){if(b.data.startsWith("FormsAccessTokenFromHost:"))try{var c="FormsAccessTokenFromHost:Bearer ",d=b.data.indexOf(c);if(-1!=d){var e=b.data.substring(d+c.length);a.AccessTokenFromHost=new k(e)}}finally{window.removeEventListener("message",a.receiveAccessToken,!1)}},a.prototype.getTokenInternal=function(b){var c=this,g=$.Deferred();if(Forms.getPageContext().Flighting.isEnabled("CookieAuth"))return g.resolve(null),g.promise();var j=b.getCachedUser();return j?(b.acquireToken(i.getFormsResourceId(),function(j,k){if(!j&&k)return c.lastAcquireTokenSuccessTime=new Date,void g.resolve(k);var l=b.getCachedToken(i.getAadClientId());if(!l){if(c.lastAcquireTokenSuccessTime){var m=(new Date).getTime()-c.lastAcquireTokenSuccessTime.getTime();d.log({eventName:"Auth.AcquireTokenIdleTime",eventType:"engagement_event",extraData:{error:j,idleTimeInMinutes:m/6e4}})}return b.clearCache(),void e.reloadPage()}if(b.clearCache(),j.match("^AADSTS50079:")){d.log({eventName:"AADAcquireTokenMfaCheckFailure",eventType:"error_event",extraData:j});var n=new Error;return n.name=OfficeForm.Exports.ClientErrorNames.AADAcquireTokenMfaCheckError,n.message=j,void g.reject(n)}if(!j.match("^AADSTS50058:")){d.log({eventName:"AADAcquireTokenFailure",eventType:"error_event",extraData:j});var n=new Error;return n.name=OfficeForm.Exports.ClientErrorNames.AADAcquireTokenError,n.message=j,void g.reject(n)}if(h.isIE()||h.isEdge()){var o=f.AuthRelatedLocalStorage.UseLegacyLoginDomain;if(d.log({eventName:"LoginIECrossZone",eventType:"error_event",extraData:{useLegacyLoginDomain:!!o}}),f.AuthRelatedLocalStorage.UseLegacyLoginDomain)f.AuthRelatedLocalStorage.UseLegacyLoginDomain=!1;else if(f.AuthRelatedLocalStorage.isSupported())return f.AuthRelatedLocalStorage.UseLegacyLoginDomain=!0,void e.reloadPage()}else d.log({eventName:"AADAcquireTokenFailure",eventType:"error_event",extraData:j});a.getThirdPartyCookieError(j).done(function(a){return g.reject(a)})}),g.promise()):(g.resolve(null),g.promise())},a.getThirdPartyCookieError=function(b){var c=$.Deferred();return a.detectThirdPartyCookieSupport(function(a){d.log({eventName:"Auth.ThirdPartyCookieSupport",eventType:"engagement_event",extraData:{allow:a}});var e=new Error(b);a?e.name=OfficeForm.Exports.ClientErrorNames.LoginIECrossZoneError:e.name=OfficeForm.Exports.ClientErrorNames.ThirdPartyCookieBlockedError,c.resolve(e)}),c.promise()},a.detectThirdPartyCookieSupport=function(a){var b=function(c){"TPC:NotSupported"===c.data?(a(!1),window.removeEventListener("message",b)):"TPC:Supported"===c.data&&(a(!0),window.removeEventListener("message",b))};window.addEventListener("message",b,!1);var c="https://controls.officeppe.com/thirdpartycookie/check.html";$("body").append('<iframe id="detectThirdPartyCookieFrame" style="display:none;" src='+c+"><iframe>")},a.prototype.waitForAccessToken=function(){var b=this;if(null!=a.AccessTokenFromHost){var c=a.AccessTokenFromHost.AccessToken;g.AddinAuth.refreshInfo(c).always(function(){return a.getAccessTokenFromHostHandler.resolve(c)})}else this.waitHostAccessTokenRetryCount<10?(this.waitHostAccessTokenRetryCount++,setTimeout(function(){return b.waitForAccessToken()},1e3)):(this.waitHostAccessTokenRetryCount=0,a.getAccessTokenFromHostHandler.resolve(null))},a.AccessTokenFromHost=null,a}();b.TokenGetter=j;var k=function(){function a(a){this.accessToken=a;var b=33e5;this.tokenExpireTime=(new Date).getTime()+b}return Object.defineProperty(a.prototype,"AccessToken",{get:function(){return this.accessToken},enumerable:!0,configurable:!0}),a.prototype.isAccessTokenFromHostValid=function(){return!!this.accessToken&&(new Date).getTime()<this.tokenExpireTime},a}()},function(a,b,c){"use strict";function d(){function a(a){b.current=a}var b=a;return b}Object.defineProperty(b,"__esModule",{value:!0});var e=c(0);e.createRef||(e.createRef=d)},function(a,b){"name"in Function.prototype||Object.defineProperty(Function.prototype,"name",{get:function(){var a=/function\s([^(]{1,})\(/,b=a.exec(this.toString());return b&&b.length>1?b[1].trim():""}})},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),c(22),c(30),c(2),c(13),c(26)},function(a,b,c){"use strict";function d(a){a&&!g[a]&&(g[a]=!0,e.log({eventName:"Flight."+a+"."+(f.Flight.isEnabled(a)?"Enabled":"Disabled"),eventType:"engagement_event"}))}Object.defineProperty(b,"__esModule",{value:!0});var e=c(2),f=OfficeForm.Exports.Flighting,g={};b.logFlightStatus=d,Forms.Common.logFlightStatus=d},function(a,b,c){"use strict";function d(a,b){var c=a.replace(/\s/,"");return b?c[c.length-1]:c[0]}function e(a,b){var c=a.replace(/\s/,"");return c.length<=2?b?c[0]:c[c.length-1]:b?c.substr(0,2):c.substr(c.length-2,c.length)}function f(a,b){var c="",d=a.split(" ");return 2===d.length?(c+=d[0].charAt(0).toUpperCase(),c+=d[1].charAt(0).toUpperCase()):3===d.length?(c+=d[0].charAt(0).toUpperCase(),c+=d[2].charAt(0).toUpperCase()):0!==d.length&&(c+=d[0].charAt(0).toUpperCase()),b&&c.length>1?c.charAt(1)+c.charAt(0):c}function g(a){return a=a.replace(k,""),a=a.replace(l,""),a=a.replace(m," "),a=a.trim()}function h(a,b){return null==a?"":(arguments.length<2&&(b=j.isRtl()),a=g(a),n.test(a)?d(a,!!b):o.test(a)||p.test(a)?e(a,!!b):f(a,!!b))}function i(a,b){return h(((a||"")+" "+(b||"")).trim())}Object.defineProperty(b,"__esModule",{value:!0});var j=OfficeForm.Exports.Utilities,k=new RegExp("\\(([^)]*)\\)","gi"),l=new RegExp("(?:[\x00-/:-@[-^`{-퟿-￿]|[�-�][�-�]|[�-�](?![�-�])|(?:[^�-�]|^)[�-�]) ","gi"),m=new RegExp("\\s+","gi"),n=new RegExp("[ء-ي٠-٩]"),o=new RegExp("[ᄀ-ᇿ|㄰-㆏|ꥠ-꥿|가-힯|ힰ-퟿]"),p=new RegExp("[一-鿌㐀-䶵﨎﨏﨑﨓﨔﨟﨡﨣﨤﨧-﨩]|[�-�][�-�]|�[�-��-�]|[�-�][�-�]|�[�-��-�]|�[�-�]");b.getInitials=h,b.getDisplayText=i,Forms.UX.getDisplayText=i,Forms.UX.getInitials=h},,function(a,b,c){"use strict";function d(a){return g.createElement(k,a)}var e=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),f=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};Object.defineProperty(b,"__esModule",{value:!0});var g=c(0),h=c(1),i=OfficeForm.Exports.ColorHelper,j=OfficeForm.Exports.Control.createFontIconControl,k=function(a){function b(b){return a.call(this,b)||this}return e(b,a),b.prototype.render=function(){var a=this.createColorInfo(),b=this.props.displayText?this.props.displayText.toLocaleUpperCase():j({HTMLAttributes:{className:"author-notification-icon"},IconName:"Contact"}),c={backgroundColor:a.backgroundColor,color:a.textColor},d={"aria-label":this.props.ariaLabel||this.props.tooltip,className:"author-notification-content",style:c,title:this.props.tooltip};return g.createElement("div",f({},d),g.createElement("span",{"aria-hidden":!0},b))},b.createColor=function(a){for(var c=8,d=0,e=a.length-1;e>=0;e--){var f=a.charCodeAt(e),g=e%c;d^=(f<<g)+(f>>c-g)}var h=d%b.COLOR_SWATCHES_LOOKUP.length;return b.COLOR_SWATCHES_LOOKUP[h]},b.prototype.createColorInfo=function(){var a=this.props,c="",d="";a.backgroundColor&&(c=i.colorToHex(a.backgroundColor)),a.textColor&&(d=i.colorToHex(a.textColor));var e=a.email||a.name;return""!==d&&""!==c||!e||(c=c||b.createColor(e),d=d||i.colorToHex(i.contrastingColor(i.hexToRGB(c)))),c=c||b.defaultBackgroundColor,d=d||b.defaultTextColor,{backgroundColor:c,textColor:d}},b.COLOR_SWATCHES_LOOKUP=["#3765E4","#D83B01","#B91C49","#910A19","#E40089","#971497","#8150FD","#562685","#2C5797","#007B8A","#11723F","#6F292A","#A16412"],b.defaultBackgroundColor=b.COLOR_SWATCHES_LOOKUP[0],b.defaultTextColor="#FFFFFF",b}(h.ReactComponent);b.AuthorFacePile=k,b.createFacePile=d,Forms.UX.createFacePile=d},function(a,b,c){"use strict";function d(a){return a?e[a]||null:b.defaultPredefinedTheme}Object.defineProperty(b,"__esModule",{value:!0});var e={};b.getPredefinedThemeByName=d,b.predefinedThemes=[{BackgroundColor:"#E8F2F4",BackgroundImage:null,Name:"Teal",PrimaryColor:"#008272",SecondaryColor:"#004B50",Thumbnail:"../../Images/Theme/teal-thumbnail.png"},{BackgroundColor:"#F7F1F7",BackgroundImage:null,Name:"Raspberry",PrimaryColor:"#8D398F",SecondaryColor:"#712E72",Thumbnail:"../../Images/Theme/raspberry-thumbnail.png"},{BackgroundColor:"#FCF2F0",BackgroundImage:null,Name:"Dark_Orange",PrimaryColor:"#CE4B28",SecondaryColor:"#BC2E1B",Thumbnail:"../../Images/Theme/darkorange-thumbnail.png"},{BackgroundColor:"#F6EFF2",BackgroundImage:null,Name:"Pomegranate",PrimaryColor:"#911844",SecondaryColor:"#4E0D25",Thumbnail:"../../Images/Theme/pomegranate-thumbnail.png"},{BackgroundColor:"#FAEDF7",BackgroundImage:null,Name:"Pink",PrimaryColor:"#BF3088",SecondaryColor:"#BC2075",Thumbnail:"../../Images/Theme/pink-thumbnail.png"},{BackgroundColor:"#F2F8E7",BackgroundImage:null,Name:"Bright_Green",PrimaryColor:"#0E8906",SecondaryColor:"#448715",Thumbnail:"../../Images/Theme/brightgreen-thumbnail.png"},{BackgroundColor:"#ECF8FE",BackgroundImage:null,Name:"Bright_Blue",PrimaryColor:"#0078D7",SecondaryColor:"#0D5BC3",Thumbnail:"../../Images/Theme/brightblue-thumbnail.png"},{BackgroundColor:"#E7EDF3",BackgroundImage:null,Name:"Medium_Dark_Blue",PrimaryColor:"#004B8B",SecondaryColor:"#032D63",Thumbnail:"../../Images/Theme/darkblue-thumbnail.png"},{BackgroundColor:"#F4EBDC",BackgroundImage:"../../Images/Theme/office.png",Name:"Office",PrimaryColor:"#B84F22",SecondaryColor:"#cb6a07",Thumbnail:"../../Images/Theme/office-thumbnail.png"},{BackgroundColor:"#DCE9F4",BackgroundImage:"../../Images/Theme/ocean.png",Name:"Ocean",PrimaryColor:"#1D5482",SecondaryColor:"#143350",Thumbnail:"../../Images/Theme/ocean-thumbnail.png"},{BackgroundColor:"#DCE9F4",BackgroundImage:"../../Images/Theme/sky.png",Name:"Sky",PrimaryColor:"#006DB2",SecondaryColor:"#075F9C",Thumbnail:"../../Images/Theme/sky-thumbnail.png"},{BackgroundColor:"#DCE9F4",BackgroundImage:"../../Images/Theme/ski.png",Name:"Ski",PrimaryColor:"#006DB2",SecondaryColor:"#075F9C",Thumbnail:"../../Images/Theme/ski-thumbnail.png"},{BackgroundColor:"#EAF4DC",BackgroundImage:"../../Images/Theme/city01.png",Name:"City01",PrimaryColor:"#3A501D",SecondaryColor:"#2A3B13",Thumbnail:"../../Images/Theme/city01-thumbnail.png"},{BackgroundColor:"#DCE9F4",BackgroundImage:"../../Images/Theme/city02.png",Name:"City02",PrimaryColor:"#024582",SecondaryColor:"#00315D",Thumbnail:"../../Images/Theme/city02-thumbnail.png"},{BackgroundColor:"#EAF4DC",BackgroundImage:"../../Images/Theme/chemistry.png",Name:"Chemistry",PrimaryColor:"#025700",
SecondaryColor:"#013D00",Thumbnail:"../../Images/Theme/chemistry-thumbnail.png"},{BackgroundColor:"#DCE9F4",BackgroundImage:"../../Images/Theme/astronomy.png",Name:"Astronomy",PrimaryColor:"#0A1431",SecondaryColor:"#030716",Thumbnail:"../../Images/Theme/astronomy-thumbnail.png"},{BackgroundColor:"#F5F2FF",BackgroundImage:"../../Images/Theme/office2.png",Name:"Office02",PrimaryColor:"#562685",SecondaryColor:"#32145A",Thumbnail:"../../Images/Theme/office2-thumbnail.png"},{BackgroundColor:"#E6EDF3",BackgroundImage:"../../Images/Theme/meeting.png",Name:"Meeting",PrimaryColor:"#053870",SecondaryColor:"#032D63",Thumbnail:"../../Images/Theme/meeting-thumbnail.png"}],b.predefinedThemes.forEach(function(a,c){a=Object.freeze(a),b.predefinedThemes[c]=a,e[a.Name]=a}),b.defaultPredefinedTheme=b.predefinedThemes[0],b.customizedThemeName="Customized Theme",b.defaultCustomizedBackgroundColor="#E8F2F4",b.defaultCustomizedPrimaryColor="#008272",b.defaultCustomizedSecondaryColor="#004B50",Forms.Models.predefinedThemes=b.predefinedThemes,Forms.Models.defaultTheme=b.defaultPredefinedTheme,Forms.Models.defaultCustomizedBackgroundColor=b.defaultCustomizedBackgroundColor,Forms.Models.defaultCustomizedPrimaryColor=b.defaultCustomizedPrimaryColor,Forms.Models.defaultCustomizedSecondaryColor=b.defaultCustomizedSecondaryColor},function(a,b,c){"use strict";function d(a,b){return h.hasOwnProperty(b)||(h[b]=new g.BatchHelper(function(a){return e(a,b)})),h[b].insert(a)}function e(a,b){var c=a.length,d=f.getFormMasterById(b);return d?OfficeForm.Exports.Models.FormDataSource.getDataProviderByFormMaster(d).copyLocaleResources(b,a).then(function(){for(var a=[],b=0;c>b;++b)a.push({Succeeded:!0,Value:void 0});return a},function(a){for(var b=[],d=0;c>d;++d)b.push({Error:a,Succeeded:!1});return b}):$.Deferred().resolve().promise()}Object.defineProperty(b,"__esModule",{value:!0});var f=c(20),g=c(27),h={};b.createLocalizedItemBatch=d},,,function(a,b,c){"use strict";function d(a){var b=[],c=Object.keys(a);return c.forEach(function(c){a[c]&&(b=b.concat(t[c]))}),b}function e(a){var b=g(a),c={className:"forms-icon-size20x20 office-form-theme-quiz-point analyze-view-file-icon",style:{color:b.Color}};return h.createElement(i.FontIconControl,{HTMLAttributes:c,IconName:b.Name})}function f(a){switch(a){case"Audio":return j.LocalizedStrings.UploadFile_Type_Audio;case"Excel":return j.LocalizedStrings.UploadFile_Type_Excel;case"Image":return j.LocalizedStrings.UploadFile_Type_Image;case"PDF":return j.LocalizedStrings.UploadFile_Type_PDF;case"PowerPoint":return j.LocalizedStrings.UploadFile_Type_PowerPoint;case"Text":return j.LocalizedStrings.UploadFile_Type_Text;case"Video":return j.LocalizedStrings.UploadFile_Type_Video;case"Word":return j.LocalizedStrings.UploadFile_Type_Word;default:return""}}function g(a){var b=a.split("."),c=b[b.length-1].toLowerCase(),d=u[s[c]];return d||{Color:"#666666",Name:"TextDocument"}}Object.defineProperty(b,"__esModule",{value:!0});var h=c(0),i=OfficeForm.Exports.Control,j=OfficeForm.Exports.Resources,k=["mp3","aif","iff","m3u","m4a","mid","mpa","ra","wav","wma"],l=["xls","xlt","xlm","xlsx","xlsm","xltx","xltm"],m=["jpg","jpeg","png","gif","bmp","tiff","psd","thm","yuv","ai","drw","eps","ps","svg","3dm","max"],n=["pdf"],o=["ppt","pot","pps","pptx","pptm","potx","potm","ppam","ppsx","ppsm","sldx","sldm"],p=["txt","rtf","wpd","wps","log","msg","pages"],q=["avi","mp4","mov","wmv","asf","3g2","3gp","asx","flv","mpg","rm","swf","vob"],r=["doc","dot","wbk","docx","docm","dotx","dotm","docb"],s={};k.forEach(function(a){return s[a]="Audio"}),l.forEach(function(a){return s[a]="Excel"}),m.forEach(function(a){return s[a]="Image"}),n.forEach(function(a){return s[a]="PDF"}),o.forEach(function(a){return s[a]="PowerPoint"}),p.forEach(function(a){return s[a]="Text"}),q.forEach(function(a){return s[a]="Video"}),r.forEach(function(a){return s[a]="Word"});var t={Audio:k,Excel:l,Image:m,PDF:n,PowerPoint:o,Text:p,Video:q,Word:r},u={Audio:{Color:"#666666",Name:"Microphone"},Excel:{Color:"#217346",Name:"ExcelDocument"},Image:{Color:"#666666",Name:"Photo2"},PDF:{Color:"#666666",Name:"PDF"},PowerPoint:{Color:"#B7472A",Name:"PowerPointDocument"},Text:{Color:"#666666",Name:"TextField"},Video:{Color:"#666666",Name:"Video"},Word:{Color:"#2B579A",Name:"WordDocument"}};b.getAcceptedFileTypes=d,b.getFileIcon=e,b.convertFileTypeToString=f,Forms.UX.FileUpload.getFileIcon=e,Forms.UX.FileUpload.getFileIconInDetailTable=function(a){var b=g(a);return'<i class="ms-Icon ms-Icon--'+b.Name+' forms-icon-size20x20 response-dialog-fileIcon office-form-theme-quiz-point" style="color: '+b.Color+';"></i>'}},function(a,b,c){"use strict";function d(a){return Nerve.getObjectMasterFromModel(a)}function e(){return{Title:k.LocalizedStrings.DesciptiveElementType_Section_DefaultTitle,Type:j.QuestionType.Section}}var f=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var g=c(3),h=c(2),i=c(60),j=OfficeForm.Exports.Models,k=OfficeForm.Exports.Resources,l=Nerve.Spec,m=OfficeForm.Exports.Utilities,n={CoAuthors:l.collectionOf(l.reference(),{IsLocalField:!0}),Id:l.string({IsKeyField:!0,SourceFieldName:"id"}),ImageInfo:l.fromMasterClass(function(){return j.ImageInfoMaster},{SourceFieldName:"image"}),ImageSettings:l.fromMasterClass(function(){return j.ImageSettingsMaster},{IsLocalField:!0}),IntegratedSavingState:l.reference({IsLocalField:!0}),Order:l.number({SourceFieldName:"order"}),QuestionInfo:l.string({SourceFieldName:"questionInfo"}),SavingState:l.reference({IsLocalField:!0}),ShowSubtitle:l["boolean"]({IsLocalField:!0}),Subtitle:l.string({SourceFieldName:"subtitle"}),Title:l.string({SourceFieldName:"title"}),Type:l.reference({SourceFieldName:"type"}),VideoInfo:l.create({Author:l.string(),OriginalHeight:l.number(),OriginalWidth:l.number(),Thumbnail_url:l.string(),Title:l.string(),Url:l.string()},{IsLocalField:!0})};b.getDescriptiveElementMaster=d,b.createDefaultSectionDefinition=e;var o=function(a,b){return new i.DescriptiveElementDataSource(a,b)},p=function(a){function b(c){var d=this,e=$.Deferred();if(!c.InitialData)throw Error("Element model should created with initial data.");return c=g.clone(c),c.InitialData=g.clone(c.InitialData),d=a.call(this,c,{MasterReady:e.promise(),Scheduler:new j.Scheduler})||this,j.keepSavingStateUpdated(d),d.updateIntegratedSavingState(),d.initializeQuestionInfoBinder(c),j.bindImageSettings(d,b.Schema.ImageInfo,b.Schema.ImageSettings),b.Rules.forEach(function(a){return d.addRule(a)}),d.coAuthorTimers={},e.resolve(),d}return f(b,a),Object.defineProperty(b.prototype,"Form",{get:function(){return this.Parent.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"ImageInfoMaster",{get:function(){return j.getImageInfoMaster(this.Model.ImageInfo)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"ImageSettingsMaster",{get:function(){return j.getImageSettingsMaster(this.Model.ImageSettings)},enumerable:!0,configurable:!0}),b.prototype.isFieldReady=function(c){return c=b.getSourceFields([c])[0],a.prototype.isFieldReady.call(this,c)},b.prototype.ensureFieldsReady=function(c){return a.prototype.ensureFieldsReady.call(this,b.getSourceFields(c))},b.prototype.fieldsReady=function(c){return a.prototype.fieldsReady.call(this,b.getSourceFields(c))},b.prototype.ensureCreationDone=function(){var a=this;return this.ImageInfoMaster.Synchronizer.flush().then(function(){return a.Synchronizer.flush()})},b.prototype.setVideoUrl=function(a){var c=this.Model.VideoInfo,d=Nerve.getObjectMasterFromModel(c);d.bulkEdit(function(){c.Url=b.generateEmbedURLLocally(a),c.Title="",c.Author="",c.Thumbnail_url="",c.OriginalWidth=b.defaultWidth,c.OriginalHeight=b.defaultHeight})},b.prototype.clearVideoInfo=function(){this.Model.VideoInfo={Author:"",OriginalHeight:b.defaultHeight,OriginalWidth:b.defaultWidth,Thumbnail_url:"",Title:"",Url:""}},b.prototype.createSyncJob=function(a){var b=this,c=$.Deferred(),d=c.promise().then(function(){return b.Form.getQuestionSyncBlocker(d)}).then(a);return c.resolve(),d},b.prototype.createUploadSyncJob=function(a){var b=this,c=$.Deferred(),d=$.when(c,this.uploadJob).then(function(){return b.createSyncJob(a)});return c.resolve(),this.uploadJob=m.Promise.always(d),d},b.prototype.updateCoAuthors=function(a){var b=this,c=g.filter(this.Model.CoAuthors,function(b){return a.userId===b.userId})[0],d=function(){c&&e.deleteItems([c]),a.userId in b.coAuthorTimers&&(clearTimeout(b.coAuthorTimers[a.userId]),delete b.coAuthorTimers[a.userId])},e=Nerve.getCollectionMasterFromModel(this.Model.CoAuthors);e.bulkEdit(function(){d(),c=Nerve.Collection.addItems(b.Model.CoAuthors,[a])[0]});var f=1e4;this.coAuthorTimers[a.userId]=window.setTimeout(d,f)},b.prototype.initializeQuestionInfoBinder=function(a){this.questionInfoBinder=new j.FieldBinder(this,b.Schema.QuestionInfo,b.QuestionInfoFieldSet),a.InitialData&&this.isFieldReady(b.Schema.QuestionInfo)&&(a.ExistingInDataSource||a.InitialData.QuestionInfo?this.questionInfoBinder.deserialize():this.questionInfoBinder.serialize())},b.prototype.updateIntegratedSavingState=function(){this.isFieldReady(b.Schema.ImageInfo)?this.Model.IntegratedSavingState=j.integrateSavingState([this.Model.ImageInfo.SavingState,this.Model.SavingState]):this.Model.IntegratedSavingState=this.Model.SavingState},b.generateEmbedURLLocally=function(a){var b=document.createElement("a");b.href=a;var c=b.pathname.split("/"),d=a.substring(a.indexOf("?")+1),e=m.Html.getQueries(d),f=e.v||c[0]||c[1];return"https://www.youtube.com/embed/"+f+"?feature=oembed&modestbranding=1&rel=0"},Object.defineProperty(b,"QuestionInfoFieldSet",{get:function(){return b.questionInfoFieldSet||(b.questionInfoFieldSet=new j.FieldSet([b.Schema.ImageSettings,b.Schema.ShowSubtitle,b.Schema.VideoInfo])),b.questionInfoFieldSet},enumerable:!0,configurable:!0}),Object.defineProperty(b,"Rules",{get:function(){if(!b.rules){var a=b.Schema;b.rules=[{InterestedFields:[a.Id],Name:"block id changes",onChange:function(a){var b=a.Master.Model,c=b.Id,d=a.OldValues.Id;b.Id=d;var e;try{throw Error("Changing element id")}catch(f){e=f}h.log({eventName:"UpdatingElementId",eventType:"error_event",extraData:{newId:c,oldId:d,stack:e.stack}})}},{InterestedFields:[a.ImageInfo.SavingState,a.SavingState],Name:"IntegrateSavingState",onChange:function(a){return a.Master.updateIntegratedSavingState()}}]}return b.rules},enumerable:!0,configurable:!0}),b.getSourceFields=function(a){return g.uniq(a.map(function(a){return b.QuestionInfoFieldSet.covers(a)?b.Schema.QuestionInfo:a}))},b.defaultWidth=459,b.defaultHeight=256,b}(Nerve.createObjectMasterClass("DescriptiveElementMaster",n,o));b.DescriptiveElementMaster=p,Forms.Models.DescriptiveElementMaster=p,Forms.Models.getDescriptiveElementMaster=d},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c(3),e=c(17),f=OfficeForm.Exports.Models.FormMaster,g=OfficeForm.Exports.Models.QuestionMaster,h=OfficeForm.Exports.Resources,i=OfficeForm.Exports.Utilities,j=500,k=100,l=function(){function a(a){this.formMaster=a}return Object.defineProperty(a,"QuestionOrderFloor",{get:function(){return j},enumerable:!0,configurable:!0}),Object.defineProperty(a,"QuestionOrderDefaultStep",{get:function(){return k},enumerable:!0,configurable:!0}),a.isDescriptiveElement=function(a){return a===OfficeForm.Exports.Models.QuestionType.Section},a.isSection=function(a){return a===OfficeForm.Exports.Models.QuestionType.Section},Object.defineProperty(a.prototype,"TopQuestionMasters",{get:function(){return d.filter(this.formMaster.Model.Questions,function(a){return!a.GroupId}).map(Nerve.getObjectMasterFromModel)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"HeaderTopQuestionMasters",{get:function(){var a=this.SectionMasters,b=a.length&&a[0].Model.Order;return b>0?this.findQuestionsInBetween(null,b):this.TopQuestionMasters},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"HeaderQuestionMasters",{get:function(){var a=this.SectionMasters,b=a.length&&a[0].Model.Order;return b>0?this.findQuestionsInBetween(null,b,!0):this.QuestionMasters},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"QuestionMasters",{get:function(){return Nerve.convertToArray(this.formMaster.Model.Questions).map(Nerve.getObjectMasterFromModel)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"DescriptiveElementMasters",{get:function(){return Nerve.convertToArray(this.formMaster.Model.DescriptiveElements).map(Nerve.getObjectMasterFromModel)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"SectionMasters",{get:function(){return d.filter(this.DescriptiveElementMasters,function(b){return a.isDescriptiveElement(b.Model.Type)})},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"AllElementMasters",{get:function(){return this.getAllElements().map(Nerve.getObjectMasterFromModel)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"TopElementMasters",{get:function(){return this.getFormElements(!0).map(Nerve.getObjectMasterFromModel)},enumerable:!0,configurable:!0}),a.prototype.getQuestionById=function(a){var b=Nerve.Collection.getItemWithKeyFields(this.formMaster.Model.Questions,{Id:a});return b&&OfficeForm.Exports.Models.getQuestionMaster(b)},a.prototype.getElementMasterById=function(a){return this.getQuestionById(a)||this.getDescriptiveElementMasterById(a)},a.prototype.getDescriptiveElementMasterById=function(a){var b=Nerve.Collection.getItemWithKeyFields(this.formMaster.Model.DescriptiveElements,{Id:a});return b&&Forms.Models.getDescriptiveElementMaster(b)},a.prototype.appendElement=function(b,c){var e=[];b.Id||(b=d.clone(b),b.Id=a.createNewQuestionId());var f=this.getAllElements(),g=f.length>0?f[f.length-1].Order:a.QuestionOrderFloor;if(b.Order=g+a.QuestionOrderDefaultStep,c&&(e=c.map(function(c,e){return c=d.clone(c),c.Id=a.createNewQuestionId(),c.GroupId=b.Id,c.Order=b.Order+(e+1)*a.QuestionOrderDefaultStep,c})),a.isDescriptiveElement(b.Type)){var h=Nerve.Collection.addItems(this.formMaster.Model.DescriptiveElements,[b]);return Forms.Models.getDescriptiveElementMaster(h[0])}var i=[b];i=i.concat(e);var h=Nerve.Collection.addItems(this.formMaster.Model.Questions,i);return OfficeForm.Exports.Models.getQuestionMaster(h[0])},a.prototype.duplicateElement=function(a){var b=a.getSnapshotWithoutBranchInfo();delete b.Id;var c=a.SubQuestionMasters.map(function(a){var b=a.getSnapshotWithoutBranchInfo();return delete b.Id,delete b.GroupId,delete b.QuestionInfo,b});return this.insertElementAfter(b,a,c)},a.prototype.duplicateSectionAndSubElements=function(b){var c=this,f=this.findQuestionsInSection(b,!0),g=d.find(this.SectionMasters,function(a){return a.Model.Order>b.Model.Order}),i=b.Model.Order,j=b.Model.Order+a.QuestionOrderDefaultStep*(f.length+1);f.length>0&&(i=d.last(f).Model.Order),g&&(j=g.Model.Order);var k=(j-i)/(f.length+2),l=d.clone(b.getSnapshot());l.Id=a.createNewQuestionId(),l.Order=i+k,l.Title=h.LocalizedStrings.Title_For_Duplicate_Section.format(l.Title);var m,n=[{newId:l.Id,oldId:b.Model.Id}],o=[];return f&&f.forEach(function(b,c){var e=d.clone(b.getSnapshot());switch(e.Id=a.createNewQuestionId(),e.Order=l.Order+k*(c+1),o.push(e),e.Type){case OfficeForm.Exports.Models.QuestionType.MatrixChoiceGroup:m=e.Id;break;case OfficeForm.Exports.Models.QuestionType.MatrixChoice:e.GroupId=m}n.push({newId:e.Id,oldId:b.Model.Id})}),this.formMaster.bulkEdit(function(){Nerve.Collection.addItems(c.formMaster.Model.DescriptiveElements,[l]),Nerve.Collection.addItems(c.formMaster.Model.Questions,o)}),e.duplicateQuestionLocaleResources(b.Form.Model.LocalizedResources,n),this.getDescriptiveElementMasterById(l.Id)},a.prototype.deleteFormQuestion=function(a){Nerve.Collection.itemsDeletedInSource(a.Form.Model.Questions,a.SubQuestionMasters.map(function(a){return a.Model})),a.Deleted=!0},a.prototype.deleteSectionAndSubElements=function(a){var b=this,c=this.findQuestionsInSection(a);this.formMaster.bulkEdit(function(){c.forEach(function(a){return b.deleteFormQuestion(a)}),a.Deleted=!0})},a.prototype.findQuestionsInSection=function(b,c){if(b){var e=this.SectionMasters,f=a.isSection(b.Model.Type)?d.indexOf(e,b):d.findLastIndex(e,function(a){return a.Model.Order<b.Model.Order});return f>=0?this.findQuestionsInBetween(e[f].Model.Order,f+1<e.length?e[f+1].Model.Order:null,c):[]}return c?this.HeaderQuestionMasters:this.HeaderTopQuestionMasters},a.prototype.moveElementDown=function(b){var c=this.TopElementMasters,e=d.indexOf(c,b);if(e!==c.length-1){var f=c[e+1],h=f instanceof g&&f.SubQuestionMasters.length>0?f.SubQuestionMasters[f.SubQuestionMasters.length-1].Model.Order:f.Model.Order,i=h+a.QuestionOrderDefaultStep;e+1<c.length-1&&(i=c[e+2].Model.Order);var j=b.SubQuestionMasters.map(function(a){return a.Model});this.formMaster.bulkEdit(function(){return a.updateQuestionOrder(b.Model,j,h,i)})}},a.prototype.moveElementUp=function(b){var c=this.TopElementMasters,e=d.indexOf(c,b);if(!(0>=e)){var f=a.QuestionOrderFloor,g=c[e-1],h=d.indexOf(this.AllElementMasters,g);h>0&&(f=this.AllElementMasters[h-1].Model.Order);var i=c[e-1].Model.Order,j=b.SubQuestionMasters.map(function(a){return a.Model});this.formMaster.bulkEdit(function(){return a.updateQuestionOrder(b.Model,j,f,i)})}},a.prototype.moveSectionTo=function(b,c){var e,f=a.QuestionOrderFloor,g=this.SectionMasters,h=d.indexOf(g,b),i=d.indexOf(g,c),j=d.last(this.HeaderTopQuestionMasters);j&&(f=j.Model.Order);var k=this.findQuestionsInSection(b,!0).map(function(a){return a.Model});if(h>i){if(e=c.Model.Order,i>0){f=g[i-1].Model.Order;var l=this.findQuestionsInSection(g[i-1]);l.length>0&&(f=d.max(l,function(a){return a.Model.Order}).Model.Order)}}else{if(!(i>h))return;var l=this.findQuestionsInSection(c);f=g[i].Model.Order,l.length>0&&(f=d.max(l,function(a){return a.Model.Order}).Model.Order),e=f+a.QuestionOrderDefaultStep*(k.length+1),i+1<g.length&&(e=g[i+1].Model.Order)}this.formMaster.bulkEdit(function(){return a.updateDescriptiveElementOrder(b.Model,k,f,e)})},a.prototype.insertElementAfter=function(b,c,e){b=d.clone(b);var f=[];e&&(f=e.map(d.clone));var h=this.getAllElements(),i=a.QuestionOrderFloor,j=i+a.QuestionOrderDefaultStep;if(c){c instanceof g&&c.SubQuestionMasters.length>0&&(c=c.SubQuestionMasters[c.SubQuestionMasters.length-1]);var k=d.indexOf(h,c.Model);k!==h.length-1?(i=c.Model.Order,j=h[k+1].Order):(i=c.Model.Order,j=c.Model.Order+a.QuestionOrderDefaultStep)}else h.length>0&&(j=h[0].Order);if(a.updateQuestionOrder(b,f,i,j),b.Id||(b.Id=a.createNewQuestionId(),f.forEach(function(c){c.Id=a.createNewQuestionId(),c.GroupId=b.Id})),a.isDescriptiveElement(b.Type)){var l=Nerve.Collection.addItems(this.formMaster.Model.DescriptiveElements,[b]);return Forms.Models.getDescriptiveElementMaster(l[0])}var m=[b];m=m.concat(f);var l=Nerve.Collection.addItems(this.formMaster.Model.Questions,m);return OfficeForm.Exports.Models.getQuestionMaster(l[0])},a.prototype.adjustElementOrders=function(){var b=this;if(this.formMaster.isFieldReady(f.Schema.Questions)){var c=this.formMaster.isFieldReady(f.Schema.DescriptiveElements),d=this.getAllElements();d.length&&this.formMaster.bulkEdit(function(){d.sort(a.questionComparer),d[0].Order||(d[0].Order=a.QuestionOrderFloor+a.QuestionOrderDefaultStep);for(var e=0,f=d[0].Order,g=1;g<=d.length;++g){var h=d[g]&&d[g].Order;if(!h)break;if(f!==h){var i=(h-f)/(g-e);for(f+=i;++e<g;)d[e].Order=f,f+=i}}for(;++e<d.length;)f+=a.QuestionOrderDefaultStep,d[e].Order=f;b.formMaster.Model.Questions=d.filter(function(b){return!a.isDescriptiveElement(b.Type)}).map(function(a){return a}),c&&(b.formMaster.Model.DescriptiveElements=d.filter(function(b){return a.isDescriptiveElement(b.Type)}))})}},a.prototype.getFormElements=function(b){var c=Nerve.convertToArray(this.formMaster.Model.Questions);b&&(c=d.filter(c,function(a){return!a.GroupId}));var e=c;return this.formMaster.isFieldReady(f.Schema.DescriptiveElements)&&(e=e.concat(Nerve.convertToArray(this.formMaster.Model.DescriptiveElements)).sort(a.questionComparer)),e},a.prototype.getAllElements=function(){return this.getFormElements(!1)},a.createNewQuestionId=function(){var a=i.Guid.newGuid();return"r"+a.replace(/-/g,"")},a.questionComparer=function(a,b){var c=a.Order-b.Order;return a.Order&&b.Order||(c=-c),c||a.Id.localeCompare(b.Id)},a.updateQuestionOrder=function(a,b,c,d){var e=(d-c)/(b.length+2);a.Order=c+e,b.forEach(function(b,c){b.Order=a.Order+e*(c+1)})},a.updateDescriptiveElementOrder=function(a,b,c,d){var e=(d-c)/(b.length+2);a.Order=c+e,b.forEach(function(b,c){b.Order=a.Order+e*(c+1)})},a.prototype.findQuestionsInBetween=function(a,b,c){var d;return d=c?this.QuestionMasters:this.TopQuestionMasters,null!==b&&(d=d.filter(function(a){return b>a.Model.Order})),null!==a&&(d=d.filter(function(b){return b.Model.Order>a})),d},a}();b.FormElementManager=l,Forms.Models.FormElementManager=l},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=OfficeForm.Exports.PageMethods,e=function(){function a(){}return a.loadThemes=function(){return a.themes||(a.themes=d.getThemes().then(JSON.parse)),a.themes},a}();b.IntelligenceThemes=e,Forms.Themes.IntelligenceThemes=e},,,,function(a,b,c){"use strict";function d(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];if(a&&document.activeElement&&a.contains(document.activeElement)){var d=$(":focusable");b&&b.forEach(function(a){d=d.not(function(b,c){return a.contains(c)})});var e=d.index(document.activeElement);if(!(0>e)){for(var f=e+1;f<d.length;++f){var g=d[f];if(!a.contains(g)&&!l(g))return void d[f].focus()}for(var f=e-1;f>=0;--f){var g=d[f];if(!a.contains(g)&&!l(g))return void d[f].focus()}}}}function e(a){$(a).on("keydown",k)}function f(a){$(a).off("keydown",k)}function g(a,b){o||(o={}),o[a]||delete o[a],o[a]=b}function h(a){o&&o[a]&&(o[a](),delete o[a])}function i(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];var d=$(a).find(":focusable");b&&b.forEach(function(a){d=d.not(function(b,c){return a.contains(c)})}),d[d.length-1].focus()}function j(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];var d=$(a).find(":focusable");b&&b.forEach(function(a){d=d.not(function(b,c){return a.contains(c)})}),d.length>0&&d[0].focus()}function k(a){if(a.keyCode===n.KeyCode.Tab){a.stopPropagation(),a.preventDefault();var b=$(this),c=m.union(b.filter(":focusable").toArray(),b.find(":focusable").toArray()),d=c.indexOf(document.activeElement);if(!(0>d)){var e=m.union(c.slice(d+1),c.slice(0,d));a.shiftKey&&e.reverse(),e.push(c[d]);var f=m.find(e,function(a){return!l(a)});f&&f.focus()}}}function l(a){var b=Number(a.getAttribute("tabindex"));return!isNaN(b)&&0>b}Object.defineProperty(b,"__esModule",{value:!0});var m=c(3);c(93);var n=c(11);b.focusOut=d,b.trapFocusInsideElement=e,b.stopTrapFocusInsideElement=f,b.trackFocusJump=g,b.jumpFocusBack=h,b.focusOnLastFfocusableElement=i,b.focusOnFirstFocusableElement=j;var o;Forms.UX.Utilities.focusOut=d,Forms.UX.Utilities.trapFocusInsideElement=e,Forms.UX.Utilities.stopTrapFocusInsideElement=f,Forms.UX.Utilities.trackFocusJump=g,Forms.UX.Utilities.jumpFocusBack=h,Forms.UX.Utilities.focusOnLastFfocusableElement=i,Forms.UX.Utilities.focusOnFirstFocusableElement=j},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),e=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};Object.defineProperty(b,"__esModule",{value:!0});var f=c(0),g=c(23),h=c(6),i=c(24),j=c(2),k=c(14),l=c(5),m=c(1),n=c(25),o=OfficeForm.Exports.ClientErrorNames,p=OfficeForm.Exports.Control,q=OfficeForm.Exports.EnvironmentConfig,r=OfficeForm.Exports.EngagementEventNames,s=OfficeForm.Exports.EngagementEventNames.Error,t=OfficeForm.Exports.Utilities,u=OfficeForm.Exports.Resources,v=function(a){function b(b){var c=a.call(this,b)||this;return c.state={ShowErrorDetail:!1},c.onClickMoreDetailButton=c.onClickMoreDetailButton.bind(c),c}return d(b,a),b.getErrorMessage=function(a){var b=u.LocalizedStrings,c="";if(a)if(a.correlationId){var d=a;d.innerCode&&(c=b["Error_Message_"+d.innerCode]||u.LocalizedStrings.Error_Message_Default.format(d.innerCode))}else{var e=a;switch(e.name){case o.LoginIECrossZoneError:c=u.LocalizedStrings.Error_Message_Client_LoginIECrossZoneError.format(window.location.origin,q.getAadInstance());break;case o.ThirdPartyCookieBlockedError:c=u.LocalizedStrings.Error_Message_Client_ThirdPartyCookieError.format(q.getAadInstance());break;case o.AuthNoStorageError:c=u.LocalizedStrings.Error_Message_Client_AuthNoStorageError;break;case o.AADAcquireTokenMfaCheckError:c=u.LocalizedStrings.Error_Message_705;break;case o.TeamSiteNoGroupError:c=u.LocalizedStrings.Error_Message_Client_TeamSiteNoGroupError}}return c},b.createActionButton=function(a,b){var c={ButtonStyle:"LightBackground",HTMLAttributes:{"aria-describedby":"errorPageSubtitle",className:"office-form-info-error-action-button",onClick:b},Text:a},d=f.createElement(l.TextButton,e({},c));return f.createElement("div",{className:"office-form-info-error-action-button-container"},d)},b.prototype.componentDidMount=function(){var a=this.props.Error,b=u.LocalizedStrings;j.log({eventName:"Error"===this.props.ErrorType?s.ErrorPage.Error:s.ErrorPage.Information,eventType:"engagement_event",extraData:{Error:a,ErrorMessage:this.props.ErrorMessage,ErrorTitle:this.props.ErrorTitle,isEmptyMessage:!b["Error_Message_"+this.props.Error.innerCode],stack:a&&a.stack}});var c=450;t.OEmbed.notifyResponsePageFixedHeightToParentWindow(c)},b.prototype.render=function(){var a,c=u.LocalizedStrings,d=this.props.Error||{},e=c["Error_Message_"+d.innerCode+"_title"]||u.LocalizedStrings.Error_Page_DefaultErrorTitle,g=c["Error_Message_"+d.innerCode]||u.LocalizedStrings.Error_Page_DefaultMessage,h=b.getErrorMessage(this.props.Error),j=this.props.ErrorType;switch(j){case"Error":e=e||u.LocalizedStrings.Error_Page_DefaultErrorTitle,g=g||h;break;case"Information":e?g=g||h:e=h}switch(d.innerCode){case i.InnerCode.NoPermission:this.props.IsResponsePage?(e=c["Error_Message_"+d.innerCode+"_title_2"],g=void 0):this.props.IsAnalysisPage?(e=c["Error_Message_"+d.innerCode+"_title_3"],g=void 0):e=c["Error_Message_"+d.innerCode+"_title_1"];break;case i.InnerCode.FormClosed:var k="This form is closed."===d.innerMessage;if(k)e=u.LocalizedStrings.Error_Message_FormClosed;else{var l="Inner Message:",m=d.innerMessage.indexOf("Inner Message:")+l.length,p=d.innerMessage.length;e=d.innerMessage.substring(m,p).trim()}g="";break;case i.InnerCode.ExceedMaximumFormLimition:g=c["Error_Message_"+d.innerCode+"_recyclebin"];break;case i.InnerCode.FailedToCheckUserLicense||i.InnerCode.NotAllowedBySetting||i.InnerCode.NotSupportComposeFormId:g=c.Error_Page_DelayTryMessage;break;case i.InnerCode.NotAllowedByResponseOwnership:case i.InnerCode.ResponseNotFound:g=void 0}switch(d.message===u.LocalizedStrings.Error_Message_FormClosed&&(e=d.message),d.innerCode){case i.InnerCode.FormEnded:case i.InnerCode.FormNotStarted:e=c["Error_Message_"+d.innerCode+"_title"],g=""}switch(d.message){case u.LocalizedStrings.TakeATest_Win10:case u.LocalizedStrings.TakeATest_NotWin10:e=d.message,g=u.LocalizedStrings.TakeATest_Subtitle,a=b.createLinkMessage(u.LocalizedStrings.TakeATest_LearnMore,b.onClickHelpLinkButton)}var q=this.createErrorDetail();d.innerCode===i.InnerCode.LoginNotSupportInCurrentBrowser&&(e="",g=f.createElement("div",{dangerouslySetInnerHTML:{__html:g}}),q=void 0);var r;this.props.ShowCreateFormLink&&this.props.IsResponsePage&&d.name!==o.LoginIECrossZoneError&&d.name!==o.ThirdPartyCookieBlockedError&&d.name!==o.AuthNoStorageError&&d.name!==o.AADAcquireTokenMfaCheckError&&d.name!==o.TeamSiteNoGroupError&&d.innerCode!==i.InnerCode.DisabledByTenantAdmin&&d.innerCode!==i.InnerCode.LoginNotSupportInCurrentBrowser&&(r=this.createPropotionMessage());var s=t.isOEmbedSPO()?"office-form-page-padding office-form-error-page-container office-form-spo-embed":"office-form-page-padding office-form-error-page-container";return e=e&&f.createElement("div",{className:"office-form-info-title"},e),g=g&&f.createElement("div",{className:"office-form-info-subtitle",id:"errorPageSubtitle"},g),a=a&&f.createElement("div",{className:"office-form-info-subtitle"},a),f.createElement("div",{className:s},f.createElement("div",{className:"office-form office-form-info-container"},e,g,a,q,f.createElement("div",{className:"office-form-info-other"},r),!t.isOEmbedSPO()&&f.createElement(n.FooterControl,null)))},b.prototype.onClickMoreDetailButton=function(){this.setState({ShowErrorDetail:!this.state.ShowErrorDetail})},b.prototype.getTechnicalMessage=function(){var a=this.props.Error;return a?a.correlationId?u.LocalizedStrings.Error_TechnicalMessage2.format(k.getCurrentSessionId(),a.correlationId):u.LocalizedStrings.Error_TechnicalMessage.format(k.getCurrentSessionId()):void 0},b.prototype.createErrorDetail=function(){var a=u.LocalizedStrings;if("Information"===this.props.ErrorType)return void 0;var c,d=this.getTechnicalMessage(),e=p.createGlyphButton({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{"aria-hidden":!0,"aria-label":u.LocalizedStrings.Error_More_Detail,className:"office-form-info-error-detail-button office-form-info-error-children",onClick:this.onClickMoreDetailButton},Icon:this.state.ShowErrorDetail?"ChevronUp":"ChevronDown",IconClassName:"forms-icon-size12x12"});this.state.ShowErrorDetail&&(c=f.createElement("div",{className:"office-form-info-error-detail"},d));var j=null;switch(this.props.Error.innerCode){case i.InnerCode.NotRolloutMsaUser:g.AuthTokenHelper.signOutInIframe(),j=b.createActionButton(a.Error_Message_BackToLoginButton,g.AuthTokenHelper.signInWithOtherAccount);break;case i.InnerCode.AntiForgeryTokenValidationError:j=b.createActionButton(a.Error_Message_RefreshPageButton,function(){return h.reloadPage()});break;case i.InnerCode.CoAuthNotAllowedForMsa:j=b.createActionButton(a.Error_Message_SignInButton,g.AuthTokenHelper.forceAadSignIn)}return f.createElement("div",{className:"office-form-info-error-detail-container"},e,f.createElement("span",{className:"office-form-info-error-children office-form-info-children"},a.Error_More_Detail),c,j)},b.prototype.createPropotionMessage=function(){return!this.props.IsResponsePage||t.Flight.isPPTIntegration()||OfficeForm.Exports.EnvironmentSettings.IsAssignmentsIntegration?void 0:b.createLinkMessage(u.LocalizedStrings.Renderer_PromotionMessage,b.onClickPropotionLinkButton)},b.createLinkMessage=function(a,b){var c="office-form-info-premotion office-form-info-children";return t.isOEmbedSPO()&&(c=t.Html.combineAttributes(c,"office-form-theme-spo-link")),f.createElement("div",null,f.createElement("a",{className:c,onClick:b},a))},b.onClickPropotionLinkButton=function(){var a="DesignPage.aspx",b=t.isOEmbed()||t.isOEmbedSPO();if(b){var c=t.getNonEmbedQuery(),d="../Pages/DesignPage.aspx?"+jQuery.param(c);a=t.Html.getAbsoluteUrl(d)}j.log({eventName:r.ResponsePage.ThanksView.NavigateToPortal,eventType:"engagement_event"});var e=b?"_blank":"_self";t.Html.safeOpen(a,e)},b.onClickHelpLinkButton=function(){j.log({eventName:r.ResponsePage.ThanksView.LearnMoreForTakeATest,eventType:"engagement_event"}),t.Html.safeOpen(u.LocalizedStrings.TakeATest_LearnMoreLink,"_blank")},b}(m.ReactComponent);b.ErrorPage=v,Forms.UX.Renderer.ErrorPage=v},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{
__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),e=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};Object.defineProperty(b,"__esModule",{value:!0});var f=c(0),g=c(4),h=c(1),i=OfficeForm.Exports.Resources,j=OfficeForm.Exports.Utilities,k=function(a){function b(b){var c=a.call(this,b)||this;return c.state={PrivacyUrl:"https://go.microsoft.com/fwlink/?LinkId=521839"},c.refreshPrivacy=c.refreshPrivacy.bind(c),c}return d(b,a),b.prototype.componentDidMount=function(){this.refreshPrivacy()},b.prototype.render=function(){var a={className:j.isOEmbedSPO()?"office-form-theme-spo-link":void 0,href:this.state.PrivacyUrl,target:"_blank"};return f.createElement("div",{className:this.props.Multiline?"office-form-footer-block":"office-form-footer-inline"},f.createElement("a",e({},a),i.LocalizedStrings.Form_Footer_PrivacyStatement))},b.prototype.refreshPrivacy=function(){var a=this;g.getPageContext().getPrivacyUrl().done(function(b){return a.setState({PrivacyUrl:b||""})})},b}(h.ReactComponent);b.FooterLinks=k},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var e=c(0),f=c(3),g=c(12),h=c(80),i=c(41),j=c(39),k=c(1),l=c(57),m=c(58),n=OfficeForm.Exports.Models,o=OfficeForm.Exports.Utilities,p=n.ImageSize,q=n.ImageLayout,r=n.ImageProcessingStatus,s=OfficeForm.Exports.FormLimitation,t=OfficeForm.Exports.Resources,u=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return d(b,a),b.prototype.componentWillMount=function(){this.setSectionResourceMaster(this.props)},b.prototype.componentWillReceiveProps=function(a){this.setSectionResourceMaster(a)},b.prototype.componentDidMount=function(){var a=this;this.update=function(){return a.forceUpdate()};var b=this.props.Master,c=Forms.Models.DescriptiveElementMaster.Schema;b.observe(this.update,[c.Title,c.Subtitle,c.VideoInfo,c.CoAuthors]),b.Form.observe(this.update,[n.FormMaster.Schema.HasQuestionMedia]);var d=n.ImageSettingsMaster.Schema;b.ImageSettingsMaster.observe(this.update,[d.NaturalWidth,d.NaturalHeight,d.ContainerWidth,d.ContainerHeight,d.Size,d.Layout]);var e=n.ImageInfoMaster.Schema;b.ImageInfoMaster.observe(this.update,[e.ImageProcessingStatus,e.UploadParameters])},b.prototype.componentWillUnmount=function(){var a=this.props.Master;a.unobserve(this.update),a.ImageInfoMaster.unobserve(this.update),a.ImageSettingsMaster.unobserve(this.update)},b.prototype.render=function(){var a,b=this.props.Master,c=b.Model,d="Right",g=c.VideoInfo,i=b.ImageInfoMaster,j=b.ImageSettingsMaster,k=i.Model;if(!this.props.HideMedia)if(k.ErrorType||k.ImageProcessingStatus===r.Idle&&!n.hasImage(k))g&&g.Url&&(d="Bottom",a=e.createElement(h.VideoControl,{ClassNameForIFrame:"design-question-title-video-frame",HTMLAttributes:{className:"design-question-image-title-big-horizontal"},Url:g.Url}));else{var p=this.calcImageLayout(j.Model);d=p.ImageLayout,a=e.createElement(m.ImageRenderer,{FullFilled:"Bottom"===d,ImageWidth:p.Width,ImageHeight:p.Height,ImageInfoMaster:i,ImageSettingMaster:j,ImageType:"Section"})}var q=f.extend({},this.props.HTMLAttributes);q.className=o.Html.combineAttributes(q.className,"__section-title__ office-form-section-title",this.props.Master.Form.Model.HasQuestionMedia?"office-form-theme-image-question-background with-image":void 0);var s,t,u={className:"office-form-theme-primary-color"};if(this.sectionResourceMaster){var v=this.sectionResourceMaster.Model;s=v.title||"",t=v.subtitle||""}return s=s||c.Title,t=t||c.Subtitle,e.createElement(l.TitleMediaRenderer,{Heading:2,HTMLAttributes:q,HTMLPropsForInnerElement:u,MediaLayout:d,SubTitle:t,Title:s},a,this.createCoAuthorContainer())},b.prototype.setSectionResourceMaster=function(a){var b=a.Master,c=b.Form,d=a.LocaleId;d&&(this.sectionResourceMaster=g.FormLocalizedItemMaster.getQuestionResourceMaster(d,b.Model.Id,c))},b.prototype.createCoAuthorContainer=function(){var a=this,b=this.props.Master.Model,c=b.CoAuthors,d=c&&c.length>0;return d&&c[c.length-1].userId!==OfficeFormServerInfo.userInfo.UserId?e.createElement("div",{className:"question-coAuthor-notification-container-design-mode"},f.map(c,function(b){return a.createAuthorFacePile(b)})):void 0},b.prototype.createAuthorFacePile=function(a){if(a.userId!==OfficeFormServerInfo.userInfo.UserId){var b=t.LocalizedStrings.DesignPage_NavBar_CoAuthor_Section_Screen_Reader.format(a.displayName||a.userId,this.props.Ordinal);return e.createElement(i.AuthorFacePile,{ariaLabel:b,displayText:j.getDisplayText(a.firstName,a.lastName),email:a.email,key:a.userId,name:a.displayName,tooltip:a.displayName||a.userId})}},b.prototype.calcImageLayout=function(a){return this.props.IsMobile||o.isSmallScreen()||a.Layout===q.Horizontal&&a.Size===p.Large?{ImageLayout:"Bottom"}:{Height:a.ContainerHeight||s.ImagePlaceHolderHeight,ImageLayout:"Right",Width:a.ContainerWidth||s.ImagePlaceHolderWidth}},b}(k.ReactComponent);b.SectionTitleRenderer=u},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),e=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};Object.defineProperty(b,"__esModule",{value:!0});var f,g=c(0),h=c(3),i=c(1),j=OfficeForm.Exports.Utilities;!function(a){a[a.Loading=0]="Loading",a[a.Success=1]="Success",a[a.Error=2]="Error"}(f||(f={}));var k=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.subTitleRef=g.createRef(),b}return d(b,a),b.prototype.componentDidMount=function(){$(this.subTitleRef.current).linkify()},b.prototype.componentDidUpdate=function(){$(this.subTitleRef.current).linkify()},b.prototype.render=function(){var a=h.extend({},this.props.HTMLAttributes);return a.className=j.Html.combineAttributes(a.className,"office-form-title-container"),g.createElement("div",e({},a),this.createTitleContainer(),this.createSubTitle(),"Bottom"===this.props.MediaLayout?this.props.children:void 0)},b.prototype.createTitleContainer=function(a){var b,c="office-form-title-box";return"Bottom"!==this.props.MediaLayout&&(c=c+" "+this.props.MediaLayout.toLowerCase(),b=this.props.children),g.createElement("div",{className:c},b,this.createTitle())},b.prototype.createTitle=function(){var a=h.extend({},this.props.HTMLPropsForInnerElement);return a.className=j.Html.combineAttributes("office-form-title",a.className,"heading-"+(this.props.Heading||1),2===this.props.Heading&&"office-form-theme-secondary-color"),g.createElement("div",e({},a),g.createElement("span",null,this.props.Title),a.children)},b.prototype.createSubTitle=function(){return this.props.SubTitle?g.createElement("div",{className:"office-form-subtitle heading-"+(this.props.Heading||1),ref:this.subTitleRef},this.props.SubTitle):void 0},b}(i.ReactComponent);b.TitleMediaRenderer=k},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var e,f=c(0),g=c(2),h=c(1),i=OfficeForm.Exports.FormLimitation,j=OfficeForm.Exports.Models,k=OfficeForm.Exports.EngagementEventNames.Image;!function(a){a[a.Loading=0]="Loading",a[a.Success=1]="Success",a[a.Error=2]="Error"}(e||(e={}));var l=function(a){function b(b){var c=a.call(this,b)||this;return c.state={ImageLoadStatus:e.Loading,RetryCount:0},c.onLoad=c.onLoad.bind(c),c.onError=c.onError.bind(c),c.updateImage=c.updateImage.bind(c),c}return d(b,a),b.prototype.componentDidMount=function(){var a=j.ImageInfoMaster.Schema;this.props.ImageInfoMaster.observe(this.updateImage,[a.AltText,a.ResourceId,a.ResourceUrl])},b.prototype.componentWillUnmount=function(){this.retryTimeId&&window.clearTimeout(this.retryTimeId),this.props.ImageInfoMaster.unobserve(this.updateImage)},b.prototype.render=function(){var a,c;this.props.FullFilled?(a="100%",c="auto"):(a=this.props.ImageWidth||i.ImagePlaceHolderWidth,c=this.props.ImageHeight||i.ImagePlaceHolderHeight);var d=this.state.RetryCount,g=this.props.ImageInfoMaster.Model,h=g.ResourceUrl;this.state.ImageLoadStatus===e.Error&&d>0&&(h+="?"+d);var j,k;this.showSpinner()?k=b.createSpinner():this.state.ImageLoadStatus===e.Success&&(j="visiable");var l=g.AltText||"";return f.createElement("div",{className:"office-form-title-image-box"},f.createElement("img",{alt:l,className:j,height:c,onError:this.onError,onLoad:this.onLoad,src:h,title:l,width:a}),k)},b.prototype.showSpinner=function(){var a=this.props.ImageInfoMaster.Model,b=this.props.ImageSettingMaster.Model,c=this.state.ImageLoadStatus;return c!==e.Success||a.ResourceId!==b.TargetResourceId||a.ImageProcessingStatus!==j.ImageProcessingStatus.Idle},b.createSpinner=function(){return f.createElement("div",{className:"image-spinner"},f.createElement("div",{className:"spinner-tile-animation"}))},b.prototype.onLoad=function(){g.log({eventName:k.ImageOnLoad.Success,eventType:"engagement_event",extraData:{imageType:this.props.ImageType,location:"1"}}),this.setState({ImageLoadStatus:e.Success})},b.prototype.onError=function(){var a=this,b=this.state.RetryCount;3>b?this.retryTimeId=window.setTimeout(function(){return a.setState({RetryCount:++b})},1e3):(g.log({eventName:k.ImageOnLoad.Failure,eventType:"engagement_event",extraData:{imageSrc:this.props.ImageInfoMaster.Model.ResourceUrl,imageType:this.props.ImageType,location:"1"}}),this.setState({ImageLoadStatus:e.Error}))},b.prototype.updateImage=function(){this.forceUpdate()},b}(h.ReactComponent);b.ImageRenderer=l},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),c(18),c(47),c(48),c(20),c(54)},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=OfficeForm.Exports.DataProvider.ErrorCode,e=OfficeForm.Exports.Models,f=function(){function a(a,b){this.element=a,this.dataProvider=e.FormDataSource.getDataProviderByFormMaster(this.element.Form)}return Object.defineProperty(a.prototype,"FormId",{get:function(){return this.element.Form.Model.Id},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"ElementId",{get:function(){return this.element.Model.Id},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"ElementType",{get:function(){return this.element.Model.Type},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"ExtraQosData",{get:function(){var a=this.element.Form,b=a.isFieldReady(a.Schema.DescriptiveElements)&&!!a.FormElementManager.SectionMasters.length;return{WithSection:b}},enumerable:!0,configurable:!0}),a.prototype.add=function(a){var b=this;if(this.element.Form.SyncContext!==e.FormSyncContext.DesignTimeForm)throw Error("Trying to create an element without design type.");return this.element.createSyncJob(function(){return b.dataProvider.createFormDescriptiveElement(b.FormId,a,b.ExtraQosData)})},a.prototype["delete"]=function(a){var b=this;if(!a||!a.id)throw Error("Trying to delete an empty element.");if(this.element.Form.SyncContext!==e.FormSyncContext.DesignTimeForm)throw Error("Trying to delete an element without design type.");var c=function(){return b.dataProvider.deleteFormDescriptiveElement(b.FormId,a.id||"",b.ElementType,b.ExtraQosData)};return $.when(this.element.createSyncJob(c)).then(null,function(a){return a&&a.innerCode===d.InnerCode.CDBColumnNotFound?$.Deferred().resolve().promise():a})},a.prototype.query=function(a){throw Error("No scenario to call this method currently.")},a.prototype.update=function(a,b){var c=this;return this.element.Form.SyncContext!==e.FormSyncContext.DesignTimeForm?$.Deferred().resolve().promise():this.element.createUploadSyncJob(function(){return c.dataProvider.updateFormDescriptiveElement(c.FormId,c.ElementId,c.ElementType,a,c.ExtraQosData)})},a}();b.DescriptiveElementDataSource=f},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),c(62)},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var e=c(7),f=c(49),g=c(42),h=OfficeForm.Exports.Models.FormMaster,i=e.Spec,j={BackgroundColor:i.string({IsLocalField:!0}),BackgroundImage:i.string({IsLocalField:!0}),Name:i.string(),PrimaryColor:i.string({IsLocalField:!0}),SecondaryColor:i.string({IsLocalField:!0}),Thumbnail:i.string({IsLocalField:!0})},k=function(a){function b(b){var c=a.call(this,b)||this;if(b.MasterTreeReady){var d=h.Schema;b.MasterTreeReady.then(function(){return c.Form.fieldsReady([d.Theme])}).then(function(){return c.Form.ensureFieldsReady([d.PrimaryCustomizedThemeColor,d.SecondaryCustomizedThemeColor,d.TertiaryCustomizedThemeColor,d.Background])}).done(function(){return c.initialize()})}return c}return d(b,a),Object.defineProperty(b.prototype,"Form",{get:function(){return this.Parent},enumerable:!0,configurable:!0}),b.prototype.isCustomized=function(){var a=this.Model.Name;return!!a&&!g.getPredefinedThemeByName(a)},b.prototype.getCustomizedTheme=function(){var a=this.Form.Model;return{BackgroundColor:a.TertiaryCustomizedThemeColor||g.defaultCustomizedBackgroundColor,BackgroundImage:a.Background.ResourceUrl,Name:g.customizedThemeName,PrimaryColor:a.PrimaryCustomizedThemeColor||g.defaultCustomizedPrimaryColor,SecondaryColor:a.SecondaryCustomizedThemeColor||g.defaultCustomizedSecondaryColor,Thumbnail:null}},b.prototype.initialize=function(){var a=this;this.addRule({Name:"calculate theme basing on name",onChange:function(b){b.BeingDeleted||a.calculateThemeProperties()}});var b=h.Schema;this.Form.observe(function(){return a.calculateThemeProperties()},[b.PrimaryCustomizedThemeColor,b.SecondaryCustomizedThemeColor,b.TertiaryCustomizedThemeColor,b.Background.ResourceUrl]),this.calculateThemeProperties()},b.prototype.calculateThemeProperties=function(){var a=this,b=this.Model.Name;if(b&&-1!==b.indexOf("Suggest")){var c=b.split(".")[1];f.IntelligenceThemes.loadThemes().done(function(d){if(d){var e=d[c];if(e){var f=e.filter(function(a){return a.Name===b})[0];a.setData(f)}}})}else{var d=g.getPredefinedThemeByName(this.Model.Name)||this.getCustomizedTheme();this.setData(d)}},b}(e.createObjectMasterClass("FormTheme",j));b.FormThemeMaster=k,Forms.Models.FormThemeMaster=k},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),e=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};Object.defineProperty(b,"__esModule",{value:!0});var f=c(0),g=c(11),h=c(2),i=c(1),j=OfficeForm.Exports.Control,k=j.VirtualKeyboardControl,l=OfficeForm.Exports.Utilities,m=OfficeForm.Exports.EngagementEventNames,n=function(a){function b(b){var c=a.call(this,b)||this;return c.formulaRef=f.createRef(),c.onKeyDown=c.onKeyDown.bind(c),c.onMouseDown=c.onMouseDown.bind(c),c.onExit=c.onExit.bind(c),c.onValueChange=c.onValueChange.bind(c),c.props.ForceDesignMode&&(c.state.InDesignMode=c.props.ForceDesignMode),c}return d(b,a),b.prototype.render=function(){var a;return a=this.state.InDesignMode?this.createDesignerComponent():this.createRendererComponent(),f.createElement("div",{className:"formula-designer-container",ref:this.props.containerRef},a,this.props.children)},b.prototype.componentDidMount=function(){!this.state.InDesignMode&&this.props.HasFocus&&this.setFocusOnFormulaMixer()},b.prototype.componentDidUpdate=function(){this.state.InDesignMode&&this.props.onRenderComplete&&this.props.onRenderComplete(null,null)},b.prototype.shouldComponentUpdate=function(a,b){return this.props.Value!==a.Value||this.state.InDesignMode!==b.InDesignMode},b.prototype.createRendererComponent=function(){var a=this,b=l.Html.mergeReactProps(this.props.HTMLAttributes,{"aria-label":this.props.Value,className:this.props.Value?"design-formula-mixer":"design-formula-mixer placeholder",disabled:this.props.Disabled,key:"r",onKeyDown:this.onKeyDown,onMouseDown:this.onMouseDown,ref:this.formulaRef,role:"button",tabIndex:0}),c={DisableLinebreaks:!0,Formula:this.props.Value,onRenderComplete:function(b,c){a.props.onRenderComplete&&a.props.onRenderComplete(b,c)}};return this.props.Value?f.createElement("div",e({},b),j.createFormulaRenderer(c)):f.createElement("div",e({},b),this.props.Placeholder)},b.prototype.onKeyDown=function(a){var b=this;if(!this.props.Disabled)switch(a.keyCode){case g.KeyCode.Enter:case g.KeyCode.Space:this.setState({InDesignMode:!0},function(){b.props.blockEndDesignMode&&b.props.blockEndDesignMode(!0)})}},b.prototype.onMouseDown=function(a){var b=this;this.props.Disabled||setTimeout(function(){return b.setState({InDesignMode:!0},function(){b.props.blockEndDesignMode&&b.props.blockEndDesignMode(!0)})},0)},b.prototype.createDesignerComponent=function(){var a={onBoxBlur:this.props.onBoxBlur,onExit:this.onExit,onValueChange:this.onValueChange,QuestionId:this.props.QuestionId,Value:this.props.Value};return f.createElement("div",{className:"design-keyboard-container",key:"d"},f.createElement(k,e({},a)))},b.prototype.onExit=function(a){var b=this;this.setState({InDesignMode:!1},function(){b.props.blockEndDesignMode&&b.props.blockEndDesignMode(!1),a&&b.setFocusOnFormulaMixer()})},b.prototype.onValueChange=function(a){this.props.Value!==a&&h.log({eventName:m.DesignPage.Quiz.EditMathFormula,eventType:"engagement_event",extraData:{formulaLength:a?a.length:0,Location:this.props.Location,questionId:this.props.QuestionId}}),this.props.onValueChange(a)},b.prototype.setFocusOnFormulaMixer=function(){var a=this.formulaRef.current;a&&a.focus()},b}(i.ReactComponent);b.FormulaDesigner=n},,function(a,b,c){"use strict";function d(){return g&&"rejected"!==g.state()||(g=i.createDataProvider().getOD4BToken()),g}function e(){return g&&"pending"===g.state()||(g=i.createDataProvider().getOD4BToken()),g}function f(a){return d().then(a).then(function(a){return a},function(b){return b&&b.response&&b.response.statusCode===h.Unauthorized?e().then(a):b})}Object.defineProperty(b,"__esModule",{value:!0});var g,h,i=OfficeForm.Exports.DataProvider;!function(a){a[a.Unauthorized=401]="Unauthorized"}(h||(h={})),b.sendRequestWithToken=f},function(a,b,c){"use strict";function d(a){var b=JSON.stringify({item:{"@microsoft.graph.conflictBehavior":"rename"}});return f.sendRequestWithToken(function(c){return g.OData.send({body:b,headers:{Authorization:c,"Content-Type":"application/json"},method:"POST",qosEventName:j,requestUri:a}).then(function(a){if(null==a)return $.Deferred().reject(new Error("no data return")).promise();var b={bytesToSend:0,deferred:$.Deferred(),exporationDateTime:a.expirationDateTime,uploadUrl:a.uploadUrl};return b})})}function e(a){var b=OfficeForm.Exports.Utilities.FormId.decodeFormId(a),c=b.OwnerId,d=b.OrgId,e=b.IsGroupOwner?"groups":"users";return d+"/"+e+"/"+c}Object.defineProperty(b,"__esModule",{value:!0});var f=c(65),g=OfficeForm.Exports.DataProvider,h=OfficeForm.Exports.EnvironmentConfig,i="FileUpload.CancelUploadFile",j="FileUpload.CreateUploadSession",k="FileUpload.DeleteFile",l="FileUpload.GetOD4BFolderPath",m="FileUpload.UploadLargeFile",n="FileUpload.UploadFile",o=h.isProduction()?"https://graph.microsoft.com/v1.0/":"https://graph.microsoft-ppe.com/v1.0/",p=function(){function a(a){this.formId=a}return a.prototype.createFileUploadSession=function(a){var b=""+o+e(this.formId)+"/drive/special/approot:/Temp/"+(a+":/createUploadSession");return d(b)},a.prototype.createFileUploadSessionWithTempFolder=function(a,b){var c=""+o+e(this.formId)+"/drive/items/"+a+(":/"+b+":/createUploadSession");return d(c)},a.prototype.cancelUploadFile=function(a){return f.sendRequestWithToken(function(b){return g.OData.send({headers:{Authorization:b},method:"DELETE",qosEventName:i,requestUri:a})})},a.prototype.deleteUploadFile=function(a){var b=this;return f.sendRequestWithToken(function(c){return g.OData.send({headers:{Authorization:c},method:"DELETE",qosEventName:k,requestUri:""+o+e(b.formId)+"/drive/items/"+a})})},a.prototype.uploadBytesToSession=function(a,b,c,d,e,h){return f.sendRequestWithToken(function(c){return g.OData.send({body:b,headers:{"Content-Range":"bytes "+d+"-"+e+"/"+h,"Content-Type":"*/*"},method:"PUT",qosEventName:m,requestUri:a.uploadUrl}).then(function(a){return e===h-1?{fileType:a.file.mimeType,id:a.id,link:a.webUrl,name:a.name,referenceId:a.parentReference.id,size:a.size,status:1}:void 0})})},a.prototype.uploadSmallFile=function(a,b){var c=this,d=$.Deferred(),h=new FileReader;return h.readAsArrayBuffer(a),h.onloadend=function(){f.sendRequestWithToken(function(a){return g.OData.send({body:h.result,headers:{Authorization:a,"Content-Type":"text/plain"},method:"PUT",qosEventName:n,requestUri:""+o+e(c.formId)+"/drive/special/approot:/Temp/"+(b+":/content")}).then(function(a){d.resolve({fileType:a.file.mimeType,id:a.id,link:a.webUrl,name:a.name,referenceId:a.parentReference.id,size:a.size,status:1})},function(a){d.reject(a)})})},d.promise()},a.prototype.getFileFolder=function(a){var b=this;return f.sendRequestWithToken(function(c){return g.OData.send({headers:{Authorization:c,"Content-Type":"*/*"},method:"GET",qosEventName:l,requestUri:""+o+e(b.formId)+"/drive/items/"+a}).then(function(a){return a.webUrl})})},a}();b.FileUploadProcessProvider=p,Forms.DataProvider.FileUploadProcessProvider=p},function(a,b,c){"use strict";function d(a,b){var c=b.bytesToSend?b.bytesToSend:0,d=i.FileUploadMaxChunkBytes,e=a.size-b.bytesToSend;e>d&&(e=d);var f=c+e-1;return{chunkSize:e,finalByteIndex:f,initialByteIndex:c}}var e=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var f=c(7),g=c(66),h=f.Spec,i=OfficeForm.Exports.FormLimitation,j={fileId:h.string(),hasFile:h["boolean"](),uploadSession:h.reference()},k=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.formId="",b}return e(b,a),b.prototype.uploadLargeFile=function(a,b,c){var d=this;return new g.FileUploadProcessProvider(c).createFileUploadSession(b).then(function(b){return d.uploadLargeFileInternal(a,b)})},b.prototype.uploadLargeFileWithTempFolder=function(a,b,c,d){var e=this;return new g.FileUploadProcessProvider(d).createFileUploadSessionWithTempFolder(b,c).then(function(b){return e.uploadLargeFileInternal(a,b)})},b.prototype.uploadSmallFile=function(a,b,c){return new g.FileUploadProcessProvider(c).uploadSmallFile(a,b)},b.prototype.deleteUploadFile=function(a,b){return new g.FileUploadProcessProvider(b).deleteUploadFile(a)},b.prototype.cancelUploadFile=function(a){return new g.FileUploadProcessProvider(this.formId).cancelUploadFile(a.uploadUrl).done(function(){return a.deferred.reject()})},b.prototype.uploadBytesToSession=function(a,b,c){var e=this;void 0===c&&(c=0);var f=2;if(b&&"rejected"!==b.deferred.state()){if(c>=f)return void this.cancelUploadFile(b);var g=d(a,b),h=new FileReader;h.onerror=function(){e.cancelUploadFile(b)},h.onload=function(d){e.uploadReadBytesToSession(h.result,a,b,c,g)};var i=a.slice(g.initialByteIndex,g.finalByteIndex+1);h.readAsArrayBuffer(i)}},b.prototype.uploadReadBytesToSession=function(a,b,c,d,e){var f=this;return new g.FileUploadProcessProvider(this.formId).uploadBytesToSession(c,a,e.chunkSize,e.initialByteIndex,e.finalByteIndex,b.size).done(function(a){e.finalByteIndex<b.size-1?(c.bytesToSend=e.finalByteIndex+1,f.uploadBytesToSession(b,c)):c.deferred.resolve(a)}).fail(function(a){f.uploadBytesToSession(b,c,d+1)})},b.prototype.uploadLargeFileInternal=function(a,b){return this.Model.uploadSession=b,this.uploadBytesToSession(a,b),b.deferred.promise()},b}(f.createObjectMasterClass("UploadFileProcessMaster",j));b.FileUploadProcessMaster=k},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var e=c(7),f=c(83),g=e.Spec,h={choiceId:g.string({IsKeyField:!0}),description:g.string(),key:g.string({IsLocalField:!0})},i=function(a){return new f.ChoiceLocalizedItemDataSource(a)},j=function(a){function b(b){var c=a.call(this,b)||this;if(!c.Model.key){if(!c.Model.choiceId)throw Error("Current choice localized master doesn't has key and choiceId.");b.MasterTreeReady&&b.MasterTreeReady.then(function(){return c.Form.fieldsReady([c.Form.Schema.Questions])}).done(function(){var a=c.Form.getQuestionById(c.QuestionId).getChoiceById(Number(c.Model.choiceId));a&&(c.Model.key=a.Model.Key)})}return c}return d(b,a),Object.defineProperty(b.prototype,"QuestionLocalizedMaster",{get:function(){return this.Parent.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Form",{get:function(){return this.QuestionLocalizedMaster.Form},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"QuestionId",{get:function(){return this.QuestionLocalizedMaster.Model.questionId},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"LocaleId",{get:function(){return this.QuestionLocalizedMaster.Model.localeId},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"ChoiceId",{get:function(){return this.Model.choiceId},enumerable:!0,configurable:!0}),b}(e.createObjectMasterClass("ChoiceLocalizedItemMaster",h,i));b.ChoiceLocalizedItemMaster=j,Forms.Models.ChoiceLocalizedItemMaster=j},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),e=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};Object.defineProperty(b,"__esModule",{value:!0});var f=c(0),g=c(21);c(95);var h=c(67),i=c(2),j=c(46),k=c(5),l=c(1),m=OfficeForm.Exports.Control,n=OfficeForm.Exports.Resources,o="ResponsePage.FileUpload.UploadFile",p="ResponsePage.FileUpload.CancelUpload",q="ResponsePage.FileUpload.DeleteFile",r=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.showFileNameTimeOut=2e3,b.waitingToShowErrorAlert=1e3,b.errorMessageTimeOut=1e4,b.mounted=!1,b.fileUploadElementRef=f.createRef(),b.fileInputRef=f.createRef(),b.state={ErrorMessage:"",IsFocusedOnButton:!0,IsFocusedOnFileContainer:!1,IsUploadingFile:!1,ShowFileName:!1},b.cancelUploadFileCallBack=function(){return b.cancelFileUpload()},b.deleteFileCallBack=function(){return b.deleteFile()},b.uploadFileInPutCallBack=function(){return b.uploadFileInPut()},b}return d(b,a),b.prototype.componentWillMount=function(){this.fileUploadProcessMaster||(this.fileUploadProcessMaster=new h.FileUploadProcessMaster),this.setState({ShowFileName:this.props.IsStudentViewMode}),this.mounted=!0},b.prototype.componentWillUnmount=function(){this.mounted=!1},b.prototype.componentDidUpdate=function(){this.fileUploadElementRef.current&&!this.state.IsFocusedOnButton&&this.fileUploadElementRef.current.focus()},b.prototype.render=function(){return f.createElement("div",e({},this.props.FileUploadProps),this.createShowFileInfoButton(),this.createFileUploadedButton(),this.createUploadingFileButton(),this.createFileUploadDefaultButton(),this.fileInputContainer(),this.errorMessageContainer())},b.prototype.errorMessageContainer=function(){return f.createElement("div",{className:"office-form-upload-file-error-message-container",role:"alert"},this.state.ErrorMessage)},b.prototype.createShowFileInfoButton=function(){if(this.props.Answer&&this.props.ShowFileInfo){var a=JSON.parse(this.props.Answer);if(a.length>0){var b=a[0],c=j.getFileIcon(b.name);return f.createElement("div",{className:"office-form-upload-file-container"},c,f.createElement("a",{href:b.link,target:"_blank"},b.name))}}},b.prototype.createFileUploadedButton=function(){var a=this,b=this.props;if(b.Answer&&(this.fileUploadProcessMaster.Model.hasFile||b.IsStudentViewMode)){var c=JSON.parse(b.Answer);if(c.length>0){var d=c[0],g=this.state,h=g.ShowFileName?j.getFileIcon(d.name):m.createFontIconControl({HTMLAttributes:{className:"forms-icon-size20x20"},IconName:"CheckMark"}),i={className:"office-form-uploadFile",onBlur:function(b){b.stopPropagation(),a.setState({IsFocusedOnButton:!0})},ref:this.fileUploadElementRef,tabIndex:0,title:g.ShowFileName?d.name:void 0},k={className:"office-form-uploadFile-container",onBlur:function(){a.setState({IsFocusedOnFileContainer:!1})},onFocus:function(){a.setState({IsFocusedOnFileContainer:!0})}},l=g.ShowFileName?void 0:n.LocalizedStrings.UploadFile_Done;return f.createElement("div",e({},k),f.createElement("div",e({},i,{"aria-label":l}),h,this.createFileNameContainer(),this.createUploadedDoneMessage()),this.createDeleteButton())}}},b.prototype.createFileNameContainer=function(){if(this.state.ShowFileName){var a=JSON.parse(this.props.Answer||"[]");if(a.length>0){var b=a[0],c="office-form-uploadFile-text office-form-uploadFile-name";return this.props.Disabled?f.createElement("span",{className:c},b.name):f.createElement("a",{className:c,href:b.link,target:"_blank"},b.name)}}},b.prototype.createUploadedDoneMessage=function(){return this.state.ShowFileName?void 0:f.createElement("span",{className:"office-form-uploadFile-text"},n.LocalizedStrings.UploadFile_Done)},b.prototype.createDeleteButton=function(){return this.state.ShowFileName&&!this.props.HideDeleteButton?m.createGlyphButton({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:this.state.IsFocusedOnFileContainer?"office-form-delete-button inline-display":"office-form-delete-button none-display",onClick:this.deleteFileCallBack,title:n.LocalizedStrings.Delete_Button_Narrator},Icon:"Delete",IconClassName:"delete-file-button forms-icon-size16x16",key:"deleteFileButton"}):void 0;
},b.prototype.createUploadingFileButton=function(){if(!this.props.Answer&&!this.props.IsStudentViewMode&&this.state.IsUploadingFile){var a={ButtonStyle:"LightBackground",HTMLAttributes:{className:"office-form-cancel-fileUpload office-form-theme-primary-foreground office-form-theme-button-color",onClick:this.cancelUploadFileCallBack},Text:n.LocalizedStrings.UploadFile_Cancel_Button},b=f.createElement(k.TextButton,e({},a)),c={className:"office-form-uploadFile",ref:this.fileUploadElementRef,tabIndex:0},d=n.LocalizedStrings.UploadFile_Doing,g="uploading office-form-theme-primary-color forms-icon-size14x14";return f.createElement("div",{className:"office-form-uploadFile-container"},f.createElement("div",e({},c,{"aria-label":d}),f.createElement(m.FontIconControl,{HTMLAttributes:{className:g},IconName:"Sync"}),f.createElement("span",{className:"office-form-uploadFile-text"},d)),b)}},b.prototype.createFileUploadDefaultButton=function(){var a=this;if(!(this.props.Answer||this.props.IsStudentViewMode||this.state.IsUploadingFile)){var b=this.props,c={className:"office-form-upload-container office-form-theme-primary-foreground",disabled:b.Disabled,onBlur:function(){a.setState({IsFocusedOnButton:!0})},onClick:this.uploadFileInPutCallBack,ref:this.fileUploadElementRef},d=n.LocalizedStrings.UploadFile_Button+"\n                            "+n.LocalizedStrings.UploadFile_AllowFileType_Text.format(this.allowedFileText);c["aria-label"]=d;var e=m.createGlyphButton({ButtonStyle:"LightBackground",GlyphButtonStyle:"Horizontal",HTMLAttributes:c,Icon:"Upload",IconClassName:"forms-icon-size18x18",Text:n.LocalizedStrings.UploadFile_Button,TextClassName:"office-form-upload-text"});return f.createElement("div",null,e,this.allowedFileTypesMessage())}},b.prototype.uploadFileInPut=function(){$(this.fileInputRef.current).val("").click()},b.prototype.allowedFileTypesMessage=function(){var a=this,b=[],c=Object.keys(this.props.FileTypes);return c.forEach(function(c){a.props.FileTypes[c]&&b.push(j.convertFileTypeToString(c))}),this.allowedFileText=b.join(n.LocalizedStrings.UploadFile_Comma),f.createElement("span",{className:"office-form-upload-allowTypes"},n.LocalizedStrings.UploadFile_AllowFileType_Text.format(this.allowedFileText))},b.prototype.fileInputContainer=function(){var a=this,b=j.getAcceptedFileTypes(this.props.FileTypes),c="";b.forEach(function(a){c+="."+a+","});var d={accept:c,className:"file-upload-question-file-reader",onChange:function(c){var d=c&&c.target,e=d&&d.files,f=e&&e[0];if(f){var g=f.name.split("."),h=g[g.length-1].toLowerCase();if(-1!==b.indexOf(h)){a.setState({ErrorMessage:""});var i=a.fileInputRef.current.value,j=i.replace(/^.*[\\\/]/,"");j=j.replace(/[%#]/g,"-"),a.uploadFile(f,j)}else a.setErrorMessageWithTimeOut(n.LocalizedStrings.UploadFile_WrongFileType_ErrorMessage)}},ref:this.fileInputRef,type:"file"};return f.createElement("input",e({},d))},b.prototype.uploadFile=function(a,b){var c=this;OfficeFormServerInfo.userInfo.UserId||g.Authenticator.redirectToLogin(),this.props.increaseUploadingFileCountCallBack&&this.props.increaseUploadingFileCountCallBack(),this.setState({IsFocusedOnButton:!1,IsUploadingFile:!0,ShowFileName:!1});var d=this.fileUploadProcessMaster;Forms.getPageContext().Flighting.isEnabled("FileUploadOnlyLargeFileAPI")||a.size>OfficeForm.Exports.FormLimitation.FileUploadSmallFileBytes?d.uploadLargeFile(a,b,this.props.FormId).done(function(a){c.setAnswer(a),setTimeout(function(){c.mounted&&!c.state.ShowFileName&&c.setState({ShowFileName:!0})},c.showFileNameTimeOut)}).fail(function(a){c.uploadFileErrorHandling(a)}):d.uploadSmallFile(a,b,this.props.FormId).done(function(a){c.setAnswer(a)}).fail(function(a){c.uploadFileErrorHandling(a)})},b.prototype.uploadFileErrorHandling=function(a){a&&(this.setState({IsUploadingFile:!1}),this.setErrorMessageWithTimeOut(n.LocalizedStrings.UploadFile_Default_ErrorMessage),this.props.decreaseUploadingFileCountCallBack&&this.props.decreaseUploadingFileCountCallBack())},b.prototype.setAnswer=function(a){i.log({eventName:o,eventType:"engagement_event"});var b=this.fileUploadProcessMaster.Model;b.fileId=a.id,b.hasFile=!0,this.props.setAnswerCallback(JSON.stringify([a])),this.setState({IsUploadingFile:!1}),this.props.decreaseUploadingFileCountCallBack&&this.props.decreaseUploadingFileCountCallBack()},b.prototype.deleteFile=function(){var a=this,b=this.fileUploadProcessMaster;b.deleteUploadFile(b.Model.fileId,this.props.FormId).done(function(){i.log({eventName:q,eventType:"engagement_event"}),b.Model.hasFile=!1,a.setState({IsFocusedOnButton:!1}),a.props.setAnswerCallback(null)}).fail(function(){a.setErrorMessageWithTimeOut(n.LocalizedStrings.UploadFile_FailedToDelete_ErrorMessage)})},b.prototype.cancelFileUpload=function(){var a=this,b=this.fileUploadProcessMaster;b.Model.uploadSession&&(i.log({eventName:p,eventType:"engagement_event"}),b.cancelUploadFile(b.Model.uploadSession).done(function(){a.props.decreaseUploadingFileCountCallBack&&a.props.decreaseUploadingFileCountCallBack(),a.setState({IsUploadingFile:!1})}).fail(function(){a.setErrorMessageWithTimeOut(n.LocalizedStrings.UploadFile_FailedToCancel_ErrorMessage)}))},b.prototype.setErrorMessageWithTimeOut=function(a){var b=this;setTimeout(function(){b.setState({ErrorMessage:a})},this.waitingToShowErrorAlert),setTimeout(function(){b.mounted&&b.state.ErrorMessage&&b.setState({ErrorMessage:""})},this.errorMessageTimeOut)},b}(l.ReactComponent);b.FileUploadQuestionRenderer=r},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),e=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};Object.defineProperty(b,"__esModule",{value:!0});var f=c(0),g=c(3),h=c(12),i=c(10),j=c(1),k=OfficeForm.Exports.Control.FontIconControl,l=OfficeForm.Exports.Models,m=OfficeForm.Exports.Utilities,n=function(a){function b(b){var c=a.call(this,b)||this;return c.rootRef=f.createRef(),c.onQuestionChangeCallback=function(){return c.forceUpdate()},c.state={FocusedIndex:-1},c.expandWhenFocus=c.expandWhenFocus.bind(c),c.onValueChange=c.onValueChange.bind(c),c.lostFocus=c.lostFocus.bind(c),c}return d(b,a),b.prototype.componentWillMount=function(){this.props.Disabled||this.props.QuestionRuntimeMaster.observe(this.onQuestionChangeCallback,[l.QuestionRuntimeMaster.Schema.Answer]),this.props.QuestionMaster.observe(this.onQuestionChangeCallback,[l.QuestionMaster.Schema.Title]),this.props.LocaleId&&this.updateQuestionLocalizedItemMaster(this.props.LocaleId,this.props.QuestionMaster.Model.Id,this.props.QuestionMaster.Form)},b.prototype.componentWillReceiveProps=function(a){a.LocaleId&&this.updateQuestionLocalizedItemMaster(a.LocaleId,a.QuestionMaster.Model.Id,a.QuestionMaster.Form)},b.prototype.componentWillUnmount=function(){this.props.Disabled||this.props.QuestionRuntimeMaster.unobserve(this.onQuestionChangeCallback),this.props.QuestionMaster.unobserve(this.onQuestionChangeCallback),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.onQuestionChangeCallback)},b.prototype.render=function(){return this.props.PadView?f.createElement("div",{className:"office-form-mobile-matrix-points",onBlur:this.lostFocus,onFocus:this.expandWhenFocus,ref:this.rootRef},this.createMobileQuestionRow()):f.createElement("tr",{className:"office-form-matrix-str",role:"radiogroup"},this.createQuestionRow())},b.prototype.updateQuestionLocalizedItemMaster=function(a,b,c){this.questionLocalizedItemMaster&&(this.props.QuestionMaster.unobserve(this.onQuestionChangeCallback),this.questionLocalizedItemMaster=void 0),this.questionLocalizedItemMaster=h.FormLocalizedItemMaster.getQuestionResourceMaster(a,b,c),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.onQuestionChangeCallback,[i.QuestionLocalizedItemMaster.Schema.title])},b.prototype.expandWhenFocus=function(a){this.props.IsExpanded||this.props.onChange(this.props.QuestionIndex,!0);var b=a.target;this.setState({FocusedIndex:parseInt(b.value,10)})},b.prototype.lostFocus=function(a){var b=a.relatedTarget,c=this.rootRef.current;c&&!c.contains(b)&&this.setState({FocusedIndex:-1})},b.prototype.createQuestionRow=function(){var a=this,b=[],c=this.props.QuestionMaster,d=this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.Model.title||c.Model.Title,e=f.createElement("span",{className:"office-form-matrix-subquestion",id:this.getSubLabelId(this.props.QuestionIndex)},d),h=f.createElement("td",{className:"office-form-matrix-std",key:"subQuestionTitle"},e);b.push(h);var i=g.map(this.props.Choices,function(b,c){var d=!1;if(!a.props.ShowDesignInfo){var e=a.props.QuestionRuntimeMaster&&a.props.QuestionRuntimeMaster.Model.Answer;d=e&&g.isEqual(e.id,b.Id)}return a.createMatrixRadio(a.props.QuestionMaster.Model.Id,c,!!d)});return b=b.concat(i)},b.prototype.createMatrixRadio=function(a,c,d){var e=this.props,g=e.Disabled,h=e.Choices,i=e.PadView,j="subquestion-radio-"+a,k=this.getLabelId(c),l=f.createElement("input",{"aria-checked":d,"aria-labelledby":k+" "+this.getSubLabelId(this.props.QuestionIndex),"aria-posinset":c+1,"aria-setsize":h.length,checked:d,disabled:g,name:j,onChange:g?void 0:this.onValueChange,type:"radio",value:c});if(i){var n=m.Html.combineAttributes("office-form-question-matrix-choice","office-form-theme-page-background-active",d?"active":""),o=m.Html.combineAttributes("radio-icon "+(this.state.FocusedIndex===c?"focused":""),"ms-Icon ms-Icon--"+(d?"RadioBtnOn":"RadioBtnOff"),""+(g?"disabled":""));return f.createElement("li",{key:c,className:n},f.createElement("label",{className:"office-form-question-matrix-choice-row"},l,f.createElement("i",{className:o,"aria-hidden":"true"}),f.createElement("span",{className:"office-form-question-matrix-choice-text",id:k},h[c].Description)))}return f.createElement("td",{className:"office-form-matrix-radio",key:c,onClick:b.enlargeClickArea},f.createElement("label",{className:"office-form-matrix-label"},l))},b.enlargeClickArea=function(a){var b=a.target;b===a.currentTarget&&b.firstChild.click()},b.prototype.getLabelId=function(a){return this.props.QuestionOrdinal+"-col-"+(a+1)},b.prototype.createMobileQuestionRow=function(){var a=this,b=this.props,c=b.QuestionMaster,d=b.Choices,e=b.QuestionRuntimeMaster,h=b.QuestionIndex,i=-1,j=g.map(d,function(b,d){var f=!1;if(!a.props.ShowDesignInfo){var h=e&&e.Model.Answer;f=h&&g.isEqual(h.id,b.Id)}return f&&(i=d),a.createMatrixRadio(c.Model.Id,d,f)}),k=f.createElement("ul",{className:"office-form-mobile-matrix-choices",key:"choicelist",role:"radiogroup"},j),l=-1!==i?d[i].Description:"",m=this.createQuestionTitle(c.Model.Title,l,h);return[m,k]},b.prototype.getSubLabelId=function(a){return this.props.QuestionOrdinal+"-row-"+(a+1)},b.prototype.createQuestionTitle=function(a,b,c){var d=this,g={className:"office-form-mobile-matrix-title",id:this.getSubLabelId(c),key:"subquestion-title",onClick:this.props.PadView?function(){return d.props.onChange(c,!d.props.IsExpanded)}:void 0,ref:function(a){if(a){var b=a.parentElement,c=a.offsetHeight;d.props.IsExpanded&&(c+=a.nextElementSibling.offsetHeight),b&&(b.style.height=c+"px")}}};return f.createElement("div",e({},g),f.createElement("div",{className:"office-form-mobile-matrix-title-header"},f.createElement("span",null,a),f.createElement(k,{HTMLAttributes:{className:"select-dropdown-arrow forms-icon-size20x20"},IconName:this.props.IsExpanded?"ChevronUp":"ChevronDown"})),f.createElement("div",{className:"office-form-mobile-matrix-answered-indicator"},f.createElement("span",null,b)))},b.prototype.onValueChange=function(a){var b=this.props.QuestionRuntimeMaster,c=a.currentTarget,d=c.checked?{id:this.props.Choices[parseInt(c.value,10)].Id}:void 0;b&&(this.props.PadView&&this.props.onChange(this.props.QuestionIndex+1,!0),b.Model.Answer=d)},b}(j.ReactComponent);b.LikertSubQuestionRenderer=n},function(a,b,c){"use strict";function d(a){return r.Flight.isEnabled("DisableBrandingForMSA")&&OfficeFormServerInfo.userInfo.IsMsa?g.createElement(l.TitleContainerV1,f({},a)):g.createElement(s,f({},a))}var e=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),f=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};Object.defineProperty(b,"__esModule",{value:!0});var g=c(0),h=c(12),i=c(1),j=c(57),k=c(58),l=c(110),m=OfficeForm.Exports.Models,n=OfficeForm.Exports.Utilities,o=m.ImageProcessingStatus,p=m.ImageLayout,q=OfficeForm.Exports.FormLimitation,r=OfficeForm.Exports.Flighting,s=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return e(b,a),b.prototype.componentWillMount=function(){var a=this;this.update=function(){return a.forceUpdate()};var b=m.FormMaster.Schema;this.props.Form.observe(this.update,[b.Title,b.Description]);var c=this.props.Form.getImageSettingsMaster(m.FormMaster.Schema.LogoInfo),d=m.ImageSettingsMaster.Schema;c.observe(this.update,[d.NaturalWidth,d.NaturalHeight]);var e=this.props.Form.getImageMaster(m.FormMaster.Schema.Logo),f=m.ImageInfoMaster.Schema;e.observe(this.update,[f.ImageProcessingStatus,f.UploadParameters])},b.prototype.componentWillUnmount=function(){this.props.Form.unobserve(this.update);var a=this.props.Form.getImageSettingsMaster(m.FormMaster.Schema.LogoInfo);a.unobserve(this.update);var b=this.props.Form.getImageMaster(m.FormMaster.Schema.Logo);b.unobserve(this.update)},b.prototype.render=function(){var a,b=this.props.Form,c=b.Model,d={className:n.Html.combineAttributes("__title__ office-form-form-title office-form-theme-primary-background",this.props.IsSmallSize&&"small-size",this.props.IsSlimTitle&&"slim-size")},e={"aria-level":1,role:"heading"},f="Left",i=b.getImageMaster(m.FormMaster.Schema.Logo),l=b.getImageSettingsMaster(m.FormMaster.Schema.LogoInfo),p=i.Model;if(!p.ErrorType&&(p.ImageProcessingStatus!==o.Idle||m.hasImage(p))){var q=this.calcImageLayout(l);f=q.ImageLayout,a=g.createElement(k.ImageRenderer,{ImageWidth:q.Width,ImageHeight:q.Height,ImageInfoMaster:i,ImageSettingMaster:l,ImageType:"Logo"})}var r,s,t,u=this.props.LocaleId;return u&&(t=h.FormLocalizedItemMaster.getFormResourceMaster(u,this.props.Form),r=t.Model.title||"",s=t.Model.subtitle||""),r=r||c.Title,s=this.props.IsSlimTitle||this.props.IsSmallSize?"":s||c.Description,g.createElement(j.TitleMediaRenderer,{HTMLAttributes:d,HTMLPropsForInnerElement:e,MediaLayout:f,SubTitle:s,Title:r},a)},b.prototype.calcImageLayout=function(a){var b=a.Model;if(b.NaturalWidth){var c=a.calcLogoLayout({isMobile:this.props.IsMobile,isSlimSize:this.props.IsSlimTitle,isSmallSize:this.props.IsSmallSize});return{Height:c.ActualHeight,ImageLayout:c.Layout===p.Vertical?"Top":"Left",Width:c.ActualWidth}}return{Height:q.ImagePlaceHolderWidth,ImageLayout:"Left",Width:q.ImagePlaceHolderHeight}},b}(i.ReactComponent);b.TitleContainer=s,Forms.UX.Renderer.TitleContainer=s,b.createTitleContainer=d,Forms.UX.Renderer.createTitleContainer=d},,,function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var e=c(0),f=c(1),g=OfficeForm.Exports.DataProvider,h=OfficeForm.Exports.Utilities,i=OfficeForm.Exports.Models,j=function(a){function b(b){var c=a.call(this,b)||this;return c.state={LabelDetailLoaded:!1,LabelsLoaded:!1},c.dataClassificationLabelCallback=function(){return c.forceUpdate()},c.props.FormMaster.observe(c.dataClassificationLabelCallback,[c.props.FormMaster.Schema.DataClassificationLabel]),c}return d(b,a),b.prototype.componentDidMount=function(){var a=this;this.props.DesignTimeView&&g.FeaturePlanProvider.getDataClassificationLevels().done(function(b){a.labels=h.tryParseJson(b),a.setState({LabelsLoaded:!0})}),!this.props.DesignTimeView&&this.props.FormMaster.isFieldReady(i.FormMaster.Schema.DataClassificationLabel)&&g.FeaturePlanProvider.getDataClassificationLabelDetail(this.props.FormMaster.Model.OwnerTenantId,this.props.FormMaster.Model.DataClassificationLabel).done(function(b){a.labelShowInFormContent=b,a.setState({LabelDetailLoaded:!0})})},b.prototype.componentWillUnmount=function(){this.props.FormMaster.unobserve(this.dataClassificationLabelCallback,[this.props.FormMaster.Schema.DataClassificationLabel])},b.prototype.render=function(){if(!this.props.FormMaster.isFieldReady(i.FormMaster.Schema.DataClassificationLabel)||!this.props.FormMaster.Model.DataClassificationLabel||this.props.DesignTimeView&&!this.state.LabelsLoaded||!this.props.DesignTimeView&&(!this.state.LabelDetailLoaded||!this.labelShowInFormContent))return null;var a=this.props.FormMaster.Model.DataClassificationLabel;if(this.props.DesignTimeView)for(var b=0,c=this.labels;b<c.length;b++){var d=c[b];if(d.level===a&&!d.showInFormContent)return null}var f=h.Html.combineAttributes(this.props.HTMLAttributes&&this.props.HTMLAttributes.className,"__data-classification-label__");return e.createElement("div",{tabIndex:0,"aria-label":a,className:f},a)},b}(f.ReactComponent);b.DataClassificationLabel=j,Forms.UX.Designer.DataClassificationLabel=j},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var e=c(0),f=c(1),g=OfficeForm.Exports.Control.FontIconControl,h=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.messageElementRef=e.createRef(),b}return d(b,a),b.prototype.componentDidMount=function(){$(this.messageElementRef.current).linkify()},b.prototype.render=function(){return e.createElement(Forms.UX.Controls.LiveRegion,{Role:"Log",LazyRendering:!1},e.createElement("div",{className:"thank-you-page-confirm"},e.createElement(g,{HTMLAttributes:{className:"office-form-theme-primary-color thank-you-page-font-icon"},IconName:"Completed"}),e.createElement("span",{className:"thank-you-page-comfirm-text"},this.props.ConfirmText)),e.createElement("div",{className:"thank-you-page-container thank-you-page-message",ref:this.messageElementRef,tabIndex:-1},this.props.Message))},b}(f.ReactComponent);b.MessageContent=h},function(a,b,c){"use strict";function d(a,b){var c=Date.now(),d={sa:c-i};return j[a]=d,b.done(function(){d.d=Date.now()-c}).fail(function(){d.d=Date.now()-c,d.f=1})}function e(a){k[a]=Date.now()-i}function f(){var a="Forms.PerformanceAnalysis";h.log({eventName:a,eventType:"engagement_event",extraData:{checkPoints:k,requests:j,requestsAll:Date.now()-i,scriptCached:l,scriptDownload:window.FormsPageStartTime&&i-window.FormsPageStartTime,version:1}})}function g(){try{var a="FormsVersion"+window.location.pathname,b=window.localStorage.getItem(a),c=OfficeFormServerInfo.version;return b!==c?(window.localStorage.setItem(a,c),!1):!0}catch(d){return!1}}Object.defineProperty(b,"__esModule",{value:!0});var h=c(2),i=Date.now(),j={},k={},l=g();b.requestWithPromise=d,b.addCheckPoint=e,b.onPageReadyToRender=f,Forms.PerformanceAnalysis={addCheckPoint:e,onPageReadyToRender:f,requestWithPromise:d}},function(a,b,c){"use strict";function d(a){return 7>a?l.LocalizedStrings.NPS_Detractors:a>8?l.LocalizedStrings.NPS_Promoters:l.LocalizedStrings.NPS_Passives}var e=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),f=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};Object.defineProperty(b,"__esModule",{value:!0});var g=c(0),h=c(3),i=c(1),j=OfficeForm.Exports.Utilities.Html.combineAttributes,k=OfficeForm.Exports.Utilities.Guid,l=OfficeForm.Exports.Resources,m=function(a){function b(c){var d=a.call(this,c)||this;return d.popUpRef=g.createRef(),d.uuid=k.newGuid(),d.options=b.createNPSOptions(),d.valueChangeCallback=function(a){var b=d.props.onValueChange;b&&b(parseInt(a.currentTarget.value,10))},d.inputOnFocusCallback=function(a){d.setState({FocusValue:parseInt(a.currentTarget.value,10)})},d.inputOnBlurCallback=function(){d.setState({FocusValue:void 0})},d.touchStartCallback=function(a){return d.touchStart(a)},d.touchMoveCallback=function(){return d.canceled=!0},d.touchCancelCallback=function(a){d.canceled=!1,d.setState({Touch:-1})},d.touchEndCallback=function(a){return d.touchEnd(a)},d}return e(b,a),b.prototype.render=function(){var a="nps-control clearfix unselectable-text",b="nps-control-table reset";this.props.Disabled||(b=j(b,"enabled"));var c=this.props.HTMLAttributes,d={};return c&&(a=j(a,c.className),h.extend(d,c)),d.className=b,g.createElement("div",{className:a,role:"radiogroup"},this.createPopUp(),g.createElement("table",f({},d),this.createThead(),this.createTbody()),this.props.LeftLabel||this.props.RightLabel?this.createLabels():void 0)},b.prototype.createPopUp=function(){var a=this.state.Touch,b=j(void 0!==a&&-1!==a?"nps-pop-up show":"nps-pop-up",this.props.ClassNameForInnerLabel,a===this.props.Value?"active":"");return g.createElement("div",{className:b,ref:this.popUpRef},g.createElement("span",{className:"nps-pop-up-text"},this.state.Touch))},b.prototype.createLabels=function(){return g.createElement("div",{className:"nps-control-label-container clearfix"},g.createElement("div",{className:"left-label"},g.createElement("span",null,this.props.LeftLabel)),g.createElement("div",{className:"right-label"},g.createElement("span",null,this.props.RightLabel)))},b.createNPSOptions=function(){for(var a=11,b=[],c=0;a>c;c++)b.push({DisplayName:d(c),Key:c,Value:c});return b},b.prototype.createThead=function(){return g.createElement("thead",null,g.createElement("tr",{className:"nps-head-row"},this.options.map(function(a){return g.createElement("th",{className:"nps-head-column",key:a.Key},a.Value)})))},b.prototype.createTbody=function(){var a=this,b=this.options.map(function(b,c){return a.createTd(b,c)});return g.createElement("tbody",null,g.createElement("tr",null,b))},b.prototype.createTd=function(a,b){var c=this.props.Value,d=this.props.Disabled;h.isString(c)&&(c=parseInt(c,10));var e=c===a.Value,i="nps-"+this.uuid+"-"+a.Value,k={"aria-label":a.Value.toString(),"aria-posinset":b+1,"aria-setsize":this.options.length,checked:e,disabled:this.props.Disabled,id:i,name:"nps-"+this.uuid,type:"radio",value:a.Value},l={htmlFor:i};return d||(h.extend(k,{onBlur:-1===this.state.Touch?void 0:this.inputOnBlurCallback,onChange:this.valueChangeCallback,onFocus:-1===this.state.Touch?void 0:this.inputOnFocusCallback}),h.extend(l,{htmlFor:i,onTouchCancel:this.touchCancelCallback,onTouchEnd:this.touchEndCallback,onTouchMove:this.touchMoveCallback,onTouchStart:this.touchStartCallback})),l.className=j("answer-label",void 0!==this.state.Touch?"touch":"",this.props.ClassNameForInnerLabel,e?"active":"",this.state.FocusValue===a.Value?"focus":""),g.createElement("td",{key:a.Key,className:"radio-button-item"},g.createElement("div",{className:"radio-button"},g.createElement("input",f({},k)),g.createElement("label",f({},l),g.createElement("span",{"data-text":a.Value,className:"radio-button-display"}))))},b.prototype.touchStart=function(a){var b=a.currentTarget,c=this.popUpRef.current,d=c.parentElement.getBoundingClientRect(),e=b.getBoundingClientRect(),f=e.width/2,g=e.height/2;c.style.left=e.left-d.left-f/2+"px",c.style.top=e.top-d.top-g/2+"px",c.style.width=e.width+f+"px",c.style.height=e.height+g+"px";var h=b.firstElementChild,i="text";this.setState({Touch:parseInt(h.dataset[i],10)})},b.prototype.touchEnd=function(a){var b=this;if(this.canceled)this.canceled=!1,this.setState({Touch:-1});else{var c=this.state.Touch;this.setState({Touch:-1},function(){var a=b.props.onValueChange;a&&a(c)})}a.preventDefault()},b}(i.ReactComponent);b.NPSControl=m,Forms.UX.Controls.NPSControl=m,Forms.UX.Controls.getNpsCategoryDescription=d},,function(a,b,c){"use strict";function d(a){var b=[];a=a||{};for(var c=0,d=Object.keys(f);c<d.length;c++){var e=d[c],g={Disabled:a[e],DisplayName:f[e],Key:e,Value:e};b.push(g)}return b}function e(){return"en-us"}Object.defineProperty(b,"__esModule",{value:!0});var f={af:"Afrikaans","am-et":"አማርኛ (ኢትዮጵያ)",ar:"العربية","as-in":"অসমীয়া (ভাৰত)","az-latn-az":"azərbaycan (Azərbaycan)",be:"Беларуская",bg:"български","bn-bd":"বাংলা (বাংলাদেশ)","bn-in":"বাংলা (ভারত)","bs-latn-ba":"bosanski (Bosna i Hercegovina)",ca:"català","ca-es-valencia":"valencià (Espanya)",cs:"čeština","cy-gb":"Cymraeg (Y Deyrnas Unedig)",da:"dansk",de:"Deutsch",el:"Ελληνικά","en-gb":"English (United Kingdom)","en-us":"English (United States)",es:"español","es-mx":"español (México)",et:"eesti",eu:"euskara",fa:"فارسی",fi:"suomi","fil-ph":"Filipino (Pilipinas)",fr:"français","fr-ca":"français (Canada)","ga-ie":"Gaeilge (Éire)",gd:"Gàidhlig",gl:"galego",gu:"ગુજરાતી","ha-latn-ng":"Hausa (Najeriya)",he:"עברית",hi:"हिन्दी",hr:"hrvatski",hu:"magyar",hy:"Հայերեն",id:"Indonesia",is:"íslenska",it:"italiano",ja:"日本語",ka:"ქართული",kk:"қазақ тілі","km-kh":"ភាសាខ្មែរ (កម្ពុជា)",kn:"ಕನ್ನಡ",ko:"한국어",kok:"कोंकणी",ky:"Кыргыз","lb-lu":"Lëtzebuergesch (Lëtzebuerg)",lo:"ລາວ",lt:"lietuvių",lv:"latviešu","mi-nz":"te reo Māori (Aotearoa)",mk:"македонски",ml:"മലയാളം",mn:"монгол",mr:"मराठी",ms:"Melayu","mt-mt":"Malti (Malta)","nb-no":"norsk bokmål (Norge)","ne-np":"नेपाली (नेपाल)",nl:"Nederlands","nn-no":"nynorsk (Noreg)","or-in":"ଓଡ଼ିଆ (ଭାରତ)",pa:"ਪੰਜਾਬੀ",pl:"polski","prs-af":"polski","pt-br":"português (Brasil)","pt-pt":"português (Portugal)","quz-pe":"Runasimi (Perú)",ro:"română",ru:"русский","sd-arab-pk":"سنڌي (پاکستان)","si-lk":"සිංහල (ශ්‍රී ලංකාව)",sk:"slovenčina",sl:"slovenščina",sq:"shqip","sr-cyrl-ba":"српски (Босна и Херцеговина)","sr-cyrl-rs":"српски (Србија)","sr-latn-rs":"srpski (Srbija)",sv:"svenska",sw:"Kiswahili",ta:"தமிழ்",te:"తెలుగు",th:"ไทย","tk-tm":"Türkmen dili (Türkmenistan)",tr:"Türkçe",tt:"Татар",ug:"ئۇيغۇرچە",uk:"українська",ur:"اُردو","uz-latn-uz":"o‘zbek (Oʻzbekiston)",vi:"Tiếng Việt","zh-cn":"中文（中国）","zh-tw":"中文（台灣）"};b.getLocaleList=d,b.getDefaultLanguage=e,Forms.UX.MultiLingual.getLocaleList=d},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),e=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};Object.defineProperty(b,"__esModule",{value:!0});var f=c(0),g=c(1),h=OfficeForm.Exports.FormLimitation,i=OfficeForm.Exports.Utilities,j=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return d(b,a),b.prototype.render=function(){return f.createElement("div",e({},this.props.HTMLAttributes),f.createElement("iframe",{allowFullScreen:!0,className:this.props.ClassNameForIFrame,frameBorder:"0",height:b.calcVideoDisplayHeight(),sandbox:"allow-scripts allow-same-origin allow-popups",src:this.props.Url,width:"100%"}),this.props.children)},b.calcVideoDisplayHeight=function(){if(i.isMobile()){var a=$(window).width();return 0===a&&(a=document.body.scrollWidth),9*a/16}return h.DefaultVideoHeight},b}(g.ReactComponent);b.VideoControl=j,Forms.UX.Controls.VideoControl=j},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var e=c(0),f=c(1),g=OfficeForm.Exports.ColorHelper,h=OfficeForm.Exports.Utilities,i=OfficeForm.Exports.Resources,j=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.mounted=!0,b.imgToLoadBackground=new Image,b}return d(b,a),b.prototype.componentWillMount=function(){var a=this,b=this.props.ThemeMaster;b&&(this.observerCallback=function(b){b.NewValues.Name===i.LocalizedStrings.Customized_Theme_Name&&b.NewValues.BackgroundImage!==a.state.ImageUrl?a.setState({ImageUrl:b.NewValues.BackgroundImage,IsBackgroundImgCached:!1}):a.forceUpdate()},b.observe(this.observerCallback))},b.prototype.componentWillUnmount=function(){var a=this.props.ThemeMaster;this.mounted=!1,a&&a.unobserve(this.observerCallback)},b.prototype.render=function(){var a,c=this,d=this.props.ThemeMaster;if(a=h.isOEmbedSPO()&&OfficeFormServerInfo.themeInfo?b.getSPOTheme(OfficeFormServerInfo.themeInfo):d&&d.Model,!a)return null;var f=a.Name,g=a.PrimaryColor,j=a.SecondaryColor,k=a.BackgroundColor,l=a.BackgroundImage,m=4;l&&l.match("url((.*))")&&(l=l.substring(m,l.length-1)),f===i.LocalizedStrings.Customized_Theme_Name&&l&&(this.state.IsBackgroundImgCached||(this.imgToLoadBackground.src=l,this.imgToLoadBackground.onload=function(a){c.mounted&&c.setState({ImageUrl:l,IsBackgroundImgCached:!0})},l+="_mo"));var n="";return n+=".office-form-theme-primary-color { color:"+g+"; }",n+=".office-form-theme-secondary-color { color:"+j+"; }",n+=".office-form-theme-primary-background { background:"+g+"; color:#FFFFFF; }",n+=".office-form-theme-secondary-background { background:"+j+"; }",n+=".office-form-theme-primary-foreground, ",n+=".office-form-theme-primary-foreground a, ",n+=".office-form-theme-primary-foreground.rateit .rateit-selected, ",n+=".office-form-theme-primary-foreground.rateit .rateit-hover",n+="{ color:"+g+"; } ",n+=".office-form-theme-border-top { border-top-color:"+g+"; }",n+=".office-form-theme-border { border-color:"+g+";}",n+=".office-form-theme-interactive-background.active { background-color:"+g+"; }",n+=".office-form-theme-interactive-background:hover { background-color:"+j+"; }",n+=".office-form-theme-interactive-background:focus { background-color:"+j+"; }",n+=".office-form-theme-interactive-background:active { background-color:"+j+"; }",n+=".office-form-theme-interactive-color { color:"+g+"; }",n+=".office-form-theme-interactive-color:hover { color:"+j+"; }",n+=".office-form-theme-interactive-color:focus { color:"+j+"; }",n+=".office-form-theme-interactive-color:active { color:"+j+"; }",n+=".office-form-theme-button { color: white; background:"+g+"; }",n+=".office-form-theme-button:hover { background:"+j+"; }",n+=".office-form-theme-button:focus { background:"+j+"; }",n+=".office-form-dark-theme-button {color:"+j+"}",n+=".office-form-dark-theme-button:hover { color:"+j+"; }",n+=".office-form-dark-theme-button:focus { color:"+j+"; }",n+=".office-form-theme-page-background-active.active { background :"+(g+"; color: #FFFFFF; }"),n+=".office-form-theme-page-foreground-active.active, ",
n+=".office-form-theme-select-color.active *{ color: "+g+"; }",n+=".office-form-theme-toggle.active { background: "+(g+"; border-color:"+g+"; }"),n+=".office-form-theme-border { border-color:"+g+"; }",n+=".office-form-theme-outline { outline-color:"+g+"; }",n+=".office-form-theme-button-foreground.active,.office-form-theme-button-foreground.touch.active:hover { color: white; background: "+(g+"; outline-color:"+g+"; }"),n+=".office-form-theme-button-foreground.active:hover { background: "+(j+"; outline-color:"+j+"; }"),n+=".office-form-theme-quiz-point { color:"+j+"; }",n+=".office-form-theme-quiz-totalPoints-bar {color:"+g+"; }",n+=".office-form-theme-image-question-background, .office-form-theme-video-question-background { background-color: "+(k+"; outline: 1px solid transparent; }"),n+=".office-form-theme-image-container-border { border: 3px solid "+(k+"; }"),n+=".office-form-sortable-chosen .office-form-sort-item "+("{ background: "+g+"; color:white; }"),n+=".office-form-theme-sort-item { color: white; background:"+g+"; }",n+=".office-form-theme-sort-item:hover { background:"+j+"; }",n+=".office-form-theme-focus-border .office-form-textfield-input:focus,.office-form-theme-focus-border .form-control:focus,.office-form-theme-focus-border .select-control:focus,.office-form-theme-focus-border .picker--focused .picker__holder:focus{ border-color: "+(g+"; outline-color:"+g+"; }"),n+=".office-form-theme-bgcolor-hover:hover { background:"+k+"; }",n+=".office-form-theme-button-color:hover *{ color:"+j+"; }",n+=".form-intelligence-question-row.office-form-intelligence-theme-li { outline: 1px solid "+(j+"; background-color:"+k+";}"),n+=".office-form-insight-theme-control .simple-data-control-content { color : "+(g+"; }"),n+=".office-form-insight-theme-control .simple-data-control-description { color : "+(g+"; }"),n+=".office-form-insight-theme-control .simple-data-control-description:hover { color : "+(j+"; }"),n+=".office-form-insight-theme-control .simple-data-control-description:focus { color : "+(j+"; }"),n+=".office-form-insight-theme-control .simple-data-control-description:active { color : "+(j+"; }"),n+=".office-form-info-container .office-form-info-children.office-form-theme-spo-link { color: "+(g+"; }"),n+=".office-form-info-container .office-form-info-children.office-form-theme-spo-link:hover"+("{color:"+j+"; }"),n+=".office-form-spo-embed .office-form-footer-block .office-form-theme-spo-link { color: "+(g+"; }"),n+=".office-form-spo-embed .office-form-footer-block .office-form-theme-spo-link:hover { color: "+(j+"; }"),n+=".office-form-theme-spo-link { color:"+g+"; }",n+=".office-form-theme-spo-link:hover { color:"+j+"; }",h.isOEmbedSPO()||(l?(n+=".thank-you-page-content { opacity:.97; }",n+=".introduction-for-responser-container { opacity:.97; }",h.isMobile()?(n+=".office-form-theme-page-background { background-color:"+k+"; }",n+=".office-form-theme-footer { background: rgba(255,255,255,.4); }"):(n+=".office-form-theme-page-background { background-image: url("+(l+"); }"),n+=".office-form-theme-footer { background: rgba(244,244,244,.8); }"),n+=".preview-mobile-container.office-form-theme-page-background { background:"+(k+"; }"),n+=".preview-mobile-container .office-form-theme-footer { background: rgba(255,255,255,.4); }"):(n+=".office-form-theme-footer { background : rgba(255,255,255,.4); }",n+=".office-form-theme-page-background { background-color:"+k+"; }")),n+=l&&f!==i.LocalizedStrings.Customized_Theme_Name?".office-form-theme-shadow { box-shadow : none; }":".office-form-theme-shadow { box-shadow: 0 0 11px rgba(0,0,0,.12); }",f===i.LocalizedStrings.Customized_Theme_Name&&(n+=".office-form-body { opacity: 0.97; }"),e.createElement("style",null,n)},b.getSPOTheme=function(a){var b=g.normalizePrimaryColor(a),c={BackgroundColor:g.primaryHexToBackgroundHex(b),BackgroundImage:null,Name:"Customized Theme",PrimaryColor:b,SecondaryColor:g.primaryHexToSecondaryHex(b),Thumbnail:null};return c},b}(f.ReactComponent);b.ThemeRender=j,Forms.UX.Renderer.ThemeRender=j},,function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c(43),e=OfficeForm.Exports.Models,f=function(){function a(a){this.master=a,this.dataProvider=e.FormDataSource.getDataProviderByFormMaster(this.master.Form)}return a.prototype.add=function(a){var b=this;if(this.master.Form.SyncContext!==e.FormSyncContext.DesignTimeForm)return $.Deferred().resolve().promise();var c=this.master.QuestionId;if(c){var f=this.master.Form.getQuestionById(c),g=f.getChoiceByKey(this.master.Model.key||"");if(g)return g.Synchronizer.existingInDataSource().then(function(){var c=g.Model.Id.toString();b.master.Model.choiceId=c;var e={elementKey:"choiceid_"+c,elementValue:a.description,locale:b.master.LocaleId,questionId:b.master.QuestionId};return d.createLocalizedItemBatch(e,b.master.FormId).then(function(){var b={choiceId:c,description:a.description};return b})})}return $.Deferred().reject().promise()},a.prototype["delete"]=function(a){throw Error("No scenario to call this method currently.")},a.prototype.query=function(a){throw Error("No scenario to call this method currently.")},a.prototype.update=function(a,b){if(!b.ValuesBefore||this.master.Form.SyncContext!==e.FormSyncContext.DesignTimeForm)return $.Deferred().resolve().promise();if(a.choiceId||void 0===a.description)throw Error("No valid payload to update.");var c={elementKey:"choiceid_"+this.master.ChoiceId,elementValue:a.description,locale:this.master.LocaleId,questionId:this.master.QuestionId},d=null!==b.ValuesBefore.description;return d?this.dataProvider.updateLocaleItem(this.master.FormId,c):this.dataProvider.createLocaleItem(this.master.FormId,c)},a}();b.ChoiceLocalizedItemDataSource=f},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c(3),e=c(43),f=c(17),g=OfficeForm.Exports.Models,h=function(){function a(a){this.master=a,this.dataProvider=g.FormDataSource.getDataProviderByFormMaster(this.master.Form)}return a.prototype.add=function(a){var b=this;if(this.master.Form.SyncContext!==g.FormSyncContext.DesignTimeForm)return $.Deferred().resolve().promise();var c=this.master.Form;return c?c.Synchronizer.existingInDataSource().then(function(){var c,g=[];for(c in a)if(a.hasOwnProperty(c)){var h=f.parseFormLocalizedItem(d.pick(a,[c]));null!==h.elementKey&&"localename"!==h.elementKey&&(h.locale=b.master.Model.localeId,h.questionId="",g.push(e.createLocalizedItemBatch(h,b.master.FormId)))}return $.when.apply($,g).then(function(a){})}):$.Deferred().reject().promise()},a.prototype["delete"]=function(a){throw Error("No scenario to call this method currently.")},a.prototype.query=function(a){throw Error("No scenario to call this method currently.")},a.prototype.update=function(a,b){if(!b.ValuesBefore||this.master.Form.SyncContext!==g.FormSyncContext.DesignTimeForm)return $.Deferred().resolve().promise();var c,e=[];for(c in a)if(a.hasOwnProperty(c)){var h=null!==b.ValuesBefore[c],i=f.parseFormLocalizedItem(d.pick(a,[c]));i.locale=this.master.Model.localeId,i.questionId="",e.push(h?this.dataProvider.updateLocaleItem(this.master.FormId,i):this.dataProvider.createLocaleItem(this.master.FormId,i))}return $.when.apply($,e).then(function(a){})},a}();b.FormLocalizedItemDataSource=h},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c(3),e=c(43),f=c(17),g=OfficeForm.Exports.Models,h=function(){function a(a){this.master=a,this.dataProvider=g.FormDataSource.getDataProviderByFormMaster(this.master.Form)}return a.prototype.add=function(a){var b=this;if(this.master.Form.SyncContext!==g.FormSyncContext.DesignTimeForm)return $.Deferred().resolve().promise();var c=this.master.QuestionId;if(c){var h=this.master.Form.getElementById(c);if(h)return h.Synchronizer.existingInDataSource().then(function(){var c,g=[];for(c in a)if(a.hasOwnProperty(c)){var h=f.parseQuestionLocalizedItem(d.pick(a,[c]));h.elementKey&&(h.locale=b.master.Model.localeId,h.questionId=b.master.QuestionId,g.push(e.createLocalizedItemBatch(h,b.master.FormId)))}return $.when.apply($,g).then(function(a){})})}return $.Deferred().reject().promise()},a.prototype["delete"]=function(a){throw Error("No scenario to call this method currently.")},a.prototype.query=function(a){throw Error("No scenario to call this method currently.")},a.prototype.update=function(a,b){if(!b.ValuesBefore||this.master.Form.SyncContext!==g.FormSyncContext.DesignTimeForm)return $.Deferred().resolve().promise();var c,e=[];for(c in a)if(a.hasOwnProperty(c)){var h=null!==b.ValuesBefore[c],i=f.parseQuestionLocalizedItem(d.pick(a,[c]));i.locale=this.master.Model.localeId,i.questionId=this.master.QuestionId,e.push(h?this.dataProvider.updateLocaleItem(this.master.FormId,i):this.dataProvider.createLocaleItem(this.master.FormId,i))}return $.when.apply($,e).then(function(a){})},a}();b.QuestionLocalizedItemDataSource=h},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var e=c(7),f=c(87),g=e.Spec,h={localeId:g.string({IsKeyField:!0}),localeName:g.string()},i=function(a){return new f.LocaleInfoDataSource(a)},j=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return d(b,a),Object.defineProperty(b.prototype,"Form",{get:function(){return this.Parent.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!0,configurable:!0}),b}(e.createObjectMasterClass("LocaleInfoMaster",h,i));b.LocaleInfoMaster=j,Forms.Models.LocaleInfoMaster=j},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=OfficeForm.Exports.Models,e=function(){function a(a){this.master=a,this.dataProvider=d.FormDataSource.getDataProviderByFormMaster(this.master.Form)}return a.prototype.add=function(a){if(!a.localeId||!a.localeName||this.master.Form.SyncContext!==d.FormSyncContext.DesignTimeForm)return $.Deferred().resolve().promise();var b={elementKey:"localename",elementValue:a.localeName,locale:a.localeId,questionId:""};return this.dataProvider.createLocaleItem(this.master.FormId,b)},a.prototype["delete"]=function(a){return a.localeId&&this.master.Form.SyncContext===d.FormSyncContext.DesignTimeForm?this.dataProvider.deleteLocale(this.master.FormId,a.localeId):$.Deferred().resolve().promise()},a.prototype.query=function(a){throw Error("No scenario to call this method currently.")},a.prototype.update=function(a,b){if(!b.ValuesBefore||!a.localeName||this.master.Form.SyncContext!==d.FormSyncContext.DesignTimeForm)return $.Deferred().resolve().promise();var c=null!==b.ValuesBefore.localeName,e={elementKey:"localename",elementValue:a.localeName,locale:this.master.Model.localeId,questionId:null};return c?this.dataProvider.updateLocaleItem(this.master.FormId,e):this.dataProvider.createLocaleItem(this.master.FormId,e)},a}();b.LocaleInfoDataSource=e},,,,function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),e=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};Object.defineProperty(b,"__esModule",{value:!0});var f=c(0),g=c(3),h=c(1),i=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.renderingElement=f.createRef(),b}return d(b,a),b.prototype.componentDidMount=function(){var a=this;this.props.LazyRendering&&(this.renderingElement.current&&console.log(this.renderingElement.current),window.setTimeout(function(){return a.setState({Mounted:!0})}))},b.prototype.render=function(){var a=g.clone(this.props.HTMLAttributes||{});switch(this.props.Role){case"Alert":a.role="alert";break;case"Log":a.role="log",a["aria-live"]=a["aria-live"]||"polite",a["aria-relevant"]=a["aria-relevant"]||"additions text";break;case"Marquee":a.role="marquee";break;case"Status":a.role="status"}return this.props.LazyRendering&&!this.state.Mounted?(a["aria-label"]=void 0,a.children=null,a.ref=this.renderingElement,f.createElement("div",e({},a))):f.createElement("div",e({},a),this.props.children)},b}(h.ReactComponent);b.LiveRegion=i,Forms.UX.Controls.LiveRegion=i},,function(a,b){function c(a,b){var c,e,f,g=a.nodeName.toLowerCase();return"area"===g?(c=a.parentNode,e=c.name,a.href&&e&&"map"===c.nodeName.toLowerCase()?(f=$("img[usemap=#"+e+"]")[0],!!f&&d(f)):!1):(/input|select|textarea|button|object/.test(g)?!a.disabled:"a"===g?a.href||b:b)&&d(a)}function d(a){return $.expr.filters.visible(a)&&!$(a).parents().addBack().filter(function(){return"hidden"===$.css(this,"visibility")}).length}$.extend($.expr[":"],{focusable:function(a){return c(a,!isNaN($.attr(a,"tabindex")))}})},function(a,b,c){"use strict";function d(a){return g.createElement(l,f({},a))}var e=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),f=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};Object.defineProperty(b,"__esModule",{value:!0});var g=c(0),h=c(46),i=c(1),j=OfficeForm.Exports.Control,k=OfficeForm.Exports.Resources,l=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.allowedTypesCount=0,b}return e(b,a),b.prototype.render=function(){var a=j.createFontIconControl({HTMLAttributes:{className:"forms-icon-size18x18"},IconName:"Upload"}),b=g.createElement("span",{className:"design-question-upload-text"},k.LocalizedStrings.UploadFile_Button),c=g.createElement("div",{className:"design-question-upload-container",key:"addButton"},g.createElement("div",{className:"design-question-upload-button"},a,b));return g.createElement("div",null,c,this.createFileUploadValidation())},b.prototype.createFileUploadValidation=function(){var a=this.props.FileTypes;return this.props.HasSpecificFileType?(0===this.allowedTypesCount&&(this.allowedTypesCount=Object.keys(a).length),g.createElement("div",{className:"design-question-restrictions-container",key:"restrictionsContainer"},g.createElement("span",{className:"design-question-restrictions-title"},k.LocalizedStrings.UploadFile_Restrictions),g.createElement("div",{className:"design-question-fileUpload-fileType-container"},g.createElement("div",{className:"design-question-fileUpload-fileType"},this.createFileTypeButton("Word"),this.createFileTypeButton("Excel"),this.createFileTypeButton("PowerPoint"),this.createFileTypeButton("PDF")),g.createElement("div",{className:"design-question-fileUpload-fileType"},this.createFileTypeButton("Image"),this.createFileTypeButton("Text"),this.createFileTypeButton("Video"),this.createFileTypeButton("Audio"))))):null},b.prototype.createFileTypeButton=function(a){var b=this;return j.createCheckBox({Description:h.convertFileTypeToString(a),HTMLAttributes:{className:"inline-display design-question-upload-checkbox"},onValueChange:function(c){b.props.FileTypes[a]=c,c?b.allowedTypesCount++:b.allowedTypesCount--,0===b.allowedTypesCount&&b.props.setSpecificFileTypeCallback(!1)},Options:{classNameForInnerDiv:"inline-display"},SpanClassName:"design-question-file-type",Value:this.props.FileTypes[a]})},b}(i.ReactComponent);b.FileUploadQuestionDesigner=l,b.createFileUploadDesigner=d,Forms.UX.FileUpload.createFileUploadDesigner=d},function(a,b){},,,function(a,b,c){"use strict";function d(){return j.log({eventName:o,eventType:"engagement_event"}),i.redirectTo("/Pages/DesignPage.aspx"),!0}function e(){return j.log({eventName:n,eventType:"engagement_event"}),i.redirectTo("/Pages/DesignPage.aspx"),!0}var f=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),g=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};Object.defineProperty(b,"__esModule",{value:!0});var h=c(0),i=c(6),j=c(2),k=c(5),l=c(1),m=OfficeForm.Exports.Resources,n="ResponsePage.IntroductionForResponser.Create",o="ResponsePage.IntroductionForResponser.TryForms",p=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.buttonRef=h.createRef(),b}return f(b,a),b.prototype.render=function(){var a=h.createElement("div",{className:"introduction-title-container"},h.createElement("div",{className:"introduction-title"},m.LocalizedStrings.Form_Introduction_Title_MSA),h.createElement("a",{className:"office-form-try-link",href:"javascript:void(0)",onClick:d},m.LocalizedStrings.Form_Introduction_TryText_MSA)),b={ButtonStyle:"LightBackground",HTMLAttributes:{"aria-label":m.LocalizedStrings.Form_Introduction_CreateButtonText_MSA,className:"introduction-create-form",onClick:e,title:m.LocalizedStrings.Form_Introduction_CreateButtonText_MSA},ref:this.buttonRef,Text:m.LocalizedStrings.Form_Introduction_CreateButtonText_MSA},c=h.createElement(k.TextButton,g({},b));return h.createElement("div",{className:"office-form introduction-for-responser-container"},a,h.createElement("div",{className:"introduction-container"},h.createElement("div",{className:"introduction"},h.createElement("img",{alt:m.LocalizedStrings.Form_Introduction_MSA_1,className:"introduction-image",key:"introductionImage1",src:"../Images/MSAIntroduction1.png"}),h.createElement("div",{className:"introduction-text"},m.LocalizedStrings.Form_Introduction_MSA_1)),h.createElement("div",{className:"introduction"},h.createElement("img",{alt:m.LocalizedStrings.Form_Introduction_MSA_2,className:"introduction-image",key:"introductionImage2",src:"../Images/MSAIntroduction2.png"}),h.createElement("div",{className:"introduction-text"},m.LocalizedStrings.Form_Introduction_MSA_2)),h.createElement("div",{className:"introduction"},h.createElement("img",{alt:m.LocalizedStrings.Form_Introduction_MSA_3,className:"introduction-image",key:"introductionImage3",src:"../Images/MSAIntroduction3.png"}),h.createElement("div",{className:"introduction-text"},m.LocalizedStrings.Form_Introduction_MSA_3))),h.createElement("div",{className:"introduction-button"},c))},b}(l.ReactComponent);Forms.UX.Renderer.IntroductionForResponder=p},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),e=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};Object.defineProperty(b,"__esModule",{value:!0});var f=c(0),g=c(3),h=c(10),i=c(15),j=c(16),k=OfficeForm.Exports.CategoryExtensionPoints,l=OfficeForm.Exports.Control,m=OfficeForm.Exports.ExtensionPoints,n=OfficeForm.Exports.Flighting,o=OfficeForm.Exports.FormLimitation,p=OfficeForm.Exports.Models,q=OfficeForm.Exports.Resources,r=OfficeForm.Exports.Utilities,s="6c660282-db72-436c-87bb-8272cba504d3",t=function(a){function b(b){var c=a.call(this,b)||this;c.otherAnswerTextRef=f.createRef(),c.radioGroupName=r.Guid.newGuid();var d=c.parseAnswer();return c.state={ChoiceOptions:c.getOptions(),IsOtherOptionSelected:!!d.OtherAnswer,LocalizedOptions:c.questionLocalizedItemMaster&&c.questionLocalizedItemMaster.Model.option,OptionsOrder:c.generateOptionsOrder(),OtherOptionText:d.OtherAnswer,SelectedOptions:d.SelectedOptions},c.onChange=c.onChange.bind(c),c.handleOtherInputChange=c.handleOtherInputChange.bind(c),c.resetState=c.resetState.bind(c),c.resetLocaleResourceState=c.resetLocaleResourceState.bind(c),c.onAnswerChange=c.onAnswerChange.bind(c),c.handleOtherValueChange=c.handleOtherValueChange.bind(c),c}return d(b,a),b.prototype.componentDidMount=function(){a.prototype.componentDidMount.call(this),this.props.Master.Question.observe(this.resetState),this.props.ShowQuizResult&&this.props.Master.observe(this.onAnswerChange,[p.QuestionRuntimeMaster.Schema.Answer]),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.resetLocaleResourceState,[h.QuestionLocalizedItemMaster.Schema.choicesV1])},b.prototype.componentWillUnmount=function(){this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.resetLocaleResourceState),this.props.Master.Question.unobserve(this.resetState),this.props.ShowQuizResult&&this.props.Master.unobserve(this.onAnswerChange,[p.QuestionRuntimeMaster.Schema.Answer]),a.prototype.componentWillUnmount.call(this)},b.prototype.componentWillReceiveProps=function(b){this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.resetLocaleResourceState),a.prototype.componentWillReceiveProps.call(this,b),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.resetLocaleResourceState,[h.QuestionLocalizedItemMaster.Schema.choicesV1])},b.prototype.shouldComponentUpdate=function(a,b){var c=!g.isEqual(a,this.props),d=!g.isEqual(b,this.state);return c||d},b.prototype.createReactNodes=function(){var a=this.props.Master.Question,b=a.Model,c=b.ChoiceType===p.ChoiceType.SingleChoice;if(n.Flight.isEnabled("DropDown")){if(!this.props.ExpandAll&&a.showAsDropdown()&&!this.props.IsMobile&&(!b.IsQuiz||!this.props.ShowQuizResult))return[this.createDropDown()]}else if(!this.props.ExpandAll&&a.showAsDropdown()&&!this.props.IsMobile&&!b.IsQuiz)return[this.createDropDown()];return[this.createChoices(c)]},b.prototype.onAnswerChange=function(){var a=this.parseAnswer();this.setState({IsOtherOptionSelected:!!a.OtherAnswer,OtherOptionText:a.OtherAnswer,SelectedOptions:a.SelectedOptions})},b.prototype.updateAnswer=function(){var a,b=[],c=this.props.Master.Question.Model.ChoiceType===p.ChoiceType.SingleChoice,d=this.state.SelectedOptions;d&&d.forEach(function(a){return b.push(a)});var e=this.state.OtherOptionText;if(this.state.IsOtherOptionSelected&&e&&-1===b.indexOf(e)&&b.push(e),c)a=b[0];else if(b.length){var f=this.sortAnswers(b);a=JSON.stringify(f)}this.props.Master.Model.Answer=a},b.prototype.createChoices=function(a){var c=this,d=this.props.Master,h=d.Question.Model,i=g.map(this.state.OptionsOrder,function(a){return c.state.ChoiceOptions[a]}),j=i.length+(h.AllowOtherAnswer?1:0),n=this.props.Master.Question.Form,o=k.supportsExtensionPoint(n,m.ResponsePagePollView),p=i.map(function(d,g){var h={className:r.Html.combineAttributes(c.props.IsMobile&&!o?"office-form-question-choice-mobile office-form-theme-page-background-active":"office-form-question-choice")},i=!1,k=c.state.SelectedOptions;-1!==k.indexOf(d.Description)&&(i=!0,c.props.IsMobile&&(h.className=r.Html.combineAttributes(h.className,"active")));var m={"aria-checked":i,checked:i,disabled:c.props.Disabled,name:a?c.radioGroupName:void 0,onChange:c.onChange,type:"checkbox",value:d.Description};a&&(m.type="radio",m["aria-posinset"]=g+1,m["aria-setsize"]=j);var n,p=c.props.Master.Question.Model.IsQuiz,q="office-form-question-choice-row";if(p&&(q=r.Html.combineAttributes(q,"office-form-question-choice-quiz-row")),c.props.Master.Question.Model.IsMathQuiz&&d.IsMathOption){var s=l.createFormulaRenderer({DisableLinebreaks:c.props.DisableFormulaLinebreak,Formula:d.Description,onRenderComplete:c.props.onHeightChange});n=f.createElement("div",{className:"office-form-question-choice-formula"},s);var t={"aria-label":d.Description};m=r.Html.mergeReactProps(m,t)}else{var u=c.questionLocalizedItemMaster,v=void 0;if(u){var w=u.getChoiceV1LocalizedMaster(c.state.OptionsOrder[g]);v=w&&w.Model.description}var x=v||d.Description,y={RenderMode:l.UserTextRenderMode.RichText,Text:x},z=l.createUserTextRenderer(y);n=f.createElement("span",{className:"office-form-question-choice-text-span"},z),q=r.Html.combineAttributes(q,"office-form-question-choice-text-row")}var A=b.getAnswerKeyMark(c.props,d,i),B=b.getAnswerHintLabel(c.props,d,i);return f.createElement("div",e({},h,{key:g}),f.createElement("div",{className:a?"radio":"checkbox"},f.createElement("label",{className:q},f.createElement("input",e({},m)),n,A)),B)}),q=this.getElementProps({key:"choicequestion-choices",role:a?"radiogroup":"group"});return f.createElement("div",e({},q),p,this.createOtherAnswer(a))},b.prototype.createOtherAnswer=function(a){var b=this.props.Master.Question.Form,c=k.supportsExtensionPoint(b,m.ResponsePagePollView);if(this.props.Master.Question.Model.AllowOtherAnswer){var d={className:this.props.IsMobile&&!c?"office-form-other-answer-mobile":"office-form-other-answer",key:"other-answer"};return f.createElement("div",e({},d),this.createOtherAnswerInput(a),this.createOtherAnswerTextbox())}},b.prototype.createOtherAnswerInput=function(a){var b="otherAnswerInput",c=this.state.ChoiceOptions,d={"aria-label":q.LocalizedStrings.Response_Page_OtherAnswerTitle,checked:this.state.IsOtherOptionSelected,disabled:this.props.Disabled,name:a?this.radioGroupName:void 0,onChange:this.handleOtherInputChange,ref:b,role:"checkbox",type:"checkbox",value:this.state.OtherOptionText||""};return a&&(d.role="radio",d.type="radio",d["aria-posinset"]=c.length+1,d["aria-setsize"]=c.length+1),f.createElement("input",e({},d))},b.prototype.handleOtherInputChange=function(a){var b=this,c=a.target,d=c.checked;if(!this.state.IsOtherOptionSelected||!d){var e=g.clone(this.state.SelectedOptions);if(d&&c.value){this.props.Master.Question.Model.ChoiceType===p.ChoiceType.SingleChoice&&(e=[]);var f=this.otherAnswerTextRef.current;f&&f.focus()}else d&&(c.checked=!1),d=!1;this.setState({IsOtherOptionSelected:d,SelectedOptions:e},function(){return b.updateAnswer()})}},b.prototype.createOtherAnswerTextbox=function(){var a={"aria-label":q.LocalizedStrings.Designer_OtherAnswer,className:"office-form-other-answer-textbox"},b={Disabled:this.props.Disabled,HTMLAttributes:{className:"inline-display office-form-other-answer-margin-left-mobile"},MaxLength:o.OtherOptionLength,onValueChange:this.handleOtherValueChange,Options:{HTMLPropsForInnerElement:a},Placeholder:q.LocalizedStrings.Designer_OtherAnswer,ref:this.otherAnswerTextRef,Value:this.state.OtherOptionText||""};return l.createTextField(b)},b.prototype.handleOtherValueChange=function(a){var b=this,c=this.state.SelectedOptions;this.props.Master.Question.Model.ChoiceType===p.ChoiceType.SingleChoice&&(c=[]),this.setState({IsOtherOptionSelected:!!a,OtherOptionText:a,SelectedOptions:c},function(){return b.updateAnswer()})},b.prototype.resetState=function(){var a=this.parseAnswer();this.setState({ChoiceOptions:this.getOptions(),OptionsOrder:this.generateOptionsOrder(),OtherOptionText:a.OtherAnswer,SelectedOptions:a.SelectedOptions})},b.prototype.resetLocaleResourceState=function(){this.setState({LocalizedOptions:this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.Model.option})},b.prototype.onChange=function(a){var b=this,c=a.target,d=g.clone(this.state.SelectedOptions),e=this.props.Master.Question.Model.ChoiceType===p.ChoiceType.SingleChoice,f=c.defaultValue,h=this.state.IsOtherOptionSelected;if(e){if(f===d[0])return;h=!1,d=[f]}else{var i=d.indexOf(f);c.checked?-1===i&&d.push(f):-1!==i&&d.splice(i,1)}this.setState({IsOtherOptionSelected:h,SelectedOptions:d},function(){return b.updateAnswer()})},b.prototype.createDropDown=function(){var a,c,d=this,e=this.props.Master,h=e.Question.Model,i=g.map(this.state.OptionsOrder,function(a){return d.state.ChoiceOptions[a]}),j=i.map(function(a,b){var c,e=d.questionLocalizedItemMaster;if(e){var f=e.getChoiceV1LocalizedMaster(d.state.OptionsOrder[b]);c=f&&f.Model.description}var g=c||a.Description,h={DisplayName:g,Key:Nerve.getObjectMasterFromModel(a).getInstanceId(),Value:a.Description};return h}),k=e.Model.Answer;n.Flight.isEnabled("DropDown")?(h.AllowOtherAnswer&&j.push(b.createDropDownOtherOption()),this.state.IsOtherOptionSelected&&(k=s),!this.props.ShowDesignInfo&&this.state.IsOtherOptionSelected&&(a=this.createDropDownOtherAnswer()),c=function(a){return d.onDropDownValueChange(a)}):c=function(a){return e.Model.Answer=a};var m=l.createSelect({AllowWrap:!0,HTMLAttributes:this.getElementProps({className:"office-form-question-dropdown",disabled:this.props.Disabled,title:h.Hint||q.LocalizedStrings.Dropdown_DefaultHint}),key:"choicequestion-dropdown",onValueChange:c,Placeholder:h.Hint||q.LocalizedStrings.Dropdown_DefaultHint,SelectOptions:j,Value:k});return f.createElement("div",{className:this.getValidationStyle()},m,a)},b.prototype.onDropDownValueChange=function(a){var b=this,c=a===s,d=c?[]:[a];this.setState({IsOtherOptionSelected:c,SelectedOptions:d},function(){return b.updateAnswer()})},b.createDropDownOtherOption=function(){var a={DisplayName:q.LocalizedStrings.Designer_OtherAnswer,Key:s,Value:s};return a},b.prototype.createDropDownOtherAnswer=function(){var a=this,b="office-form-other-answer office-form-dropdown-other-answer",c={"aria-label":q.LocalizedStrings.TextField_DefaultPlaceholder,className:"office-form-other-answer-textbox"},d={AutoFocus:!0,Disabled:this.props.Disabled,HTMLAttributes:{className:b},onValueChange:function(b){a.setState({OtherOptionText:b,SelectedOptions:[]},function(){return a.updateAnswer()})},Options:{HTMLPropsForInnerElement:c},Placeholder:q.LocalizedStrings.TextField_DefaultPlaceholder,ref:this.otherAnswerTextRef,Value:this.state.OtherOptionText};return l.createTextField(d)},b.prototype.sortAnswers=function(a){var b=this.props.Master.Question.Model.Choices,c=g.map(b,function(a){return a.Description});return a.sort(function(a,b){return c.indexOf(a)-c.indexOf(b)})},b.isQuizResultAnswerKey=function(a,b){if(!a||!a.IsAnswerKeys)return!1;var c=a.Choices;return c?a.IsAnswerKeys[c.indexOf(b.Description)]:!1},b.getAnswerKeyMark=function(a,c,d){var e,f,g,h=a.Master,i=h.Model.QuizResult,j=h.Question,k=b.isQuizResultAnswerKey(i,c);if(c.IsAnswerKey&&a.ShowDesignInfo&&j.Model.IsQuiz||k)g="CheckMark",e=a.IsMobile&&d?"image-button-checked-answerkey-mobile office-form-answerkey":"image-button-answerkey office-form-answerkey",f=q.LocalizedStrings.Quiz_CorrectAnswer;else{if(!(d&&i&&i.IsAnswerKeys&&i.IsAnswerKeys.some(function(a){return a}))||k)return void 0;e=a.IsMobile?"image-button-checked-wrong-answer-mobile office-form-answerkey":"",g=a.IsMobile?"Cancel":"",f=q.LocalizedStrings.Quiz_WrongAnswer}return e=r.Html.combineAttributes(e,"forms-icon-size20x20"),l.createFontIconControl({HTMLAttributes:{className:e,role:"tooltip",title:f},IconName:g})},b.getAnswerHintLabel=function(a,c,d){var e,g=a.Master.Model.QuizResult;if(!a.ShowDesignInfo&&d&&g){var h=g.Choices,i=h?h.indexOf(c.Description):-1,j=g.AnswerHints&&g.AnswerHints[i];if(j){var k=void 0;k=b.isQuizResultAnswerKey(g,c)?a.IsMobile?"validation-success-mobile":"validation-success":a.IsMobile?"validation-error-mobile":"validation-error",k=r.Html.combineAttributes("office-form-answerhint",k),e=f.createElement("div",{className:k},j)}}return e},b.prototype.getOptions=function(){var a=this.props.Master.Question.Model;return this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.getChoiceV1LocalizedMaster(a.Choices.length-1),
Nerve.convertToArray(a.Choices)},b.prototype.generateOptionsOrder=function(){for(var a=this.props.Master.Question.Model,b=[],c=0;c<a.Choices.length;c++)b[c]=c;return!a.ShuffleOptions||this.props.DisableShuffle?b:g.shuffle(b)},b.prototype.parseAnswer=function(){var a,b=this.props.Master,c=b.Model,d=b.Question.Model,e=d.ChoiceType===p.ChoiceType.SingleChoice,f=[],h=p.Question.getChoiceAnswer(c.Answer||"",d).SelectedOptions;if(h.length>0){var i=e?[c.Answer]:h;i.forEach(function(b){var c=g.findIndex(d.Choices,function(a){return a.Description===b});-1!==c?f.push(b):d.AllowOtherAnswer&&(a=b)})}return{OtherAnswer:a,SelectedOptions:f}},b}(j.QuestionRendererBase);i.registerRendererComponentClass(p.QuestionType.Choice,t)},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var e=c(15),f=c(16),g=OfficeForm.Exports.Control,h=OfficeForm.Exports.Models,i=OfficeForm.Exports.Resources,j=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return d(b,a),b.prototype.createReactNodes=function(){var a,b=this,c=this.props.Master.Model;return this.isValueInvalid&&(a=g.createLabel({Alert:!0,HTMLAttributes:{className:"validation-error-message-label",role:"alert"},key:"error",Label:i.LocalizedStrings.DateValidation_ErrorMessage.format(OfficeFormServerInfo.cultureInfo.DateTimeFormat.ShortDatePattern)})),[g.createDateTimePicker({DateTitle:i.LocalizedStrings.QuestionType_DatePicker_DateTitle,Disabled:this.props.Disabled,IsLocaleInvariant:!0,key:"dateTime",onValueChange:function(a){c.Answer=a},onValueValidation:function(a){b.isValueInvalid=!a,b.forceUpdate()},Options:{classNameForInnerDiv:"office-form-textfield",HTMLPropsForInnerElement:this.getElementProps({className:"office-form-question-textbox"})},Placeholder:i.LocalizedStrings.QuestionType_DateTime_PlaceHolder.format(OfficeFormServerInfo.cultureInfo.DateTimeFormat.ShortDatePattern),ShowClearButton:!0,Theme:this.props.Theme,Type:g.PickerType.DatePicker,ValidationStyle:this.getValidationStyle(),Value:c.Answer}),a]},b}(f.QuestionRendererBase);e.registerRendererComponentClass(h.QuestionType.DateTime,j)},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var e=c(0),f=c(69),g=c(15),h=c(16),i=OfficeForm.Exports.Models,j=function(a){function b(b){var c=a.call(this,b)||this;return c.createOD4BTempFolder=c.createOD4BTempFolder.bind(c),c.setAnswer=c.setAnswer.bind(c),c}return d(b,a),b.prototype.createReactNodes=function(){var a=this.props;return[e.createElement(f.FileUploadQuestionRenderer,{Answer:a.Master.Model.Answer,createOD4BTempFolderCallBack:this.createOD4BTempFolder,decreaseUploadingFileCountCallBack:a.decreaseUploadingFileCountCallBack,Disabled:a.Disabled,FileTypes:a.Master.Question.Model.FileTypes,FileUploadProps:this.getElementProps(),FormId:a.Master.Question.Form.Model.Id,HideDeleteButton:!!a.HideDeleteButton,increaseUploadingFileCountCallBack:a.increaseUploadingFileCountCallBack,IsStudentViewMode:!!a.IsStudentViewMode,setAnswerCallback:this.setAnswer,ShowFileInfo:!!a.ShowFileInfo})]},b.prototype.createOD4BTempFolder=function(){return this.props.Master.createOD4BTempFolder()},b.prototype.setAnswer=function(a){this.props.Master.Model.Answer=a||""},b}(h.QuestionRendererBase);g.registerRendererComponentClass(i.QuestionType.FileUpload,j)},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),e=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};Object.defineProperty(b,"__esModule",{value:!0});var f=c(0),g=c(3),h=c(10),i=c(15),j=c(70),k=c(16),l=OfficeForm.Exports.Models,m=OfficeForm.Exports.Utilities.isSmallScreen,n=function(a){function b(b){var c=a.call(this,b)||this;return c.state={IsSubQuestionsExpanded:[!b.Disabled]},c}return d(b,a),b.prototype.componentWillMount=function(){var b=this;a.prototype.componentWillMount.call(this);var c=this.props.Master;this.onSubQuestionListChangeCallback=function(a){return b.onSubQuestionListChange(a)};var d=Nerve.getCollectionMasterFromModel(c.Question.Form.Model.Questions);d.observe(this.onSubQuestionListChangeCallback),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.update,[h.QuestionLocalizedItemMaster.Schema.choices])},b.prototype.componentWillUnmount=function(){var b=Nerve.getCollectionMasterFromModel(this.props.Master.Question.Form.Model.Questions);b.unobserve(this.onSubQuestionListChangeCallback),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.update),a.prototype.componentWillUnmount.call(this)},b.prototype.createReactNodes=function(){var a,b=this.createSubQuestionsLayout(),c=this.showPadView();if(c){var d=this.getElementProps({className:"office-form-mobile-matrix-container",key:"Likert",role:"List"});a=f.createElement("div",e({},d),b)}else{var g=this.createHeaderLine();a=f.createElement("div",{className:"office-form-matrix-table",key:"Likert"},f.createElement("table",e({},this.getElementProps()),g,f.createElement("tbody",{className:"office-form-matrix-stbody"},b)))}return[a]},b.prototype.onSubQuestionListChange=function(a){var b=this.props.Master,c=a.AddedModels.concat(Nerve.convertToArray(a.RemovedModels)).map(Nerve.getObjectMasterFromModel).some(function(a){return a.Model.GroupId===b.Question.Model.Id});c&&this.forceUpdate()},b.prototype.createHeaderLine=function(){var a,b=this,c=this.props.Master.Question.Model,d=this.questionLocalizedItemMaster,h=f.createElement("td",{className:"office-form-matrix-ptd",key:"emptyTd"}),i={className:"office-form-matrix-ptd",width:"width:calc((100% - 180px)/"+c.ChoiceGroup.length+")"},j=c.ChoiceGroup;return a=g.map(j,function(a,c){var h;d&&d.Model.choices.length&&(h=g.find(d.Model.choices,function(b){return b.choiceId===a.Id.toString()}));var j=h&&h.description||a.Description;return f.createElement("td",e({},i,{key:c,id:b.getLabelId(c)}),f.createElement("span",null,j))}),f.createElement("thead",{className:"office-form-matrix-pthead"},f.createElement("tr",{className:"office-form-matrix-ptr"},h,a))},b.prototype.createSubQuestionsLayout=function(){var a=this,b=this.props.Master,c=b.Question.Model.ChoiceGroup,d=b.SubQuestions,h=this.showPadView(),i=this.questionLocalizedItemMaster,k=g.map(d,function(d,g){var k={Choices:c,Disabled:a.props.Disabled,IsExpanded:a.state.IsSubQuestionsExpanded[g],LocaleId:i&&i.Model.localeId||"",onChange:function(b,c){return a.questionExpandedChange(b,c)},PadView:!!h,QuestionIndex:g,QuestionMaster:d,QuestionOrdinal:a.getQuestionId(),QuestionRuntimeMaster:b.getSubQuestionRuntimeById(d.Model.Id),ShowDesignInfo:!!a.props.ShowDesignInfo};return f.createElement(j.LikertSubQuestionRenderer,e({},k,{key:d.getInstanceId()}))});return k},b.prototype.showPadView=function(){return this.props.IsMobile||!this.props.ShowDesignInfo&&m()},b.prototype.questionExpandedChange=function(a,b){var c=this.props.Master.SubQuestions.length,d=[];c>a&&(d[a]=b),this.setState({IsSubQuestionsExpanded:d})},b.prototype.getLabelId=function(a){return this.getQuestionId()+"-col-"+(a+1)},b}(k.QuestionRendererBase);i.registerRendererComponentClass(l.QuestionType.MatrixChoiceGroup,n)},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var e=c(0),f=c(10),g=c(77),h=c(15),i=c(16),j=OfficeForm.Exports.Models,k=function(a){function b(b){var c=a.call(this,b)||this;return c.onValueChangeCallback=function(a){return c.props.Master.Model.Answer=a},c}return d(b,a),b.prototype.componentWillMount=function(){a.prototype.componentWillMount.call(this),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.update,[f.QuestionLocalizedItemMaster.Schema.leftDescription,f.QuestionLocalizedItemMaster.Schema.rightDescription])},b.prototype.componentWillUnmount=function(){this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.update),a.prototype.componentWillUnmount.call(this)},b.prototype.createReactNodes=function(){var a=this.props.Master.Question.Model,b=this.props.Master.Model,c=this.questionLocalizedItemMaster,d=c&&c.Model,f=d&&d.leftDescription||a.LeftDescription,h=d&&d.rightDescription||a.RightDescription;return[e.createElement("div",{key:"nps",className:"office-form-question-nps-container"},e.createElement(g.NPSControl,{ClassNameForInnerLabel:"office-form-theme-button-foreground",Disabled:this.props.Disabled,HTMLAttributes:this.getElementProps(),LeftLabel:f,RightLabel:h,onValueChange:this.onValueChangeCallback,Value:b.Answer}))]},b}(i.QuestionRendererBase);h.registerRendererComponentClass(j.QuestionType.NPS,k)},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),e=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};Object.defineProperty(b,"__esModule",{value:!0});var f,g=c(0),h=c(3),i=c(11),j=c(10),k=c(2),l=c(9),m=c(15),n=c(16),o=OfficeForm.Exports.Control,p=OfficeForm.Exports.JavaScriptLoader,q=OfficeForm.Exports.Models,r=OfficeForm.Exports.Resources,s=OfficeForm.Exports.Utilities;!function(a){a[a.Up=0]="Up",a[a.Down=1]="Down"}(f=b.Direction||(b.Direction={}));var t=function(a){function b(b){var c=a.call(this,b)||this;return c.selectedClass="office-form-theme-sort-item office-form-selected-item",c.focusStatus=-1,c.selectedIndex=-1,c.rankingRef=g.createRef(),c.isDragging=!1,c.sortableInitialized=!1,c.updateChoicesInternally(),c.rankUp=c.rankUp.bind(c),c.rankDown=c.rankDown.bind(c),c.focusOnSortItem=c.focusOnSortItem.bind(c),c.blurOnSortItem=c.blurOnSortItem.bind(c),c.onKeyDown=c.onKeyDown.bind(c),c.decorateSortableGroup=c.decorateSortableGroup.bind(c),c.onDragStart=c.onDragStart.bind(c),c.onDragEnd=c.onDragEnd.bind(c),c}return d(b,a),b.prototype.componentWillMount=function(){var b=this;a.prototype.componentWillMount.call(this),p.loadJavaScript("Sortable").done(function(){b.setState({SortableLoaded:!0})}),this.choicesUpdate=function(){b.updateChoicesInternally(),b.forceUpdate()},this.props.Master.Question.observe(this.choicesUpdate,[q.QuestionMaster.Schema.ChoiceGroup]),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.choicesUpdate,[j.QuestionLocalizedItemMaster.Schema.choices])},b.prototype.componentWillUnmount=function(){this.sortable&&(this.sortable.destroy(),this.sortable=void 0),a.prototype.componentWillUnmount.call(this),this.props.Master.Question.unobserve(this.choicesUpdate),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.choicesUpdate)},b.prototype.componentWillReceiveProps=function(b){a.prototype.componentWillReceiveProps.call(this,b),b.ShowQuizResult&&this.updateChoicesInternally(),(b.ShowDesignInfo||b.Disabled)&&this.sortable&&(this.sortable.destroy(),this.sortable=void 0)},b.prototype.componentDidMount=function(){a.prototype.componentDidMount.call(this);var b=this.rankingRef.current;!this.props.ShowDesignInfo&&!this.props.Disabled&&this.state.SortableLoaded&&b&&this.decorateSortableGroup(b)},b.prototype.componentDidUpdate=function(a,b){if(this.choices&&this.choices.length>0&&-1!==this.focusStatus&&this.updateFocusStatus(),!this.props.ShowDesignInfo&&!this.props.Disabled&&this.state.SortableLoaded&&!this.sortable){var c=this.rankingRef.current;c&&this.decorateSortableGroup(c)}},b.prototype.createReactNodes=function(){var a=this.createSortableList(),b=this.createCorrectAnswerList(),c=this.props.IsMobile?"office-form-mobile-sort-list":"office-form-sort-list",d=this.getElementProps({className:c,onKeyDown:this.onKeyDown,ref:this.rankingRef,role:"listbox"});return[g.createElement("div",e({},d,{key:"Ranking"}),a),b]},b.prototype.decorateSortableGroup=function(a){var b=150,c={animation:b,chosenClass:"office-form-sortable-chosen",delay:this.props.IsMobile?b:0,fallbackClass:"office-form-sortable-fallback",filter:".office-form-ranking-arrow",forceFallback:!0,ghostClass:"office-form-sortable-ghost",handle:".office-form-sort-item",onEnd:this.onDragEnd,onStart:this.onDragStart,preventOnFilter:!1};try{this.sortable=Sortable.create(a,c),this.sortableInitialized||k.log({eventName:"DesignPage.Questions.SortableInitialization",eventType:"engagement_event",extraData:{Successful:!0}}),this.sortableInitialized=!0}catch(d){k.log({eventName:"DesignPage.Questions.SortableInitialization",eventType:"engagement_event",extraData:{Successful:!1}}),this.sortableInitialized=!1}},b.prototype.onDragStart=function(a){if(this.isDragging=!0,-1!==this.selectedIndex&&this.selectedIndex!==a.oldIndex){var b=this.rankingRef.current;if(b){var c=this.selectedIndex+(this.selectedIndex>a.oldIndex?1:0),d=b.children[c];d&&$(d.firstElementChild).removeClass(this.selectedClass)}}},b.prototype.onDragEnd=function(a){var b=a.oldIndex,c=a.newIndex,d=this.props.Master.Model.Answer;if(this.isDragging=!1,d&&b===c)a.item.firstChild.focus();else{var e=this.rankingRef.current;c>b?$(e).find(".office-form-sort-item-container:eq("+b+")").before($(a.item)):b>c&&$(e).find(".office-form-sort-item-container:eq("+b+")").after($(a.item)),this.focusStatus=0,this.moveElement(b,c)}},b.prototype.createSortableList=function(){var a=this,b=this.props.Master.Model.Answer,c=this.shouldShowJudgeIcon(),d=b&&b.length>0;return h.map(this.choices,function(b,e){return a.createRankItem(b,e,c,d)})},b.prototype.createRankItem=function(a,c,d,f){var i,j=this.questionLocalizedItemMaster;if(j){var k=h.find(j.Model.choices,function(b){return b.choiceId===a.Id.toString()});i=k&&k.description||""}i=i||a.Description;var m;if(f&&d){var n=this.props.Master.Model.QuizResult,p=JSON.parse(n.GradingBasis),q=a.Key===p[c];m=g.createElement("span",{className:"office-form-sort-item-icon"},b.getAnswerKeyMark(q))}!this.props.Disabled&&this.props.IsMobile&&(m=b.createDragHandleIcon());var t,u=g.createElement("div",{className:"office-form-sort-item-indicator"},m,g.createElement("span",{className:"office-form-sort-item-ordinal office-form-theme-secondary-color"},f?c+1:void 0)),v=this.getQuestionId()+"-"+c,w={"aria-posinset":c+1,"aria-setsize":this.choices.length,className:"office-form-sort-item",disabled:this.props.Disabled,id:v,role:"option",tabIndex:this.props.Disabled?void 0:0};if(!this.props.Disabled){var x={disabled:!0,tabIndex:-1},y=0===c,z={"aria-describedby":v,"aria-label":r.LocalizedStrings.QuestionType_Ranking_ArrowUp_Narrator,className:s.Html.combineAttributes("office-form-ranking-arrow",y?"office-sort-disabled-arrow":"office-form-active-arrow"),onClick:y?void 0:this.rankUp,title:r.LocalizedStrings.QuestionType_Ranking_ArrowUp_Narrator};z=y?s.Html.mergeReactProps(z,x):z;var A={ButtonStyle:"LightBackground",children:o.createFontIconControl({HTMLAttributes:{className:"forms-icon-size18x18"},IconName:"Up"}),HTMLAttributes:z,key:"form-up-arrow"+c},B=g.createElement(l.Button,e({},A)),C=c===this.choices.length-1,D={"aria-describedby":v,"aria-label":r.LocalizedStrings.QuestionType_Ranking_ArrowDown_Narrator,className:s.Html.combineAttributes("office-form-ranking-arrow",C?"office-sort-disabled-arrow":"office-form-active-arrow"),onClick:C?void 0:this.rankDown,title:r.LocalizedStrings.QuestionType_Ranking_ArrowDown_Narrator};D=C?s.Html.mergeReactProps(D,x):D;var E={ButtonStyle:"LightBackground",children:o.createFontIconControl({HTMLAttributes:{className:"forms-icon-size18x18"},IconName:"Down"}),HTMLAttributes:D,key:"form-down-arrow"+c},F=g.createElement(l.Button,e({},E));w=s.Html.mergeReactProps(w,{onBlur:this.blurOnSortItem,onFocus:this.focusOnSortItem}),t=g.createElement("div",{className:"office-form-sort-list-arrows"},B,F)}var G=g.createElement("div",e({},w),u,g.createElement("p",{className:"office-form-sort-item-content"},i),t);return g.createElement("div",{className:"office-form-sort-item-container office-form-unselectable",key:a.Key},G)},b.prototype.focusOnSortItem=function(a){if(!this.isDragging){var b=a.currentTarget;$(b).addClass(this.selectedClass);var c=this.rankingRef.current;if(c){var d=c.children,e=b.parentElement;this.selectedIndex=h.findIndex(d,function(a){return e===a})}}},b.prototype.blurOnSortItem=function(a){var b=a.currentTarget,c=s.Html.getTargetElementOfFocusEvent(a);this.isDragging||b&&c&&b.contains(c)||($(b).removeClass(this.selectedClass),this.selectedIndex=-1)},b.prototype.rankUp=function(){this.resortItems(f.Up)},b.prototype.rankDown=function(){this.resortItems(f.Down)},b.prototype.resortItems=function(a){var b,c=this.selectedIndex;a===f.Up?(this.focusStatus=1,b=c-1):(this.focusStatus=2,b=c+1),this.moveElement(c,b)},b.getAnswerKeyMark=function(a){return o.createFontIconControl({HTMLAttributes:{className:s.Html.combineAttributes("office-form-judge-icon forms-icon-size16x16",a?"office-form-right-answerkey":"office-form-wrong-answerkey")},IconName:a?"CheckMark":"Cancel"})},b.stringifyAnswer=function(a){return h.map(a,function(a,b){return{answerOrder:b,id:a.Id}})},b.createDragHandleIcon=function(){return g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},g.createElement("circle",{cx:"9.5",cy:"6.5",r:"1.5",fill:"currentColor"}),g.createElement("circle",{cx:"14.5",cy:"6.5",r:"1.5",fill:"currentColor"}),g.createElement("circle",{cx:"9.5",cy:"12.5",r:"1.5",fill:"currentColor"}),g.createElement("circle",{cx:"14.5",cy:"12.5",r:"1.5",fill:"currentColor"}),g.createElement("circle",{cx:"9.5",cy:"18.5",r:"1.5",fill:"currentColor"}),g.createElement("circle",{cx:"14.5",cy:"18.5",r:"1.5",fill:"currentColor"}))},b.prototype.shouldShowJudgeIcon=function(){var a=this.props.Master.Question.Model,b=this.props.Master.Model.QuizResult;return this.props.ShowQuizResult&&a.IsQuiz?!!b:!1},b.prototype.createCorrectAnswerList=function(){var a=this.props.Master.Model.QuizResult;if(this.shouldHideCorrectAnswerList())return void 0;var b=this.props.Master.Question.Model.ChoiceGroup,c=JSON.parse(a.GradingBasis),d=c.map(function(a){return h.findWhere(b,{Key:a})}).filter(function(a){return!!a}).map(function(a){return a&&a.Description}),e=d.join(r.LocalizedStrings.VariousLocations_ItemList_Separator),f=s.Html.combineAttributes("office-form-right-answerkey","various-short-text-correct-answer-list-correctness-icon","forms-icon-size14x14"),i=o.createFontIconControl({HTMLAttributes:{"aria-hidden":!0,className:f,role:"presentation"},IconName:"CheckMark"});return g.createElement("div",{className:"various-short-text-correct-answer-list"},i,g.createElement("b",null,r.LocalizedStrings.VariousLocations_CorrectAnswerList_Label," "),e)},b.prototype.shouldHideCorrectAnswerList=function(){var a=this.props.Master.Question.Model,b=this.props.Master.Model.QuizResult;return this.props.ShowDesignInfo||!a.IsQuiz?!0:!b||b.IsAnswerCorrect?!0:!1},b.prototype.onKeyDown=function(a){var b=this.rankingRef.current;if(-1!==this.selectedIndex&&b){var c=b.children,d=c.length,e=this.selectedIndex+d,f=void 0;switch(a.keyCode){case i.KeyCode.ArrowUp:this.focusStatus=-1,f=c[--e%d],f&&f.firstElementChild.focus();break;case i.KeyCode.ArrowDown:this.focusStatus=-1,f=c[++e%d],f&&f.firstElementChild.focus()}}},b.prototype.updateFocusStatus=function(){var a=this.selectedIndex,b=this.rankingRef.current;if(b){var c=b.children[a];if(c)if(0===this.focusStatus)c.firstElementChild.focus();else{var d=void 0;d=1===this.focusStatus?0===a?1:0:c===b.lastElementChild?0:1;var e=".office-form-sort-list-arrows > button:nth-child("+(d+1)+")";c.querySelector(e).focus()}}this.focusStatus=-1},b.prototype.updateChoicesInternally=function(){var a=this.props.Master,b=a.Question,c=b.Model,d=a.Model.Answer;d&&d.length>0?this.choices=h.clone(d).sort(function(a,b){return a.answerOrder-b.answerOrder}).map(function(a){return h.find(c.ChoiceGroup,function(b){return b.Id===a.id})}).filter(function(a){return!!a}):this.props.ShowDesignInfo||!c.IsQuiz||this.props.ShowQuizResult?this.choices=Nerve.convertToArray(c.ChoiceGroup):this.choices=h.shuffle(c.ChoiceGroup)},b.prototype.moveElement=function(a,c){var d=this.choices.splice(a,1)[0];this.choices.splice(c,0,d),this.selectedIndex=c,this.props.Master.Model.Answer=b.stringifyAnswer(this.choices),this.forceUpdate()},b}(n.QuestionRendererBase);m.registerRendererComponentClass(q.QuestionType.Ranking,t)},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var e=c(10),f=c(15),g=c(16),h=OfficeForm.Exports.Control,i=OfficeForm.Exports.Models,j=OfficeForm.Exports.Resources,k=OfficeForm.Exports.Utilities,l=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return d(b,a),b.prototype.componentWillMount=function(){a.prototype.componentWillMount.call(this),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.update,[e.QuestionLocalizedItemMaster.Schema.leftDescription,e.QuestionLocalizedItemMaster.Schema.rightDescription])},b.prototype.componentWillUnmount=function(){this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.update),a.prototype.componentWillUnmount.call(this)},b.prototype.createReactNodes=function(){var a=this.props.Master,b=a.Question.Model,c=b.Length>3&&(this.props.IsMobile||k.isMobile()),d=this.questionLocalizedItemMaster,e=d&&d.Model,f=e&&e.leftDescription||b.LeftDescription,g=e&&e.rightDescription||b.RightDescription;return b.RatingShape===i.RatingShape.Number?[h.createNumberRating({Disabled:this.props.Disabled,HTMLAttributes:this.getElementProps(),key:"numberRating",Layout:c?"Center":"Left",LeftDescription:f,Length:b.Length,MinRating:b.MinRating,onValueChange:function(b){return a.Model.Answer=b},RightDescription:g,ShowRatingLabel:b.ShowRatingLabel,Value:a.Model.Answer})]:($.rateit.aria.ratingLabel=j.LocalizedStrings.RateItControl_AriaLabel,k.isIOS()&&($.rateit.aria.ratingDescription=j.LocalizedStrings.RateItControl_AriaDescription),[h.createRating({Disabled:this.props.Disabled,IsMobile:!!this.props.IsMobile,key:"rating",Label:"",LeftDescription:f,LeftDescriptionTitle:j.LocalizedStrings.RatingDescriptionTitle.format(1),Length:b.Length,NoTabFocus:this.props.Disabled,onValueChange:function(b){return a.Model.Answer=b},Options:{HTMLPropsForInnerElement:this.getElementProps()},RightDescription:g,RightDescriptionTitle:j.LocalizedStrings.RatingDescriptionTitlePlural.format(b.Length),ShowRatingLabel:b.ShowRatingLabel,Theme:this.props.Theme,ValidationStyle:this.getValidationStyle(),Value:a.Model.Answer})])},b}(g.QuestionRendererBase);f.registerRendererComponentClass(i.QuestionType.Rating,l)},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),e=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};Object.defineProperty(b,"__esModule",{value:!0});var f=c(0),g=c(3),h=c(4),i=c(2),j=c(63),k=c(15),l=c(16),m=OfficeForm.Exports.Control,n=OfficeForm.Exports.FormLimitation,o=OfficeForm.Exports.Models,p=o.QuestionValidationResult,q=OfficeForm.Exports.Resources,r=OfficeForm.Exports.Utilities,s=OfficeForm.Exports.EngagementEventNames,t=OfficeForm.Exports.Flighting,u=!1,v=function(a){function b(b){var c=a.call(this,b)||this;return c.domRole="presentation",c.onMathValueChange=c.onMathValueChange.bind(c),c.toggleMathResponse=c.toggleMathResponse.bind(c),c.validateOnBlur=c.validateOnBlur.bind(c),c.showPhishingFormWarning=c.showPhishingFormWarning.bind(c),c.setInputFieldDefault(),c.props.ShowPhishingWarning&&t.Flight.isEnabled("CheckPhishingForm")&&c.props.Master.Question.updateTitlePhishingInfo(),c}return d(b,a),b.prototype.createReactNodes=function(){var a,b,c=this.props.Master.Model,d=this.props.Master.Question,e=d.Model,g=this.getPhishingWarningLabel(),i=this.getErrorMessageLabel();if(this.props.PrintView)a=f.createElement("div",{className:"textbox-printview",key:"printView"},c.Answer);else{var k=void 0,l=void 0;if(e.IsMathQuiz&&!e.Multiline&&h.getPageContext().Flighting.isEnabled("TextFieldMathAnswers")){var o=this.getCorrectnessIcon(!0),p=e.InputSwitcherDisabled||!e.IsMathInputDefault,s=this.props.Disabled||p?void 0:this.createMathTextSwitcher(),t=void 0,u=void 0;if(c.AnswerEntity)t=c.AnswerEntity.IsMathAnswer,u=c.AnswerEntity.Answer;else{t=!e.IsAnswerPlainText;var v=r.tryParseJson(c.Answer||"{}");u=v.Answer||""}if(t){var w=e.InputSwitcherDisabled?q.LocalizedStrings.TextField_EnterMathAnswer:q.LocalizedStrings.TextField_DefaultPlaceholder,x={onBlur:this.validateOnBlur},y=f.createElement(j.FormulaDesigner,{Disabled:this.props.Disabled,HTMLAttributes:x,key:"textmathquestion-mathfield",Location:"TextField.Response",onValueChange:this.onMathValueChange,Placeholder:w,QuestionId:e.Id,Value:u},s);l=f.createElement("div",{className:"office-form-response-question-math-container"},y,o)}else{var z=m.createTextField({AutoSelection:!0,Disabled:this.props.Disabled,HTMLAttributes:{className:"design-question-math-plaintext-text",onBlur:this.validateOnBlur},key:"textmathquestion-textfield",Label:void 0,MaxLength:n.AnswerTextfieldLength,MinimalHeight:40,onValueChange:this.onMathValueChange,Options:{HTMLPropsForInnerElement:this.getElementProps({className:"design-question-math-plaintext-text"})},Placeholder:q.LocalizedStrings.TextField_DefaultPlaceholder,Theme:this.props.Theme,ValidationStyle:this.getValidationStyle(),Value:u});l=f.createElement("div",{className:"office-form-response-question-math-textfield"},z,s,o)}b=f.createElement("div",{className:"student-feedback-view-short-text-field-with-correctness",key:"normalView"},l)}else{k=m.createTextField({Disabled:this.props.Disabled,HTMLAttributes:{onBlur:this.validateOnBlur,onFocus:this.showPhishingFormWarning},key:"textquestion-textfield",Label:void 0,MaxLength:n.AnswerTextfieldLength,onValueChange:function(a){return c.Answer=a},Options:{HTMLPropsForInnerElement:this.getElementProps({className:"office-form-question-textbox"})},Placeholder:e.IsNumber?d.getNumberValidationErrorMessage():e.Placeholder||q.LocalizedStrings.TextField_DefaultPlaceholder,TextFieldType:e.Multiline?m.TextFieldType.AutoHeightMultiline:m.TextFieldType.SingleLine,Theme:this.props.Theme,ValidationStyle:this.getValidationStyle(),Value:c.Answer});var o=this.getCorrectnessIcon();b=f.createElement("div",{className:"student-feedback-view-short-text-field-with-correctness",key:"normalView"},k,o)}}return[a,b,this.createCorrectAnswerList(),g,i]},b.prototype.createMathTextSwitcher=function(){var a=this.props.Master.Question.Model,b="design-question-choice-to-math-button";this.props.IsMobile&&(b=r.Html.combineAttributes(b,"isMobile"));var c,d;return a.IsAnswerPlainText?(c={"aria-label":q.LocalizedStrings.Designer_Question_Equation_Button,className:b,onClick:this.toggleMathResponse(),title:q.LocalizedStrings.Designer_Question_Equation_Button_Tooltip},d="NumberField"):(c={"aria-label":q.LocalizedStrings.Designer_Question_EquationToText_Button,className:b,onClick:this.toggleMathResponse(),title:q.LocalizedStrings.Designer_Question_EquationToText_Button_Tooltip},d="TextField"),m.createGlyphButton({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:c,Icon:d,IconClassName:"design-question-choice-to-math-button-icon"})},b.prototype.toggleMathResponse=function(){var a=this;return function(b){var c=a.props.Master.Question.Model,d=a.props.Master.Model,e=r.tryParseJson(d.Answer||"{}");c.IsAnswerPlainText=!c.IsAnswerPlainText;var f={Answer:e.Answer,IsMath:!c.IsAnswerPlainText};d.Answer=JSON.stringify(f),i.log({eventName:c.IsAnswerPlainText?s.DesignPage.Quiz.SwitchMathToTextInput:s.DesignPage.Quiz.SwitchTextToMathInput,eventType:"engagement_event",extraData:{location:"TextField.Response",questionId:c.Id}}),a.forceUpdate()}},b.prototype.setInputFieldDefault=function(){var a=this.props.Master.Question.Model,b=this.props.Master;if(!a.IsMathQuiz||!h.getPageContext().Flighting.isEnabled("TextFieldMathAnswers"))return void(a.IsAnswerPlainText=!0);if(b.Model.Answer){var c=r.tryParseJson(b.Model.Answer||"{}");if(void 0!==c.IsMath)return void(a.IsAnswerPlainText=!c.IsMath)}a.IsAnswerPlainText=!a.IsMathInputDefault},b.prototype.onMathValueChange=function(a){var b=this.props.Master.Model,c={Answer:a,IsMath:!this.props.Master.Question.Model.IsAnswerPlainText};b.Answer=JSON.stringify(c)},b.prototype.validateOnBlur=function(){var a=this.props.Master.Model,b=this.props.Master.Question;if(b.Model.IsNumber){var c=a.Answer;b.verify(c)!==p.Success||b.Model.IsMathQuiz||(a.Answer=r.NumberValidation.formatAsFloat(c))}},b.prototype.showPhishingFormWarning=function(){this.props.Master.Model.ShowPhishingFormWarning=!0,u||(u=!0,i.log({eventName:"ResponsePage.Phshing.Warning",eventType:"engagement_event"}))},b.prototype.getErrorMessageLabel=function(){var a=this.props.Master.Model,b=this.props.Master.Question,c=b.verify(a.Answer);if(a.Answer&&c!==p.Success){var d=void 0;switch(c){case p.NumberValidationError:d=b.getNumberValidationErrorMessage();break;case p.MathLengthError:d=q.LocalizedStrings.Math_Answer_LengthLimit_Message;break;default:return void 0}return m.createLabel({Alert:!0,HTMLAttributes:{className:"validation-error-message-label",role:"alert"},key:"textquestion-errorlabel",Label:d})}},b.prototype.getPhishingWarningLabel=function(){if(!this.props.ShowPhishingWarning||!t.Flight.isEnabled("CheckPhishingForm"))return void 0;var a=this.props.Master.Model,b=this.props.Master.Question;if(a.ShowPhishingFormWarning&&b.Model.TitleAndSubTitleHasPhishingKeywords){var c=m.createLabel({Alert:!0,HTMLAttributes:{className:"phishing-notice-message-label",role:"alert"},key:"textquestion-errorlabel",Label:q.LocalizedStrings.Response_Page_Textfield_Question_Notice}),d=(r.isOEmbedSPO()?"office-form-notice-report office-form-theme-spo-link":"office-form-notice-report")+" phishing-notice-message-label",e=".";return f.createElement("div",{className:"phishing-notice-message"},c,f.createElement("a",{className:d,href:"javascript:void(0)",onClick:this.props.setAbuseReportStateCallBack},q.LocalizedStrings.Response_Page_Textfield_Question_Report),e);
}},b.prototype.getCorrectnessIcon=function(a){var c=this.props.Master,d=this.props.Master.Question,g=d.Model;if(!this.props.ShowQuizResult||g.Multiline||!g.IsQuiz)return void 0;var h=b.isAnswerCorrect(c);if(null===h)return void 0;if(!h&&!this.props.IsMobile)return void 0;var i=a?"student-feedback-view-short-text-math-correctness-icon-container":"student-feedback-view-short-text-correctness-icon-container";this.props.IsMobile&&(i=r.Html.combineAttributes(i,"isMobile"));var j,k=h?q.LocalizedStrings.Quiz_CorrectAnswer:q.LocalizedStrings.Quiz_WrongAnswer,l={HTMLAttributes:{className:r.Html.combineAttributes("student-feedback-view-short-text-correctness-icon forms-icon-size14x14",h?"image-button-answerkey":"image-button-checked-wrong-answer"),title:k},IconName:h?"CheckMark":"Cancel"},n=c.Model.Answer;if(j=n,!n||r.Guid.isNullOrEmpty(n))j=g.Placeholder||q.LocalizedStrings.TextField_DefaultPlaceholder;else if(d.Model.IsMathQuiz){var o=r.tryParseJson(n||"{}");j=o.IsMath?m.createFormulaRenderer({Formula:null==o.Answer?n:o.Answer}):null==o.Answer?n:o.Answer}var p={"aria-hidden":!0,className:"student-feedback-view-short-text-hidden-text-to-position-correctness-icon",role:this.domRole};return f.createElement("div",{className:i},f.createElement("span",e({},p),j),m.createFontIconControl(l))},b.isAnswerCorrect=function(a){var b=a.Model;if(null!=b.QuizResult)return b.QuizResult.IsAnswerCorrect;var c=new o.ShortTextAutograder(a.Question.Model);return c.areAnyAnswersDefined()?a.Question.isCorrectAnswer(b.Answer):null},b.prototype.createCorrectAnswerList=function(){var a=this.props.Master.Question.Model,b=this.props.Master.Model.QuizResult;if(!this.shouldShowCorrectAnswerList())return void 0;var c=null!=b?b:a,d=new o.ShortTextAutograder(c);if(!d.areAnyAnswersDefined())return void 0;var e,h=d.getAnswers();if(h.some(function(a){return a.isMath})){for(var i=[],j=0,k=h;j<k.length;j++){var l=k[j];if(l.isMath){var n=m.createFormulaRenderer({Formula:l.answer});i.push(f.createElement("div",{className:"correct-answer-list-formula-element"},n))}else i.push(l.answer);i.push(q.LocalizedStrings.VariousLocations_ItemList_Separator)}i.pop(),e=f.createElement("div",{className:"correct-answer-list-formula-container"},i)}else e=g.map(h,function(a){return a.answer}).join(q.LocalizedStrings.VariousLocations_ItemList_Separator);var p={"aria-hidden":!0,className:"office-form-right-answerkey various-short-text-correct-answer-list-correctness-icon",role:this.domRole},r={HTMLAttributes:p,IconName:""};return f.createElement("div",{className:"various-short-text-correct-answer-list",key:"answerList"},m.createFontIconControl(r),f.createElement("b",null,q.LocalizedStrings.VariousLocations_CorrectAnswerList_Label," "),e)},b.prototype.shouldShowCorrectAnswerList=function(){var a=this.props.Master.Model,b=this.props.Master.Question.Model,c=this.props.Master.Model.QuizResult,d=b.Multiline||!b.IsQuiz;if(d)return!1;var e=!this.props.ShowDesignInfo&&null==c;if(e)return!1;var f=null!=c&&c.IsAnswerCorrect;if(f)return!1;var g=null==c&&this.props.Master.Question.isCorrectAnswer(a.Answer);return g?!1:!0},b}(l.QuestionRendererBase);k.registerRendererComponentClass(o.QuestionType.TextField,v)},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var e=c(0),f=c(1),g=OfficeForm.Exports.Utilities,h=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return d(b,a),b.prototype.render=function(){var a="form-renderer-section-breaker";return this.props.HasTheme&&(a=g.Html.combineAttributes(a,"office-form-theme-page-background")),e.createElement("div",{className:a})},b}(f.ReactComponent);Forms.UX.Renderer.SectionBreaker=h},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var e=c(0),f=c(1),g=c(56),h=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return d(b,a),b.prototype.render=function(){return e.createElement("div",{className:"form-renderer-section-container",role:"region","aria-label":this.props.SectionMaster.Model.Title},this.createSectionTitle(),e.createElement("div",{className:"form-renderer-section-content"},this.props.children))},b.prototype.createSectionTitle=function(){var a=this.props.SectionMaster.Model;return a.Title||a.Subtitle||a.ImageInfo.ResourceUrl||a.VideoInfo.Url?e.createElement("div",{className:"form-renderer-section-title"},e.createElement(g.SectionTitleRenderer,{IsMobile:this.props.IsMobile,LocaleId:this.props.LocaleId,Master:this.props.SectionMaster,Ordinal:this.props.Ordinal})):null},b}(f.ReactComponent);b.SectionRender=h,Forms.UX.Renderer.SectionRender=h},function(a,b,c){"use strict";function d(){e();var a="/Pages/DesignPage.aspx";return s.IsExternalIntegration||(a+="?"+jQuery.param(u.getNonEmbedQuery())),k.redirectTo(a),!0}function e(){return m.log({eventName:v.NavigateToPortal,eventType:"engagement_event"}),!0}function f(){return e(),k.redirectTo("/Pages/DesignPage.aspx"),!0}var g=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),h=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};Object.defineProperty(b,"__esModule",{value:!0});var i=c(0),j=c(8),k=c(6),l=c(12),m=c(2),n=c(75),o=c(5),p=c(1),q=c(25),r=c(71),s=OfficeForm.Exports.EnvironmentSettings,t=OfficeForm.Exports.Resources,u=OfficeForm.Exports.Utilities,v=OfficeForm.Exports.EngagementEventNames.ResponsePage.ThanksView,w=200,x=function(a){function b(b){var c=a.call(this,b)||this;return c.contentRef=i.createRef(),c.titleRef=i.createRef(),c.notifyHeightToParentWindow=c.notifyHeightToParentWindow.bind(c),c}return g(b,a),b.prototype.componentDidMount=function(){m.log({eventName:v.Navigate,eventType:"engagement_event"}),u.isOEmbedSPO()&&(this.notifyHeightToParentWindow(),window.addEventListener("resize",this.notifyHeightToParentWindow))},b.prototype.componentWillUnmount=function(){u.isOEmbedSPO()&&window.removeEventListener("resize",this.notifyHeightToParentWindow)},b.prototype.render=function(){var a="office-form thank-you-page-content";this.props.viewResultsHandler&&(a=u.Html.combineAttributes(a,"quiz")),this.props.submitAnother||(a=u.Html.combineAttributes(a,"one-response"));var b,c=!u.isOEmbedSPO()&&i.createElement("div",{className:"thank-you-page-footer-container"},this.createPromotionLink(),i.createElement(q.FooterControl,null)),d=this.props.LocaleId;if(d){var e=l.FormLocalizedItemMaster.getFormResourceMaster(d,this.props.FormMaster);b=e.Model.thankYouMessage}b=b||this.props.FormMaster.Model.ThankYouMessage||t.LocalizedStrings.Renderer_SubmissionSucceeded;var f=r.createTitleContainer({Form:this.props.FormMaster,IsSmallSize:!0,LocaleId:d,ref:this.titleRef}),g=i.createElement(n.MessageContent,{ConfirmText:t.LocalizedStrings.Response_Page_Thanks,Message:b});return i.createElement("div",{className:"thank-you-page-root-container"},f,i.createElement("div",{ref:this.contentRef,className:a},g,i.createElement("div",{className:"thank-you-page-other"},this.createQuizButton(),this.createReloadLink())),c)},b.prototype.notifyHeightToParentWindow=function(){if(this.contentRef.current&&this.titleRef.current){var a=$(this.contentRef.current).height()+$(j.findDOMNode(this.titleRef.current)).height()+w;u.OEmbed.notifyResponsePageFixedHeightToParentWindow(a)}},b.prototype.createQuizButton=function(){var a={ButtonStyle:"LightBackground",HTMLAttributes:{className:"office-form-view-result-button office-form-theme-button",onClick:this.props.viewResultsHandler},Text:t.LocalizedStrings.Response_Thank_You_Page_Button_Quiz_ViewResults};return this.props.viewResultsHandler&&i.createElement(o.TextButton,h({},a))},b.prototype.createReloadLink=function(){var a="office-form-info-children",b="thank-you-page-reload-link";return this.props.viewResultsHandler&&(b=u.Html.combineAttributes(b,"quiz")),u.isOEmbedSPO()&&(a=u.Html.combineAttributes(a,"office-form-theme-spo-link")),this.props.submitAnother?i.createElement("div",{className:b},i.createElement("a",{className:a,href:"javascript:void(0)",onClick:this.props.submitAnother},t.LocalizedStrings.Response_Submit_Again_Link)):void 0},b.prototype.createPromotionLink=function(){var a="office-form-info-children";if(this.props.ShowPromotionMessage&&!s.IsAssignmentsIntegration){var b={className:a,href:"javascript:void(0)",onClick:f};(u.isOEmbed()||s.IsExternalIntegration)&&(b.onClick=d);var c="office-form-theme-footer thank-you-page-promotion office-form-padding-align";return i.createElement("div",{className:c},i.createElement("a",h({},b),t.LocalizedStrings.Renderer_PromotionMessage))}},b}(p.ReactComponent);Forms.UX.Renderer.ThankYouPage=x},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var e=c(0),f=c(1),g=OfficeForm.Exports.Models,h=OfficeForm.Exports.Utilities,i=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.subTitleRef=e.createRef(),b}return d(b,a),b.prototype.componentWillMount=function(){var a=this;this.update=function(){return a.forceUpdate()};var b=g.FormMaster.Schema;this.props.Form.observe(this.update,[b.Title,b.Description,b.LogoInfo])},b.prototype.componentDidMount=function(){$(this.subTitleRef.current).linkify()},b.prototype.componentWillUnmount=function(){this.props.Form.unobserve(this.update)},b.prototype.render=function(){var a,b=this.props.Form,c=b.Model,d=c.LogoInfo;if(c.Logo&&c.Logo.ResourceUrl&&d.TargetResourceId){var f=b.getImageMaster(g.FormMaster.Schema.Logo);a=e.createElement("div",{className:"logo-image-container old"},e.createElement(OfficeForm.Exports.ImageRenderer,{Image:f,ImageSettings:b.getImageSettingsMaster(g.FormMaster.Schema.LogoInfo),ImageType:"Logo"}),OfficeForm.Exports.createImageSpinner(f.Model))}var i;c.Description&&!this.props.IsSmallSize&&(i=e.createElement("div",{className:"office-form-subtitle heading-1",ref:this.subTitleRef},c.Description));var j=h.Html.combineAttributes("__title__ office-form-title-container office-form-form-title office-form-theme-primary-background",this.props.IsSmallSize?"small-size":void 0);return e.createElement("div",{className:j},e.createElement("div",{className:"office-form-logo-title"},a,e.createElement("div",{className:"office-form-title heading-1"},e.createElement("span",{role:"heading","aria-level":1},c.Title))),i)},b}(f.ReactComponent);b.TitleContainerV1=i,Forms.UX.Renderer.TitleContainerV1=i},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),c(38),c(65),c(76),c(22),c(66),c(67),c(68),c(12),c(86),c(17),c(10),c(9),c(91),c(5),c(79),c(46),c(94),c(69),c(74),c(25),c(98),c(99),c(100),c(101),c(102),c(70),c(103),c(104),c(105),c(106),c(152),c(107),c(108),c(56),c(109),c(81),c(71),c(53),c(59)},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),e=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};Object.defineProperty(b,"__esModule",{value:!0});var f,g=c(0),h=c(18),i=c(2),j=c(75),k=c(5),l=c(1),m=c(25),n=OfficeForm.Exports.Control,o=OfficeForm.Exports.EnvironmentSettings,p=OfficeForm.Exports.Resources,q=OfficeForm.Exports.Utilities;!function(a){a[a.Phishing=1]="Phishing",a[a.ThreatsCyberbullyingHarassment=2]="ThreatsCyberbullyingHarassment",a[a.ChildEndangermentExploitation=3]="ChildEndangermentExploitation",a[a.OffensiveContent=4]="OffensiveContent",a[a.VirusSpywareMalware=5]="VirusSpywareMalware",a[a.ContentInfringement=6]="ContentInfringement",a[a.Other=7]="Other"}(f||(f={}));var r;!function(a){a[a.NotReported=0]="NotReported",a[a.Reportting=1]="Reportting",a[a.Failed=2]="Failed",a[a.Succeed=3]="Succeed"}(r||(r={}));var s=function(a){function b(b){var c=a.call(this,b)||this;return c.state={Notes:"",ReportState:r.NotReported},c.clickSubmitButton=c.clickSubmitButton.bind(c),i.log({eventName:"ReportPage.Navigate",eventType:"engagement_event"}),c}return d(b,a),b.prototype.render=function(){var a,c=Forms.Common.isOwnerMsaUser(),d=c?"https://go.microsoft.com/fwlink/?linkid=866263":"http://go.microsoft.com/fwlink/p/?LinkId=869010",e=b.addInlineLink(p.LocalizedStrings.Report_Page_Question,d);return a=this.state.ReportState===r.Succeed?g.createElement("div",{className:"office-form thank-you-page-content"},g.createElement(j.MessageContent,{ConfirmText:p.LocalizedStrings.Report_Page_Thanks,Message:p.LocalizedStrings.Report_Page_Submit_Succeed_Message})):g.createElement("div",{className:"office-form-body"},g.createElement("div",null,g.createElement("span",{className:"office-form-report-title",dangerouslySetInnerHTML:{__html:e}})),g.createElement("div",null,this.createOptions(c)),g.createElement("div",null,this.createComments(),g.createElement("div",{className:"office-form-bottom-button-div"},this.createSubmitButton()))),g.createElement("div",null,b.createTitle(),g.createElement("div",null,a),g.createElement(m.FooterControl,null))},b.createTitle=function(){return g.createElement("div",{className:"office-form-title-container office-form-form-title office-form-theme-primary-background"},g.createElement("div",{className:"office-form-title heading-1"},g.createElement("span",{role:"heading"},p.LocalizedStrings.Report_Page_Title)))},b.prototype.createOptions=function(a){var b=this,c=[],d=function(d){if(f[d]){var i=parseInt(d,10);if(!a&&i>f.Phishing&&i<f.Other)return"continue";if(!isNaN(i)){var j=f[d],k={"aria-checked":h.state.Category===i,"aria-posinset":i+1,checked:h.state.Category===i,name:j,onChange:function(){return b.setState({Category:i})},role:"radio",type:"radio"},l=p.LocalizedStrings,m="Report_Page_Choice_"+j;c.push(g.createElement("div",{className:"radio office-form-question-choice office-form-question-choice-margin",key:i},g.createElement("label",{className:"office-form-question-choice-row office-form-question-choice-text-row"},g.createElement("input",e({},k)),g.createElement("span",{className:"office-form-question-choice-text-span"},l[m]))))}}},h=this;for(var i in f)d(i);return c},b.prototype.createComments=function(){var a=this;if(this.state.Category===f.ContentInfringement){var c=b.addInlineLink(p.LocalizedStrings.Report_Page_Notice_content,"https://www.microsoft.com/info/cpyrtInfrg.aspx");return g.createElement("div",{className:"office-form-notice-contaienr"},g.createElement("div",{className:"office-form-notice"},p.LocalizedStrings.Report_Page_Notice),g.createElement("div",null,g.createElement("span",{dangerouslySetInnerHTML:{__html:c}})))}var d=n.createTextField({MaxLength:1e3,MinimalHeight:100,onValueChange:function(b){return a.setState({Notes:b})},Placeholder:p.LocalizedStrings.Report_Page_PlacheHolder,TextFieldType:n.TextFieldType.AutoHeightMultiline,Value:this.state.Notes});return g.createElement("div",{className:"office-form-comments-container"},g.createElement("div",{className:"office-form-comments-title"},p.LocalizedStrings.Report_Page_Comments),g.createElement("div",{className:"office-form-comments-textfield"},d))},b.prototype.createSubmitButton=function(){var a=this.state.Category===f.ContentInfringement?p.LocalizedStrings.Report_Page_OkayButton:p.LocalizedStrings.Report_Page_SubmitButton,b=this.state.ReportState===r.Reportting,c={ButtonStyle:"LightBackground",HTMLAttributes:{className:q.Html.combineAttributes("__submit-button__ office-form-bottom-button office-form-theme-button",b?"office-form-hide-text":""),disabled:b,onClick:this.clickSubmitButton},Text:b?p.LocalizedStrings.Report_Page_Submitting_Message:a},d=g.createElement(k.TextButton,e({},c));return g.createElement("div",null,d,this.createSpinner())},b.prototype.submitReportLog=function(){i.log({eventName:"ReportPage.Submit",eventType:"engagement_event",extraData:{category:this.state.Category&&f[this.state.Category],formId:h.getCurrentFormId()}})},b.prototype.submitReport=function(){var a=this;this.setState({ReportState:r.Reportting}),OfficeForm.Exports.DataProvider.createDataProvider().reportAbuse({Category:this.state.Category&&f[this.state.Category],Notes:this.state.Notes,Url:window.location.href}).done(function(){a.setState({ReportState:r.Succeed})}).fail(function(b){a.setState({ReportState:r.Failed})})},b.addInlineLink=function(a,b){return q.isOEmbedSPO()||o.IsExternalIntegration?a.replace("<a>",'<a href="'+b+"\" target='_blank'>"):a.replace("<a>",'<a href="'+b+'" >')},b.prototype.clickSubmitButton=function(){this.submitReportLog(),this.state.Category!==f.ContentInfringement&&this.submitReport()},b.prototype.createSpinner=function(){if(this.state.ReportState===r.Reportting){var a={className:"screenReaderVisible"};return g.createElement("div",{className:"submit-spinner"},g.createElement("div",{className:"spinner-tile-animation"},g.createElement(Forms.UX.Controls.LiveRegion,{HTMLAttributes:a,LazyRendering:!0,Role:"Log"},p.LocalizedStrings.Response_Page_Submitting_Message)))}return null},b}(l.ReactComponent);b.ReportPage=s,Forms.UX.Renderer.ReportPage=s},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),c(314)},function(a,b,c){"use strict";function d(){e();var a=Forms.PerformanceAnalysis.requestWithPromise("pre-auth",Forms.Authenticator.handleAuthForContentPage(!1));a.done(function(){f.log({eventName:"session_start",eventType:"session_start"});var a=OfficeForm.Exports.Models.createResponseFormMaster(k.Html.getQueries().id);if(OfficeForm.Exports.RuntimeFormPage.showForm(a,function(){return a.ensureReadyToResponse()}),k.Html.getQueries().qrcode&&f.log({eventName:"ResponsePage.Form.QRCode",eventType:"engagement_event"}),k.isOEmbed()){var b=k.Html.getQueries().platform,c=k.Html.getQueries().host,d=void 0;(b||c)&&(d={host:c,platform:b}),f.log({eventName:"ResponsePage.EmbedView.IsEmbeddedSession",eventType:"engagement_event",extraData:d})}}).fail(function(a){return OfficeForm.Exports.RuntimeFormPage.showErrorPage("Error",!1,a)})}function e(){var a="forms.scriptloadinglog";if(i.Flight.isEnabled("CheckScriptLoading")){var b=j.LocalStorage.getItem(a),c=JSON.parse(b);b&&c&&0!==c.length&&(c.forEach(function(a){switch(a.result){case"start":f.log({eventName:"ResponsePage.LoadingScript.Start",eventType:"engagement_event",extraData:{timestamp:a.timestamp,session:a.session}});break;case"success":f.log({eventName:"ResponsePage.LoadingScript.Success",eventType:"engagement_event",extraData:{timestamp:a.timestamp,script:a.script,session:a.session}});break;case"failure":f.log({eventName:"ResponsePage.LoadingScript.Failure",eventType:"engagement_event",extraData:{timestamp:a.timestamp,script:a.script,session:a.session}})}}),j.LocalStorage.removeItem(a))}}Object.defineProperty(b,"__esModule",{value:!0});var f=c(2),g=c(14);c(37);var h=c(4);c(151);var i=OfficeForm.Exports.Flighting,j=OfficeForm.Exports.SafeStorage,k=OfficeForm.Exports.Utilities;h.initializePageContext({authenticators:[]}),h.getPageContext().setFlightsBasingOnAuth_Deprecated(OfficeFormServerInfo.flights),g.initializeTelemetry(),Forms.PerformanceAnalysis.addCheckPoint("0"),d()}]);